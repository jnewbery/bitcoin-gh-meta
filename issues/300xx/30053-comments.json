[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage\nFor detailed information about the code coverage, see the [test coverage report](https://corecheck.dev/bitcoin/bitcoin/pulls/30053).\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [maflcko](https://github.com/bitcoin/bitcoin/pull/30053#issuecomment-2097465074), [rkrux](https://github.com/bitcoin/bitcoin/pull/30053#pullrequestreview-2042752271), [alfonsoromanz](https://github.com/bitcoin/bitcoin/pull/30053#pullrequestreview-2043495326), [tdb3](https://github.com/bitcoin/bitcoin/pull/30053#pullrequestreview-2044504789), [davidgumberg](https://github.com/bitcoin/bitcoin/pull/30053#issuecomment-2099652701) |\n\nIf your review is incorrectly listed, please react with ð to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#29996](https://github.com/bitcoin/bitcoin/pull/29996) (test: Assumeutxo: import snapshot in a node with a divergent chain by alfonsoromanz)\n* [#29428](https://github.com/bitcoin/bitcoin/pull/29428) (test: Assumeutxo: snapshots with less work should not be loaded by hernanmarino)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "created_at" : "2024-05-06T21:32:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/30053#issuecomment-2096959988",
      "id" : 2096959988,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/30053",
      "node_id" : "IC_kwDOABII5858_RH0",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2096959988/reactions"
      },
      "updated_at" : "2024-05-08T03:03:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2096959988",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "ACK ee67bba76cca2355541f99bb731f58479981b29e",
      "created_at" : "2024-05-07T05:18:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/30053#issuecomment-2097465074",
      "id" : 2097465074,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/30053",
      "node_id" : "IC_kwDOABII5859BMby",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 1,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2097465074/reactions"
      },
      "updated_at" : "2024-05-07T05:18:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2097465074",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/30053#discussion_r1592215194"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/30053"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1592215194"
         }
      },
      "author_association" : "NONE",
      "body" : "Got to learn about the functionality of the slash operator in case of Pathlib.Path!\r\nhttps://docs.python.org/3/library/pathlib.html#operators",
      "commit_id" : "ee67bba76cca2355541f99bb731f58479981b29e",
      "created_at" : "2024-05-07T10:34:24Z",
      "diff_hunk" : "@@ -152,6 +152,12 @@ def test_invalid_mempool_state(self, dump_output_path):\n \n         self.restart_node(2, extra_args=self.extra_args[2])\n \n+    def test_invalid_file_path(self):\n+        self.log.info(\"Test bitcoind should fail when file path is invalid.\")\n+        node = self.nodes[0]\n+        path = node.datadir_path / node.chain / \"invalid\" / \"path\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/30053#discussion_r1592215194",
      "id" : 1592215194,
      "line" : 158,
      "node_id" : "PRRC_kwDOABII585e50aa",
      "original_commit_id" : "ee67bba76cca2355541f99bb731f58479981b29e",
      "original_line" : 158,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "test/functional/feature_assumeutxo.py",
      "position" : 7,
      "pull_request_review_id" : 2042752271,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/30053",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1592215194/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-05-07T10:41:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1592215194",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5960750?v=4",
         "events_url" : "https://api.github.com/users/rkrux/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rkrux/followers",
         "following_url" : "https://api.github.com/users/rkrux/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rkrux/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rkrux",
         "id" : 5960750,
         "login" : "rkrux",
         "node_id" : "MDQ6VXNlcjU5NjA3NTA=",
         "organizations_url" : "https://api.github.com/users/rkrux/orgs",
         "received_events_url" : "https://api.github.com/users/rkrux/received_events",
         "repos_url" : "https://api.github.com/users/rkrux/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rkrux/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rkrux/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rkrux"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/30053#discussion_r1593301869"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/30053"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1593301869"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Minor nit:\r\nStyle guidelines prefer `f'{}'`.  (https://github.com/bitcoin/bitcoin/blob/master/test/functional/README.md#style-guidelines)\r\n\r\ne.g. \r\n\r\n```diff\r\ndiff --git a/test/functional/feature_assumeutxo.py b/test/functional/feature_assumeutxo.py\r\nindex a65a11a9b5..47f87297f3 100755\r\n--- a/test/functional/feature_assumeutxo.py\r\n+++ b/test/functional/feature_assumeutxo.py\r\n@@ -156,7 +156,7 @@ class AssumeutxoTest(BitcoinTestFramework):\r\n         self.log.info(\"Test bitcoind should fail when file path is invalid.\")\r\n         node = self.nodes[0]\r\n         path = node.datadir_path / node.chain / \"invalid\" / \"path\"\r\n-        assert_raises_rpc_error(-8, \"Couldn't open file {} for reading.\".format(path), node.loadtxoutset, path)\r\n+        assert_raises_rpc_error(-8, f\"Couldn't open file {path} for reading.\", node.loadtxoutset, path)\r\n \r\n     def run_test(self):\r\n         \"\"\"\r\n```",
      "commit_id" : "ee67bba76cca2355541f99bb731f58479981b29e",
      "created_at" : "2024-05-08T02:26:37Z",
      "diff_hunk" : "@@ -152,6 +152,12 @@ def test_invalid_mempool_state(self, dump_output_path):\n \n         self.restart_node(2, extra_args=self.extra_args[2])\n \n+    def test_invalid_file_path(self):\n+        self.log.info(\"Test bitcoind should fail when file path is invalid.\")\n+        node = self.nodes[0]\n+        path = node.datadir_path / node.chain / \"invalid\" / \"path\"\n+        assert_raises_rpc_error(-8, \"Couldn't open file {} for reading.\".format(path), node.loadtxoutset, path)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/30053#discussion_r1593301869",
      "id" : 1593301869,
      "line" : 159,
      "node_id" : "PRRC_kwDOABII585e99tt",
      "original_commit_id" : "ee67bba76cca2355541f99bb731f58479981b29e",
      "original_line" : 159,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "test/functional/feature_assumeutxo.py",
      "position" : 8,
      "pull_request_review_id" : 2044504789,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/30053",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1593301869/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-05-08T02:31:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1593301869",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/106488469?v=4",
         "events_url" : "https://api.github.com/users/tdb3/events{/privacy}",
         "followers_url" : "https://api.github.com/users/tdb3/followers",
         "following_url" : "https://api.github.com/users/tdb3/following{/other_user}",
         "gists_url" : "https://api.github.com/users/tdb3/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/tdb3",
         "id" : 106488469,
         "login" : "tdb3",
         "node_id" : "U_kgDOBljilQ",
         "organizations_url" : "https://api.github.com/users/tdb3/orgs",
         "received_events_url" : "https://api.github.com/users/tdb3/received_events",
         "repos_url" : "https://api.github.com/users/tdb3/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/tdb3/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/tdb3/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/tdb3"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "LGTM ACK https://github.com/bitcoin/bitcoin/pull/30053/commits/ee67bba76cca2355541f99bb731f58479981b29e\r\n\r\nThis PR improves coverage of the `loadtxoutset` rpc, I tested by removing the error throw from `blockchain.cpp` and verifying that the test complains:\r\n\r\n```diff\r\n FILE* file{fsbridge::fopen(path, \"rb\")};\r\n AutoFile afile{file};\r\n if (afile.IsNull()) {\r\n-    throw JSONRPCError(\r\n-        RPC_INVALID_PARAMETER,\r\n-        \"Couldn't open file \" + path.utf8string() + \" for reading.\");\r\n }\r\n```\r\n+1 to @tdb3 style nit [above](https://github.com/bitcoin/bitcoin/pull/30053#discussion_r1593301869)\r\n\r\nI thought for a bit about whether or not we should also check files with invalid path names or bad permissions, but I think this check sufficiently demonstrates that if a file passed to `loadtxoutset` cannot be opened for any reason at all, an error will be thrown.",
      "created_at" : "2024-05-08T03:03:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/30053#issuecomment-2099652701",
      "id" : 2099652701,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/30053",
      "node_id" : "IC_kwDOABII5859Jihd",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2099652701/reactions"
      },
      "updated_at" : "2024-05-08T03:03:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2099652701",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2257631?v=4",
         "events_url" : "https://api.github.com/users/davidgumberg/events{/privacy}",
         "followers_url" : "https://api.github.com/users/davidgumberg/followers",
         "following_url" : "https://api.github.com/users/davidgumberg/following{/other_user}",
         "gists_url" : "https://api.github.com/users/davidgumberg/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/davidgumberg",
         "id" : 2257631,
         "login" : "davidgumberg",
         "node_id" : "MDQ6VXNlcjIyNTc2MzE=",
         "organizations_url" : "https://api.github.com/users/davidgumberg/orgs",
         "received_events_url" : "https://api.github.com/users/davidgumberg/received_events",
         "repos_url" : "https://api.github.com/users/davidgumberg/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/davidgumberg/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/davidgumberg/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/davidgumberg"
      }
   }
]
