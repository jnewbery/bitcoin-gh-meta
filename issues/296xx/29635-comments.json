[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "For the records, `master` is at d14c7286b653ad09a5a196aa351b325f97db546b (in case this vanishes due to some change in `master`).\r\n\r\nI guess it must be 5316ae5dd8 from https://github.com/bitcoin/bitcoin/pull/28078. That commit can be reversed cleanly on `master`: `git show 5316ae5dd8 |git apply -R`. Can you try if the problem disappears if you do that? If it does, I wouldn't still revert it on `master` without understanding what the problem is actually.\r\n\r\nWhich test is causing this?\r\n\r\ncc @jonatack, @stickies-v.",
      "created_at" : "2024-03-12T14:21:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/29635#issuecomment-1991765866",
      "id" : 1991765866,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29635",
      "node_id" : "IC_kwDOABII5852t-9q",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1991765866/reactions"
      },
      "updated_at" : "2024-03-12T14:21:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1991765866",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Interesting, thanks! Will have a look.",
      "created_at" : "2024-03-12T14:23:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/29635#issuecomment-1991771891",
      "id" : 1991771891,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29635",
      "node_id" : "IC_kwDOABII5852uAbz",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1991771891/reactions"
      },
      "updated_at" : "2024-03-12T14:23:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1991771891",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Which test is causing this?\r\n\r\nIt will likely show up with almost any test i.e you can run `example_test.py`:\r\n```bash\r\n./autogen.sh && ./configure CC=clang CXX=clang++ && make -C src bitcoind && test/functional/test_runner.py example_test.py --combinedlogslen=19999 --timeout-factor=12 --valgrind\r\n.....\r\n test  2024-03-12T14:26:46.321000Z TestFramework.node0 (DEBUG): Stopping node \r\n\r\n node0 stderr ==205278== Thread 26 b-msghand:\r\n==205278== Conditional jump or move depends on uninitialised value(s)\r\n==205278==    at 0x1934C4: _M_reset (optional:313)\r\n==205278==    by 0x1934C4: ~_Optional_payload (optional:437)\r\n==205278==    by 0x1934C4: ~_Optional_base (optional:508)\r\n==205278==    by 0x1934C4: GetLocalAddress(CNode const&) (???:220)\r\n==205278==    by 0x1935B3: GetLocalAddrForPeer(CNode&) (net.cpp:240)\r\n==205278==    by 0x1D0F87: MaybeSendAddr (net_processing.cpp:5401)\r\n==205278==    by 0x1D0F87: (anonymous namespace)::PeerManagerImpl::SendMessages(CNode*) (???:5585)\r\n==205278==    by 0x1A92C7: CConnman::ThreadMessageHandler() (net.cpp:2918)\r\n==205278==    by 0x79017F: operator() (std_function.h:591)\r\n==205278==    by 0x79017F: util::TraceThread(std::basic_string_view<char, std::char_traits<char> >, std::function<void ()>) (???:21)\r\n==205278==    by 0x1B2653: __invoke_impl<void, void (*)(std::basic_string_view<char, std::char_traits<char> >, std::function<void ()>), const char *, (lambda at net.cpp:3267:71)> (invoke.h:61)\r\n==205278==    by 0x1B2653: __invoke<void (*)(std::basic_string_view<char, std::char_traits<char> >, std::function<void ()>), const char *, (lambda at net.cpp:3267:71)> (invoke.h:96)\r\n==205278==    by 0x1B2653: _M_invoke<0UL, 1UL, 2UL> (std_thread.h:292)\r\n==205278==    by 0x1B2653: operator() (std_thread.h:299)\r\n==205278==    by 0x1B2653: std::thread::_State_impl<std::thread::_Invoker<std::tuple<void (*)(std::basic_string_view<char, std::char_traits<char> >, std::function<void ()>), char const*, CConnman::Start(CScheduler&, CConnman::Options const&)::$_6> > >::_M_run() (std_thread.h:244)\r\n==205278==    by 0x4C501BF: execute_native_thread_routine (thread.cc:104)\r\n==205278==    by 0x4F85E37: start_thread (pthread_create.c:447)\r\n==205278==    by 0x4FF0E5B: thread_start (clone.S:79)\r\n==205278== \r\n{\r\n   <insert_a_suppression_name_here>\r\n   Memcheck:Cond\r\n   fun:_M_reset\r\n   fun:~_Optional_payload\r\n   fun:~_Optional_base\r\n   fun:_Z15GetLocalAddressRK5CNode\r\n   fun:_Z19GetLocalAddrForPeerR5CNode\r\n   fun:MaybeSendAddr\r\n   fun:_ZN12_GLOBAL__N_115PeerManagerImpl12SendMessagesEP5CNode\r\n   fun:_ZN8CConnman20ThreadMessageHandlerEv\r\n   fun:operator()\r\n   fun:_ZN4util11TraceThreadESt17basic_string_viewIcSt11char_traitsIcEESt8functionIFvvEE\r\n   fun:__invoke_impl<void, void (*)(std::basic_string_view<char, std::char_traits<char> >, std::function<void ()>), const char *, (lambda at net.cpp:3267:71)>\r\n   fun:__invoke<void (*)(std::basic_string_view<char, std::char_traits<char> >, std::function<void ()>), const char *, (lambda at net.cpp:3267:71)>\r\n   fun:_M_invoke<0UL, 1UL, 2UL>\r\n   fun:operator()\r\n   fun:_ZNSt6thread11_State_implINS_8_InvokerISt5tupleIJPFvSt17basic_string_viewIcSt11char_traitsIcEESt8functionIFvvEEEPKcZN8CConnman5StartER10CSchedulerRKNSE_7OptionsEE3$_6EEEEE6_M_runEv\r\n   fun:execute_native_thread_routine\r\n   fun:start_thread\r\n   fun:thread_start\r\n}\r\n==205278== \r\n==205278== Exit program on first error (--exit-on-first-error=yes) \r\n\r\nTEST            | STATUS    | DURATION\r\n\r\nexample_test.py | â Failed  | 15 s\r\n\r\nALL             | â Failed  | 15 s (accumulated) \r\nRuntime: 15 s\r\n```",
      "created_at" : "2024-03-12T14:28:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/29635#issuecomment-1991783811",
      "id" : 1991783811,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29635",
      "node_id" : "IC_kwDOABII5852uDWD",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1991783811/reactions"
      },
      "updated_at" : "2024-03-12T14:28:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1991783811",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@fanquake, what's in those lines in your `optional` header?\r\n\r\n`cat -n /usr/include/c++/13.2.1/optional |grep -B5 -A5 -E '^[[:space:]]*(313|437|508)'`\r\n\r\n(that `13.2.1` will probably be different in your environment).",
      "created_at" : "2024-03-12T16:02:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/29635#issuecomment-1992009891",
      "id" : 1992009891,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29635",
      "node_id" : "IC_kwDOABII5852u6ij",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1992009891/reactions"
      },
      "updated_at" : "2024-03-12T16:02:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1992009891",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   }
]
