[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage\nFor detailed information about the code coverage, see the [test coverage report](https://corecheck.dev/bitcoin/bitcoin/pulls/29617).\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#29612](https://github.com/bitcoin/bitcoin/pull/29612) (rpc: Optimize serialization disk space of dumptxoutset - Reloaded by fjahr)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "created_at" : "2024-03-11T03:00:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29617#issuecomment-1987539987",
      "id" : 1987539987,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29617",
      "node_id" : "IC_kwDOABII5852d3QT",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1987539987/reactions"
      },
      "updated_at" : "2024-03-14T14:35:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1987539987",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--85328a0da195eb286784d51f73fa0af9-->\n\nð§ At least one of the CI tasks failed. Make sure to run all tests locally, according to the\ndocumentation.\n\nPossibly this is due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n<sub>Debug: https://github.com/bitcoin/bitcoin/runs/22494357167</sub>",
      "created_at" : "2024-03-11T04:05:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29617#issuecomment-1987598631",
      "id" : 1987598631,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29617",
      "node_id" : "IC_kwDOABII5852eFkn",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1987598631/reactions"
      },
      "updated_at" : "2024-03-11T04:05:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1987598631",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29617#discussion_r1519887039"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29617"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1519887039"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Would it not be easier to add this to https://github.com/bitcoin/bitcoin/blob/a945f09fa6e0f94cc424da9e06516f9cfa192545/test/functional/feature_assumeutxo.py#L72",
      "commit_id" : "4104d9f9608e5b63241e4be645eb2d1b66d320cf",
      "created_at" : "2024-03-11T15:10:17Z",
      "diff_hunk" : "@@ -148,6 +148,42 @@ def test_invalid_mempool_state(self, dump_output_path):\n \n         self.restart_node(2, extra_args=self.extra_args[2])\n \n+    def test_invalid_snapshot_wrong_coin_code(self, valid_snapshot_path):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29617#discussion_r1519887039",
      "id" : 1519887039,
      "line" : 151,
      "node_id" : "PRRC_kwDOABII585al6K_",
      "original_commit_id" : "46f16a3c0fd31aa72119ccff4d207ee67685385d",
      "original_line" : 151,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "test/functional/feature_assumeutxo.py",
      "position" : 4,
      "pull_request_review_id" : 1928106989,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29617",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1519887039/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-03-11T15:16:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1519887039",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/15610188?v=4",
         "events_url" : "https://api.github.com/users/BrandonOdiwuor/events{/privacy}",
         "followers_url" : "https://api.github.com/users/BrandonOdiwuor/followers",
         "following_url" : "https://api.github.com/users/BrandonOdiwuor/following{/other_user}",
         "gists_url" : "https://api.github.com/users/BrandonOdiwuor/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/BrandonOdiwuor",
         "id" : 15610188,
         "login" : "BrandonOdiwuor",
         "node_id" : "MDQ6VXNlcjE1NjEwMTg4",
         "organizations_url" : "https://api.github.com/users/BrandonOdiwuor/orgs",
         "received_events_url" : "https://api.github.com/users/BrandonOdiwuor/received_events",
         "repos_url" : "https://api.github.com/users/BrandonOdiwuor/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/BrandonOdiwuor/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/BrandonOdiwuor/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/BrandonOdiwuor"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29617#discussion_r1519956212"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29617"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1519956212"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```suggestion\r\n            \"Testing snapshot file with an incorrect coin height 364 and coinbase 0\"\r\n```",
      "commit_id" : "4104d9f9608e5b63241e4be645eb2d1b66d320cf",
      "created_at" : "2024-03-11T15:50:14Z",
      "diff_hunk" : "@@ -148,6 +148,42 @@ def test_invalid_mempool_state(self, dump_output_path):\n \n         self.restart_node(2, extra_args=self.extra_args[2])\n \n+    def test_invalid_snapshot_wrong_coin_code(self, valid_snapshot_path):\n+        self.log.info(\n+            \"Testing snapshot file with an incorrect coin code: height 364 and coinbase 0\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29617#discussion_r1519956212",
      "id" : 1519956212,
      "line" : 153,
      "node_id" : "PRRC_kwDOABII585amLD0",
      "original_commit_id" : "46f16a3c0fd31aa72119ccff4d207ee67685385d",
      "original_line" : 153,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "test/functional/feature_assumeutxo.py",
      "position" : 6,
      "pull_request_review_id" : 1928222108,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29617",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1519956212/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-03-11T15:58:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1519956212",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48946461?v=4",
         "events_url" : "https://api.github.com/users/ismaelsadeeq/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ismaelsadeeq/followers",
         "following_url" : "https://api.github.com/users/ismaelsadeeq/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ismaelsadeeq/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ismaelsadeeq",
         "id" : 48946461,
         "login" : "ismaelsadeeq",
         "node_id" : "MDQ6VXNlcjQ4OTQ2NDYx",
         "organizations_url" : "https://api.github.com/users/ismaelsadeeq/orgs",
         "received_events_url" : "https://api.github.com/users/ismaelsadeeq/received_events",
         "repos_url" : "https://api.github.com/users/ismaelsadeeq/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ismaelsadeeq/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ismaelsadeeq/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ismaelsadeeq"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29617#discussion_r1519962442"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29617"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1519962442"
         }
      },
      "author_association" : "MEMBER",
      "body" : "IMO If the `check_error` subroutine is not going to be used outside the scope of `test_invalid_snapshot_wrong_coin_code` function, receive args and used by future tests, this can just be simplified to be inline.\r\n```suggestion\r\n              with self.nodes[1].assert_debug_log([\"[snapshot] bad snapshot data after deserializing 0 coins\"]):\r\n            assert_raises_rpc_error(\r\n                -32603,\r\n                \"Unable to load UTXO snapshot\",\r\n                self.nodes[1].loadtxoutset,\r\n                bad_snapshot_path,\r\n            )\r\n```",
      "commit_id" : "4104d9f9608e5b63241e4be645eb2d1b66d320cf",
      "created_at" : "2024-03-11T15:54:21Z",
      "diff_hunk" : "@@ -148,6 +148,42 @@ def test_invalid_mempool_state(self, dump_output_path):\n \n         self.restart_node(2, extra_args=self.extra_args[2])\n \n+    def test_invalid_snapshot_wrong_coin_code(self, valid_snapshot_path):\n+        self.log.info(\n+            \"Testing snapshot file with an incorrect coin code: height 364 and coinbase 0\"\n+        )\n+        with open(valid_snapshot_path, \"rb\") as f:\n+            valid_snapshot_contents = f.read()\n+        bad_snapshot_path = valid_snapshot_path + \".mod\"\n+\n+        # Offset calculation explanation:\n+        # The offset (76 bytes) positions the insertion after the block hash (32 bytes),\n+        # num coins (8 bytes), outpoint hash (32 bytes), and outpoint index (4 bytes).\n+        wrong_coin_code_case = [\n+            b\"\\x84\\x58\",\n+            76,\n+        ]  # Incorrect coin code with height 364 and coinbase 0\n+\n+        content, offset = wrong_coin_code_case\n+\n+        with open(bad_snapshot_path, \"wb\") as f:\n+            f.write(valid_snapshot_contents[:offset])\n+            f.write(content)\n+            f.write(valid_snapshot_contents[offset + len(content) :])\n+\n+        def check_error():\n+            with self.nodes[1].assert_debug_log(\n+                [\"[snapshot] bad snapshot data after deserializing 0 coins\"]\n+            ):\n+                assert_raises_rpc_error(\n+                    -32603,\n+                    \"Unable to load UTXO snapshot\",\n+                    self.nodes[1].loadtxoutset,\n+                    bad_snapshot_path,\n+                )\n+\n+        check_error()",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29617#discussion_r1519962442",
      "id" : 1519962442,
      "line" : 185,
      "node_id" : "PRRC_kwDOABII585amMlK",
      "original_commit_id" : "46f16a3c0fd31aa72119ccff4d207ee67685385d",
      "original_line" : 185,
      "original_position" : 38,
      "original_start_line" : 174,
      "path" : "test/functional/feature_assumeutxo.py",
      "position" : 38,
      "pull_request_review_id" : 1928222108,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29617",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1519962442/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 174,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2024-03-11T15:58:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1519962442",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48946461?v=4",
         "events_url" : "https://api.github.com/users/ismaelsadeeq/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ismaelsadeeq/followers",
         "following_url" : "https://api.github.com/users/ismaelsadeeq/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ismaelsadeeq/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ismaelsadeeq",
         "id" : 48946461,
         "login" : "ismaelsadeeq",
         "node_id" : "MDQ6VXNlcjQ4OTQ2NDYx",
         "organizations_url" : "https://api.github.com/users/ismaelsadeeq/orgs",
         "received_events_url" : "https://api.github.com/users/ismaelsadeeq/received_events",
         "repos_url" : "https://api.github.com/users/ismaelsadeeq/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ismaelsadeeq/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ismaelsadeeq/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ismaelsadeeq"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29617#discussion_r1519965353"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29617"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1519965353"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```suggestion\r\n    def test_snapshot_with_invalid_coin_height(self, valid_snapshot_path):\r\n```",
      "commit_id" : "4104d9f9608e5b63241e4be645eb2d1b66d320cf",
      "created_at" : "2024-03-11T15:55:45Z",
      "diff_hunk" : "@@ -148,6 +148,42 @@ def test_invalid_mempool_state(self, dump_output_path):\n \n         self.restart_node(2, extra_args=self.extra_args[2])\n \n+    def test_invalid_snapshot_wrong_coin_code(self, valid_snapshot_path):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29617#discussion_r1519965353",
      "id" : 1519965353,
      "line" : 151,
      "node_id" : "PRRC_kwDOABII585amNSp",
      "original_commit_id" : "46f16a3c0fd31aa72119ccff4d207ee67685385d",
      "original_line" : 151,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "test/functional/feature_assumeutxo.py",
      "position" : 4,
      "pull_request_review_id" : 1928222108,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29617",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1519965353/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-03-11T15:58:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1519965353",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48946461?v=4",
         "events_url" : "https://api.github.com/users/ismaelsadeeq/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ismaelsadeeq/followers",
         "following_url" : "https://api.github.com/users/ismaelsadeeq/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ismaelsadeeq/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ismaelsadeeq",
         "id" : 48946461,
         "login" : "ismaelsadeeq",
         "node_id" : "MDQ6VXNlcjQ4OTQ2NDYx",
         "organizations_url" : "https://api.github.com/users/ismaelsadeeq/orgs",
         "received_events_url" : "https://api.github.com/users/ismaelsadeeq/received_events",
         "repos_url" : "https://api.github.com/users/ismaelsadeeq/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ismaelsadeeq/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ismaelsadeeq/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ismaelsadeeq"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Missing `test: ` prefix in pull title?",
      "created_at" : "2024-03-11T16:02:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29617#issuecomment-1988794302",
      "id" : 1988794302,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29617",
      "node_id" : "IC_kwDOABII5852ipe-",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1988794302/reactions"
      },
      "updated_at" : "2024-03-11T16:02:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1988794302",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29617#discussion_r1520352558"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29617"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520352558"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I was planning to add new methods to allow for more focused test cases, so each scenario is encapsulated within its relevant context. However, I guess the method name `test_invalid_snapshot_scenarios` assumes all snapshot scenarios are to be included in it. So I'll adjust my approach",
      "commit_id" : "4104d9f9608e5b63241e4be645eb2d1b66d320cf",
      "created_at" : "2024-03-11T19:54:12Z",
      "diff_hunk" : "@@ -148,6 +148,42 @@ def test_invalid_mempool_state(self, dump_output_path):\n \n         self.restart_node(2, extra_args=self.extra_args[2])\n \n+    def test_invalid_snapshot_wrong_coin_code(self, valid_snapshot_path):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29617#discussion_r1520352558",
      "id" : 1520352558,
      "in_reply_to_id" : 1519887039,
      "line" : 151,
      "node_id" : "PRRC_kwDOABII585anr0u",
      "original_commit_id" : "46f16a3c0fd31aa72119ccff4d207ee67685385d",
      "original_line" : 151,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "test/functional/feature_assumeutxo.py",
      "position" : 4,
      "pull_request_review_id" : 1929052753,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29617",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520352558/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-03-11T19:54:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520352558",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19940301?v=4",
         "events_url" : "https://api.github.com/users/jrakibi/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jrakibi/followers",
         "following_url" : "https://api.github.com/users/jrakibi/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jrakibi/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jrakibi",
         "id" : 19940301,
         "login" : "jrakibi",
         "node_id" : "MDQ6VXNlcjE5OTQwMzAx",
         "organizations_url" : "https://api.github.com/users/jrakibi/orgs",
         "received_events_url" : "https://api.github.com/users/jrakibi/received_events",
         "repos_url" : "https://api.github.com/users/jrakibi/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jrakibi/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jrakibi/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jrakibi"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29617#discussion_r1520359252"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29617"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520359252"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks @ismaelsadeeq, I've squashed them.\r\nBase height is related to AssumeUTXO snapshot, refers to the block height at which the UTXOset snapshot was taken.\r\nAlso coin code in this context encodes the block height and whether the tx is Coinbase or not",
      "commit_id" : "4104d9f9608e5b63241e4be645eb2d1b66d320cf",
      "created_at" : "2024-03-11T20:00:01Z",
      "diff_hunk" : "@@ -148,6 +148,42 @@ def test_invalid_mempool_state(self, dump_output_path):\n \n         self.restart_node(2, extra_args=self.extra_args[2])\n \n+    def test_invalid_snapshot_wrong_coin_code(self, valid_snapshot_path):\n+        self.log.info(\n+            \"Testing snapshot file with an incorrect coin code: height 364 and coinbase 0\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29617#discussion_r1520359252",
      "id" : 1520359252,
      "in_reply_to_id" : 1519956212,
      "line" : 153,
      "node_id" : "PRRC_kwDOABII585antdU",
      "original_commit_id" : "46f16a3c0fd31aa72119ccff4d207ee67685385d",
      "original_line" : 153,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "test/functional/feature_assumeutxo.py",
      "position" : 6,
      "pull_request_review_id" : 1929073517,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29617",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520359252/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-03-11T20:03:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520359252",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19940301?v=4",
         "events_url" : "https://api.github.com/users/jrakibi/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jrakibi/followers",
         "following_url" : "https://api.github.com/users/jrakibi/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jrakibi/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jrakibi",
         "id" : 19940301,
         "login" : "jrakibi",
         "node_id" : "MDQ6VXNlcjE5OTQwMzAx",
         "organizations_url" : "https://api.github.com/users/jrakibi/orgs",
         "received_events_url" : "https://api.github.com/users/jrakibi/received_events",
         "repos_url" : "https://api.github.com/users/jrakibi/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jrakibi/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jrakibi/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jrakibi"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--85328a0da195eb286784d51f73fa0af9-->\n\nð§ At least one of the CI tasks failed. Make sure to run all tests locally, according to the\ndocumentation.\n\nPossibly this is due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n<sub>Debug: https://github.com/bitcoin/bitcoin/runs/22587330142</sub>",
      "created_at" : "2024-03-13T00:01:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29617#issuecomment-1992758783",
      "id" : 1992758783,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29617",
      "node_id" : "IC_kwDOABII5852xxX_",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1992758783/reactions"
      },
      "updated_at" : "2024-03-13T00:01:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1992758783",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@ismaelsadeeq  @BrandonOdiwuor  I've updated the PR with your feedbacks. Also included my test case in `test_invalid_snapshot_scenarios` method to keep all invalid snapshot scenarios cases in one place",
      "created_at" : "2024-03-13T00:47:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29617#issuecomment-1992870694",
      "id" : 1992870694,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29617",
      "node_id" : "IC_kwDOABII5852yMsm",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1992870694/reactions"
      },
      "updated_at" : "2024-03-13T01:05:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1992870694",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19940301?v=4",
         "events_url" : "https://api.github.com/users/jrakibi/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jrakibi/followers",
         "following_url" : "https://api.github.com/users/jrakibi/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jrakibi/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jrakibi",
         "id" : 19940301,
         "login" : "jrakibi",
         "node_id" : "MDQ6VXNlcjE5OTQwMzAx",
         "organizations_url" : "https://api.github.com/users/jrakibi/orgs",
         "received_events_url" : "https://api.github.com/users/jrakibi/received_events",
         "repos_url" : "https://api.github.com/users/jrakibi/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jrakibi/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jrakibi/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jrakibi"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I've just added another test case to invalidate snapshots containing outputs whose amounts exceed the MAX_MONEY supply limit",
      "created_at" : "2024-03-19T00:41:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29617#issuecomment-2005493786",
      "id" : 2005493786,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29617",
      "node_id" : "IC_kwDOABII5853iWga",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2005493786/reactions"
      },
      "updated_at" : "2024-03-19T00:41:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2005493786",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19940301?v=4",
         "events_url" : "https://api.github.com/users/jrakibi/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jrakibi/followers",
         "following_url" : "https://api.github.com/users/jrakibi/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jrakibi/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jrakibi",
         "id" : 19940301,
         "login" : "jrakibi",
         "node_id" : "MDQ6VXNlcjE5OTQwMzAx",
         "organizations_url" : "https://api.github.com/users/jrakibi/orgs",
         "received_events_url" : "https://api.github.com/users/jrakibi/received_events",
         "repos_url" : "https://api.github.com/users/jrakibi/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jrakibi/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jrakibi/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jrakibi"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29617#discussion_r1565319719"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29617"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1565319719"
         }
      },
      "author_association" : "NONE",
      "body" : "Suggest the below refactoring to avoid passing wrong_hash and error_message in the same variable while relying on is_custom_message to differentiate between the two.\r\n\r\n```\r\ndiff --git a/test/functional/feature_assumeutxo.py b/test/functional/feature_assumeutxo.py\r\nindex a70b511c91..d07f2db530 100755\r\n--- a/test/functional/feature_assumeutxo.py\r\n+++ b/test/functional/feature_assumeutxo.py\r\n@@ -100,25 +100,24 @@ class AssumeutxoTest(BitcoinTestFramework):\r\n         self.log.info(\"  - snapshot file with alternated UTXO data\")\r\n         cases = [\r\n             # (content, offset, wrong_hash or message, is_custom_message)\r\n-            [b\"\\xff\" * 32, 0, \"7d52155c9a9fdc4525b637ef6170568e5dad6fabd0b1fdbb9432010b8453095b\", False],  # wrong outpoint hash\r\n-            [(1).to_bytes(4, \"little\"), 32, \"9f4d897031ab8547665b4153317ae2fdbf0130c7840b66427ebc48b881cb80ad\", False],  # wrong outpoint index\r\n-            [b\"\\x81\", 36, \"3da966ba9826fb6d2604260e01607b55ba44e1a5de298606b08704bc62570ea8\", False],  # wrong coin code VARINT\r\n-            [b\"\\x80\", 36, \"091e893b3ccb4334378709578025356c8bcb0a623f37c7c4e493133c988648e5\", False],  # another wrong coin code\r\n-            [b\"\\x84\\x58\", 36, \"[snapshot] bad snapshot data after deserializing 0 coins\", True],  # wrong coin case with height 364 and coinbase 0\r\n-            [b\"\\xCA\\xD2\\x8F\\x5A\", 41, \"[snapshot] bad snapshot data after deserializing 0 coins - bad tx out value\", True],  # Amount exceed MAX_MONEY\r\n+            [b\"\\xff\" * 32, 0, \"7d52155c9a9fdc4525b637ef6170568e5dad6fabd0b1fdbb9432010b8453095b\", None],  # wrong outpoint hash\r\n+            [(1).to_bytes(4, \"little\"), 32, \"9f4d897031ab8547665b4153317ae2fdbf0130c7840b66427ebc48b881cb80ad\", None],  # wrong outpoint index\r\n+            [b\"\\x81\", 36, \"3da966ba9826fb6d2604260e01607b55ba44e1a5de298606b08704bc62570ea8\", None],  # wrong coin code VARINT\r\n+            [b\"\\x80\", 36, \"091e893b3ccb4334378709578025356c8bcb0a623f37c7c4e493133c988648e5\", None],  # another wrong coin code\r\n+            [b\"\\x84\\x58\", 36, None, \"[snapshot] bad snapshot data after deserializing 0 coins\"],  # wrong coin case with height 364 and coinbase 0\r\n+            [b\"\\xCA\\xD2\\x8F\\x5A\", 41, None, \"[snapshot] bad snapshot data after deserializing 0 coins - bad tx out value\"],  # Amount exceed MAX_MONEY\r\n         ]\r\n\r\n-        for content, offset, error_message_or_hash, is_custom_message in cases:\r\n+        for content, offset, wrong_hash, custom_message in cases:\r\n             with open(bad_snapshot_path, \"wb\") as f:\r\n                 f.write(valid_snapshot_contents[: (32 + 8 + offset)])\r\n                 f.write(content)\r\n                 f.write(valid_snapshot_contents[(32 + 8 + offset + len(content)) :])\r\n-\r\n-            if is_custom_message:\r\n-                expected_error(log_msg=error_message_or_hash)\r\n+            if custom_message:\r\n+                expected_error(log_msg=custom_message)\r\n             else:\r\n                 expected_error(\r\n-                    log_msg=f\"[snapshot] bad snapshot content hash: expected a4bf3407ccb2cc0145c49ebba8fa91199f8a3903daf0883875941497d2493c27, got {error_message_or_hash}\"\r\n+                    log_msg=f\"[snapshot] bad snapshot content hash: expected a4bf3407ccb2cc0145c49ebba8fa91199f8a3903daf0883875941497d2493c27, got {wrong_hash}\"\r\n                 )\r\n\r\n     def test_headers_not_synced(self, valid_snapshot_path):\r\n```",
      "commit_id" : "e807838d26d81de916e9788676fe75d4cb01f6a8",
      "created_at" : "2024-04-15T07:46:36Z",
      "diff_hunk" : "@@ -101,18 +99,27 @@ def expected_error(log_msg=\"\", rpc_details=\"\"):\n \n         self.log.info(\"  - snapshot file with alternated UTXO data\")\n         cases = [\n-            [b\"\\xff\" * 32, 0, \"7d52155c9a9fdc4525b637ef6170568e5dad6fabd0b1fdbb9432010b8453095b\"],  # wrong outpoint hash\n-            [(1).to_bytes(4, \"little\"), 32, \"9f4d897031ab8547665b4153317ae2fdbf0130c7840b66427ebc48b881cb80ad\"],  # wrong outpoint index\n-            [b\"\\x81\", 36, \"3da966ba9826fb6d2604260e01607b55ba44e1a5de298606b08704bc62570ea8\"],  # wrong coin code VARINT((coinbase ? 1 : 0) | (height << 1))\n-            [b\"\\x80\", 36, \"091e893b3ccb4334378709578025356c8bcb0a623f37c7c4e493133c988648e5\"],  # another wrong coin code\n+            # (content, offset, wrong_hash or message, is_custom_message)\n+            [b\"\\xff\" * 32, 0, \"7d52155c9a9fdc4525b637ef6170568e5dad6fabd0b1fdbb9432010b8453095b\", False],  # wrong outpoint hash\n+            [(1).to_bytes(4, \"little\"), 32, \"9f4d897031ab8547665b4153317ae2fdbf0130c7840b66427ebc48b881cb80ad\", False],  # wrong outpoint index\n+            [b\"\\x81\", 36, \"3da966ba9826fb6d2604260e01607b55ba44e1a5de298606b08704bc62570ea8\", False],  # wrong coin code VARINT\n+            [b\"\\x80\", 36, \"091e893b3ccb4334378709578025356c8bcb0a623f37c7c4e493133c988648e5\", False],  # another wrong coin code\n+            [b\"\\x84\\x58\", 36, \"[snapshot] bad snapshot data after deserializing 0 coins\", True],  # wrong coin case with height 364 and coinbase 0\n+            [b\"\\xCA\\xD2\\x8F\\x5A\", 41, \"[snapshot] bad snapshot data after deserializing 0 coins - bad tx out value\", True],  # Amount exceed MAX_MONEY\n         ]\n \n-        for content, offset, wrong_hash in cases:\n+        for content, offset, error_message_or_hash, is_custom_message in cases:\n             with open(bad_snapshot_path, \"wb\") as f:\n-                f.write(valid_snapshot_contents[:(32 + 8 + offset)])\n+                f.write(valid_snapshot_contents[: (32 + 8 + offset)])\n                 f.write(content)\n-                f.write(valid_snapshot_contents[(32 + 8 + offset + len(content)):])\n-            expected_error(log_msg=f\"[snapshot] bad snapshot content hash: expected a4bf3407ccb2cc0145c49ebba8fa91199f8a3903daf0883875941497d2493c27, got {wrong_hash}\")\n+                f.write(valid_snapshot_contents[(32 + 8 + offset + len(content)) :])\n+\n+            if is_custom_message:\n+                expected_error(log_msg=error_message_or_hash)\n+            else:\n+                expected_error(\n+                    log_msg=f\"[snapshot] bad snapshot content hash: expected a4bf3407ccb2cc0145c49ebba8fa91199f8a3903daf0883875941497d2493c27, got {error_message_or_hash}\"\n+                )",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29617#discussion_r1565319719",
      "id" : 1565319719,
      "line" : 122,
      "node_id" : "PRRC_kwDOABII585dTOIn",
      "original_commit_id" : "e807838d26d81de916e9788676fe75d4cb01f6a8",
      "original_line" : 122,
      "original_position" : 41,
      "original_start_line" : 100,
      "path" : "test/functional/feature_assumeutxo.py",
      "position" : 41,
      "pull_request_review_id" : 2000245020,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29617",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1565319719/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 100,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2024-04-15T07:48:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1565319719",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5960750?v=4",
         "events_url" : "https://api.github.com/users/rkrux/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rkrux/followers",
         "following_url" : "https://api.github.com/users/rkrux/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rkrux/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rkrux",
         "id" : 5960750,
         "login" : "rkrux",
         "node_id" : "MDQ6VXNlcjU5NjA3NTA=",
         "organizations_url" : "https://api.github.com/users/rkrux/orgs",
         "received_events_url" : "https://api.github.com/users/rkrux/received_events",
         "repos_url" : "https://api.github.com/users/rkrux/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rkrux/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rkrux/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rkrux"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29617#discussion_r1565360894"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29617"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1565360894"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I think using one field for multiple things makes this more confusing than necessary. Please keep the hash field for the hash and where you have the boolean you can use that field for a custom message. Then you can check if the custom message is set instead of an explicit boolean.",
      "commit_id" : "e807838d26d81de916e9788676fe75d4cb01f6a8",
      "created_at" : "2024-04-15T08:19:00Z",
      "diff_hunk" : "@@ -101,18 +99,27 @@ def expected_error(log_msg=\"\", rpc_details=\"\"):\n \n         self.log.info(\"  - snapshot file with alternated UTXO data\")\n         cases = [\n-            [b\"\\xff\" * 32, 0, \"7d52155c9a9fdc4525b637ef6170568e5dad6fabd0b1fdbb9432010b8453095b\"],  # wrong outpoint hash\n-            [(1).to_bytes(4, \"little\"), 32, \"9f4d897031ab8547665b4153317ae2fdbf0130c7840b66427ebc48b881cb80ad\"],  # wrong outpoint index\n-            [b\"\\x81\", 36, \"3da966ba9826fb6d2604260e01607b55ba44e1a5de298606b08704bc62570ea8\"],  # wrong coin code VARINT((coinbase ? 1 : 0) | (height << 1))\n-            [b\"\\x80\", 36, \"091e893b3ccb4334378709578025356c8bcb0a623f37c7c4e493133c988648e5\"],  # another wrong coin code\n+            # (content, offset, wrong_hash or message, is_custom_message)\n+            [b\"\\xff\" * 32, 0, \"7d52155c9a9fdc4525b637ef6170568e5dad6fabd0b1fdbb9432010b8453095b\", False],  # wrong outpoint hash\n+            [(1).to_bytes(4, \"little\"), 32, \"9f4d897031ab8547665b4153317ae2fdbf0130c7840b66427ebc48b881cb80ad\", False],  # wrong outpoint index\n+            [b\"\\x81\", 36, \"3da966ba9826fb6d2604260e01607b55ba44e1a5de298606b08704bc62570ea8\", False],  # wrong coin code VARINT\n+            [b\"\\x80\", 36, \"091e893b3ccb4334378709578025356c8bcb0a623f37c7c4e493133c988648e5\", False],  # another wrong coin code\n+            [b\"\\x84\\x58\", 36, \"[snapshot] bad snapshot data after deserializing 0 coins\", True],  # wrong coin case with height 364 and coinbase 0",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29617#discussion_r1565360894",
      "id" : 1565360894,
      "line" : 107,
      "node_id" : "PRRC_kwDOABII585dTYL-",
      "original_commit_id" : "e807838d26d81de916e9788676fe75d4cb01f6a8",
      "original_line" : 107,
      "original_position" : 22,
      "original_start_line" : null,
      "path" : "test/functional/feature_assumeutxo.py",
      "position" : 22,
      "pull_request_review_id" : 2000312610,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29617",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1565360894/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-15T08:33:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1565360894",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29617#discussion_r1565361998"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29617"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1565361998"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Unnecessary blank space removal",
      "commit_id" : "e807838d26d81de916e9788676fe75d4cb01f6a8",
      "created_at" : "2024-04-15T08:19:53Z",
      "diff_hunk" : "@@ -367,7 +374,6 @@ def check_tx_counts(final: bool) -> None:\n                 # Ensure indexes have synced for the assumeutxo node\n                 self.wait_until(lambda: n.getindexinfo() == completed_idx_state)\n \n-",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29617#discussion_r1565361998",
      "id" : 1565361998,
      "line" : 370,
      "node_id" : "PRRC_kwDOABII585dTYdO",
      "original_commit_id" : "e807838d26d81de916e9788676fe75d4cb01f6a8",
      "original_line" : 370,
      "original_position" : 49,
      "original_start_line" : null,
      "path" : "test/functional/feature_assumeutxo.py",
      "position" : 49,
      "pull_request_review_id" : 2000312610,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29617",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1565361998/reactions"
      },
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-15T08:33:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1565361998",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29617#discussion_r1565369875"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29617"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1565369875"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I don't think we put a space here anywhere else?",
      "commit_id" : "e807838d26d81de916e9788676fe75d4cb01f6a8",
      "created_at" : "2024-04-15T08:25:42Z",
      "diff_hunk" : "@@ -101,18 +99,27 @@ def expected_error(log_msg=\"\", rpc_details=\"\"):\n \n         self.log.info(\"  - snapshot file with alternated UTXO data\")\n         cases = [\n-            [b\"\\xff\" * 32, 0, \"7d52155c9a9fdc4525b637ef6170568e5dad6fabd0b1fdbb9432010b8453095b\"],  # wrong outpoint hash\n-            [(1).to_bytes(4, \"little\"), 32, \"9f4d897031ab8547665b4153317ae2fdbf0130c7840b66427ebc48b881cb80ad\"],  # wrong outpoint index\n-            [b\"\\x81\", 36, \"3da966ba9826fb6d2604260e01607b55ba44e1a5de298606b08704bc62570ea8\"],  # wrong coin code VARINT((coinbase ? 1 : 0) | (height << 1))\n-            [b\"\\x80\", 36, \"091e893b3ccb4334378709578025356c8bcb0a623f37c7c4e493133c988648e5\"],  # another wrong coin code\n+            # (content, offset, wrong_hash or message, is_custom_message)\n+            [b\"\\xff\" * 32, 0, \"7d52155c9a9fdc4525b637ef6170568e5dad6fabd0b1fdbb9432010b8453095b\", False],  # wrong outpoint hash\n+            [(1).to_bytes(4, \"little\"), 32, \"9f4d897031ab8547665b4153317ae2fdbf0130c7840b66427ebc48b881cb80ad\", False],  # wrong outpoint index\n+            [b\"\\x81\", 36, \"3da966ba9826fb6d2604260e01607b55ba44e1a5de298606b08704bc62570ea8\", False],  # wrong coin code VARINT\n+            [b\"\\x80\", 36, \"091e893b3ccb4334378709578025356c8bcb0a623f37c7c4e493133c988648e5\", False],  # another wrong coin code\n+            [b\"\\x84\\x58\", 36, \"[snapshot] bad snapshot data after deserializing 0 coins\", True],  # wrong coin case with height 364 and coinbase 0\n+            [b\"\\xCA\\xD2\\x8F\\x5A\", 41, \"[snapshot] bad snapshot data after deserializing 0 coins - bad tx out value\", True],  # Amount exceed MAX_MONEY\n         ]\n \n-        for content, offset, wrong_hash in cases:\n+        for content, offset, error_message_or_hash, is_custom_message in cases:\n             with open(bad_snapshot_path, \"wb\") as f:\n-                f.write(valid_snapshot_contents[:(32 + 8 + offset)])\n+                f.write(valid_snapshot_contents[: (32 + 8 + offset)])",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29617#discussion_r1565369875",
      "id" : 1565369875,
      "line" : 113,
      "node_id" : "PRRC_kwDOABII585dTaYT",
      "original_commit_id" : "e807838d26d81de916e9788676fe75d4cb01f6a8",
      "original_line" : 113,
      "original_position" : 30,
      "original_start_line" : null,
      "path" : "test/functional/feature_assumeutxo.py",
      "position" : 30,
      "pull_request_review_id" : 2000312610,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29617",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1565369875/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-15T08:33:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1565369875",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   }
]
