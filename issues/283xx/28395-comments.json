[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept ACK | [brunoerg](https://github.com/bitcoin/bitcoin/pull/28395#issuecomment-1703964319) |\n\nIf your review is incorrectly listed, please react with ð to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#28366](https://github.com/bitcoin/bitcoin/pull/28366) (Fix waste calculation in SelectionResult by murchandamus)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "created_at" : "2023-09-02T22:57:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28395#issuecomment-1703958752",
      "id" : 1703958752,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28395",
      "node_id" : "IC_kwDOABII585lkFjg",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1703958752/reactions"
      },
      "updated_at" : "2023-09-03T00:07:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1703958752",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK\r\n\r\n",
      "created_at" : "2023-09-02T23:35:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28395#issuecomment-1703964319",
      "id" : 1703964319,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28395",
      "node_id" : "IC_kwDOABII585lkG6f",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1703964319/reactions"
      },
      "updated_at" : "2023-09-02T23:36:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1703964319",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19480819?v=4",
         "events_url" : "https://api.github.com/users/brunoerg/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brunoerg/followers",
         "following_url" : "https://api.github.com/users/brunoerg/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brunoerg/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brunoerg",
         "id" : 19480819,
         "login" : "brunoerg",
         "node_id" : "MDQ6VXNlcjE5NDgwODE5",
         "organizations_url" : "https://api.github.com/users/brunoerg/orgs",
         "received_events_url" : "https://api.github.com/users/brunoerg/received_events",
         "repos_url" : "https://api.github.com/users/brunoerg/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brunoerg/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brunoerg/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brunoerg"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Cherry-picked this commit to test it with #28372 and did the changes to the harness to fit it. Previous crashes don't fail anymore, will leave it running overnight! \r\n\r\n```diff\r\ndiff --git a/src/wallet/test/fuzz/coinselection.cpp b/src/wallet/test/fuzz/coinselection.cpp\r\nindex 07bb0f001c..2c96c79ea2 100644\r\n--- a/src/wallet/test/fuzz/coinselection.cpp\r\n+++ b/src/wallet/test/fuzz/coinselection.cpp\r\n@@ -125,9 +125,9 @@ FUZZ_TARGET(coinselection)\r\n     }\r\n \r\n     // Run coinselection algorithms\r\n-    auto result_bnb = SelectCoinsBnB(group_pos, target, coin_params.m_cost_of_change, MAX_STANDARD_TX_WEIGHT);\r\n+    auto result_bnb = SelectCoinsBnB(group_pos, target, coin_params.min_viable_change, MAX_STANDARD_TX_WEIGHT);\r\n     if (result_bnb) {\r\n-        assert(result_bnb->GetChange(coin_params.m_cost_of_change, CAmount{0}) == 0);\r\n+        assert(result_bnb->GetChange(coin_params.min_viable_change, CAmount{0}) == 0);\r\n         assert(result_bnb->GetSelectedValue() >= target);\r\n         (void)result_bnb->GetShuffledInputVector();\r\n         (void)result_bnb->GetInputSet();\r\n```",
      "created_at" : "2023-09-02T23:54:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28395#issuecomment-1703966581",
      "id" : 1703966581,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28395",
      "node_id" : "IC_kwDOABII585lkHd1",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1703966581/reactions"
      },
      "updated_at" : "2023-09-02T23:55:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1703966581",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19480819?v=4",
         "events_url" : "https://api.github.com/users/brunoerg/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brunoerg/followers",
         "following_url" : "https://api.github.com/users/brunoerg/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brunoerg/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brunoerg",
         "id" : 19480819,
         "login" : "brunoerg",
         "node_id" : "MDQ6VXNlcjE5NDgwODE5",
         "organizations_url" : "https://api.github.com/users/brunoerg/orgs",
         "received_events_url" : "https://api.github.com/users/brunoerg/received_events",
         "repos_url" : "https://api.github.com/users/brunoerg/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brunoerg/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brunoerg/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brunoerg"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "cc: @murchandamus \r\n",
      "created_at" : "2023-09-03T00:23:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28395#issuecomment-1703971969",
      "id" : 1703971969,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28395",
      "node_id" : "IC_kwDOABII585lkIyB",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1703971969/reactions"
      },
      "updated_at" : "2023-09-03T00:23:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1703971969",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19480819?v=4",
         "events_url" : "https://api.github.com/users/brunoerg/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brunoerg/followers",
         "following_url" : "https://api.github.com/users/brunoerg/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brunoerg/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brunoerg",
         "id" : 19480819,
         "login" : "brunoerg",
         "node_id" : "MDQ6VXNlcjE5NDgwODE5",
         "organizations_url" : "https://api.github.com/users/brunoerg/orgs",
         "received_events_url" : "https://api.github.com/users/brunoerg/received_events",
         "repos_url" : "https://api.github.com/users/brunoerg/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brunoerg/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brunoerg/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brunoerg"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "```\r\n/bip324_ecdh.cpp\r\nclang-tidy-16 -p=/ci_container_base/ci/scratch/build/bitcoin-x86_64-pc-linux-gnu -quiet -load=/tidy-build/libbitcoin-tidy.so /ci_container_base/ci/scratch/build/bitcoin-x86_64-pc-linux-gnu/src/coins.cpp\r\nclang-tidy-16 -p=/ci_container_base/ci/scratch/build/bitcoin-x86_64-pc-linux-gnu -quiet -load=/tidy-build/libbitcoin-tidy.so /ci_container_base/ci/scratch/build/bitcoin-x86_64-pc-linux-gnu/src/wallet/test/coinselector_tests.cpp\r\nwallet/test/coinselector_tests.cpp:434:63: error: argument name 'cost_of_change' in comment does not match parameter name 'min_viable_change' [bugprone-argument-comment,-warnings-as-errors]\r\n                                            selection_target, /*cost_of_change=*/0, MAX_STANDARD_TX_WEIGHT);\r\n                                                              ^\r\n./wallet/coinselection.h:412:131: note: 'min_viable_change' declared here\r\nutil::Result<SelectionResult> SelectCoinsBnB(std::vector<OutputGroup>& utxo_pool, const CAmount& selection_target, const CAmount& min_viable_change,\r\n                                                                                                                                  ^\r\n--",
      "created_at" : "2023-09-03T07:52:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28395#issuecomment-1704040153",
      "id" : 1704040153,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28395",
      "node_id" : "IC_kwDOABII585lkZbZ",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1704040153/reactions"
      },
      "updated_at" : "2023-09-03T07:52:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1704040153",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "It needs to change unit tests and fuzz.",
      "created_at" : "2023-09-03T10:21:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28395#issuecomment-1704108235",
      "id" : 1704108235,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28395",
      "node_id" : "IC_kwDOABII585lkqDL",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1704108235/reactions"
      },
      "updated_at" : "2023-09-03T10:21:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1704108235",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19480819?v=4",
         "events_url" : "https://api.github.com/users/brunoerg/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brunoerg/followers",
         "following_url" : "https://api.github.com/users/brunoerg/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brunoerg/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brunoerg",
         "id" : 19480819,
         "login" : "brunoerg",
         "node_id" : "MDQ6VXNlcjE5NDgwODE5",
         "organizations_url" : "https://api.github.com/users/brunoerg/orgs",
         "received_events_url" : "https://api.github.com/users/brunoerg/received_events",
         "repos_url" : "https://api.github.com/users/brunoerg/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brunoerg/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brunoerg/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brunoerg"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I don't think this is correct. The upper bound is the cost of change, not the minimum viable change. The minimum viable change is the minimum we're willing to make and this is not inherently tied to feerates. Cost of change is tied to the current feerate and the long term feerate. The minimum viable change is generally much higher than the cost of change. This PR will result in BnB solutions throwing away far more money.",
      "created_at" : "2023-09-07T19:27:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28395#issuecomment-1710665495",
      "id" : 1710665495,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28395",
      "node_id" : "IC_kwDOABII585l9q8X",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1710665495/reactions"
      },
      "updated_at" : "2023-09-07T19:27:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1710665495",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28395#discussion_r1319044044"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28395"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1319044044"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In `GetChange`, `min_viable_change` refers to the minimum amount of the change output (after deducting the fee), so I think this here should at least be `selection_target + min_viable_change + change_fee`. And `min_viable_change` should be at least `change_spend_fee + 1`.\r\n\r\nSince `cost_of_change` is `change_fee  + changes_spend_fee`, that would make `min_viable_change` exactly 1 bigger than `cost_of_change`.\r\n\r\nGenerally, I think we should be careful to distinguish the `min_viable_change` from the âbudget necessary to create a change output with at least an amount of `min_viable_change`. \r\n\r\nI think this PR may also overlap with https://github.com/bitcoin/bitcoin/pull/28366",
      "commit_id" : "f81047b4eccd737f3f8040ec1a89dc7a8282df55",
      "created_at" : "2023-09-07T19:38:52Z",
      "diff_hunk" : "@@ -102,12 +102,19 @@ util::Result<SelectionResult> SelectCoinsBnB(std::vector<OutputGroup>& utxo_pool\n     bool is_feerate_high = utxo_pool.at(0).fee > utxo_pool.at(0).long_term_fee;\n     bool max_tx_weight_exceeded = false;\n \n+    // We seek for a solution where the process does not create change, so we can go as high as one unit below\n+    // the amount where the transaction creation process starts creating a change output.\n+    // In other words, the range of the possible solutions is:\n+    // target <= solution_amount < target + min_viable_change - 1.\n+    // Note: when 'min_viable_change=0', the upper bound is 'selection_target'.\n+    CAmount selection_upper_bound = selection_target + (min_viable_change != 0 ? min_viable_change - 1 : 0);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28395#discussion_r1319044044",
      "id" : 1319044044,
      "line" : 110,
      "node_id" : "PRRC_kwDOABII585OnwPM",
      "original_commit_id" : "1e83af161f29455c2aee5d50f4d8d8ffa4a0cb1b",
      "original_line" : 110,
      "original_position" : 26,
      "original_start_line" : null,
      "path" : "src/wallet/coinselection.cpp",
      "position" : 26,
      "pull_request_review_id" : 1616127096,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28395",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1319044044/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-09-07T19:40:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1319044044",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/murchandamus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/murchandamus/followers",
         "following_url" : "https://api.github.com/users/murchandamus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/murchandamus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/murchandamus",
         "id" : 4060799,
         "login" : "murchandamus",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/murchandamus/orgs",
         "received_events_url" : "https://api.github.com/users/murchandamus/received_events",
         "repos_url" : "https://api.github.com/users/murchandamus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/murchandamus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/murchandamus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/murchandamus"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Cost of change is tied to the current feerate and the long term feerate.\r\n\r\nIf I recall correctly, the Bitcoin Core definition of `cost_of_change` is tied to the discard_feerate for the input, rather than the LTFRE",
      "created_at" : "2023-09-07T19:41:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28395#issuecomment-1710680223",
      "id" : 1710680223,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28395",
      "node_id" : "IC_kwDOABII585l9uif",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1710680223/reactions"
      },
      "updated_at" : "2023-09-07T19:41:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1710680223",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/murchandamus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/murchandamus/followers",
         "following_url" : "https://api.github.com/users/murchandamus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/murchandamus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/murchandamus",
         "id" : 4060799,
         "login" : "murchandamus",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/murchandamus/orgs",
         "received_events_url" : "https://api.github.com/users/murchandamus/received_events",
         "repos_url" : "https://api.github.com/users/murchandamus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/murchandamus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/murchandamus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/murchandamus"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28395#discussion_r1320572798"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28395"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1320572798"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> In `GetChange`, `min_viable_change` refers to the minimum amount of the change output (after deducting the fee), so I think this here should at least be `selection_target + min_viable_change + change_fee`. And `min_viable_change` should be at least `change_spend_fee + 1`.\r\n> \r\n> Since `cost_of_change` is `change_fee + changes_spend_fee`, that would make `min_viable_change` exactly 1 bigger than `cost_of_change`.\r\n\r\nGreat comment. This made me go further over https://github.com/bitcoin/bitcoin/pull/28395#pullrequestreview-1618045956. It seems that we had different views of the process. You were watching the typical flow, while I was looking at the SFFO one.\r\n\r\nWill work on it. Thanks!.",
      "commit_id" : "f81047b4eccd737f3f8040ec1a89dc7a8282df55",
      "created_at" : "2023-09-09T14:01:55Z",
      "diff_hunk" : "@@ -102,12 +102,19 @@ util::Result<SelectionResult> SelectCoinsBnB(std::vector<OutputGroup>& utxo_pool\n     bool is_feerate_high = utxo_pool.at(0).fee > utxo_pool.at(0).long_term_fee;\n     bool max_tx_weight_exceeded = false;\n \n+    // We seek for a solution where the process does not create change, so we can go as high as one unit below\n+    // the amount where the transaction creation process starts creating a change output.\n+    // In other words, the range of the possible solutions is:\n+    // target <= solution_amount < target + min_viable_change - 1.\n+    // Note: when 'min_viable_change=0', the upper bound is 'selection_target'.\n+    CAmount selection_upper_bound = selection_target + (min_viable_change != 0 ? min_viable_change - 1 : 0);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28395#discussion_r1320572798",
      "id" : 1320572798,
      "in_reply_to_id" : 1319044044,
      "line" : 110,
      "node_id" : "PRRC_kwDOABII585Otld-",
      "original_commit_id" : "1e83af161f29455c2aee5d50f4d8d8ffa4a0cb1b",
      "original_line" : 110,
      "original_position" : 26,
      "original_start_line" : null,
      "path" : "src/wallet/coinselection.cpp",
      "position" : 26,
      "pull_request_review_id" : 1618645155,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28395",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1320572798/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-09-09T14:02:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1320572798",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I am confused by your conclusion \r\n\r\n> So, as generally change_spend_fee > dust.\r\n\r\nAccording to [`GetDustThreshold(â¦)`](https://github.com/bitcoin/bitcoin/blob/8f7b9eb8711fdb32e8bdb59d2a7462a46c7a8086/src/policy/policy.cpp#L26),  `dust = (output_size + input_size) Ã discard_feerate` while `change_spend_fee` is only `change_spend_size Ã discard_feerate`. So shouldnât that rather be:\r\n\r\n> change_spend_fee **<** dust\r\n",
      "created_at" : "2023-09-11T16:05:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28395#issuecomment-1714181527",
      "id" : 1714181527,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28395",
      "node_id" : "IC_kwDOABII585mLFWX",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1714181527/reactions"
      },
      "updated_at" : "2023-09-11T16:05:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1714181527",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/murchandamus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/murchandamus/followers",
         "following_url" : "https://api.github.com/users/murchandamus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/murchandamus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/murchandamus",
         "id" : 4060799,
         "login" : "murchandamus",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/murchandamus/orgs",
         "received_events_url" : "https://api.github.com/users/murchandamus/received_events",
         "repos_url" : "https://api.github.com/users/murchandamus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/murchandamus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/murchandamus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/murchandamus"
      }
   }
]
