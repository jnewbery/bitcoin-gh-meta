[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Stale ACK | [MarcoFalke](https://github.com/bitcoin/bitcoin/pull/28379#issuecomment-1702306593) |\n\nIf your review is incorrectly listed, please react with ð to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#28202](https://github.com/bitcoin/bitcoin/pull/28202) (Silent Payments: receiving by josibake)\n* [#27827](https://github.com/bitcoin/bitcoin/pull/27827) (Silent Payments: send and receive by josibake)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "created_at" : "2023-08-31T17:06:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28379#issuecomment-1701431986",
      "id" : 1701431986,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28379",
      "node_id" : "IC_kwDOABII585lacqy",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1701431986/reactions"
      },
      "updated_at" : "2023-09-01T09:19:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1701431986",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28379#discussion_r1312666609"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28379"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1312666609"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Looks like it would be cleaner to remove this method completely? This is only used to check that the chain type is regtest, which can be seen in the error strings. See:\r\n\r\n```\r\n$ git grep -A1 IsMockableChain  src/rpc/\r\nsrc/rpc/mempool.cpp:            if (!Params().IsMockableChain()) {\r\nsrc/rpc/mempool.cpp-                throw std::runtime_error(\"submitpackage is for regression testing (-regtest mode) only\");\r\n--\r\nsrc/rpc/node.cpp:    if (!Params().IsMockableChain()) {\r\nsrc/rpc/node.cpp-        throw std::runtime_error(\"setmocktime is for regression testing (-regtest mode) only\");\r\n--\r\nsrc/rpc/node.cpp:    if (!Params().IsMockableChain()) {\r\nsrc/rpc/node.cpp-        throw std::runtime_error(\"mockscheduler is for regression testing (-regtest mode) only\");\r\n```\r\n\r\nThe rpc code would be easier to read if the chain type check was inlined and this method be removed, I'd say. For example, `submitpackage` has nothing to do with whether the time can be mocked.",
      "commit_id" : "48e7791dc3f5cb75f1b3b7a0fa31a3a52234df49",
      "created_at" : "2023-09-01T07:21:25Z",
      "diff_hunk" : "@@ -103,7 +103,7 @@ class CChainParams\n     /** Default value for -checkmempool and -checkblockindex argument */\n     bool DefaultConsistencyChecks() const { return fDefaultConsistencyChecks; }\n     /** If this chain is exclusively used for testing */\n-    bool IsTestChain() const { return m_is_test_chain; }\n+    bool IsTestChain() const { return m_chain_type != ChainType::MAIN; }\n     /** If this chain allows time to be mocked */\n     bool IsMockableChain() const { return m_is_mockable_chain; }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28379#discussion_r1312666609",
      "id" : 1312666609,
      "line" : 106,
      "node_id" : "PRRC_kwDOABII585OPbPx",
      "original_commit_id" : "27b4084e16a1cb210ce27119416ee34625781052",
      "original_line" : 108,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "src/kernel/chainparams.h",
      "position" : 7,
      "pull_request_review_id" : 1606399234,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28379",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1312666609/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-09-01T07:21:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1312666609",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "lgtm ACK 27b4084e16a1cb210ce27119416ee34625781052\r\n\r\nLooks good, with or without the other suggestion.",
      "created_at" : "2023-09-01T07:35:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28379#issuecomment-1702306593",
      "id" : 1702306593,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28379",
      "node_id" : "IC_kwDOABII585ldyMh",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1702306593/reactions"
      },
      "updated_at" : "2023-09-01T07:35:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1702306593",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Thanks for the suggestion. I've removed the IsTestChain method and replaced all occurrences with inline checks of the ChainType.",
      "created_at" : "2023-09-01T08:54:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28379#issuecomment-1702404315",
      "id" : 1702404315,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28379",
      "node_id" : "IC_kwDOABII585leKDb",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1702404315/reactions"
      },
      "updated_at" : "2023-09-01T08:54:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1702404315",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/56458039?v=4",
         "events_url" : "https://api.github.com/users/devtimnbr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/devtimnbr/followers",
         "following_url" : "https://api.github.com/users/devtimnbr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/devtimnbr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/devtimnbr",
         "id" : 56458039,
         "login" : "devtimnbr",
         "node_id" : "MDQ6VXNlcjU2NDU4MDM5",
         "organizations_url" : "https://api.github.com/users/devtimnbr/orgs",
         "received_events_url" : "https://api.github.com/users/devtimnbr/received_events",
         "repos_url" : "https://api.github.com/users/devtimnbr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/devtimnbr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/devtimnbr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/devtimnbr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28379#discussion_r1312794051"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28379"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1312794051"
         }
      },
      "author_association" : "MEMBER",
      "body" : "For clarity, my comment is on `IsMockableChain`, not on `IsTestChain`.",
      "commit_id" : "48e7791dc3f5cb75f1b3b7a0fa31a3a52234df49",
      "created_at" : "2023-09-01T09:22:02Z",
      "diff_hunk" : "@@ -103,7 +103,7 @@ class CChainParams\n     /** Default value for -checkmempool and -checkblockindex argument */\n     bool DefaultConsistencyChecks() const { return fDefaultConsistencyChecks; }\n     /** If this chain is exclusively used for testing */\n-    bool IsTestChain() const { return m_is_test_chain; }\n+    bool IsTestChain() const { return m_chain_type != ChainType::MAIN; }\n     /** If this chain allows time to be mocked */\n     bool IsMockableChain() const { return m_is_mockable_chain; }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28379#discussion_r1312794051",
      "id" : 1312794051,
      "in_reply_to_id" : 1312666609,
      "line" : 106,
      "node_id" : "PRRC_kwDOABII585OP6XD",
      "original_commit_id" : "27b4084e16a1cb210ce27119416ee34625781052",
      "original_line" : 108,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "src/kernel/chainparams.h",
      "position" : 7,
      "pull_request_review_id" : 1606592412,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28379",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1312794051/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-09-01T09:22:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1312794051",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28379#discussion_r1312816359"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28379"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1312816359"
         }
      },
      "author_association" : "NONE",
      "body" : "I see. So keep `IsTestChain` and remove `IsMockableChain` method and replace all occurrences with inline checks like `!= ChainType::REGTEST`?",
      "commit_id" : "48e7791dc3f5cb75f1b3b7a0fa31a3a52234df49",
      "created_at" : "2023-09-01T09:43:38Z",
      "diff_hunk" : "@@ -103,7 +103,7 @@ class CChainParams\n     /** Default value for -checkmempool and -checkblockindex argument */\n     bool DefaultConsistencyChecks() const { return fDefaultConsistencyChecks; }\n     /** If this chain is exclusively used for testing */\n-    bool IsTestChain() const { return m_is_test_chain; }\n+    bool IsTestChain() const { return m_chain_type != ChainType::MAIN; }\n     /** If this chain allows time to be mocked */\n     bool IsMockableChain() const { return m_is_mockable_chain; }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28379#discussion_r1312816359",
      "id" : 1312816359,
      "in_reply_to_id" : 1312666609,
      "line" : 106,
      "node_id" : "PRRC_kwDOABII585OP_zn",
      "original_commit_id" : "27b4084e16a1cb210ce27119416ee34625781052",
      "original_line" : 108,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "src/kernel/chainparams.h",
      "position" : 7,
      "pull_request_review_id" : 1606625662,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28379",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1312816359/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-09-01T09:43:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1312816359",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/56458039?v=4",
         "events_url" : "https://api.github.com/users/devtimnbr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/devtimnbr/followers",
         "following_url" : "https://api.github.com/users/devtimnbr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/devtimnbr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/devtimnbr",
         "id" : 56458039,
         "login" : "devtimnbr",
         "node_id" : "MDQ6VXNlcjU2NDU4MDM5",
         "organizations_url" : "https://api.github.com/users/devtimnbr/orgs",
         "received_events_url" : "https://api.github.com/users/devtimnbr/received_events",
         "repos_url" : "https://api.github.com/users/devtimnbr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/devtimnbr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/devtimnbr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/devtimnbr"
      }
   }
]
