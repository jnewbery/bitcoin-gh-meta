[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n",
      "created_at" : "2023-08-31T10:14:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28374#issuecomment-1700759702",
      "id" : 1700759702,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28374",
      "node_id" : "IC_kwDOABII585lX4iW",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1700759702/reactions"
      },
      "updated_at" : "2023-08-31T10:14:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1700759702",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1312997599"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1312997599"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "naming nit: the nonce from `CHACHA20_TESTS` is not provided as a hex string, but as a list of two integers, so the `hex_` prefix doesn't apply here. Maybe something like `nonce_pair` instead? (or simply `nonce` and rename the bytes-version below to somethig else like `nonce_bytes`)\r\n```suggestion\r\n            hex_key, nonce_pair, counter, hex_output = test_vector\r\n```",
      "commit_id" : "7ceb9b77fec4eca6e5054b1f8166735b1dea826c",
      "created_at" : "2023-09-01T13:00:39Z",
      "diff_hunk" : "@@ -0,0 +1,103 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2022 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Python implementation of ChaCha20 cipher\"\"\"\n+\n+import unittest\n+\n+CHACHA20_INDICES = (\n+    (0, 4, 8, 12), (1, 5, 9, 13), (2, 6, 10, 14), (3, 7, 11, 15),\n+    (0, 5, 10, 15), (1, 6, 11, 12), (2, 7, 8, 13), (3, 4, 9, 14)\n+)\n+\n+CHACHA20_CONSTANTS = (0x61707865, 0x3320646e, 0x79622d32, 0x6b206574)\n+\n+def rotl32(v, bits):\n+    \"\"\"Rotate the 32-bit value v left by bits bits.\"\"\"\n+    bits %= 32  # Make sure the term below does not throw an exception\n+    return ((v << bits) & 0xffffffff) | (v >> (32 - bits))\n+\n+def chacha20_doubleround(s):\n+    \"\"\"Apply a ChaCha20 double round to 16-element state array s.\n+    See https://cr.yp.to/chacha/chacha-20080128.pdf and https://tools.ietf.org/html/rfc8439\n+    \"\"\"\n+    for a, b, c, d in CHACHA20_INDICES:\n+        s[a] = (s[a] + s[b]) & 0xffffffff\n+        s[d] = rotl32(s[d] ^ s[a], 16)\n+        s[c] = (s[c] + s[d]) & 0xffffffff\n+        s[b] = rotl32(s[b] ^ s[c], 12)\n+        s[a] = (s[a] + s[b]) & 0xffffffff\n+        s[d] = rotl32(s[d] ^ s[a], 8)\n+        s[c] = (s[c] + s[d]) & 0xffffffff\n+        s[b] = rotl32(s[b] ^ s[c], 7)\n+\n+def chacha20_block(key, nonce, cnt):\n+    \"\"\"Compute the 64-byte output of the ChaCha20 block function.\n+    Takes as input a 32-byte key, 12-byte nonce, and 32-bit integer counter.\n+    \"\"\"\n+    # Initial state.\n+    init = [0 for _ in range(16)]\n+    for i in range(4):\n+        init[i] = CHACHA20_CONSTANTS[i]\n+    for i in range(8):\n+        init[4 + i] = int.from_bytes(key[4 * i:4 * (i+1)], 'little')\n+    init[12] = cnt\n+    for i in range(3):\n+        init[13 + i] = int.from_bytes(nonce[4 * i:4 * (i+1)], 'little')\n+    # Perform 20 rounds.\n+    state = list(init)\n+    for _ in range(10):\n+        chacha20_doubleround(state)\n+    # Add initial values back into state.\n+    for i in range(16):\n+        state[i] = (state[i] + init[i]) & 0xffffffff\n+    # Produce byte output\n+    return b''.join(state[i].to_bytes(4, 'little') for i in range(16))\n+\n+\n+# Test vectors from RFC7539/8439 consisting of 32 byte key, 12 byte nonce, block counter\n+# and 64 byte output after applying `chacha20_block` function\n+CHACHA20_TESTS = [\n+    [\"000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f\", [0x09000000, 0x4a000000], 1,\n+     \"10f1e7e4d13b5915500fdd1fa32071c4c7d1f4c733c068030422aa9ac3d46c4e\"\n+     \"d2826446079faa0914c2d705d98b02a2b5129cd1de164eb9cbd083e8a2503c4e\"],\n+    [\"0000000000000000000000000000000000000000000000000000000000000000\", [0, 0], 0,\n+     \"76b8e0ada0f13d90405d6ae55386bd28bdd219b8a08ded1aa836efcc8b770dc7\"\n+     \"da41597c5157488d7724e03fb8d84a376a43b8f41518a11cc387b669b2ee6586\"],\n+    [\"0000000000000000000000000000000000000000000000000000000000000000\", [0, 0], 1,\n+     \"9f07e7be5551387a98ba977c732d080dcb0f29a048e3656912c6533e32ee7aed\"\n+     \"29b721769ce64e43d57133b074d839d531ed1f28510afb45ace10a1f4b794d6f\"],\n+    [\"0000000000000000000000000000000000000000000000000000000000000001\", [0, 0], 1,\n+     \"3aeb5224ecf849929b9d828db1ced4dd832025e8018b8160b82284f3c949aa5a\"\n+     \"8eca00bbb4a73bdad192b5c42f73f2fd4e273644c8b36125a64addeb006c13a0\"],\n+    [\"00ff000000000000000000000000000000000000000000000000000000000000\", [0, 0], 2,\n+     \"72d54dfbf12ec44b362692df94137f328fea8da73990265ec1bbbea1ae9af0ca\"\n+     \"13b25aa26cb4a648cb9b9d1be65b2c0924a66c54d545ec1b7374f4872e99f096\"],\n+    [\"0000000000000000000000000000000000000000000000000000000000000000\", [0, 0x200000000000000], 0,\n+     \"c2c64d378cd536374ae204b9ef933fcd1a8b2288b3dfa49672ab765b54ee27c7\"\n+     \"8a970e0e955c14f3a88e741b97c286f75f8fc299e8148362fa198a39531bed6d\"],\n+    [\"000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f\", [0, 0x4a000000], 1,\n+     \"224f51f3401bd9e12fde276fb8631ded8c131f823d2c06e27e4fcaec9ef3cf78\"\n+     \"8a3b0aa372600a92b57974cded2b9334794cba40c63e34cdea212c4cf07d41b7\"],\n+    [\"0000000000000000000000000000000000000000000000000000000000000001\", [0, 0], 0,\n+     \"4540f05a9f1fb296d7736e7b208e3c96eb4fe1834688d2604f450952ed432d41\"\n+     \"bbe2a0b6ea7566d2a5d1e7e20d42af2c53d792b1c43fea817e9ad275ae546963\"],\n+    [\"0000000000000000000000000000000000000000000000000000000000000000\", [0, 1], 0,\n+     \"ef3fdfd6c61578fbf5cf35bd3dd33b8009631634d21e42ac33960bd138e50d32\"\n+     \"111e4caf237ee53ca8ad6426194a88545ddc497a0b466e7d6bbdb0041b2f586b\"],\n+    [\"000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f\", [0, 0x0706050403020100], 0,\n+     \"f798a189f195e66982105ffb640bb7757f579da31602fc93ec01ac56f85ac3c1\"\n+     \"34a4547b733b46413042c9440049176905d3be59ea1c53f15916155c2be8241a\"],\n+]\n+\n+\n+class TestFrameworkChacha(unittest.TestCase):\n+    def test_chacha20(self):\n+        \"\"\"ChaCha20 test vectors.\"\"\"\n+        for test_vector in CHACHA20_TESTS:\n+            hex_key, hex_nonce, counter, hex_output = test_vector",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1312997599",
      "id" : 1312997599,
      "line" : 139,
      "node_id" : "PRRC_kwDOABII585OQsDf",
      "original_commit_id" : "cb838f0d9c9b84c07b5081c783275680e48a9023",
      "original_line" : 99,
      "original_position" : 99,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/chacha20.py",
      "position" : 139,
      "pull_request_review_id" : 1606904477,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1312997599/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-09-01T13:42:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1312997599",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1313004252"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1313004252"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "As `key.py` is currently containing only code related to digital signatures (according to the module description it's a \"secp256k1 elliptic curve protocols implementation\"), the HKDF would maybe be better suited in another (new?) module. Probably it generally makes sense to do a follow-up with restructuring crypto-related helpers, e.g. having an own \"test_framework/crypto\" folder would be nice on the long-term for better structuring I think, as the list of crypto-related modules has grown quite a bit.",
      "commit_id" : "7ceb9b77fec4eca6e5054b1f8166735b1dea826c",
      "created_at" : "2023-09-01T13:07:03Z",
      "diff_hunk" : "@@ -27,6 +27,22 @@ def TaggedHash(tag, data):\n     ss += data\n     return hashlib.sha256(ss).digest()\n \n+# HKDF-SHA256\n+def hmac_sha256(key, data):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1313004252",
      "id" : 1313004252,
      "line" : 31,
      "node_id" : "PRRC_kwDOABII585OQtrc",
      "original_commit_id" : "21f71c67895c186137cc19b30f26c57b8a8c562e",
      "original_line" : 31,
      "original_position" : 5,
      "original_start_line" : 30,
      "path" : "test/functional/test_framework/key.py",
      "position" : 5,
      "pull_request_review_id" : 1606904477,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1313004252/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 30,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-09-01T13:42:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1313004252",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1313018187"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1313018187"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: named arguments for the boolean here and below would be nice\r\n```suggestion\r\n                enc_aead.crypt(b\"\", b\"\", is_decrypt=False)\r\n```",
      "commit_id" : "7ceb9b77fec4eca6e5054b1f8166735b1dea826c",
      "created_at" : "2023-09-01T13:17:51Z",
      "diff_hunk" : "@@ -112,3 +161,24 @@ def test_aead(self):\n             self.assertEqual(hex_cipher, ciphertext.hex())\n             plaintext = aead_chacha20_poly1305_decrypt(key, nonce, aad, ciphertext)\n             self.assertEqual(plain, plaintext)\n+\n+    def test_fschacha20poly1305aead(self):\n+        \"FSChaCha20Poly1305 AEAD test vectors.\"\n+        for test_vector in FSAEAD_TESTS:\n+            hex_plain, hex_aad, hex_key, msg_idx, hex_cipher = test_vector\n+            plain = bytes.fromhex(hex_plain)\n+            aad = bytes.fromhex(hex_aad)\n+            key = bytes.fromhex(hex_key)\n+\n+            enc_aead = FSChaCha20Poly1305(key)\n+            dec_aead = FSChaCha20Poly1305(key)\n+\n+            for _ in range(msg_idx):\n+                enc_aead.crypt(b\"\", b\"\", False)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1313018187",
      "id" : 1313018187,
      "line" : 177,
      "node_id" : "PRRC_kwDOABII585OQxFL",
      "original_commit_id" : "7ceb9b77fec4eca6e5054b1f8166735b1dea826c",
      "original_line" : 177,
      "original_position" : 94,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/bip324_cipher.py",
      "position" : 94,
      "pull_request_review_id" : 1606904477,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1313018187/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-09-01T13:42:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1313018187",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1313030628"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1313030628"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Follow-up idea: it might be nice to also test that the decryption fails (i.e. returns `None` due to poly1305 tag mismatch) if a random bit in `ciphertext` or `aad` is flipped.",
      "commit_id" : "7ceb9b77fec4eca6e5054b1f8166735b1dea826c",
      "created_at" : "2023-09-01T13:28:49Z",
      "diff_hunk" : "@@ -0,0 +1,114 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2022 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"ChaCha20 Poly1305 AEAD Construction in RFC 8439\"\"\"\n+\n+import unittest\n+\n+from .chacha20 import chacha20_block\n+from .poly1305 import Poly1305\n+\n+def aead_chacha20_poly1305_encrypt(key, nonce, aad, plaintext):\n+    \"\"\"Encrypt a plaintext using ChaCha20Poly1305.\"\"\"\n+    ret = bytearray()\n+    msg_len = len(plaintext)\n+    for i in range((msg_len + 63) // 64):\n+        now = min(64, msg_len - 64 * i)\n+        keystream = chacha20_block(key, nonce, i + 1)\n+        for j in range(now):\n+            ret.append(plaintext[j + 64 * i] ^ keystream[j])\n+    poly1305 = Poly1305(chacha20_block(key, nonce, 0)[:32])\n+    poly1305.add(aad, pad=True).add(ret, pad=True)\n+    poly1305.add(len(aad).to_bytes(8, 'little') + msg_len.to_bytes(8, 'little'))\n+    ret += poly1305.tag()\n+    return bytes(ret)\n+\n+def aead_chacha20_poly1305_decrypt(key, nonce, aad, ciphertext):\n+    \"\"\"Decrypt a ChaCha20Poly1305 ciphertext.\"\"\"\n+    if len(ciphertext) < 16:\n+        return None\n+    msg_len = len(ciphertext) - 16\n+    poly1305 = Poly1305(chacha20_block(key, nonce, 0)[:32])\n+    poly1305.add(aad, pad=True)\n+    poly1305.add(ciphertext, length=msg_len, pad=True)\n+    poly1305.add(len(aad).to_bytes(8, 'little') + msg_len.to_bytes(8, 'little'))\n+    if ciphertext[-16:] != poly1305.tag():\n+        return None\n+    ret = bytearray()\n+    for i in range((msg_len + 63) // 64):\n+        now = min(64, msg_len - 64 * i)\n+        keystream = chacha20_block(key, nonce, i + 1)\n+        for j in range(now):\n+            ret.append(ciphertext[j + 64 * i] ^ keystream[j])\n+    return bytes(ret)\n+\n+\n+# Test vectors from RFC8439 consisting of plaintext, aad, 32 byte key, 12 byte nonce and ciphertext\n+AEAD_TESTS = [\n+    # RFC 8439 Example from section 2.8.2\n+    [\"4c616469657320616e642047656e746c656d656e206f662074686520636c6173\"\n+     \"73206f66202739393a204966204920636f756c64206f6666657220796f75206f\"\n+     \"6e6c79206f6e652074697020666f7220746865206675747572652c2073756e73\"\n+     \"637265656e20776f756c642062652069742e\",\n+     \"50515253c0c1c2c3c4c5c6c7\",\n+     \"808182838485868788898a8b8c8d8e8f909192939495969798999a9b9c9d9e9f\",\n+     [7, 0x4746454443424140],\n+     \"d31a8d34648e60db7b86afbc53ef7ec2a4aded51296e08fea9e2b5a736ee62d6\"\n+     \"3dbea45e8ca9671282fafb69da92728b1a71de0a9e060b2905d6a5b67ecd3b36\"\n+     \"92ddbd7f2d778b8c9803aee328091b58fab324e4fad675945585808b4831d7bc\"\n+     \"3ff4def08e4b7a9de576d26586cec64b61161ae10b594f09e26a7e902ecbd060\"\n+     \"0691\"],\n+    # RFC 8439 Test vector A.5\n+    [\"496e7465726e65742d4472616674732061726520647261667420646f63756d65\"\n+     \"6e74732076616c696420666f722061206d6178696d756d206f6620736978206d\"\n+     \"6f6e74687320616e64206d617920626520757064617465642c207265706c6163\"\n+     \"65642c206f72206f62736f6c65746564206279206f7468657220646f63756d65\"\n+     \"6e747320617420616e792074696d652e20497420697320696e617070726f7072\"\n+     \"6961746520746f2075736520496e7465726e65742d4472616674732061732072\"\n+     \"65666572656e6365206d6174657269616c206f7220746f206369746520746865\"\n+     \"6d206f74686572207468616e206173202fe2809c776f726b20696e2070726f67\"\n+     \"726573732e2fe2809d\",\n+     \"f33388860000000000004e91\",\n+     \"1c9240a5eb55d38af333888604f6b5f0473917c1402b80099dca5cbc207075c0\",\n+     [0, 0x0807060504030201],\n+     \"64a0861575861af460f062c79be643bd5e805cfd345cf389f108670ac76c8cb2\"\n+     \"4c6cfc18755d43eea09ee94e382d26b0bdb7b73c321b0100d4f03b7f355894cf\"\n+     \"332f830e710b97ce98c8a84abd0b948114ad176e008d33bd60f982b1ff37c855\"\n+     \"9797a06ef4f0ef61c186324e2b3506383606907b6a7c02b0f9f6157b53c867e4\"\n+     \"b9166c767b804d46a59b5216cde7a4e99040c5a40433225ee282a1b0a06c523e\"\n+     \"af4534d7f83fa1155b0047718cbc546a0d072b04b3564eea1b422273f548271a\"\n+     \"0bb2316053fa76991955ebd63159434ecebb4e466dae5a1073a6727627097a10\"\n+     \"49e617d91d361094fa68f0ff77987130305beaba2eda04df997b714d6c6f2c29\"\n+     \"a6ad5cb4022b02709beead9d67890cbb22392336fea1851f38\"],\n+    # Test vectors exercising aad and plaintext which are multiples of 16 bytes.\n+    [\"8d2d6a8befd9716fab35819eaac83b33269afb9f1a00fddf66095a6c0cd91951\"\n+     \"a6b7ad3db580be0674c3f0b55f618e34\",\n+     \"\",\n+     \"72ddc73f07101282bbbcf853b9012a9f9695fc5d36b303a97fd0845d0314e0c3\",\n+     [0x3432b75f, 0xb3585537eb7f4024],\n+     \"f760b8224fb2a317b1b07875092606131232a5b86ae142df5df1c846a7f6341a\"\n+     \"f2564483dd77f836be45e6230808ffe402a6f0a3e8be074b3d1f4ea8a7b09451\"],\n+    [\"\",\n+     \"36970d8a704c065de16250c18033de5a400520ac1b5842b24551e5823a3314f3\"\n+     \"946285171e04a81ebfbe3566e312e74ab80e94c7dd2ff4e10de0098a58d0f503\",\n+     \"77adda51d6730b9ad6c995658cbd49f581b2547e7c0c08fcc24ceec797461021\",\n+     [0x1f90da88, 0x75dafa3ef84471a4],\n+     \"aaae5bb81e8407c94b2ae86ae0c7efbe\"],\n+]\n+\n+\n+class TestFrameworkAEAD(unittest.TestCase):\n+    def test_aead(self):\n+        \"\"\"ChaCha20Poly1305 AEAD test vectors.\"\"\"\n+        for test_vector in AEAD_TESTS:\n+            hex_plain, hex_aad, hex_key, hex_nonce, hex_cipher = test_vector\n+            plain = bytes.fromhex(hex_plain)\n+            aad = bytes.fromhex(hex_aad)\n+            key = bytes.fromhex(hex_key)\n+            nonce = hex_nonce[0].to_bytes(4, 'little') + hex_nonce[1].to_bytes(8, 'little')\n+\n+            ciphertext = aead_chacha20_poly1305_encrypt(key, nonce, aad, plain)\n+            self.assertEqual(hex_cipher, ciphertext.hex())\n+            plaintext = aead_chacha20_poly1305_decrypt(key, nonce, aad, ciphertext)\n+            self.assertEqual(plain, plaintext)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1313030628",
      "id" : 1313030628,
      "line" : 163,
      "node_id" : "PRRC_kwDOABII585OQ0Hk",
      "original_commit_id" : "8a35ba8bdf15be5bb5e2b36610d5499079fd2153",
      "original_line" : 114,
      "original_position" : 114,
      "original_start_line" : 113,
      "path" : "test/functional/test_framework/bip324_cipher.py",
      "position" : 163,
      "pull_request_review_id" : 1606904477,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1313030628/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 162,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-09-01T13:42:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1313030628",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1313036350"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1313036350"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "small nit: not sure if it's really worth to change it, but in Python member variables and methods that shouldn't be accessed from the outside are usually prefixed with an underscore (`_`) (see e.g.: https://peps.python.org/pep-0008/#method-names-and-instance-variables). But that's just a naming convention anyway and the \"private\" usage is not enforced by the language.",
      "commit_id" : "7ceb9b77fec4eca6e5054b1f8166735b1dea826c",
      "created_at" : "2023-09-01T13:33:20Z",
      "diff_hunk" : "@@ -55,6 +57,34 @@ def chacha20_block(key, nonce, cnt):\n     # Produce byte output\n     return b''.join(state[i].to_bytes(4, 'little') for i in range(16))\n \n+class FSChaCha20:\n+    \"\"\"Rekeying wrapper stream cipher around ChaCha20.\"\"\"\n+    def __init__(self, initial_key, rekey_interval=REKEY_INTERVAL):\n+        self.key = initial_key",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28374#discussion_r1313036350",
      "id" : 1313036350,
      "line" : 63,
      "node_id" : "PRRC_kwDOABII585OQ1g-",
      "original_commit_id" : "9a5f84fc5ccc3320df106cc117ba3ba8357f2732",
      "original_line" : 63,
      "original_position" : 25,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/chacha20.py",
      "position" : 63,
      "pull_request_review_id" : 1606904477,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28374",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1313036350/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-09-01T13:42:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1313036350",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   }
]
