[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "As nodes with limited mempools (presumably some of the RPi node things do this by default?) become more and more common, this is potentially gonna start to be an issue.  Of course post-package-relay+mempool-sync (heh) its less of an issue, but lightning nodes really care about this kinda thing...",
      "created_at" : "2023-08-30T15:17:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/28371#issuecomment-1699379249",
      "id" : 1699379249,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28371",
      "node_id" : "IC_kwDOABII585lSngx",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1699379249/reactions"
      },
      "updated_at" : "2023-08-30T15:17:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1699379249",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "node_id" : "MDQ6VXNlcjY0OTI0Ng==",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "What about discouraging outbound peers with a mempool -say- 80% smaller than ours? It seems useful in general, would solve this situation for transactions with a reasonable fee attached, and for transactions with a fee such as it would be under 60MB of unconfirmed transactions.. it's the application's responsibility to prevent this?\r\n\r\nI understand for Lightning's commitment transactions you rely on your peer to cosign a feerate update, but you would most likely have dropped to chain before getting in a situation where you are holding a commit tx whose feerate is lower than that of 60MB worth of unconfirmed transactions?\r\n\r\nWe should probably check what the node-in-a-box projects set as `-maxmempool` too.",
      "created_at" : "2023-09-04T08:21:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/28371#issuecomment-1704825553",
      "id" : 1704825553,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28371",
      "node_id" : "IC_kwDOABII585lnZLR",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1704825553/reactions"
      },
      "updated_at" : "2023-09-04T08:21:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1704825553",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "From my understanding of the current state of #27742 (package relay code), `m_fee_filter_received` is not looked on during the composition of the `ANCPKGINFO` reply in `ProcessGetData` / `MaybeGetAncPkgInfo`, neither in the further processing of complementary missing package txn relay at `GETPKGTXNS` so effectively package relay deployment should be a good hardening for time-sensitive lightning transactions with a pre-signed feerate, assuming Lightning node / softwares responsibly RBFing / CPFPing their low-feerate txn as timelock expiration is approaching.\r\n\r\nI think there is still a longer concern about a majority of low-mempool-limit peers (i.e low-value `-maxmempool`) screwing up the transaction-relay of low-feerate lightning transactions and therefore delaying the confirmation of those ones, or at least making not seen by the miners mempools and so _artificially fee-bumping them as timelocks expiration is approaching. So low-mempool-limit peers with a fee-filter not representing miners / default full-nodes mempool setting might be an individual source of failure for transaction-relay propagation and holistically a waste in fee-bumping reserves for Lightning nodes. \r\n\r\nI think it might makes sense in the long-term to discourage (or preferentially evict them) tx-relay peers with relatively lower mempool size than ours. I guess it would be better to get back on the table https://github.com/bitcoin/bitcoin/pull/20726 and BIP338 (clean up of features flow negotiated with peers) before we complexify discourage / peers disconnection on local node settings.",
      "created_at" : "2023-09-08T23:28:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/28371#issuecomment-1712332704",
      "id" : 1712332704,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28371",
      "node_id" : "IC_kwDOABII585mEB-g",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1712332704/reactions"
      },
      "updated_at" : "2023-09-08T23:28:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1712332704",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> As nodes with limited mempools (presumably some of the RPi node things do this by default?) become more and more common, this is potentially gonna start to be an issue. Of course post-package-relay+mempool-sync (heh) its less of an issue, but lightning nodes really care about this kinda thing...\r\n\r\nWhy would this become more common? I'm looking at Amazon right now, and the supermajority of Raspberry Pi's for sale are 4GB or higher, with only a few 2GB models and just one 1GB model (in the first page of results). The default is 300MB of actual RAM usage, which is just 15% of a 2GB RPi's available RAM. I'm also not aware of any RPi node software with a non-default max mempool.\r\n\r\nI've you've actually observed a problem that appears to be this, I'd be more inclined to suspect a cause like a sybil attack of badly written chainalysis tx monitoring nodes.",
      "created_at" : "2023-09-18T07:47:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/28371#issuecomment-1722904016",
      "id" : 1722904016,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28371",
      "node_id" : "IC_kwDOABII585msW3Q",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1722904016/reactions"
      },
      "updated_at" : "2023-09-18T07:47:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1722904016",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7042?v=4",
         "events_url" : "https://api.github.com/users/petertodd/events{/privacy}",
         "followers_url" : "https://api.github.com/users/petertodd/followers",
         "following_url" : "https://api.github.com/users/petertodd/following{/other_user}",
         "gists_url" : "https://api.github.com/users/petertodd/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/petertodd",
         "id" : 7042,
         "login" : "petertodd",
         "node_id" : "MDQ6VXNlcjcwNDI=",
         "organizations_url" : "https://api.github.com/users/petertodd/orgs",
         "received_events_url" : "https://api.github.com/users/petertodd/received_events",
         "repos_url" : "https://api.github.com/users/petertodd/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/petertodd/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/petertodd/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/petertodd"
      }
   }
]
