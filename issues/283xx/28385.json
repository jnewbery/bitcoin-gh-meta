{
   "active_lock_reason" : null,
   "assignee" : null,
   "assignees" : [],
   "author_association" : "MEMBER",
   "body" : "Motivation\r\n- I think it's preferable to use stdlib data structures instead of boost if we can achieve the same thing.\r\n- Code external to mempool should ideally use its public helper methods instead of accessing `mapTx` directly.\r\n- Also see #28335 for further context/motivation. This PR simplifies that one.\r\n\r\nThings done in this PR:\r\n- Add a bench for `DisconnectedBlockTransactions` where we add and remove {100%, 90%, 10%} of the transactions. AFAIU the 100% and 90% represent the most common cases in practice.\r\n- Rewrite `DisconnectedBlockTransactions` as a `std::list` instead of a boost multi index container.\r\n  - On my machine, the bench suggests the performance is pretty much identical.\r\n  - I also have an [alternative implementation](https://github.com/glozow/bitcoin/tree/2023-09-unboost-disconnectedtxns) if we don't like making the set of block txids.\r\n- Move `DisconnectedBlockTransactions` from txmempool.h to validation.h. This class isn't used by txmempool, and doesn't have much to do with txmempool. My guess is that it's been living there for convenience since the boost includes are there.\r\n\r\nAlso (these were my perhaps-controversial suggestions to #28335):\r\n- Change a call in node/interfaces grabbing all mempool transactions to use `infoAll()` instead of iterating through `mapTx`.\r\n  - Note that we use `infoAll` in other places that grab all mempool transactions as well, such as in net_processing when responding to bip35 messages.\r\n- Change a call in validation to use `exists()` instead of `it = mapTx.find(); if (it != mapTx.end())...`. The maybe-controversial bit is that `GenTxid` creates a copy of the txid. \r\n\r\n",
   "closed_at" : null,
   "closed_by" : null,
   "comments" : 1,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28385/comments",
   "created_at" : "2023-09-01T15:52:38Z",
   "draft" : false,
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28385/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/pull/28385",
   "id" : 1877662624,
   "labels" : [
      {
         "color" : "E6F6D6",
         "default" : false,
         "description" : null,
         "id" : 135961,
         "name" : "Refactoring",
         "node_id" : "MDU6TGFiZWwxMzU5NjE=",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Refactoring"
      }
   ],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28385/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "node_id" : "PR_kwDOABII585ZWh9x",
   "number" : 28385,
   "performed_via_github_app" : null,
   "pull_request" : {
      "diff_url" : "https://github.com/bitcoin/bitcoin/pull/28385.diff",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28385",
      "merged_at" : null,
      "patch_url" : "https://github.com/bitcoin/bitcoin/pull/28385.patch",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28385"
   },
   "reactions" : {
      "+1" : 0,
      "-1" : 0,
      "confused" : 0,
      "eyes" : 0,
      "heart" : 0,
      "hooray" : 0,
      "laugh" : 0,
      "rocket" : 0,
      "total_count" : 0,
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28385/reactions"
   },
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "open",
   "state_reason" : null,
   "timeline_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28385/timeline",
   "title" : "[refactor] rewrite DisconnectedblockTransactions to not use boost, remove some external mapTx accesses",
   "updated_at" : "2023-09-01T15:52:42Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28385",
   "user" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
      "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
      "followers_url" : "https://api.github.com/users/glozow/followers",
      "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
      "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/glozow",
      "id" : 25183001,
      "login" : "glozow",
      "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
      "organizations_url" : "https://api.github.com/users/glozow/orgs",
      "received_events_url" : "https://api.github.com/users/glozow/received_events",
      "repos_url" : "https://api.github.com/users/glozow/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/glozow"
   }
}
