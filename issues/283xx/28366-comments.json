[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage\nFor detailed information about the code coverage, see the [test coverage report](https://corecheck.dev/bitcoin/bitcoin/pulls/28366).\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept ACK | [ismaelsadeeq](https://github.com/bitcoin/bitcoin/pull/28366#pullrequestreview-2038028445) |\n| Stale ACK | [achow101](https://github.com/bitcoin/bitcoin/pull/28366#pullrequestreview-2020564522), [S3RK](https://github.com/bitcoin/bitcoin/pull/28366#pullrequestreview-2044816148) |\n\nIf your review is incorrectly listed, please react with ð to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#30080](https://github.com/bitcoin/bitcoin/pull/30080) (wallet: add coin selection parameter `add_excess_to_recipient_position` for changeless txs with excess that would be added to fees by remyers)\n* [#29523](https://github.com/bitcoin/bitcoin/pull/29523) (Wallet:  Add `max_tx_weight` to transaction funding options (take 2) by ismaelsadeeq)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "created_at" : "2023-08-29T22:17:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28366#issuecomment-1698218774",
      "id" : 1698218774,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28366",
      "node_id" : "IC_kwDOABII585lOMMW",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1698218774/reactions"
      },
      "updated_at" : "2024-05-24T18:48:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1698218774",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n",
      "created_at" : "2023-08-29T23:41:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28366#issuecomment-1698280801",
      "id" : 1698280801,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28366",
      "node_id" : "IC_kwDOABII585lObVh",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1698280801/reactions"
      },
      "updated_at" : "2023-08-29T23:41:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1698280801",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Rebased to address conflict",
      "created_at" : "2023-08-30T15:28:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28366#issuecomment-1699396102",
      "id" : 1699396102,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28366",
      "node_id" : "IC_kwDOABII585lSroG",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1699396102/reactions"
      },
      "updated_at" : "2023-08-30T15:28:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1699396102",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/murchandamus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/murchandamus/followers",
         "following_url" : "https://api.github.com/users/murchandamus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/murchandamus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/murchandamus",
         "id" : 4060799,
         "login" : "murchandamus",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/murchandamus/orgs",
         "received_events_url" : "https://api.github.com/users/murchandamus/received_events",
         "repos_url" : "https://api.github.com/users/murchandamus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/murchandamus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/murchandamus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/murchandamus"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Rebased on latest #26152 ",
      "created_at" : "2023-09-13T19:15:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28366#issuecomment-1718179147",
      "id" : 1718179147,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28366",
      "node_id" : "IC_kwDOABII585maVVL",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1718179147/reactions"
      },
      "updated_at" : "2023-09-13T19:15:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1718179147",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/murchandamus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/murchandamus/followers",
         "following_url" : "https://api.github.com/users/murchandamus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/murchandamus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/murchandamus",
         "id" : 4060799,
         "login" : "murchandamus",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/murchandamus/orgs",
         "received_events_url" : "https://api.github.com/users/murchandamus/received_events",
         "repos_url" : "https://api.github.com/users/murchandamus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/murchandamus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/murchandamus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/murchandamus"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Approach ACK\r\n\r\nCommit message in 0a31864bbe6ab8cbc081f56ea490e123bf25ed7c says that `GetChange()` relied to special meaning of `change_cost == 0`, but actually it was `GetSelectionWaste()` function which was in fault.",
      "created_at" : "2023-09-14T06:42:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28366#issuecomment-1718852874",
      "id" : 1718852874,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28366",
      "node_id" : "IC_kwDOABII585mc50K",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1718852874/reactions"
      },
      "updated_at" : "2023-09-14T06:43:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1718852874",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1466284?v=4",
         "events_url" : "https://api.github.com/users/S3RK/events{/privacy}",
         "followers_url" : "https://api.github.com/users/S3RK/followers",
         "following_url" : "https://api.github.com/users/S3RK/following{/other_user}",
         "gists_url" : "https://api.github.com/users/S3RK/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/S3RK",
         "id" : 1466284,
         "login" : "S3RK",
         "node_id" : "MDQ6VXNlcjE0NjYyODQ=",
         "organizations_url" : "https://api.github.com/users/S3RK/orgs",
         "received_events_url" : "https://api.github.com/users/S3RK/received_events",
         "repos_url" : "https://api.github.com/users/S3RK/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/S3RK/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/S3RK/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/S3RK"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Approach ACK\r\n> \r\n> Commit message in [0a31864](https://github.com/bitcoin/bitcoin/commit/0a31864bbe6ab8cbc081f56ea490e123bf25ed7c) says that `GetChange()` relied to special meaning of `change_cost == 0`, but actually it was `GetSelectionWaste()` function which was in fault.\r\n\r\nThanks, I updated the commit message and rebased on master. Ready for review.",
      "created_at" : "2023-09-14T20:25:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28366#issuecomment-1720097086",
      "id" : 1720097086,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28366",
      "node_id" : "IC_kwDOABII585mhpk-",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1720097086/reactions"
      },
      "updated_at" : "2023-09-14T20:25:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1720097086",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/murchandamus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/murchandamus/followers",
         "following_url" : "https://api.github.com/users/murchandamus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/murchandamus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/murchandamus",
         "id" : 4060799,
         "login" : "murchandamus",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/murchandamus/orgs",
         "received_events_url" : "https://api.github.com/users/murchandamus/received_events",
         "repos_url" : "https://api.github.com/users/murchandamus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/murchandamus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/murchandamus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/murchandamus"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "The CoinSelection benchmarks fails when I run it with -min-time=1000\r\n```\r\n./src/bench/bench_bitcoin -filter=CoinSelection -min-time=1000\r\nbench_bitcoin: bench/coin_selection.cpp:84: CoinSelection(ankerl::nanobench::Bench&)::<lambda()>: Assertion `result->GetSelectedValue() == 1003 * COIN' failed.\r\nAborted\r\n```",
      "created_at" : "2023-11-30T12:45:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28366#issuecomment-1833714256",
      "id" : 1833714256,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28366",
      "node_id" : "IC_kwDOABII585tTEJQ",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1833714256/reactions"
      },
      "updated_at" : "2023-11-30T12:45:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1833714256",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22493292?v=4",
         "events_url" : "https://api.github.com/users/aureleoules/events{/privacy}",
         "followers_url" : "https://api.github.com/users/aureleoules/followers",
         "following_url" : "https://api.github.com/users/aureleoules/following{/other_user}",
         "gists_url" : "https://api.github.com/users/aureleoules/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/aureleoules",
         "id" : 22493292,
         "login" : "aureleoules",
         "node_id" : "MDQ6VXNlcjIyNDkzMjky",
         "organizations_url" : "https://api.github.com/users/aureleoules/orgs",
         "received_events_url" : "https://api.github.com/users/aureleoules/received_events",
         "repos_url" : "https://api.github.com/users/aureleoules/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/aureleoules/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/aureleoules/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/aureleoules"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Fixed the coin_selection benchmark, thanks @aureleoules.",
      "created_at" : "2024-01-16T19:54:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28366#issuecomment-1894414662",
      "id" : 1894414662,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28366",
      "node_id" : "IC_kwDOABII585w6nlG",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1894414662/reactions"
      },
      "updated_at" : "2024-01-16T21:11:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1894414662",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/murchandamus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/murchandamus/followers",
         "following_url" : "https://api.github.com/users/murchandamus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/murchandamus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/murchandamus",
         "id" : 4060799,
         "login" : "murchandamus",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/murchandamus/orgs",
         "received_events_url" : "https://api.github.com/users/murchandamus/received_events",
         "repos_url" : "https://api.github.com/users/murchandamus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/murchandamus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/murchandamus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/murchandamus"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--85328a0da195eb286784d51f73fa0af9-->\n\nð§ At least one of the CI tasks failed. Make sure to run all tests locally, according to the\ndocumentation.\n\nPossibly this is due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n<sub>Debug: https://github.com/bitcoin/bitcoin/runs/20547490347</sub>",
      "created_at" : "2024-02-12T04:13:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28366#issuecomment-1938043325",
      "id" : 1938043325,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28366",
      "node_id" : "IC_kwDOABII585zhDG9",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1938043325/reactions"
      },
      "updated_at" : "2024-02-12T04:13:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1938043325",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Are you still working on this?",
      "created_at" : "2024-04-05T07:50:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28366#issuecomment-2039175023",
      "id" : 2039175023,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28366",
      "node_id" : "IC_kwDOABII5855i1dv",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2039175023/reactions"
      },
      "updated_at" : "2024-04-05T07:50:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2039175023",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Are you still working on this?\r\n\r\nThanks, rebased and fixed the call from adding CoinGrinder that was using the removed function.",
      "created_at" : "2024-04-05T16:43:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28366#issuecomment-2040240531",
      "id" : 2040240531,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28366",
      "node_id" : "IC_kwDOABII5855m5mT",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2040240531/reactions"
      },
      "updated_at" : "2024-04-05T19:40:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2040240531",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/murchandamus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/murchandamus/followers",
         "following_url" : "https://api.github.com/users/murchandamus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/murchandamus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/murchandamus",
         "id" : 4060799,
         "login" : "murchandamus",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/murchandamus/orgs",
         "received_events_url" : "https://api.github.com/users/murchandamus/received_events",
         "repos_url" : "https://api.github.com/users/murchandamus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/murchandamus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/murchandamus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/murchandamus"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28366#discussion_r1578299095"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28366"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1578299095"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In 44db79b0c48d6b1a26dba6ab01c2a296d610c06b \"Refactor ComputeAndSetWaste()\"\r\n\r\nnit: Unnecessary parentheses, also usually the check of the value is after the function. Could also use brace initialization.\r\n\r\n```suggestion\r\n    bool makes_change{GetChange(min_viable_change, change_fee) != 0};\r\n```",
      "commit_id" : "e95b9159380f2de7f9a6e7a202cc171ad285ee6c",
      "created_at" : "2024-04-24T17:52:06Z",
      "diff_hunk" : "@@ -842,13 +842,8 @@ void SelectionResult::SetBumpFeeDiscount(const CAmount discount)\n \n void SelectionResult::ComputeAndSetWaste(const CAmount min_viable_change, const CAmount change_cost, const CAmount change_fee)\n {\n-    const CAmount change = GetChange(min_viable_change, change_fee);\n-\n-    if (change > 0) {\n-        m_waste = GetSelectionWaste(change_cost, m_target, m_use_effective);\n-    } else {\n-        m_waste = GetSelectionWaste(0, m_target, m_use_effective);\n-    }\n+    bool makes_change = (0 != GetChange(min_viable_change, change_fee));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28366#discussion_r1578299095",
      "id" : 1578299095,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585eEu7X",
      "original_commit_id" : "44db79b0c48d6b1a26dba6ab01c2a296d610c06b",
      "original_line" : 845,
      "original_position" : 11,
      "original_start_line" : null,
      "path" : "src/wallet/coinselection.cpp",
      "position" : null,
      "pull_request_review_id" : 2020564522,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28366",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1578299095/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-24T18:00:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1578299095",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28366#discussion_r1589130802"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28366"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1589130802"
         }
      },
      "author_association" : "MEMBER",
      "body" : "From the commit message in e95b9159380f2de7f9a6e7a202cc171ad285ee6c you mention we can have change_cost of 0 and also a change output, so this is no longer the case?\r\n```suggestion\r\n    * @param[in] change_cost       The cost of creating change and spending it in the future.\r\n     *                              Only used if there is change.\r\n```",
      "commit_id" : "e95b9159380f2de7f9a6e7a202cc171ad285ee6c",
      "created_at" : "2024-05-03T12:23:46Z",
      "diff_hunk" : "@@ -387,8 +371,20 @@ struct SelectionResult\n     /** How much individual inputs overestimated the bump fees for shared ancestries */\n     void SetBumpFeeDiscount(const CAmount discount);\n \n-    /** Calculates and stores the waste for this selection via GetSelectionWaste */\n-    void ComputeAndSetWaste(const CAmount min_viable_change, const CAmount change_cost, const CAmount change_fee);\n+    /** Calculates and stores the waste for this result given the cost of change\n+     * and the opportunity cost of spending these inputs now vs in the future.\n+     * If change exists, waste = change_cost + inputs * (effective_feerate - long_term_feerate) - bump_fee_group_discount\n+     * If no change, waste = excess + inputs * (effective_feerate - long_term_feerate) - bump_fee_group_discount\n+     * where excess = selected_effective_value - target\n+     * change_cost = effective_feerate * change_output_size + long_term_feerate * change_spend_size\n+     *\n+     * @param[in] min_viable_change The minimum amount necessary to make a change output economic\n+     * @param[in] change_cost       The cost of creating change and spending it in the future.\n+     *                              Only used if there is change, in which case it must be positive.\n+     *                              Must be 0 if there is no change.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28366#discussion_r1589130802",
      "id" : 1589130802,
      "line" : 384,
      "node_id" : "PRRC_kwDOABII585euDYy",
      "original_commit_id" : "e95b9159380f2de7f9a6e7a202cc171ad285ee6c",
      "original_line" : 384,
      "original_position" : 39,
      "original_start_line" : 382,
      "path" : "src/wallet/coinselection.h",
      "position" : 39,
      "pull_request_review_id" : 2038028445,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28366",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1589130802/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 382,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2024-05-03T12:32:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1589130802",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48946461?v=4",
         "events_url" : "https://api.github.com/users/ismaelsadeeq/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ismaelsadeeq/followers",
         "following_url" : "https://api.github.com/users/ismaelsadeeq/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ismaelsadeeq/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ismaelsadeeq",
         "id" : 48946461,
         "login" : "ismaelsadeeq",
         "node_id" : "MDQ6VXNlcjQ4OTQ2NDYx",
         "organizations_url" : "https://api.github.com/users/ismaelsadeeq/orgs",
         "received_events_url" : "https://api.github.com/users/ismaelsadeeq/received_events",
         "repos_url" : "https://api.github.com/users/ismaelsadeeq/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ismaelsadeeq/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ismaelsadeeq/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ismaelsadeeq"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28366#discussion_r1589133578"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28366"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1589133578"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Why are you reducing 0.1 here?\r\n\r\nAnd above why are `effective_feerate`,` long_term_feerate`, and `discard_feerate` now having values?",
      "commit_id" : "e95b9159380f2de7f9a6e7a202cc171ad285ee6c",
      "created_at" : "2024-05-03T12:26:36Z",
      "diff_hunk" : "@@ -71,15 +71,15 @@ static void CoinSelection(benchmark::Bench& bench)\n         /*change_output_size=*/ 34,\n         /*change_spend_size=*/ 148,\n         /*min_change_target=*/ CHANGE_LOWER,\n-        /*effective_feerate=*/ CFeeRate(0),\n-        /*long_term_feerate=*/ CFeeRate(0),\n-        /*discard_feerate=*/ CFeeRate(0),\n+        /*effective_feerate=*/ CFeeRate(20'000),\n+        /*long_term_feerate=*/ CFeeRate(10'000),\n+        /*discard_feerate=*/ CFeeRate(3000),\n         /*tx_noinputs_size=*/ 0,\n         /*avoid_partial=*/ false,\n     };\n     auto group = wallet::GroupOutputs(wallet, available_coins, coin_selection_params, {{filter_standard}})[filter_standard];\n     bench.run([&] {\n-        auto result = AttemptSelection(wallet.chain(), 1003 * COIN, group, coin_selection_params, /*allow_mixed_output_types=*/true);\n+        auto result = AttemptSelection(wallet.chain(), 1002.99 * COIN, group, coin_selection_params, /*allow_mixed_output_types=*/true);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28366#discussion_r1589133578",
      "id" : 1589133578,
      "line" : 82,
      "node_id" : "PRRC_kwDOABII585euEEK",
      "original_commit_id" : "e95b9159380f2de7f9a6e7a202cc171ad285ee6c",
      "original_line" : 82,
      "original_position" : 16,
      "original_start_line" : null,
      "path" : "src/bench/coin_selection.cpp",
      "position" : 16,
      "pull_request_review_id" : 2038028445,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28366",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1589133578/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-05-03T12:31:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1589133578",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48946461?v=4",
         "events_url" : "https://api.github.com/users/ismaelsadeeq/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ismaelsadeeq/followers",
         "following_url" : "https://api.github.com/users/ismaelsadeeq/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ismaelsadeeq/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ismaelsadeeq",
         "id" : 48946461,
         "login" : "ismaelsadeeq",
         "node_id" : "MDQ6VXNlcjQ4OTQ2NDYx",
         "organizations_url" : "https://api.github.com/users/ismaelsadeeq/orgs",
         "received_events_url" : "https://api.github.com/users/ismaelsadeeq/received_events",
         "repos_url" : "https://api.github.com/users/ismaelsadeeq/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ismaelsadeeq/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ismaelsadeeq/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ismaelsadeeq"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28366#discussion_r1593503078"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28366"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1593503078"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "This comment needs to be adjusted",
      "commit_id" : "e95b9159380f2de7f9a6e7a202cc171ad285ee6c",
      "created_at" : "2024-05-08T07:12:04Z",
      "diff_hunk" : "@@ -874,55 +874,57 @@ BOOST_AUTO_TEST_CASE(SelectCoins_test)\n BOOST_AUTO_TEST_CASE(waste_test)\n {\n     const CAmount fee{100};\n+    const CAmount min_viable_change{300};\n     const CAmount change_cost{125};\n+    const CAmount change_fee{30};\n     const CAmount fee_diff{40};\n     const CAmount in_amt{3 * COIN};\n     const CAmount target{2 * COIN};\n-    const CAmount excess{in_amt - fee * 2 - target};\n+    const CAmount excess{80};\n \n     // The following tests that the waste is calculated correctly in various scenarios.\n-    // ComputeAndSetWaste will first determine the size of the change output. We don't really\n+    // RecalculateWaste will first determine the size of the change output. We don't really\n     // care about the change and just want to use the variant that always includes the change_cost,\n     // so min_viable_change and change_fee are set to 0 to ensure that.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28366#discussion_r1593503078",
      "id" : 1593503078,
      "line" : 888,
      "node_id" : "PRRC_kwDOABII585e-u1m",
      "original_commit_id" : "e95b9159380f2de7f9a6e7a202cc171ad285ee6c",
      "original_line" : 888,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "src/wallet/test/coinselector_tests.cpp",
      "position" : 17,
      "pull_request_review_id" : 2044816148,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28366",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1593503078/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-05-08T07:28:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1593503078",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1466284?v=4",
         "events_url" : "https://api.github.com/users/S3RK/events{/privacy}",
         "followers_url" : "https://api.github.com/users/S3RK/followers",
         "following_url" : "https://api.github.com/users/S3RK/following{/other_user}",
         "gists_url" : "https://api.github.com/users/S3RK/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/S3RK",
         "id" : 1466284,
         "login" : "S3RK",
         "node_id" : "MDQ6VXNlcjE0NjYyODQ=",
         "organizations_url" : "https://api.github.com/users/S3RK/orgs",
         "received_events_url" : "https://api.github.com/users/S3RK/received_events",
         "repos_url" : "https://api.github.com/users/S3RK/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/S3RK/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/S3RK/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/S3RK"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28366#discussion_r1593507686"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28366"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1593507686"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: this could be pulled to the begging of the test next to other declarations and then reused in the tests above (and below as well)",
      "commit_id" : "e95b9159380f2de7f9a6e7a202cc171ad285ee6c",
      "created_at" : "2024-05-08T07:16:12Z",
      "diff_hunk" : "@@ -932,57 +934,56 @@ BOOST_AUTO_TEST_CASE(waste_test)\n         SelectionResult selection{target, SelectionAlgorithm::MANUAL};\n         add_coin(1 * COIN, 1, selection, fee, fee);\n         add_coin(2 * COIN, 2, selection, fee, fee);\n-        selection.ComputeAndSetWaste(/*min_viable_change=*/0, change_cost, /*change_fee=*/0);\n+        selection.RecalculateWaste(min_viable_change, change_cost, change_fee);\n         BOOST_CHECK_EQUAL(change_cost, selection.GetWaste());\n     }\n \n     {\n         // Waste without change and fee == long term fee is just the excess\n-        SelectionResult selection{target, SelectionAlgorithm::MANUAL};\n+        SelectionResult selection{/*target creates no change*/in_amt - 2 * fee - excess, SelectionAlgorithm::MANUAL};\n         add_coin(1 * COIN, 1, selection, fee, fee);\n         add_coin(2 * COIN, 2, selection, fee, fee);\n-        selection.ComputeAndSetWaste(/*min_viable_change=*/0, /*change_cost=*/0, /*change_fee=*/0);\n+        selection.RecalculateWaste(min_viable_change, change_cost, change_fee);\n         BOOST_CHECK_EQUAL(excess, selection.GetWaste());\n     }\n \n     {\n-        // No Waste when fee == long_term_fee, no change, and no excess\n+        // Waste is 0 when fee == long_term_fee, no change, and no excess\n         const CAmount exact_target{in_amt - fee * 2};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28366#discussion_r1593507686",
      "id" : 1593507686,
      "line" : 952,
      "node_id" : "PRRC_kwDOABII585e-v9m",
      "original_commit_id" : "e95b9159380f2de7f9a6e7a202cc171ad285ee6c",
      "original_line" : 952,
      "original_position" : 90,
      "original_start_line" : null,
      "path" : "src/wallet/test/coinselector_tests.cpp",
      "position" : 90,
      "pull_request_review_id" : 2044816148,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28366",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1593507686/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-05-08T07:28:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1593507686",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1466284?v=4",
         "events_url" : "https://api.github.com/users/S3RK/events{/privacy}",
         "followers_url" : "https://api.github.com/users/S3RK/followers",
         "following_url" : "https://api.github.com/users/S3RK/following{/other_user}",
         "gists_url" : "https://api.github.com/users/S3RK/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/S3RK",
         "id" : 1466284,
         "login" : "S3RK",
         "node_id" : "MDQ6VXNlcjE0NjYyODQ=",
         "organizations_url" : "https://api.github.com/users/S3RK/orgs",
         "received_events_url" : "https://api.github.com/users/S3RK/received_events",
         "repos_url" : "https://api.github.com/users/S3RK/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/S3RK/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/S3RK/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/S3RK"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28366#discussion_r1593510238"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28366"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1593510238"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: same variable is already defined within another local scope above, could be reused. See another comment.",
      "commit_id" : "e95b9159380f2de7f9a6e7a202cc171ad285ee6c",
      "created_at" : "2024-05-08T07:18:08Z",
      "diff_hunk" : "@@ -932,57 +934,56 @@ BOOST_AUTO_TEST_CASE(waste_test)\n         SelectionResult selection{target, SelectionAlgorithm::MANUAL};\n         add_coin(1 * COIN, 1, selection, fee, fee);\n         add_coin(2 * COIN, 2, selection, fee, fee);\n-        selection.ComputeAndSetWaste(/*min_viable_change=*/0, change_cost, /*change_fee=*/0);\n+        selection.RecalculateWaste(min_viable_change, change_cost, change_fee);\n         BOOST_CHECK_EQUAL(change_cost, selection.GetWaste());\n     }\n \n     {\n         // Waste without change and fee == long term fee is just the excess\n-        SelectionResult selection{target, SelectionAlgorithm::MANUAL};\n+        SelectionResult selection{/*target creates no change*/in_amt - 2 * fee - excess, SelectionAlgorithm::MANUAL};\n         add_coin(1 * COIN, 1, selection, fee, fee);\n         add_coin(2 * COIN, 2, selection, fee, fee);\n-        selection.ComputeAndSetWaste(/*min_viable_change=*/0, /*change_cost=*/0, /*change_fee=*/0);\n+        selection.RecalculateWaste(min_viable_change, change_cost, change_fee);\n         BOOST_CHECK_EQUAL(excess, selection.GetWaste());\n     }\n \n     {\n-        // No Waste when fee == long_term_fee, no change, and no excess\n+        // Waste is 0 when fee == long_term_fee, no change, and no excess\n         const CAmount exact_target{in_amt - fee * 2};\n         SelectionResult selection{exact_target, SelectionAlgorithm::MANUAL};\n         add_coin(1 * COIN, 1, selection, fee, fee);\n         add_coin(2 * COIN, 2, selection, fee, fee);\n-        selection.ComputeAndSetWaste(/*min_viable_change=*/0, /*change_cost=*/0, /*change_fee=*/0);\n+        selection.RecalculateWaste(min_viable_change, change_cost , change_fee);\n         BOOST_CHECK_EQUAL(0, selection.GetWaste());\n     }\n \n     {\n-        // No Waste when (fee - long_term_fee) == (-cost_of_change), and no excess\n+        // Waste is 0 when (fee - long_term_fee) == (-cost_of_change), and no excess\n         SelectionResult selection{target, SelectionAlgorithm::MANUAL};\n-        const CAmount new_change_cost{fee_diff * 2};\n         add_coin(1 * COIN, 1, selection, fee, fee + fee_diff);\n         add_coin(2 * COIN, 2, selection, fee, fee + fee_diff);\n-        selection.ComputeAndSetWaste(/*min_viable_change=*/0, new_change_cost, /*change_fee=*/0);\n+        selection.RecalculateWaste(min_viable_change, /*change_cost=*/fee_diff * 2, change_fee);\n         BOOST_CHECK_EQUAL(0, selection.GetWaste());\n     }\n \n     {\n-        // No Waste when (fee - long_term_fee) == (-excess), no change cost\n-        const CAmount new_target{in_amt - fee * 2 - fee_diff * 2};\n+        // Waste is 0 when (fee - long_term_fee) == (-excess), no change cost\n+        const CAmount new_target{in_amt - fee * 2 - /*excess=*/fee_diff * 2};\n         SelectionResult selection{new_target, SelectionAlgorithm::MANUAL};\n         add_coin(1 * COIN, 1, selection, fee, fee + fee_diff);\n         add_coin(2 * COIN, 2, selection, fee, fee + fee_diff);\n-        selection.ComputeAndSetWaste(/*min_viable_change=*/0, /*change_cost=*/0, /*change_fee=*/0);\n+        selection.RecalculateWaste(min_viable_change, change_cost, change_fee);\n         BOOST_CHECK_EQUAL(0, selection.GetWaste());\n     }\n \n     {\n         // Negative waste when the long term fee is greater than the current fee and the selected value == target\n-        const CAmount exact_target{3 * COIN - 2 * fee};\n+        const CAmount exact_target{in_amt - 2 * fee};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28366#discussion_r1593510238",
      "id" : 1593510238,
      "line" : 981,
      "node_id" : "PRRC_kwDOABII585e-wle",
      "original_commit_id" : "e95b9159380f2de7f9a6e7a202cc171ad285ee6c",
      "original_line" : 981,
      "original_position" : 127,
      "original_start_line" : null,
      "path" : "src/wallet/test/coinselector_tests.cpp",
      "position" : 127,
      "pull_request_review_id" : 2044816148,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28366",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1593510238/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-05-08T07:28:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1593510238",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1466284?v=4",
         "events_url" : "https://api.github.com/users/S3RK/events{/privacy}",
         "followers_url" : "https://api.github.com/users/S3RK/followers",
         "following_url" : "https://api.github.com/users/S3RK/following{/other_user}",
         "gists_url" : "https://api.github.com/users/S3RK/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/S3RK",
         "id" : 1466284,
         "login" : "S3RK",
         "node_id" : "MDQ6VXNlcjE0NjYyODQ=",
         "organizations_url" : "https://api.github.com/users/S3RK/orgs",
         "received_events_url" : "https://api.github.com/users/S3RK/received_events",
         "repos_url" : "https://api.github.com/users/S3RK/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/S3RK/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/S3RK/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/S3RK"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28366#discussion_r1593513968"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28366"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1593513968"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: do you want to add assert for the comment above? It's not obvious that the statement holds given variable declarations are hundreds of lines above.\r\n\r\nthe comment:\r\n\"Negative waste when the long term fee is greater than the current fee and change_cost < - (inputs * (fee - long_term_fee))\"",
      "commit_id" : "e95b9159380f2de7f9a6e7a202cc171ad285ee6c",
      "created_at" : "2024-05-08T07:21:40Z",
      "diff_hunk" : "@@ -993,7 +994,7 @@ BOOST_AUTO_TEST_CASE(waste_test)\n         const CAmount target_waste2{-2 * large_fee_diff + change_cost}; // = (2 * fee) - (2 * (fee + large_fee_diff)) + change_cost",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28366#discussion_r1593513968",
      "id" : 1593513968,
      "line" : 994,
      "node_id" : "PRRC_kwDOABII585e-xfw",
      "original_commit_id" : "e95b9159380f2de7f9a6e7a202cc171ad285ee6c",
      "original_line" : 994,
      "original_position" : 138,
      "original_start_line" : null,
      "path" : "src/wallet/test/coinselector_tests.cpp",
      "position" : 138,
      "pull_request_review_id" : 2044816148,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28366",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1593513968/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-05-08T07:28:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1593513968",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1466284?v=4",
         "events_url" : "https://api.github.com/users/S3RK/events{/privacy}",
         "followers_url" : "https://api.github.com/users/S3RK/followers",
         "following_url" : "https://api.github.com/users/S3RK/following{/other_user}",
         "gists_url" : "https://api.github.com/users/S3RK/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/S3RK",
         "id" : 1466284,
         "login" : "S3RK",
         "node_id" : "MDQ6VXNlcjE0NjYyODQ=",
         "organizations_url" : "https://api.github.com/users/S3RK/orgs",
         "received_events_url" : "https://api.github.com/users/S3RK/received_events",
         "repos_url" : "https://api.github.com/users/S3RK/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/S3RK/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/S3RK/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/S3RK"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28366#discussion_r1593517046"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28366"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1593517046"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: could use `exact_target - excess` if you introduce `exact_target` var",
      "commit_id" : "e95b9159380f2de7f9a6e7a202cc171ad285ee6c",
      "created_at" : "2024-05-08T07:24:23Z",
      "diff_hunk" : "@@ -932,57 +934,56 @@ BOOST_AUTO_TEST_CASE(waste_test)\n         SelectionResult selection{target, SelectionAlgorithm::MANUAL};\n         add_coin(1 * COIN, 1, selection, fee, fee);\n         add_coin(2 * COIN, 2, selection, fee, fee);\n-        selection.ComputeAndSetWaste(/*min_viable_change=*/0, change_cost, /*change_fee=*/0);\n+        selection.RecalculateWaste(min_viable_change, change_cost, change_fee);\n         BOOST_CHECK_EQUAL(change_cost, selection.GetWaste());\n     }\n \n     {\n         // Waste without change and fee == long term fee is just the excess\n-        SelectionResult selection{target, SelectionAlgorithm::MANUAL};\n+        SelectionResult selection{/*target creates no change*/in_amt - 2 * fee - excess, SelectionAlgorithm::MANUAL};\n         add_coin(1 * COIN, 1, selection, fee, fee);\n         add_coin(2 * COIN, 2, selection, fee, fee);\n-        selection.ComputeAndSetWaste(/*min_viable_change=*/0, /*change_cost=*/0, /*change_fee=*/0);\n+        selection.RecalculateWaste(min_viable_change, change_cost, change_fee);\n         BOOST_CHECK_EQUAL(excess, selection.GetWaste());\n     }\n \n     {\n-        // No Waste when fee == long_term_fee, no change, and no excess\n+        // Waste is 0 when fee == long_term_fee, no change, and no excess\n         const CAmount exact_target{in_amt - fee * 2};\n         SelectionResult selection{exact_target, SelectionAlgorithm::MANUAL};\n         add_coin(1 * COIN, 1, selection, fee, fee);\n         add_coin(2 * COIN, 2, selection, fee, fee);\n-        selection.ComputeAndSetWaste(/*min_viable_change=*/0, /*change_cost=*/0, /*change_fee=*/0);\n+        selection.RecalculateWaste(min_viable_change, change_cost , change_fee);\n         BOOST_CHECK_EQUAL(0, selection.GetWaste());\n     }\n \n     {\n-        // No Waste when (fee - long_term_fee) == (-cost_of_change), and no excess\n+        // Waste is 0 when (fee - long_term_fee) == (-cost_of_change), and no excess\n         SelectionResult selection{target, SelectionAlgorithm::MANUAL};\n-        const CAmount new_change_cost{fee_diff * 2};\n         add_coin(1 * COIN, 1, selection, fee, fee + fee_diff);\n         add_coin(2 * COIN, 2, selection, fee, fee + fee_diff);\n-        selection.ComputeAndSetWaste(/*min_viable_change=*/0, new_change_cost, /*change_fee=*/0);\n+        selection.RecalculateWaste(min_viable_change, /*change_cost=*/fee_diff * 2, change_fee);\n         BOOST_CHECK_EQUAL(0, selection.GetWaste());\n     }\n \n     {\n-        // No Waste when (fee - long_term_fee) == (-excess), no change cost\n-        const CAmount new_target{in_amt - fee * 2 - fee_diff * 2};\n+        // Waste is 0 when (fee - long_term_fee) == (-excess), no change cost\n+        const CAmount new_target{in_amt - fee * 2 - /*excess=*/fee_diff * 2};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28366#discussion_r1593517046",
      "id" : 1593517046,
      "line" : 971,
      "node_id" : "PRRC_kwDOABII585e-yP2",
      "original_commit_id" : "e95b9159380f2de7f9a6e7a202cc171ad285ee6c",
      "original_line" : 971,
      "original_position" : 115,
      "original_start_line" : null,
      "path" : "src/wallet/test/coinselector_tests.cpp",
      "position" : 115,
      "pull_request_review_id" : 2044816148,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28366",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1593517046/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-05-08T07:28:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1593517046",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1466284?v=4",
         "events_url" : "https://api.github.com/users/S3RK/events{/privacy}",
         "followers_url" : "https://api.github.com/users/S3RK/followers",
         "following_url" : "https://api.github.com/users/S3RK/following{/other_user}",
         "gists_url" : "https://api.github.com/users/S3RK/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/S3RK",
         "id" : 1466284,
         "login" : "S3RK",
         "node_id" : "MDQ6VXNlcjE0NjYyODQ=",
         "organizations_url" : "https://api.github.com/users/S3RK/orgs",
         "received_events_url" : "https://api.github.com/users/S3RK/received_events",
         "repos_url" : "https://api.github.com/users/S3RK/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/S3RK/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/S3RK/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/S3RK"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28366#discussion_r1613679062"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28366"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1613679062"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Adopted the proposed change, but those lines get removed in the next commit anyway.",
      "commit_id" : "2c18b861278b3960e7142068f487c882e30ce851",
      "created_at" : "2024-05-24T15:39:41Z",
      "diff_hunk" : "@@ -842,13 +842,8 @@ void SelectionResult::SetBumpFeeDiscount(const CAmount discount)\n \n void SelectionResult::ComputeAndSetWaste(const CAmount min_viable_change, const CAmount change_cost, const CAmount change_fee)\n {\n-    const CAmount change = GetChange(min_viable_change, change_fee);\n-\n-    if (change > 0) {\n-        m_waste = GetSelectionWaste(change_cost, m_target, m_use_effective);\n-    } else {\n-        m_waste = GetSelectionWaste(0, m_target, m_use_effective);\n-    }\n+    bool makes_change = (0 != GetChange(min_viable_change, change_fee));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28366#discussion_r1613679062",
      "id" : 1613679062,
      "in_reply_to_id" : 1578299095,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585gLsnW",
      "original_commit_id" : "44db79b0c48d6b1a26dba6ab01c2a296d610c06b",
      "original_line" : 845,
      "original_position" : 11,
      "original_start_line" : null,
      "path" : "src/wallet/coinselection.cpp",
      "position" : null,
      "pull_request_review_id" : 2077274300,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28366",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1613679062/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-05-24T18:48:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1613679062",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/murchandamus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/murchandamus/followers",
         "following_url" : "https://api.github.com/users/murchandamus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/murchandamus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/murchandamus",
         "id" : 4060799,
         "login" : "murchandamus",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/murchandamus/orgs",
         "received_events_url" : "https://api.github.com/users/murchandamus/received_events",
         "repos_url" : "https://api.github.com/users/murchandamus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/murchandamus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/murchandamus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/murchandamus"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28366#discussion_r1613782680"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28366"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1613782680"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Good question.\r\n\r\nIt has been a while since I made this change, but if I remember correctly, my fixing the duplicate meaning of `change_cost` broke this bench test due to the following:\r\n\r\nBefore my change, we would set `change_cost` to `0` as a signal that a transaction does not require a change output. This would happen when a coin selection algorithm found a changeless solution and after creating the recipient outputs there would not be sufficient funds to make a viable change output. However, `change_cost` will also be _computed to be zero_ when `effective_feerate`, `long_term_feerate`, and `discard_feerate` are zero.\r\n\r\nIIRC, this lead to some unintuitive behavior in coin selection: \r\n\r\n1. One coin selection algorithm may propose a changeless input set with the two UTXOs 1000+3 BTC. Its _waste score_ would be calculated to be 0, as both the `effective_feerate` and the `long_term_feerate` are set to 0 and there is no excess.\r\n2. Another coin selection algorithm might propose a solution that should lead to a change output, e.g. two UTXOs 1000+1000 BTC. Because `change_cost` was **computed to be 0**, the transaction building would not create a change output, drop the excess 997 BTC to fees, and therefore assess the waste score to be 997â¯BTC of waste.\r\n\r\nThe changeless solution would be preferred, because of its waste score, and the bench would always succeed in finding a two input solution that uses exactly 1000+3 BTC in the inputs.\r\n\r\nAfter my rewrite, `change_cost` _only_ contains the computed value and is no longer used as a signal on whether we have sufficient budget to create a change output.\r\n\r\n1. As before, the changeless solution would have a _waste score_ of 0, as both the `effective_feerate` and the `long_term_feerate` are set to 0 and there is no excess.\r\n2. However, the solution that creates change due to picking two UTXOs with 1000+1000 BTC, would now recognize that it has a ton of money left and that it should create a change output. Instead of dropping the excess 997â¯BTC to fees, it would create a change output of 997 BTC. Since the `effective_feerate` and `discard_feerate` is 0, the `change_cost` is 0. Because the `effective_feerate` and `long_term_feerate` are 0, the waste score on the inputs is also 0. Since `effective_feerate` is 0, the fees for transaction header and recipient outputs are also 0. Therefore, the transaction with a change output now **also gets a waste score of 0**, _correctly_.\r\n\r\nAll of the proposed input sets get presented to `ChooseSelectionResult(â¦)` which picks the lowest waste score, but all solutions are tied with the same waste score of zero. The tie-breaker is to prefer the input set with more inputs, but all solutions have two inputs and are tied on that as well. Finally, it picks the first element from the result vector. The bench test expects that 1003 BTC get selected, but when it selects 2000 BTC, the bench fails.\r\n\r\nTherefore, I fixed the bench to not depend on using feerates that are do not appear in standard transactions and lead to quirky coin selection behavior, which required that I reduce the target to leave a money for fees. I would argue that we could probably do much better for a bench that tests coin selection in general.",
      "commit_id" : "2c18b861278b3960e7142068f487c882e30ce851",
      "created_at" : "2024-05-24T17:05:05Z",
      "diff_hunk" : "@@ -71,15 +71,15 @@ static void CoinSelection(benchmark::Bench& bench)\n         /*change_output_size=*/ 34,\n         /*change_spend_size=*/ 148,\n         /*min_change_target=*/ CHANGE_LOWER,\n-        /*effective_feerate=*/ CFeeRate(0),\n-        /*long_term_feerate=*/ CFeeRate(0),\n-        /*discard_feerate=*/ CFeeRate(0),\n+        /*effective_feerate=*/ CFeeRate(20'000),\n+        /*long_term_feerate=*/ CFeeRate(10'000),\n+        /*discard_feerate=*/ CFeeRate(3000),\n         /*tx_noinputs_size=*/ 0,\n         /*avoid_partial=*/ false,\n     };\n     auto group = wallet::GroupOutputs(wallet, available_coins, coin_selection_params, {{filter_standard}})[filter_standard];\n     bench.run([&] {\n-        auto result = AttemptSelection(wallet.chain(), 1003 * COIN, group, coin_selection_params, /*allow_mixed_output_types=*/true);\n+        auto result = AttemptSelection(wallet.chain(), 1002.99 * COIN, group, coin_selection_params, /*allow_mixed_output_types=*/true);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28366#discussion_r1613782680",
      "id" : 1613782680,
      "in_reply_to_id" : 1589133578,
      "line" : 82,
      "node_id" : "PRRC_kwDOABII585gMF6Y",
      "original_commit_id" : "e95b9159380f2de7f9a6e7a202cc171ad285ee6c",
      "original_line" : 82,
      "original_position" : 16,
      "original_start_line" : null,
      "path" : "src/bench/coin_selection.cpp",
      "position" : 16,
      "pull_request_review_id" : 2077274300,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28366",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1613782680/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-05-24T18:48:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1613782680",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/murchandamus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/murchandamus/followers",
         "following_url" : "https://api.github.com/users/murchandamus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/murchandamus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/murchandamus",
         "id" : 4060799,
         "login" : "murchandamus",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/murchandamus/orgs",
         "received_events_url" : "https://api.github.com/users/murchandamus/received_events",
         "repos_url" : "https://api.github.com/users/murchandamus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/murchandamus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/murchandamus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/murchandamus"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28366#discussion_r1613825421"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28366"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1613825421"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks, the \"must be 0 if there is no change\" is indeed outdated. I removed it.",
      "commit_id" : "2c18b861278b3960e7142068f487c882e30ce851",
      "created_at" : "2024-05-24T17:48:39Z",
      "diff_hunk" : "@@ -387,8 +371,20 @@ struct SelectionResult\n     /** How much individual inputs overestimated the bump fees for shared ancestries */\n     void SetBumpFeeDiscount(const CAmount discount);\n \n-    /** Calculates and stores the waste for this selection via GetSelectionWaste */\n-    void ComputeAndSetWaste(const CAmount min_viable_change, const CAmount change_cost, const CAmount change_fee);\n+    /** Calculates and stores the waste for this result given the cost of change\n+     * and the opportunity cost of spending these inputs now vs in the future.\n+     * If change exists, waste = change_cost + inputs * (effective_feerate - long_term_feerate) - bump_fee_group_discount\n+     * If no change, waste = excess + inputs * (effective_feerate - long_term_feerate) - bump_fee_group_discount\n+     * where excess = selected_effective_value - target\n+     * change_cost = effective_feerate * change_output_size + long_term_feerate * change_spend_size\n+     *\n+     * @param[in] min_viable_change The minimum amount necessary to make a change output economic\n+     * @param[in] change_cost       The cost of creating change and spending it in the future.\n+     *                              Only used if there is change, in which case it must be positive.\n+     *                              Must be 0 if there is no change.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28366#discussion_r1613825421",
      "id" : 1613825421,
      "in_reply_to_id" : 1589130802,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585gMQWN",
      "original_commit_id" : "e95b9159380f2de7f9a6e7a202cc171ad285ee6c",
      "original_line" : 384,
      "original_position" : 39,
      "original_start_line" : 382,
      "path" : "src/wallet/coinselection.h",
      "position" : null,
      "pull_request_review_id" : 2077274300,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28366",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1613825421/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2024-05-24T18:48:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1613825421",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/murchandamus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/murchandamus/followers",
         "following_url" : "https://api.github.com/users/murchandamus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/murchandamus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/murchandamus",
         "id" : 4060799,
         "login" : "murchandamus",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/murchandamus/orgs",
         "received_events_url" : "https://api.github.com/users/murchandamus/received_events",
         "repos_url" : "https://api.github.com/users/murchandamus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/murchandamus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/murchandamus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/murchandamus"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28366#discussion_r1613840073"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28366"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1613840073"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Yes! Thanks, I adjusted the comment.",
      "commit_id" : "2c18b861278b3960e7142068f487c882e30ce851",
      "created_at" : "2024-05-24T18:00:33Z",
      "diff_hunk" : "@@ -874,55 +874,57 @@ BOOST_AUTO_TEST_CASE(SelectCoins_test)\n BOOST_AUTO_TEST_CASE(waste_test)\n {\n     const CAmount fee{100};\n+    const CAmount min_viable_change{300};\n     const CAmount change_cost{125};\n+    const CAmount change_fee{30};\n     const CAmount fee_diff{40};\n     const CAmount in_amt{3 * COIN};\n     const CAmount target{2 * COIN};\n-    const CAmount excess{in_amt - fee * 2 - target};\n+    const CAmount excess{80};\n \n     // The following tests that the waste is calculated correctly in various scenarios.\n-    // ComputeAndSetWaste will first determine the size of the change output. We don't really\n+    // RecalculateWaste will first determine the size of the change output. We don't really\n     // care about the change and just want to use the variant that always includes the change_cost,\n     // so min_viable_change and change_fee are set to 0 to ensure that.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28366#discussion_r1613840073",
      "id" : 1613840073,
      "in_reply_to_id" : 1593503078,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585gMT7J",
      "original_commit_id" : "e95b9159380f2de7f9a6e7a202cc171ad285ee6c",
      "original_line" : 888,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "src/wallet/test/coinselector_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 2077274300,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28366",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1613840073/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-05-24T18:48:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1613840073",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/murchandamus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/murchandamus/followers",
         "following_url" : "https://api.github.com/users/murchandamus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/murchandamus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/murchandamus",
         "id" : 4060799,
         "login" : "murchandamus",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/murchandamus/orgs",
         "received_events_url" : "https://api.github.com/users/murchandamus/received_events",
         "repos_url" : "https://api.github.com/users/murchandamus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/murchandamus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/murchandamus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/murchandamus"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28366#discussion_r1613850265"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28366"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1613850265"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Pulled `exact_target` out as another variable",
      "commit_id" : "2c18b861278b3960e7142068f487c882e30ce851",
      "created_at" : "2024-05-24T18:11:53Z",
      "diff_hunk" : "@@ -932,57 +934,56 @@ BOOST_AUTO_TEST_CASE(waste_test)\n         SelectionResult selection{target, SelectionAlgorithm::MANUAL};\n         add_coin(1 * COIN, 1, selection, fee, fee);\n         add_coin(2 * COIN, 2, selection, fee, fee);\n-        selection.ComputeAndSetWaste(/*min_viable_change=*/0, change_cost, /*change_fee=*/0);\n+        selection.RecalculateWaste(min_viable_change, change_cost, change_fee);\n         BOOST_CHECK_EQUAL(change_cost, selection.GetWaste());\n     }\n \n     {\n         // Waste without change and fee == long term fee is just the excess\n-        SelectionResult selection{target, SelectionAlgorithm::MANUAL};\n+        SelectionResult selection{/*target creates no change*/in_amt - 2 * fee - excess, SelectionAlgorithm::MANUAL};\n         add_coin(1 * COIN, 1, selection, fee, fee);\n         add_coin(2 * COIN, 2, selection, fee, fee);\n-        selection.ComputeAndSetWaste(/*min_viable_change=*/0, /*change_cost=*/0, /*change_fee=*/0);\n+        selection.RecalculateWaste(min_viable_change, change_cost, change_fee);\n         BOOST_CHECK_EQUAL(excess, selection.GetWaste());\n     }\n \n     {\n-        // No Waste when fee == long_term_fee, no change, and no excess\n+        // Waste is 0 when fee == long_term_fee, no change, and no excess\n         const CAmount exact_target{in_amt - fee * 2};\n         SelectionResult selection{exact_target, SelectionAlgorithm::MANUAL};\n         add_coin(1 * COIN, 1, selection, fee, fee);\n         add_coin(2 * COIN, 2, selection, fee, fee);\n-        selection.ComputeAndSetWaste(/*min_viable_change=*/0, /*change_cost=*/0, /*change_fee=*/0);\n+        selection.RecalculateWaste(min_viable_change, change_cost , change_fee);\n         BOOST_CHECK_EQUAL(0, selection.GetWaste());\n     }\n \n     {\n-        // No Waste when (fee - long_term_fee) == (-cost_of_change), and no excess\n+        // Waste is 0 when (fee - long_term_fee) == (-cost_of_change), and no excess\n         SelectionResult selection{target, SelectionAlgorithm::MANUAL};\n-        const CAmount new_change_cost{fee_diff * 2};\n         add_coin(1 * COIN, 1, selection, fee, fee + fee_diff);\n         add_coin(2 * COIN, 2, selection, fee, fee + fee_diff);\n-        selection.ComputeAndSetWaste(/*min_viable_change=*/0, new_change_cost, /*change_fee=*/0);\n+        selection.RecalculateWaste(min_viable_change, /*change_cost=*/fee_diff * 2, change_fee);\n         BOOST_CHECK_EQUAL(0, selection.GetWaste());\n     }\n \n     {\n-        // No Waste when (fee - long_term_fee) == (-excess), no change cost\n-        const CAmount new_target{in_amt - fee * 2 - fee_diff * 2};\n+        // Waste is 0 when (fee - long_term_fee) == (-excess), no change cost\n+        const CAmount new_target{in_amt - fee * 2 - /*excess=*/fee_diff * 2};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28366#discussion_r1613850265",
      "id" : 1613850265,
      "in_reply_to_id" : 1593517046,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585gMWaZ",
      "original_commit_id" : "e95b9159380f2de7f9a6e7a202cc171ad285ee6c",
      "original_line" : 971,
      "original_position" : 115,
      "original_start_line" : null,
      "path" : "src/wallet/test/coinselector_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 2077274300,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28366",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1613850265/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-05-24T18:48:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1613850265",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/murchandamus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/murchandamus/followers",
         "following_url" : "https://api.github.com/users/murchandamus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/murchandamus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/murchandamus",
         "id" : 4060799,
         "login" : "murchandamus",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/murchandamus/orgs",
         "received_events_url" : "https://api.github.com/users/murchandamus/received_events",
         "repos_url" : "https://api.github.com/users/murchandamus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/murchandamus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/murchandamus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/murchandamus"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28366#discussion_r1613854692"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28366"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1613854692"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "used `exact_target` as proposed",
      "commit_id" : "2c18b861278b3960e7142068f487c882e30ce851",
      "created_at" : "2024-05-24T18:17:03Z",
      "diff_hunk" : "@@ -932,57 +934,56 @@ BOOST_AUTO_TEST_CASE(waste_test)\n         SelectionResult selection{target, SelectionAlgorithm::MANUAL};\n         add_coin(1 * COIN, 1, selection, fee, fee);\n         add_coin(2 * COIN, 2, selection, fee, fee);\n-        selection.ComputeAndSetWaste(/*min_viable_change=*/0, change_cost, /*change_fee=*/0);\n+        selection.RecalculateWaste(min_viable_change, change_cost, change_fee);\n         BOOST_CHECK_EQUAL(change_cost, selection.GetWaste());\n     }\n \n     {\n         // Waste without change and fee == long term fee is just the excess\n-        SelectionResult selection{target, SelectionAlgorithm::MANUAL};\n+        SelectionResult selection{/*target creates no change*/in_amt - 2 * fee - excess, SelectionAlgorithm::MANUAL};\n         add_coin(1 * COIN, 1, selection, fee, fee);\n         add_coin(2 * COIN, 2, selection, fee, fee);\n-        selection.ComputeAndSetWaste(/*min_viable_change=*/0, /*change_cost=*/0, /*change_fee=*/0);\n+        selection.RecalculateWaste(min_viable_change, change_cost, change_fee);\n         BOOST_CHECK_EQUAL(excess, selection.GetWaste());\n     }\n \n     {\n-        // No Waste when fee == long_term_fee, no change, and no excess\n+        // Waste is 0 when fee == long_term_fee, no change, and no excess\n         const CAmount exact_target{in_amt - fee * 2};\n         SelectionResult selection{exact_target, SelectionAlgorithm::MANUAL};\n         add_coin(1 * COIN, 1, selection, fee, fee);\n         add_coin(2 * COIN, 2, selection, fee, fee);\n-        selection.ComputeAndSetWaste(/*min_viable_change=*/0, /*change_cost=*/0, /*change_fee=*/0);\n+        selection.RecalculateWaste(min_viable_change, change_cost , change_fee);\n         BOOST_CHECK_EQUAL(0, selection.GetWaste());\n     }\n \n     {\n-        // No Waste when (fee - long_term_fee) == (-cost_of_change), and no excess\n+        // Waste is 0 when (fee - long_term_fee) == (-cost_of_change), and no excess\n         SelectionResult selection{target, SelectionAlgorithm::MANUAL};\n-        const CAmount new_change_cost{fee_diff * 2};\n         add_coin(1 * COIN, 1, selection, fee, fee + fee_diff);\n         add_coin(2 * COIN, 2, selection, fee, fee + fee_diff);\n-        selection.ComputeAndSetWaste(/*min_viable_change=*/0, new_change_cost, /*change_fee=*/0);\n+        selection.RecalculateWaste(min_viable_change, /*change_cost=*/fee_diff * 2, change_fee);\n         BOOST_CHECK_EQUAL(0, selection.GetWaste());\n     }\n \n     {\n-        // No Waste when (fee - long_term_fee) == (-excess), no change cost\n-        const CAmount new_target{in_amt - fee * 2 - fee_diff * 2};\n+        // Waste is 0 when (fee - long_term_fee) == (-excess), no change cost\n+        const CAmount new_target{in_amt - fee * 2 - /*excess=*/fee_diff * 2};\n         SelectionResult selection{new_target, SelectionAlgorithm::MANUAL};\n         add_coin(1 * COIN, 1, selection, fee, fee + fee_diff);\n         add_coin(2 * COIN, 2, selection, fee, fee + fee_diff);\n-        selection.ComputeAndSetWaste(/*min_viable_change=*/0, /*change_cost=*/0, /*change_fee=*/0);\n+        selection.RecalculateWaste(min_viable_change, change_cost, change_fee);\n         BOOST_CHECK_EQUAL(0, selection.GetWaste());\n     }\n \n     {\n         // Negative waste when the long term fee is greater than the current fee and the selected value == target\n-        const CAmount exact_target{3 * COIN - 2 * fee};\n+        const CAmount exact_target{in_amt - 2 * fee};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28366#discussion_r1613854692",
      "id" : 1613854692,
      "in_reply_to_id" : 1593510238,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585gMXfk",
      "original_commit_id" : "e95b9159380f2de7f9a6e7a202cc171ad285ee6c",
      "original_line" : 981,
      "original_position" : 127,
      "original_start_line" : null,
      "path" : "src/wallet/test/coinselector_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 2077274300,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28366",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1613854692/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-05-24T18:48:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1613854692",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/murchandamus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/murchandamus/followers",
         "following_url" : "https://api.github.com/users/murchandamus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/murchandamus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/murchandamus",
         "id" : 4060799,
         "login" : "murchandamus",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/murchandamus/orgs",
         "received_events_url" : "https://api.github.com/users/murchandamus/received_events",
         "repos_url" : "https://api.github.com/users/murchandamus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/murchandamus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/murchandamus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/murchandamus"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28366#discussion_r1613862525"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28366"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1613862525"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Added a calculation comment to illustrate the situation:\r\n\r\n```code\r\n        // = (2 * fee) - (2 * (fee + large_fee_diff)) + change_cost\r\n        // = (2 * 100) - (2 * (100 + 90)) + 125\r\n        // = 200 - 380 + 125 = -55\r\n```\r\n\r\nand asserted that my calculation is correct.",
      "commit_id" : "2c18b861278b3960e7142068f487c882e30ce851",
      "created_at" : "2024-05-24T18:26:12Z",
      "diff_hunk" : "@@ -993,7 +994,7 @@ BOOST_AUTO_TEST_CASE(waste_test)\n         const CAmount target_waste2{-2 * large_fee_diff + change_cost}; // = (2 * fee) - (2 * (fee + large_fee_diff)) + change_cost",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28366#discussion_r1613862525",
      "id" : 1613862525,
      "in_reply_to_id" : 1593513968,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585gMZZ9",
      "original_commit_id" : "e95b9159380f2de7f9a6e7a202cc171ad285ee6c",
      "original_line" : 994,
      "original_position" : 138,
      "original_start_line" : null,
      "path" : "src/wallet/test/coinselector_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 2077274300,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28366",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1613862525/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-05-24T18:48:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1613862525",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/murchandamus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/murchandamus/followers",
         "following_url" : "https://api.github.com/users/murchandamus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/murchandamus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/murchandamus",
         "id" : 4060799,
         "login" : "murchandamus",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/murchandamus/orgs",
         "received_events_url" : "https://api.github.com/users/murchandamus/received_events",
         "repos_url" : "https://api.github.com/users/murchandamus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/murchandamus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/murchandamus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/murchandamus"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28366#discussion_r1613876620"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28366"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1613876620"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I introduced an `exact_target` variable above this test block and used it everywhere it applies",
      "commit_id" : "2c18b861278b3960e7142068f487c882e30ce851",
      "created_at" : "2024-05-24T18:39:33Z",
      "diff_hunk" : "@@ -932,57 +934,56 @@ BOOST_AUTO_TEST_CASE(waste_test)\n         SelectionResult selection{target, SelectionAlgorithm::MANUAL};\n         add_coin(1 * COIN, 1, selection, fee, fee);\n         add_coin(2 * COIN, 2, selection, fee, fee);\n-        selection.ComputeAndSetWaste(/*min_viable_change=*/0, change_cost, /*change_fee=*/0);\n+        selection.RecalculateWaste(min_viable_change, change_cost, change_fee);\n         BOOST_CHECK_EQUAL(change_cost, selection.GetWaste());\n     }\n \n     {\n         // Waste without change and fee == long term fee is just the excess\n-        SelectionResult selection{target, SelectionAlgorithm::MANUAL};\n+        SelectionResult selection{/*target creates no change*/in_amt - 2 * fee - excess, SelectionAlgorithm::MANUAL};\n         add_coin(1 * COIN, 1, selection, fee, fee);\n         add_coin(2 * COIN, 2, selection, fee, fee);\n-        selection.ComputeAndSetWaste(/*min_viable_change=*/0, /*change_cost=*/0, /*change_fee=*/0);\n+        selection.RecalculateWaste(min_viable_change, change_cost, change_fee);\n         BOOST_CHECK_EQUAL(excess, selection.GetWaste());\n     }\n \n     {\n-        // No Waste when fee == long_term_fee, no change, and no excess\n+        // Waste is 0 when fee == long_term_fee, no change, and no excess\n         const CAmount exact_target{in_amt - fee * 2};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28366#discussion_r1613876620",
      "id" : 1613876620,
      "in_reply_to_id" : 1593507686,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585gMc2M",
      "original_commit_id" : "e95b9159380f2de7f9a6e7a202cc171ad285ee6c",
      "original_line" : 952,
      "original_position" : 90,
      "original_start_line" : null,
      "path" : "src/wallet/test/coinselector_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 2077274300,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28366",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1613876620/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-05-24T18:48:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1613876620",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/murchandamus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/murchandamus/followers",
         "following_url" : "https://api.github.com/users/murchandamus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/murchandamus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/murchandamus",
         "id" : 4060799,
         "login" : "murchandamus",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/murchandamus/orgs",
         "received_events_url" : "https://api.github.com/users/murchandamus/received_events",
         "repos_url" : "https://api.github.com/users/murchandamus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/murchandamus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/murchandamus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/murchandamus"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> I'm not sure whether [44db79b](https://github.com/bitcoin/bitcoin/commit/44db79b0c48d6b1a26dba6ab01c2a296d610c06b) is useful since it's fully replaced by the following commit.\r\n\r\nAh oops, yeah I guess the first commit was a vestige of my first attempt at this. I squashed it into the second commit.\r\n\r\nDiff of before reviews to latest: https://github.com/bitcoin/bitcoin/compare/e95b9159380f2de7f9a6e7a202cc171ad285ee6c..2c18b86",
      "created_at" : "2024-05-24T18:56:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28366#issuecomment-2130175396",
      "id" : 2130175396,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28366",
      "node_id" : "IC_kwDOABII585-9-Wk",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2130175396/reactions"
      },
      "updated_at" : "2024-05-24T18:56:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2130175396",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/murchandamus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/murchandamus/followers",
         "following_url" : "https://api.github.com/users/murchandamus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/murchandamus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/murchandamus",
         "id" : 4060799,
         "login" : "murchandamus",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/murchandamus/orgs",
         "received_events_url" : "https://api.github.com/users/murchandamus/received_events",
         "repos_url" : "https://api.github.com/users/murchandamus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/murchandamus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/murchandamus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/murchandamus"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--85328a0da195eb286784d51f73fa0af9-->\n\nð§ At least one of the CI tasks failed. Make sure to run all tests locally, according to the\ndocumentation.\n\nPossibly this is due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n<sub>Debug: https://github.com/bitcoin/bitcoin/runs/25393161083</sub>",
      "created_at" : "2024-05-25T00:52:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28366#issuecomment-2130620080",
      "id" : 2130620080,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28366",
      "node_id" : "IC_kwDOABII585-_q6w",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2130620080/reactions"
      },
      "updated_at" : "2024-05-25T00:52:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2130620080",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Happy to reack, but you need to fix clang-tidy first\r\n\r\n```\r\nwallet/test/coinselector_tests.cpp:893:43: error: argument name 'current_fee' in comment does not match parameter name 'fee' [bugprone-argument-comment,-warnings-as-errors]\r\n  893 |         add_coin(1 * COIN, 1, selection1, /*current_fee=*/fee, /*long_term_fee=*/fee - fee_diff);\r\n      |                                           ^\r\nwallet/test/coinselector_tests.cpp:61:90: note: 'fee' declared here\r\n   61 | static void add_coin(const CAmount& nValue, int nInput, SelectionResult& result, CAmount fee, CAmount long_term_fee)\r\n      | \r\n```",
      "created_at" : "2024-05-27T07:29:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28366#issuecomment-2132825213",
      "id" : 2132825213,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28366",
      "node_id" : "IC_kwDOABII585_IFR9",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2132825213/reactions"
      },
      "updated_at" : "2024-05-27T07:29:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2132825213",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1466284?v=4",
         "events_url" : "https://api.github.com/users/S3RK/events{/privacy}",
         "followers_url" : "https://api.github.com/users/S3RK/followers",
         "following_url" : "https://api.github.com/users/S3RK/following{/other_user}",
         "gists_url" : "https://api.github.com/users/S3RK/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/S3RK",
         "id" : 1466284,
         "login" : "S3RK",
         "node_id" : "MDQ6VXNlcjE0NjYyODQ=",
         "organizations_url" : "https://api.github.com/users/S3RK/orgs",
         "received_events_url" : "https://api.github.com/users/S3RK/received_events",
         "repos_url" : "https://api.github.com/users/S3RK/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/S3RK/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/S3RK/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/S3RK"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28366#discussion_r1619461019"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28366"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1619461019"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Could set the second parameter, `change_cost`, to 0 instead of providing `cost_of_change`. The parameter is only used if there is change and BnB goal is to not generate one.",
      "commit_id" : "bd34dd85e7b8b4cc26d2173d84bbeda2e9c27624",
      "created_at" : "2024-05-29T20:52:24Z",
      "diff_hunk" : "@@ -194,7 +194,7 @@ util::Result<SelectionResult> SelectCoinsBnB(std::vector<OutputGroup>& utxo_pool\n     for (const size_t& i : best_selection) {\n         result.AddInput(utxo_pool.at(i));\n     }\n-    result.ComputeAndSetWaste(cost_of_change, cost_of_change, CAmount{0});\n+    result.RecalculateWaste(cost_of_change, cost_of_change, CAmount{0});",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28366#discussion_r1619461019",
      "id" : 1619461019,
      "line" : 197,
      "node_id" : "PRRC_kwDOABII585ghwOb",
      "original_commit_id" : "7aa7e30441fe77bf8e8092916e36b004bbbfe2a7",
      "original_line" : 197,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/wallet/coinselection.cpp",
      "position" : 5,
      "pull_request_review_id" : 2086451768,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28366",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1619461019/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-05-29T21:13:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1619461019",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   }
]
