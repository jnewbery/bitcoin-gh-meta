[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Thank you for the bug report and repro steps.\r\n\r\nMight be related to https://github.com/bitcoin/bitcoin/issues/21151 ?\r\n\r\nI have reproduced with your script on v24.0rc2, but not yet gone through the script logic in detail to see why this is failing since https://github.com/bitcoin/bitcoin/pull/21166:\r\n\r\n```\r\nwill@ubuntu in ~/temp via ð v3.6.12 took 16s\r\nâ¯ ./26385.sh\r\nBitcoin Core starting\r\n{\r\n  \"name\": \"\",\r\n  \"warning\": \"\"\r\n}\r\n\r\nb-cli createmultisig 2 [\"02204cc848e8ac548b5e716e9c06eaf8bc84f896d08f5c5e21b97f6d5e5f88c95d\",\"030297346cd7b3236e844fc8ba63793f4677fab9eb0282abec99c00b42770d051a\",\"03d9a9029dec2e0d62f3f5bedd686b919bba7ce7bd36c2406e1b8e7ebeea1b637c\"] legacy\r\npubkeys: 02204cc848e8ac548b5e716e9c06eaf8bc84f896d08f5c5e21b97f6d5e5f88c95d 030297346cd7b3236e844fc8ba63793f4677fab9eb0282abec99c00b42770d051a 03d9a9029dec2e0d62f3f5bedd686b919bba7ce7bd36c2406e1b8e7ebeea1b637c\r\nprivkeys: cW3np3Apfi1dbvV9WxabWn1BVBkrce2nbbYYE34DkQRdZFNiNYoz cUePsEDPDouj2eb6jhYRmxhutdoMQFCiwQN1B9ErtKdmXKYx8Xjg cMjnX31zMHDQoeXfoCCgug2bjLHTX3Bihtg56re6UQicshbBcfdT\r\n\r\ncreatewallet destwallet\r\n{\r\n  \"name\": \"destwallet\",\r\n  \"warning\": \"\"\r\n}\r\nunloadwallet destwallet\r\n{\r\n  \"warning\": \"\"\r\n}\r\nSending utxo d4b5e918f5e8296b74a003037c21680b893d4161bcbf6fd9ee909537f561a259 to final address bcrt1qcysp6g4kmhk8c39yf7xm6vkqxmg8k4ljf8prtn\r\n\r\ntx BEFORE signrawtransactionwithwallet: 010000000259a261f5379590eed96fbfbc61413d890b68217c0303a0746b29e8f518e9b5d400000000fc00473044022029458f221b23dff4171a492fea136e7a6d70214aa249be6b770accf3df49511e02207a84db1a6c012106a6e3fcfe37fff4c0171995e9f99e00bbb0f3bb335789689483473044022051d3fc59fc06b82ed0b5b4812a567eed0ef597dab3f4ef67f7154b181790b7c00220528a7b1febf010fbbdd682e68ac400fe635769542323adf6e129c23c19143c51834c69522102204cc848e8ac548b5e716e9c06eaf8bc84f896d08f5c5e21b97f6d5e5f88c95d21030297346cd7b3236e844fc8ba63793f4677fab9eb0282abec99c00b42770d051a2103d9a9029dec2e0d62f3f5bedd686b919bba7ce7bd36c2406e1b8e7ebeea1b637c53ae0000000059a261f5379590eed96fbfbc61413d890b68217c0303a0746b29e8f518e9b5d40100000000000000000200e1f50500000000160014c1201d22b6ddec7c44a44f8dbd32c036d07b57f25ae40f2401000000160014d3d3201f954e2344958af90ddaa2be84b6928a0100000000\r\ntx AFTER signrawtransactionwithwallet: 0100000000010259a261f5379590eed96fbfbc61413d890b68217c0303a0746b29e8f518e9b5d4000000006d00004c69522102204cc848e8ac548b5e716e9c06eaf8bc84f896d08f5c5e21b97f6d5e5f88c95d21030297346cd7b3236e844fc8ba63793f4677fab9eb0282abec99c00b42770d051a2103d9a9029dec2e0d62f3f5bedd686b919bba7ce7bd36c2406e1b8e7ebeea1b637c53ae0000000059a261f5379590eed96fbfbc61413d890b68217c0303a0746b29e8f518e9b5d40100000017160014bafa6a4a429e1e06cd4ea7a81c8a40f5a9e73e29000000000200e1f50500000000160014c1201d22b6ddec7c44a44f8dbd32c036d07b57f25ae40f2401000000160014d3d3201f954e2344958af90ddaa2be84b6928a010002473044022012427cd5dce2b32deb820c880ed43d0f4c30f5475d783d9a1ab63df4a94c5ecd02200b962e4386dc66b9e3bcf1888a07e9a782d92473a78de36163bc4f640adc6aa30121020ada311431cadab2788e59d7e419d64859a31dc76a19e2f84926d5b7b47876ab00000000\r\nError signing with wallet (Unable to sign input, invalid stack size (possibly missing key))\r\n```",
      "created_at" : "2022-10-25T12:42:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/26385#issuecomment-1290491358",
      "id" : 1290491358,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26385",
      "node_id" : "IC_kwDOABII585M61Xe",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1290491358/reactions"
      },
      "updated_at" : "2022-10-25T12:42:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1290491358",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6606587?v=4",
         "events_url" : "https://api.github.com/users/willcl-ark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/willcl-ark/followers",
         "following_url" : "https://api.github.com/users/willcl-ark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/willcl-ark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/willcl-ark",
         "id" : 6606587,
         "login" : "willcl-ark",
         "node_id" : "MDQ6VXNlcjY2MDY1ODc=",
         "organizations_url" : "https://api.github.com/users/willcl-ark/orgs",
         "received_events_url" : "https://api.github.com/users/willcl-ark/received_events",
         "repos_url" : "https://api.github.com/users/willcl-ark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/willcl-ark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/willcl-ark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/willcl-ark"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "It looks like `$finaltx` comes from `hal`. Are you certain that that transaction is valid? I think the only way that this issue can occur is if the signatures in `$finaltx` are invalid. In that case, the signature extractor will fail to find the signatures as it is detecting them to be invalid and so ignores them. Then when it \"signs\" the input, it doesn't have anything to fill in and ends up clearing it.\r\n\r\nI don't have some of the tools needed to run the script installed on my system. Can you reproduce this issue with *only* Bitcoin Core commands? What happens if you do `testmempoolaccept $finaltx` before doing `signrawtransactionwithwallet`?",
      "created_at" : "2022-10-25T19:17:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/26385#issuecomment-1291025359",
      "id" : 1291025359,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26385",
      "node_id" : "IC_kwDOABII585M83vP",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1291025359/reactions"
      },
      "updated_at" : "2022-10-25T19:17:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1291025359",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "I'm not certain that that transaction is valid tbh, but I have no reason to suspect it isn't (hal is based on rust-bitcoin). By the way: shouldn't `decoderawtransaction` fail if that were the case?\r\n\r\nTo try to reproduce this issue with only Bitcoin Core commands: do you know which rpc I could use to merge the transactions?\r\nI tried with `testmempoolaccept $finaltx` before doing `signrawtransactionwithwallet` but it fails since the last transaction isn't signed yet.\r\nI also tried `testmempoolaccept` with only the first transaction, and it fails because it doesn't have fees (\"min relay fee not met\").",
      "created_at" : "2022-10-26T00:52:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/26385#issuecomment-1291293119",
      "id" : 1291293119,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26385",
      "node_id" : "IC_kwDOABII585M95G_",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1291293119/reactions"
      },
      "updated_at" : "2022-10-26T00:52:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1291293119",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/94554885?v=4",
         "events_url" : "https://api.github.com/users/andreabonel/events{/privacy}",
         "followers_url" : "https://api.github.com/users/andreabonel/followers",
         "following_url" : "https://api.github.com/users/andreabonel/following{/other_user}",
         "gists_url" : "https://api.github.com/users/andreabonel/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/andreabonel",
         "id" : 94554885,
         "login" : "andreabonel",
         "node_id" : "U_kgDOBaLLBQ",
         "organizations_url" : "https://api.github.com/users/andreabonel/orgs",
         "received_events_url" : "https://api.github.com/users/andreabonel/received_events",
         "repos_url" : "https://api.github.com/users/andreabonel/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/andreabonel/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/andreabonel/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/andreabonel"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> By the way: shouldn't `decoderawtransaction` fail if that were the case?\r\n\r\nNo, `decoderawtransaction` does not check signatures.\r\n\r\n> To try to reproduce this issue with only Bitcoin Core commands: do you know which rpc I could use to merge the transactions?\r\n\r\nYou could use `combinerawtransaction`.\r\n\r\n> I also tried `testmempoolaccept` with only the first transaction, and it fails because it doesn't have fees (\"min relay fee not met\").\r\n\r\nThe output has the same amount as the input, so the fee is 0. Try setting the output amount to be 0.9999",
      "created_at" : "2022-10-26T01:51:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/26385#issuecomment-1291381723",
      "id" : 1291381723,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26385",
      "node_id" : "IC_kwDOABII585M-Ovb",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1291381723/reactions"
      },
      "updated_at" : "2022-10-26T01:51:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1291381723",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Am I correct to assume this is still a bug awaiting a fix?",
      "created_at" : "2023-03-29T13:32:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/26385#issuecomment-1488621015",
      "id" : 1488621015,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26385",
      "node_id" : "IC_kwDOABII585Yuo3X",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1488621015/reactions"
      },
      "updated_at" : "2023-03-29T13:32:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1488621015",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/282177?v=4",
         "events_url" : "https://api.github.com/users/meglio/events{/privacy}",
         "followers_url" : "https://api.github.com/users/meglio/followers",
         "following_url" : "https://api.github.com/users/meglio/following{/other_user}",
         "gists_url" : "https://api.github.com/users/meglio/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/meglio",
         "id" : 282177,
         "login" : "meglio",
         "node_id" : "MDQ6VXNlcjI4MjE3Nw==",
         "organizations_url" : "https://api.github.com/users/meglio/orgs",
         "received_events_url" : "https://api.github.com/users/meglio/received_events",
         "repos_url" : "https://api.github.com/users/meglio/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/meglio/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/meglio/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/meglio"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "The problem is not easily reproducible.\r\n\r\nPlease open a new issue (or leave a comment in here if you want this re-opened) if you experience the problem again.",
      "created_at" : "2023-09-21T15:40:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/26385#issuecomment-1729837330",
      "id" : 1729837330,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26385",
      "node_id" : "IC_kwDOABII585nGzkS",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1729837330/reactions"
      },
      "updated_at" : "2023-09-21T15:40:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1729837330",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6606587?v=4",
         "events_url" : "https://api.github.com/users/willcl-ark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/willcl-ark/followers",
         "following_url" : "https://api.github.com/users/willcl-ark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/willcl-ark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/willcl-ark",
         "id" : 6606587,
         "login" : "willcl-ark",
         "node_id" : "MDQ6VXNlcjY2MDY1ODc=",
         "organizations_url" : "https://api.github.com/users/willcl-ark/orgs",
         "received_events_url" : "https://api.github.com/users/willcl-ark/received_events",
         "repos_url" : "https://api.github.com/users/willcl-ark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/willcl-ark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/willcl-ark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/willcl-ark"
      }
   }
]
