[
   {
      "author_association" : "MEMBER",
      "body" : "> I suspect a bug in the code is causing some thread to write to an incorrect memory location, possibly a memory use-after-free/reallocation/reorganization bug.\r\n\r\nWould it be possible for you to compile and run with asan, or a similar sanitizer?\r\n\r\nAlso, what filesystem are you using on the drives? Something like `df --print-type --human-readable /bdata` should print it.",
      "created_at" : "2024-05-23T15:35:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/30159#issuecomment-2127439462",
      "id" : 2127439462,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/30159",
      "node_id" : "IC_kwDOABII585-ziZm",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2127439462/reactions"
      },
      "updated_at" : "2024-05-23T15:35:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2127439462",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "xfs on the root and data drive\r\n\r\nsudo mkswap /dev/nvme[4 GB disk]\r\nsudo swapon /dev/nvme[4 GB disk]\r\n\r\nsudo mkdir /bdata\r\nsudo mkfs -t xfs /dev/nvme[40 GB disk]\r\nlsblk -o name,size,type,uuid\r\nsudo nano /etc/fstab\r\n\r\nadd to fstab:\r\nUUID=[4 GB disk uuid] swap swap defaults 0 0\r\nUUID=[40 GB disk uuid] /bdata xfs defaults,nofail 0 2\r\n\r\nsudo mount -a\r\n\r\nFilesystem       Type      Size  Used Avail Use% Mounted on\r\ndevtmpfs         devtmpfs  4.0M     0  4.0M   0% /dev\r\ntmpfs            tmpfs     210M     0  210M   0% /dev/shm\r\ntmpfs            tmpfs      84M  552K   84M   1% /run\r\n/dev/nvme0n1p1   xfs        14G  3.4G   11G  25% /\r\ntmpfs            tmpfs     210M     0  210M   0% /tmp\r\n/dev/nvme1n1     xfs        40G   19G   22G  46% /bdata\r\n/dev/nvme0n1p128 vfat       10M  1.4M  8.7M  14% /boot/efi\r\ntmpfs            tmpfs      42M     0   42M   0% /run/user/1000\r\n",
      "created_at" : "2024-05-23T15:40:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/30159#issuecomment-2127451533",
      "id" : 2127451533,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/30159",
      "node_id" : "IC_kwDOABII585-zlWN",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2127451533/reactions"
      },
      "updated_at" : "2024-05-23T15:40:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2127451533",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7013474?v=4",
         "events_url" : "https://api.github.com/users/apulsifer/events{/privacy}",
         "followers_url" : "https://api.github.com/users/apulsifer/followers",
         "following_url" : "https://api.github.com/users/apulsifer/following{/other_user}",
         "gists_url" : "https://api.github.com/users/apulsifer/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/apulsifer",
         "id" : 7013474,
         "login" : "apulsifer",
         "node_id" : "MDQ6VXNlcjcwMTM0NzQ=",
         "organizations_url" : "https://api.github.com/users/apulsifer/orgs",
         "received_events_url" : "https://api.github.com/users/apulsifer/received_events",
         "repos_url" : "https://api.github.com/users/apulsifer/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/apulsifer/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/apulsifer/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/apulsifer"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "> Would it be possible for you to compile and run with asan, or a similar sanitizer?\r\n\r\nI don't see where I would get a chunk of time to do that right now.... But as I mentioned, I copied the corrupted files, and that might give some clues to someone familiar with their format (especially if the corruption is ascii in the middle of binary, or vice versa)",
      "created_at" : "2024-05-23T15:45:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/30159#issuecomment-2127461229",
      "id" : 2127461229,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/30159",
      "node_id" : "IC_kwDOABII585-zntt",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2127461229/reactions"
      },
      "updated_at" : "2024-05-23T15:45:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2127461229",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7013474?v=4",
         "events_url" : "https://api.github.com/users/apulsifer/events{/privacy}",
         "followers_url" : "https://api.github.com/users/apulsifer/followers",
         "following_url" : "https://api.github.com/users/apulsifer/following{/other_user}",
         "gists_url" : "https://api.github.com/users/apulsifer/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/apulsifer",
         "id" : 7013474,
         "login" : "apulsifer",
         "node_id" : "MDQ6VXNlcjcwMTM0NzQ=",
         "organizations_url" : "https://api.github.com/users/apulsifer/orgs",
         "received_events_url" : "https://api.github.com/users/apulsifer/received_events",
         "repos_url" : "https://api.github.com/users/apulsifer/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/apulsifer/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/apulsifer/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/apulsifer"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> I don't see where I would get a chunk of time to do that right now....\r\n\r\nSure, no rush. I'll probably take some time to pin this down. (I don't have an AWS account, so I can't test it, but maybe someone else has).\r\n\r\nSome other ideas to test in the meantime:\r\n\r\n* Try another filesystem instead of xfs\r\n* Try the master branch (not for production, just for testing whether the issue still happens there)\r\n\r\n",
      "created_at" : "2024-05-23T16:22:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/30159#issuecomment-2127569909",
      "id" : 2127569909,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/30159",
      "node_id" : "IC_kwDOABII585-0CP1",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2127569909/reactions"
      },
      "updated_at" : "2024-05-23T16:22:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2127569909",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "xfs is used on the root drive of every Amazon EC2 instance running Amazon Linux. If xfs on Amazon EC2 were the problem, a lot of of critical infrastructure would be failing right now. And as I mentioned, these machines are also running bitcoin cash in an almost an identical configuration (data file path and ports changed) and it has had zero problems. Since the data corruption only happens about once per week when running on mainnet, I think figuring this problem out will probably take a customized and instrumented version of bitcoind being feed blocks at high speed with random jitter and waits and synthetic memory pressure. This could probably be done on a virtual machine anywhere, like Xen, KVM, Virtual Box, etc.",
      "created_at" : "2024-05-23T17:51:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/30159#issuecomment-2127734105",
      "id" : 2127734105,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/30159",
      "node_id" : "IC_kwDOABII585-0qVZ",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2127734105/reactions"
      },
      "updated_at" : "2024-05-23T17:51:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2127734105",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7013474?v=4",
         "events_url" : "https://api.github.com/users/apulsifer/events{/privacy}",
         "followers_url" : "https://api.github.com/users/apulsifer/followers",
         "following_url" : "https://api.github.com/users/apulsifer/following{/other_user}",
         "gists_url" : "https://api.github.com/users/apulsifer/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/apulsifer",
         "id" : 7013474,
         "login" : "apulsifer",
         "node_id" : "MDQ6VXNlcjcwMTM0NzQ=",
         "organizations_url" : "https://api.github.com/users/apulsifer/orgs",
         "received_events_url" : "https://api.github.com/users/apulsifer/received_events",
         "repos_url" : "https://api.github.com/users/apulsifer/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/apulsifer/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/apulsifer/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/apulsifer"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Since the data corruption only happens about once per week\r\n\r\nOnce per week is a lot and if this was a broader problem, I'd assume that more people were complaining. Given that you can consistently reproduce on different machines, this seems like a real bug is somewhere. However, Bitcoin Core is running fine in a lot of other places, so there has to be some hardware or configuration setting (or combination thereof) that triggers this bug on your side. It would be good to know which one it is.",
      "created_at" : "2024-05-23T18:27:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/30159#issuecomment-2127790284",
      "id" : 2127790284,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/30159",
      "node_id" : "IC_kwDOABII585-04DM",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2127790284/reactions"
      },
      "updated_at" : "2024-05-23T18:27:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2127790284",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "(edited first question out, I misunderstood)\r\n\r\nFrom your log it appears that this happened while the node was catching up with the tip (almost but not completely synced yet), receiving blocks quickly. Is that typical, or does it usually happen when the node is synced and receives blocks as they are mined?",
      "created_at" : "2024-05-23T18:32:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/30159#issuecomment-2127797705",
      "id" : 2127797705,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/30159",
      "node_id" : "IC_kwDOABII585-053J",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2127797705/reactions"
      },
      "updated_at" : "2024-05-23T19:18:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2127797705",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48763452?v=4",
         "events_url" : "https://api.github.com/users/mzumsande/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mzumsande/followers",
         "following_url" : "https://api.github.com/users/mzumsande/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mzumsande/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mzumsande",
         "id" : 48763452,
         "login" : "mzumsande",
         "node_id" : "MDQ6VXNlcjQ4NzYzNDUy",
         "organizations_url" : "https://api.github.com/users/mzumsande/orgs",
         "received_events_url" : "https://api.github.com/users/mzumsande/received_events",
         "repos_url" : "https://api.github.com/users/mzumsande/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mzumsande/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mzumsande/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mzumsande"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "> Once per week is a lot and if this was a broader problem, I'd assume that more people were complaining. \r\n\r\nIt could just be that the memory pressure is uncovering the problem. Of course, any machine can experience memory pressure at times, but one thing that's unique is that those machines starting hard paging to SSD for about 20 seconds after each new block arrives.",
      "created_at" : "2024-05-23T19:10:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/30159#issuecomment-2127853991",
      "id" : 2127853991,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/30159",
      "node_id" : "IC_kwDOABII585-1Hmn",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2127853991/reactions"
      },
      "updated_at" : "2024-05-23T19:10:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2127853991",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7013474?v=4",
         "events_url" : "https://api.github.com/users/apulsifer/events{/privacy}",
         "followers_url" : "https://api.github.com/users/apulsifer/followers",
         "following_url" : "https://api.github.com/users/apulsifer/following{/other_user}",
         "gists_url" : "https://api.github.com/users/apulsifer/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/apulsifer",
         "id" : 7013474,
         "login" : "apulsifer",
         "node_id" : "MDQ6VXNlcjcwMTM0NzQ=",
         "organizations_url" : "https://api.github.com/users/apulsifer/orgs",
         "received_events_url" : "https://api.github.com/users/apulsifer/received_events",
         "repos_url" : "https://api.github.com/users/apulsifer/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/apulsifer/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/apulsifer/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/apulsifer"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "> Could you explain the paging in a bit more detail?\r\n\r\nThe machines page pretty hard to SSD for about 20 seconds after each new block arrives.  That info comes from \"sar -d 10\", which I logged for a while when I was setting up the first machine.\r\n\r\n> Is the node constantly being bombarded with lots of simultaneous RPC calls (which ones?) or is some other interface used?\r\n\r\nNone of these machines has at this point serviced a single RPC call (I'm still trying to get things set up). No other interface is being used, just the bitcoind peer network, half of the machines with direct IPv6, half via torproxy.\r\n\r\n> Also, from your log it appears that this happened while the node was catching up with the tip (almost but not completely synced yet), receiving blocks quickly. Is that typical, or does it usually happen when the node is synced and receives blocks as they are mined?\r\n\r\nSync'ing has been pretty typical at the moment, since I'm still setting things up and bitcoind has been started and stopped from time-to-time to try out different settings.\r\n\r\nThe initial sync from the genesis block was done on a machine with 16 GB RAM. Then on May 7, bitcoind on that machine was stopped and the /bdata directory was copied to these 10 machines with only 512 MB RAM that are only expected to keep up with new blocks as they arrive. Since that time, two of the ten machines have had no data corruption. The other eight machines have had data corruption one or more times.\r\n\r\nThe problem doesn't just show up during block sync however. I do know that on Monday at end of day, all the machines were running and fully synced, and by Tuesday morning, two machines had data corruption. I was busy with other things and left all the machines alone, and by the time I went to fix them Wednesday afternoon, four machines had data corruption.\r\n\r\nI don't think I can definitely rule out that starting and stopping bitcoind, or rebooting the machines has not contributed to this problem. The files could sit in the bdata directory for a while, and it's possible one is getting corrupted when bitcoind shuts down or the machine reboots but bitcoind doesn't notice it until sometime later when it reads the file.  Note that bitcoind is being started and stopped by systemd service files (attached below) which has a 10 minute timeout. So systemd will politely ask bitcoind to stop, and if it hasn't exited after 10 minutes, systemd will kill it. Another thing worth noting from the service file is that I set up bitcoind to run at Nice=16, which might contribute to triggering the problem.\r\n\r\nAs of late last night, all machines are running and fully synced again. By next week, I'm going to start leaving them alone to run autonomously (with the exception of rebuilding a datadir if needed), so that will be a much better test of what happens when the machines are fully synced and bitcoind is running continuously.\r\n\r\n[Service]\r\nWorkingDirectory=/home/ec2-user\r\nExecStart=/home/ec2-user/bitcoin/bin/bitcoind -conf=/home/ec2-user/bitcoin.conf\r\nRestart=always\r\nRestartSec=60\r\nTimeoutStopSec=600\r\nNice=16\r\nUser=ec2-user\r\nGroup=ec2-user\r\nStandardOutput=journal\r\nStandardError=journal\r\n\r\n[Unit]\r\nAfter=network-online.target\r\n\r\n[Install]\r\nWantedBy=multi-user.target\r\n",
      "created_at" : "2024-05-23T19:58:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/30159#issuecomment-2127922118",
      "id" : 2127922118,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/30159",
      "node_id" : "IC_kwDOABII585-1YPG",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2127922118/reactions"
      },
      "updated_at" : "2024-05-23T19:58:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2127922118",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7013474?v=4",
         "events_url" : "https://api.github.com/users/apulsifer/events{/privacy}",
         "followers_url" : "https://api.github.com/users/apulsifer/followers",
         "following_url" : "https://api.github.com/users/apulsifer/following{/other_user}",
         "gists_url" : "https://api.github.com/users/apulsifer/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/apulsifer",
         "id" : 7013474,
         "login" : "apulsifer",
         "node_id" : "MDQ6VXNlcjcwMTM0NzQ=",
         "organizations_url" : "https://api.github.com/users/apulsifer/orgs",
         "received_events_url" : "https://api.github.com/users/apulsifer/received_events",
         "repos_url" : "https://api.github.com/users/apulsifer/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/apulsifer/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/apulsifer/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/apulsifer"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I think calling the RPC `gettxoutsetinfo muhash` on all nodes (when they are synced to the same block) and it matches for all, then the chainstate leveldb at that point in time is probably fine. I presume all failures happened in the `/bdata/bitcoin-data/chainstate/` leveldb?\r\n\r\nEdit: Calling that RPC will take a long time on your machines, I suspect.",
      "created_at" : "2024-05-23T20:20:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/30159#issuecomment-2127953334",
      "id" : 2127953334,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/30159",
      "node_id" : "IC_kwDOABII585-1f22",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2127953334/reactions"
      },
      "updated_at" : "2024-05-23T20:20:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2127953334",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Yes, all the checksum errors are in numerically-named NNNNNN.ldb files in /bdata/bitcoin-data/chainstate/\r\n\r\nI had no luck with gettxoutsetinfo muhash:\r\n\r\nbitcoin/bin/bitcoin-cli -rpcwaittimeout=0 -conf=/home/ec2-user/bitcoin.conf getblockcount\r\n844826\r\n\r\nbitcoin/bin/bitcoin-cli -rpcwaittimeout=0 -conf=/home/ec2-user/bitcoin.conf gettxoutsetinfo muhash\r\nerror: timeout on transient error: Could not connect to the server 127.0.0.1:8332 (error code 0 - \"timeout reached\")\r\n",
      "created_at" : "2024-05-23T23:51:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/30159#issuecomment-2128231134",
      "id" : 2128231134,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/30159",
      "node_id" : "IC_kwDOABII585-2jre",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2128231134/reactions"
      },
      "updated_at" : "2024-05-23T23:51:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2128231134",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7013474?v=4",
         "events_url" : "https://api.github.com/users/apulsifer/events{/privacy}",
         "followers_url" : "https://api.github.com/users/apulsifer/followers",
         "following_url" : "https://api.github.com/users/apulsifer/following{/other_user}",
         "gists_url" : "https://api.github.com/users/apulsifer/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/apulsifer",
         "id" : 7013474,
         "login" : "apulsifer",
         "node_id" : "MDQ6VXNlcjcwMTM0NzQ=",
         "organizations_url" : "https://api.github.com/users/apulsifer/orgs",
         "received_events_url" : "https://api.github.com/users/apulsifer/received_events",
         "repos_url" : "https://api.github.com/users/apulsifer/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/apulsifer/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/apulsifer/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/apulsifer"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "The RPC will take a long time (probably hours), so you'll have to disable the client timeout `-rpcclienttimeout=0`.\r\n\r\n```\r\nbitcoin/bin/bitcoin-cli -rpcclienttimeout=0 -rpcwaittimeout=0 -conf=/home/ec2-user/bitcoin.conf gettxoutsetinfo muhash",
      "created_at" : "2024-05-24T06:27:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/30159#issuecomment-2128657943",
      "id" : 2128657943,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/30159",
      "node_id" : "IC_kwDOABII585-4L4X",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2128657943/reactions"
      },
      "updated_at" : "2024-05-24T06:27:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2128657943",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Took about 20 minutes. They all match.\r\n\r\nFri May 24 12:12:33 UTC 2024\r\n{\r\n  \"height\": 844917,\r\n  \"bestblock\": \"000000000000000000017dd5f59b73629f6f88797e90017a9df39c5e435296bf\",\r\n  \"txouts\": 181984254,\r\n  \"bogosize\": 13994337434,\r\n  \"muhash\": \"b97a3fb13a61e8c889668d064f7ae5408a78ee7e4c6a4fdebedb30ecb2f23378\",\r\n  \"total_amount\": 19702649.24256659,\r\n  \"transactions\": 125720653,\r\n  \"disk_size\": 12220356091\r\n}\r\nFri May 24 12:39:58 UTC 2024\r\n",
      "created_at" : "2024-05-24T12:43:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/30159#issuecomment-2129447054",
      "id" : 2129447054,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/30159",
      "node_id" : "IC_kwDOABII585-7MiO",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 2,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 2,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2129447054/reactions"
      },
      "updated_at" : "2024-05-24T12:43:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2129447054",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7013474?v=4",
         "events_url" : "https://api.github.com/users/apulsifer/events{/privacy}",
         "followers_url" : "https://api.github.com/users/apulsifer/followers",
         "following_url" : "https://api.github.com/users/apulsifer/following{/other_user}",
         "gists_url" : "https://api.github.com/users/apulsifer/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/apulsifer",
         "id" : 7013474,
         "login" : "apulsifer",
         "node_id" : "MDQ6VXNlcjcwMTM0NzQ=",
         "organizations_url" : "https://api.github.com/users/apulsifer/orgs",
         "received_events_url" : "https://api.github.com/users/apulsifer/received_events",
         "repos_url" : "https://api.github.com/users/apulsifer/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/apulsifer/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/apulsifer/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/apulsifer"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Update: Since leaving these servers alone for a week and not rebooting them or restarting bitcoind, they have stayed perfectly in sync without issues. So it looks like the problem is triggered by starting and stopping bitcoind (which I can live with, if I do have to restart a server and I get data corruption, I'll image the data from another server).",
      "created_at" : "2024-05-31T16:55:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/30159#issuecomment-2142645727",
      "id" : 2142645727,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/30159",
      "node_id" : "IC_kwDOABII585_ti3f",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2142645727/reactions"
      },
      "updated_at" : "2024-05-31T16:55:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2142645727",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7013474?v=4",
         "events_url" : "https://api.github.com/users/apulsifer/events{/privacy}",
         "followers_url" : "https://api.github.com/users/apulsifer/followers",
         "following_url" : "https://api.github.com/users/apulsifer/following{/other_user}",
         "gists_url" : "https://api.github.com/users/apulsifer/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/apulsifer",
         "id" : 7013474,
         "login" : "apulsifer",
         "node_id" : "MDQ6VXNlcjcwMTM0NzQ=",
         "organizations_url" : "https://api.github.com/users/apulsifer/orgs",
         "received_events_url" : "https://api.github.com/users/apulsifer/received_events",
         "repos_url" : "https://api.github.com/users/apulsifer/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/apulsifer/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/apulsifer/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/apulsifer"
      }
   }
]
