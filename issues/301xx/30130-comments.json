[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage\nFor detailed information about the code coverage, see the [test coverage report](https://corecheck.dev/bitcoin/bitcoin/pulls/30130).\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n",
      "created_at" : "2024-05-17T16:10:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/30130#issuecomment-2117928697",
      "id" : 2117928697,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/30130",
      "node_id" : "IC_kwDOABII585-PQb5",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2117928697/reactions"
      },
      "updated_at" : "2024-05-17T16:10:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2117928697",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Force pushed so that the commit message is the same as the PR title.",
      "created_at" : "2024-05-17T16:11:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/30130#issuecomment-2117932334",
      "id" : 2117932334,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/30130",
      "node_id" : "IC_kwDOABII585-PRUu",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2117932334/reactions"
      },
      "updated_at" : "2024-05-17T16:11:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2117932334",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/78322931?v=4",
         "events_url" : "https://api.github.com/users/edilmedeiros/events{/privacy}",
         "followers_url" : "https://api.github.com/users/edilmedeiros/followers",
         "following_url" : "https://api.github.com/users/edilmedeiros/following{/other_user}",
         "gists_url" : "https://api.github.com/users/edilmedeiros/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/edilmedeiros",
         "id" : 78322931,
         "login" : "edilmedeiros",
         "node_id" : "MDQ6VXNlcjc4MzIyOTMx",
         "organizations_url" : "https://api.github.com/users/edilmedeiros/orgs",
         "received_events_url" : "https://api.github.com/users/edilmedeiros/received_events",
         "repos_url" : "https://api.github.com/users/edilmedeiros/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/edilmedeiros/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/edilmedeiros/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/edilmedeiros"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "A small caveat: I couldn't get rid of the `Could not satisfy difficulty target` (see the debug log just before timestamp `2024-05-17 12:56:01`). This is emitted by `bitcoin-util` itself before failing. I could not find a way to make the Python script intercept that to keep the terminal clean. I fear the complexity to achieve such an effect would not justify the benefit.",
      "created_at" : "2024-05-17T16:33:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/30130#issuecomment-2117967175",
      "id" : 2117967175,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/30130",
      "node_id" : "IC_kwDOABII585-PZ1H",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2117967175/reactions"
      },
      "updated_at" : "2024-05-17T16:33:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2117967175",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/78322931?v=4",
         "events_url" : "https://api.github.com/users/edilmedeiros/events{/privacy}",
         "followers_url" : "https://api.github.com/users/edilmedeiros/followers",
         "following_url" : "https://api.github.com/users/edilmedeiros/following{/other_user}",
         "gists_url" : "https://api.github.com/users/edilmedeiros/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/edilmedeiros",
         "id" : 78322931,
         "login" : "edilmedeiros",
         "node_id" : "MDQ6VXNlcjc4MzIyOTMx",
         "organizations_url" : "https://api.github.com/users/edilmedeiros/orgs",
         "received_events_url" : "https://api.github.com/users/edilmedeiros/received_events",
         "repos_url" : "https://api.github.com/users/edilmedeiros/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/edilmedeiros/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/edilmedeiros/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/edilmedeiros"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/30130#discussion_r1605888170"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/30130"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1605888170"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: given this is a debug log message and you're \"expecting\" this exception, I'm not sure it makes sense to include the word `exception`? Implies something went wrong.\r\n\r\n```suggestion\r\n            logging.debug('grind subprocess: {}'.format(e))\r\n```\r\n\r\nnit-ier: could use a shorter `f` string:\r\n\r\n```suggestion\r\n            logging.debug(f'grind subprocess: {e}')\r\n```",
      "commit_id" : "67fbf378ab577742a29d269b5fef2394dcd64cf7",
      "created_at" : "2024-05-18T19:48:12Z",
      "diff_hunk" : "@@ -406,16 +408,33 @@ def do_generate(args):\n \n         # mine block\n         logging.debug(\"Mining block delta=%s start=%s mine=%s\", seconds_to_hms(mine_time-bestheader[\"time\"]), mine_time, is_mine)\n-        mined_blocks += 1\n         psbt = generate_psbt(tmpl, reward_spk, blocktime=mine_time)\n         input_stream = os.linesep.join([psbt, \"true\", \"ALL\"]).encode('utf8')\n         psbt_signed = json.loads(args.bcli(\"-stdin\", \"walletprocesspsbt\", input=input_stream))\n+\n         if not psbt_signed.get(\"complete\",False):\n             logging.debug(\"Generated PSBT: %s\" % (psbt,))\n             sys.stderr.write(\"PSBT signing failed\\n\")\n             return 1\n         block, signet_solution = do_decode_psbt(psbt_signed[\"psbt\"])\n-        block = finish_block(block, signet_solution, args.grind_cmd)\n+\n+        # finish_block() will call bitcoin-util to grind PoW. If the nonce field search space is exhausted,\n+        # the subprocess will fail and thus the miner. In case of failure, increment the retries var,\n+        # use it to create a new block header and try again.\n+        try:\n+            block = finish_block(block, signet_solution, args.grind_cmd)\n+        except subprocess.CalledProcessError as e:\n+            logging.debug('subprocess exception: {}'.format(e))",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/30130#discussion_r1605888170",
      "id" : 1605888170,
      "line" : 427,
      "node_id" : "PRRC_kwDOABII585ft-iq",
      "original_commit_id" : "67fbf378ab577742a29d269b5fef2394dcd64cf7",
      "original_line" : 427,
      "original_position" : 62,
      "original_start_line" : null,
      "path" : "contrib/signet/miner",
      "position" : 62,
      "pull_request_review_id" : 2064943454,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/30130",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1605888170/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-05-18T20:07:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1605888170",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1328814?v=4",
         "events_url" : "https://api.github.com/users/AngusP/events{/privacy}",
         "followers_url" : "https://api.github.com/users/AngusP/followers",
         "following_url" : "https://api.github.com/users/AngusP/following{/other_user}",
         "gists_url" : "https://api.github.com/users/AngusP/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/AngusP",
         "id" : 1328814,
         "login" : "AngusP",
         "node_id" : "MDQ6VXNlcjEzMjg4MTQ=",
         "organizations_url" : "https://api.github.com/users/AngusP/orgs",
         "received_events_url" : "https://api.github.com/users/AngusP/received_events",
         "repos_url" : "https://api.github.com/users/AngusP/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/AngusP/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/AngusP/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/AngusP"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/30130#discussion_r1605890224"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/30130"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1605890224"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "The `subprocess.CalledProcessError` could contain the stderr&out and the return code -- given there are a couple of other cases where `bitcoin-util grind` can fail, it might be good to check we actually hit an exhaustion rather than the block header decode issue to prevent many retries when something else is wrong (even if in a rare/\"should never happen\" case)?\r\n\r\n```suggestion\r\n            if e.returncode == 1 and \"Could not satisfy difficulty target\" in e.stderr.decode(\"utf-8\"):\r\n                retries += 1\r\n            else:\r\n                raise\r\n```\r\n\r\n(Maybe don't need/want to check the return code)\r\n\r\nYou'd also need to change `stdout=subprocess.PIPE` to `capture_output=True` for these to be set on the exception `e`:\r\n\r\n```diff\r\ndiff --git a/contrib/signet/miner b/contrib/signet/miner\r\nindex 31035a5525..e50301639e 100755\r\n--- a/contrib/signet/miner\r\n+++ b/contrib/signet/miner\r\n@@ -105,7 +105,7 @@ def finish_block(block, signet_solution, grind_cmd):\r\n         headhex = CBlockHeader.serialize(block).hex()\r\n         logging.debug('grinding headhex: {}'.format(headhex))\r\n         cmd = grind_cmd.split(\" \") + [headhex]\r\n-        newheadhex = subprocess.run(cmd, stdout=subprocess.PIPE, input=b\"\", check=True).stdout.strip()\r\n+        newheadhex = subprocess.run(cmd, capture_output=True, input=b\"\", check=True).stdout.strip()\r\n         newhead = from_hex(CBlockHeader(), newheadhex.decode('utf8'))\r\n         block.nNonce = newhead.nNonce\r\n         block.rehash()\r\n```\r\n\r\n(untested with this script but I've checked a toy example so fairly sure this would work)",
      "commit_id" : "67fbf378ab577742a29d269b5fef2394dcd64cf7",
      "created_at" : "2024-05-18T20:04:27Z",
      "diff_hunk" : "@@ -406,16 +408,33 @@ def do_generate(args):\n \n         # mine block\n         logging.debug(\"Mining block delta=%s start=%s mine=%s\", seconds_to_hms(mine_time-bestheader[\"time\"]), mine_time, is_mine)\n-        mined_blocks += 1\n         psbt = generate_psbt(tmpl, reward_spk, blocktime=mine_time)\n         input_stream = os.linesep.join([psbt, \"true\", \"ALL\"]).encode('utf8')\n         psbt_signed = json.loads(args.bcli(\"-stdin\", \"walletprocesspsbt\", input=input_stream))\n+\n         if not psbt_signed.get(\"complete\",False):\n             logging.debug(\"Generated PSBT: %s\" % (psbt,))\n             sys.stderr.write(\"PSBT signing failed\\n\")\n             return 1\n         block, signet_solution = do_decode_psbt(psbt_signed[\"psbt\"])\n-        block = finish_block(block, signet_solution, args.grind_cmd)\n+\n+        # finish_block() will call bitcoin-util to grind PoW. If the nonce field search space is exhausted,\n+        # the subprocess will fail and thus the miner. In case of failure, increment the retries var,\n+        # use it to create a new block header and try again.\n+        try:\n+            block = finish_block(block, signet_solution, args.grind_cmd)\n+        except subprocess.CalledProcessError as e:\n+            logging.debug('subprocess exception: {}'.format(e))\n+            logging.debug('finish_block failed, retrying')\n+            retries += 1",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/30130#discussion_r1605890224",
      "id" : 1605890224,
      "line" : 429,
      "node_id" : "PRRC_kwDOABII585ft_Cw",
      "original_commit_id" : "67fbf378ab577742a29d269b5fef2394dcd64cf7",
      "original_line" : 429,
      "original_position" : 64,
      "original_start_line" : null,
      "path" : "contrib/signet/miner",
      "position" : 64,
      "pull_request_review_id" : 2064943454,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/30130",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1605890224/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-05-18T20:07:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1605890224",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1328814?v=4",
         "events_url" : "https://api.github.com/users/AngusP/events{/privacy}",
         "followers_url" : "https://api.github.com/users/AngusP/followers",
         "following_url" : "https://api.github.com/users/AngusP/following{/other_user}",
         "gists_url" : "https://api.github.com/users/AngusP/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/AngusP",
         "id" : 1328814,
         "login" : "AngusP",
         "node_id" : "MDQ6VXNlcjEzMjg4MTQ=",
         "organizations_url" : "https://api.github.com/users/AngusP/orgs",
         "received_events_url" : "https://api.github.com/users/AngusP/received_events",
         "repos_url" : "https://api.github.com/users/AngusP/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/AngusP/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/AngusP/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/AngusP"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/30130#discussion_r1607048554"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/30130"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1607048554"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I'll mark those as resolved since I simplified the strings in a reviewed commit. Turns out that the script is using this style all over: `logging.debug(\"Mining block delta=%s start=%s mine=%s\", seconds_to_hms(mine_time-bestheader[\"time\"]), mine_time, is_mine)`",
      "commit_id" : "67fbf378ab577742a29d269b5fef2394dcd64cf7",
      "created_at" : "2024-05-20T17:21:55Z",
      "diff_hunk" : "@@ -406,16 +408,33 @@ def do_generate(args):\n \n         # mine block\n         logging.debug(\"Mining block delta=%s start=%s mine=%s\", seconds_to_hms(mine_time-bestheader[\"time\"]), mine_time, is_mine)\n-        mined_blocks += 1\n         psbt = generate_psbt(tmpl, reward_spk, blocktime=mine_time)\n         input_stream = os.linesep.join([psbt, \"true\", \"ALL\"]).encode('utf8')\n         psbt_signed = json.loads(args.bcli(\"-stdin\", \"walletprocesspsbt\", input=input_stream))\n+\n         if not psbt_signed.get(\"complete\",False):\n             logging.debug(\"Generated PSBT: %s\" % (psbt,))\n             sys.stderr.write(\"PSBT signing failed\\n\")\n             return 1\n         block, signet_solution = do_decode_psbt(psbt_signed[\"psbt\"])\n-        block = finish_block(block, signet_solution, args.grind_cmd)\n+\n+        # finish_block() will call bitcoin-util to grind PoW. If the nonce field search space is exhausted,\n+        # the subprocess will fail and thus the miner. In case of failure, increment the retries var,\n+        # use it to create a new block header and try again.\n+        try:\n+            block = finish_block(block, signet_solution, args.grind_cmd)\n+        except subprocess.CalledProcessError as e:\n+            logging.debug('subprocess exception: {}'.format(e))",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/30130#discussion_r1607048554",
      "id" : 1607048554,
      "in_reply_to_id" : 1605888170,
      "line" : 427,
      "node_id" : "PRRC_kwDOABII585fyZ1q",
      "original_commit_id" : "67fbf378ab577742a29d269b5fef2394dcd64cf7",
      "original_line" : 427,
      "original_position" : 62,
      "original_start_line" : null,
      "path" : "contrib/signet/miner",
      "position" : 62,
      "pull_request_review_id" : 2066662280,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/30130",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1607048554/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-05-20T17:21:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1607048554",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/78322931?v=4",
         "events_url" : "https://api.github.com/users/edilmedeiros/events{/privacy}",
         "followers_url" : "https://api.github.com/users/edilmedeiros/followers",
         "following_url" : "https://api.github.com/users/edilmedeiros/following{/other_user}",
         "gists_url" : "https://api.github.com/users/edilmedeiros/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/edilmedeiros",
         "id" : 78322931,
         "login" : "edilmedeiros",
         "node_id" : "MDQ6VXNlcjc4MzIyOTMx",
         "organizations_url" : "https://api.github.com/users/edilmedeiros/orgs",
         "received_events_url" : "https://api.github.com/users/edilmedeiros/received_events",
         "repos_url" : "https://api.github.com/users/edilmedeiros/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/edilmedeiros/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/edilmedeiros/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/edilmedeiros"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/30130#discussion_r1607049322"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/30130"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1607049322"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks, that did the job indeed.",
      "commit_id" : "67fbf378ab577742a29d269b5fef2394dcd64cf7",
      "created_at" : "2024-05-20T17:22:45Z",
      "diff_hunk" : "@@ -406,16 +408,33 @@ def do_generate(args):\n \n         # mine block\n         logging.debug(\"Mining block delta=%s start=%s mine=%s\", seconds_to_hms(mine_time-bestheader[\"time\"]), mine_time, is_mine)\n-        mined_blocks += 1\n         psbt = generate_psbt(tmpl, reward_spk, blocktime=mine_time)\n         input_stream = os.linesep.join([psbt, \"true\", \"ALL\"]).encode('utf8')\n         psbt_signed = json.loads(args.bcli(\"-stdin\", \"walletprocesspsbt\", input=input_stream))\n+\n         if not psbt_signed.get(\"complete\",False):\n             logging.debug(\"Generated PSBT: %s\" % (psbt,))\n             sys.stderr.write(\"PSBT signing failed\\n\")\n             return 1\n         block, signet_solution = do_decode_psbt(psbt_signed[\"psbt\"])\n-        block = finish_block(block, signet_solution, args.grind_cmd)\n+\n+        # finish_block() will call bitcoin-util to grind PoW. If the nonce field search space is exhausted,\n+        # the subprocess will fail and thus the miner. In case of failure, increment the retries var,\n+        # use it to create a new block header and try again.\n+        try:\n+            block = finish_block(block, signet_solution, args.grind_cmd)\n+        except subprocess.CalledProcessError as e:\n+            logging.debug('subprocess exception: {}'.format(e))\n+            logging.debug('finish_block failed, retrying')\n+            retries += 1",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/30130#discussion_r1607049322",
      "id" : 1607049322,
      "in_reply_to_id" : 1605890224,
      "line" : 429,
      "node_id" : "PRRC_kwDOABII585fyaBq",
      "original_commit_id" : "67fbf378ab577742a29d269b5fef2394dcd64cf7",
      "original_line" : 429,
      "original_position" : 64,
      "original_start_line" : null,
      "path" : "contrib/signet/miner",
      "position" : 64,
      "pull_request_review_id" : 2066663474,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/30130",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1607049322/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-05-20T17:22:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1607049322",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/78322931?v=4",
         "events_url" : "https://api.github.com/users/edilmedeiros/events{/privacy}",
         "followers_url" : "https://api.github.com/users/edilmedeiros/followers",
         "following_url" : "https://api.github.com/users/edilmedeiros/following{/other_user}",
         "gists_url" : "https://api.github.com/users/edilmedeiros/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/edilmedeiros",
         "id" : 78322931,
         "login" : "edilmedeiros",
         "node_id" : "MDQ6VXNlcjc4MzIyOTMx",
         "organizations_url" : "https://api.github.com/users/edilmedeiros/orgs",
         "received_events_url" : "https://api.github.com/users/edilmedeiros/received_events",
         "repos_url" : "https://api.github.com/users/edilmedeiros/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/edilmedeiros/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/edilmedeiros/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/edilmedeiros"
      }
   }
]
