[
   {
      "author_association" : "MEMBER",
      "body" : "> when enabled: engage the fuzzing harness (compile with `-fsanitize=fuzzer`), force compiling `src/test/fuzz/fuzz` (if it is even possible to disable it via another option), force disable all other targets\r\n\r\nMore than one sanitizer exists. For example, the CI system uses more than one sanitizer. So afterwards you'd have two redundant and confusing ways to set sanitizers. Not sure that is an improvement.",
      "created_at" : "2024-06-21T06:07:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/30318#issuecomment-2182067595",
      "id" : 2182067595,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/30318",
      "node_id" : "IC_kwDOABII586CD7WL",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2182067595/reactions"
      },
      "updated_at" : "2024-06-21T06:07:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2182067595",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Feel free to propose better solutions, the one in \"Describe the solution you'd like\" in OP is just an idea.\r\n\r\n`--with-sanitizers` can be used to enable additional sanitizers. Why would that be confusing? Because when the fuzzing is enabled, then `-fsanitize=fuzzer` would be used for compilation and then it is redundant if one does `--with-sanitizers=fuzzer` in addition? That would be harmless and produce the expected results. Much like if one uses `--enable-werror` and in addition sets `CXXFLAGS=-Werror`.",
      "created_at" : "2024-06-21T07:22:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/30318#issuecomment-2182161395",
      "id" : 2182161395,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/30318",
      "node_id" : "IC_kwDOABII586CESPz",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2182161395/reactions"
      },
      "updated_at" : "2024-06-21T07:22:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2182161395",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> That would be harmless and produce the expected results.\r\n\r\nNo objection if a duplicate `-fsanitize=fuzzer` is harmless and works in all build settings.",
      "created_at" : "2024-06-21T07:37:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/30318#issuecomment-2182182086",
      "id" : 2182182086,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/30318",
      "node_id" : "IC_kwDOABII586CEXTG",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2182182086/reactions"
      },
      "updated_at" : "2024-06-21T07:37:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2182182086",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "There are a few things that `--enable-fuzz` does that we definitely want it to do:\r\n\r\n* As you said, this option disables all other binaries besides the `fuzz` binary. This is nice when you only want to do fuzzing and nothing else (e.g. oss-fuzz). It is also required for the use of libFuzzer (`--with-sanitizers=fuzzer` i.e. `-fsanitize=fuzzer` with clang), because the other binaries provide a main function.\r\n* libFuzzer is not the only fuzzing engine. We would like to support as many engines as possible and we don't want to enable `-fsanitize=fuzzer` by default because that is not guaranteed to work with other engines. For example, to build for fuzzing with afl++: `CC=afl-clang-fast CXX=afl-clang-fast++ ./configure --enable-fuzz && make`. We have a custom harness for fuzzing with afl++ (see [here](https://github.com/bitcoin/bitcoin/blob/a961ad1bebc54912b88d072abf22ab7d3cf46bf1/src/test/fuzz/fuzz.cpp#L222-L225)).\r\n\r\nWe could rename the option if that helps but we shouldn't change the way it works. I'm not even sure if a rename is worth it given that it would break every fuzzing script. Our docs explain how to properly setup fuzzing as well (including instructions for various other engines).",
      "created_at" : "2024-06-21T09:29:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/30318#issuecomment-2182380008",
      "id" : 2182380008,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/30318",
      "node_id" : "IC_kwDOABII586CFHno",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2182380008/reactions"
      },
      "updated_at" : "2024-06-21T09:29:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2182380008",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8077169?v=4",
         "events_url" : "https://api.github.com/users/dergoegge/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dergoegge/followers",
         "following_url" : "https://api.github.com/users/dergoegge/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dergoegge/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dergoegge",
         "id" : 8077169,
         "login" : "dergoegge",
         "node_id" : "MDQ6VXNlcjgwNzcxNjk=",
         "organizations_url" : "https://api.github.com/users/dergoegge/orgs",
         "received_events_url" : "https://api.github.com/users/dergoegge/received_events",
         "repos_url" : "https://api.github.com/users/dergoegge/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dergoegge/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dergoegge/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dergoegge"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Ok, a few takeaways:\r\n\r\n* Don't enable `-fsanitize=fuzzer` automatically by e.g. `--enable-fuzz` because that would conflict with other fuzzers.\r\n\r\n* A better name for `--enable-fuzz` would be `--disable-all-build-targets-except-fuzz` or `--build-only-fuzz` or `--enable-fuzz-binary=yes|no|exclusive`, but renaming it would break every fuzzing script. Maybe the transition to CMake is a good time to improve this since scripts would have to be adjusted anyway.\r\n",
      "created_at" : "2024-06-21T10:06:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/30318#issuecomment-2182440051",
      "id" : 2182440051,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/30318",
      "node_id" : "IC_kwDOABII586CFWRz",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2182440051/reactions"
      },
      "updated_at" : "2024-06-21T10:06:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2182440051",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> * `--enable-fuzz-binary=yes|no|exclusive`, but renaming it would break every fuzzing script. Maybe the transition to CMake is a good time to improve this since scripts would have to be adjusted anyway.\r\n\r\nSeems fine to do, if `-DBUILD_FUZZ_BINARY=ON/OFF/EXCL...` is easy to implement.",
      "created_at" : "2024-06-21T10:14:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/30318#issuecomment-2182454380",
      "id" : 2182454380,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/30318",
      "node_id" : "IC_kwDOABII586CFZxs",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2182454380/reactions"
      },
      "updated_at" : "2024-06-21T10:14:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2182454380",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   }
]
