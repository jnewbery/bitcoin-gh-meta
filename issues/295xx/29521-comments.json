[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage\nFor detailed information about the code coverage, see the [test coverage report](https://corecheck.dev/bitcoin/bitcoin/pulls/29521).\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept ACK | [marcofleon](https://github.com/bitcoin/bitcoin/pull/29521#pullrequestreview-1975216076) |\n| Stale ACK | [rkrux](https://github.com/bitcoin/bitcoin/pull/29521#pullrequestreview-1969853622), [davidgumberg](https://github.com/bitcoin/bitcoin/pull/29521#issuecomment-2035153866), [cbergqvist](https://github.com/bitcoin/bitcoin/pull/29521#pullrequestreview-2046768298) |\n\nIf your review is incorrectly listed, please react with ð to this comment and the bot will ignore it on the next update.\n",
      "created_at" : "2024-02-29T22:11:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29521#issuecomment-1972057162",
      "id" : 1972057162,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29521",
      "node_id" : "IC_kwDOABII5851izRK",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1972057162/reactions"
      },
      "updated_at" : "2024-05-13T01:31:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1972057162",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29521#discussion_r1508720456"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29521"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1508720456"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Is there any downside to use `ToIntegral` for new code?",
      "commit_id" : "46c91a25d93595e3934418b1001fabe906326061",
      "created_at" : "2024-03-01T09:30:32Z",
      "diff_hunk" : "@@ -747,8 +747,35 @@ static UniValue CallRPC(BaseRequestHandler* rh, const std::string& strMethod, co\n     //     2. port in -rpcconnect (ie following : in ipv4 or ]: in ipv6)\n     //     3. default port for chain\n     uint16_t port{BaseParams().RPCPort()};\n-    SplitHostPort(gArgs.GetArg(\"-rpcconnect\", DEFAULT_RPCCONNECT), port, host);\n-    port = static_cast<uint16_t>(gArgs.GetIntArg(\"-rpcport\", port));\n+    {\n+        uint16_t rpcconnect_port{0};\n+        const std::string rpcconnect_str = gArgs.GetArg(\"-rpcconnect\", DEFAULT_RPCCONNECT);\n+        if (!SplitHostPort(rpcconnect_str, rpcconnect_port, host)) {\n+            throw std::runtime_error(strprintf(\"Invalid port provided in -rpcconnect: %s\", rpcconnect_str));\n+        } else {\n+            if (rpcconnect_port != 0) {\n+                // Use the valid port provided in rpcconnect\n+                port = rpcconnect_port;\n+            } // else, no port was provided in rpcconnect (continue using default one)\n+        }\n+\n+        std::optional<std::string> rpcport_arg = gArgs.GetArg(\"-rpcport\");\n+        if (rpcport_arg.has_value()) {\n+            uint16_t n{0};\n+            if (!ParseUInt16(rpcport_arg.value(), &n) || n == 0) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29521#discussion_r1508720456",
      "id" : 1508720456,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585Z7T9I",
      "original_commit_id" : "6052f4915015975f68f7a835551f0f231effd88b",
      "original_line" : 765,
      "original_position" : 21,
      "original_start_line" : null,
      "path" : "src/bitcoin-cli.cpp",
      "position" : null,
      "pull_request_review_id" : 1910690338,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29521",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1508720456/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-03-01T09:30:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1508720456",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29521#discussion_r1509332943"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29521"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1509332943"
         }
      },
      "author_association" : "NONE",
      "body" : "Thanks @maflcko.  Rebased and updated to the new style of using `ToIntegral` to better align with doc/developer-notes.",
      "commit_id" : "46c91a25d93595e3934418b1001fabe906326061",
      "created_at" : "2024-03-01T17:45:13Z",
      "diff_hunk" : "@@ -747,8 +747,35 @@ static UniValue CallRPC(BaseRequestHandler* rh, const std::string& strMethod, co\n     //     2. port in -rpcconnect (ie following : in ipv4 or ]: in ipv6)\n     //     3. default port for chain\n     uint16_t port{BaseParams().RPCPort()};\n-    SplitHostPort(gArgs.GetArg(\"-rpcconnect\", DEFAULT_RPCCONNECT), port, host);\n-    port = static_cast<uint16_t>(gArgs.GetIntArg(\"-rpcport\", port));\n+    {\n+        uint16_t rpcconnect_port{0};\n+        const std::string rpcconnect_str = gArgs.GetArg(\"-rpcconnect\", DEFAULT_RPCCONNECT);\n+        if (!SplitHostPort(rpcconnect_str, rpcconnect_port, host)) {\n+            throw std::runtime_error(strprintf(\"Invalid port provided in -rpcconnect: %s\", rpcconnect_str));\n+        } else {\n+            if (rpcconnect_port != 0) {\n+                // Use the valid port provided in rpcconnect\n+                port = rpcconnect_port;\n+            } // else, no port was provided in rpcconnect (continue using default one)\n+        }\n+\n+        std::optional<std::string> rpcport_arg = gArgs.GetArg(\"-rpcport\");\n+        if (rpcport_arg.has_value()) {\n+            uint16_t n{0};\n+            if (!ParseUInt16(rpcport_arg.value(), &n) || n == 0) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29521#discussion_r1509332943",
      "id" : 1509332943,
      "in_reply_to_id" : 1508720456,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585Z9pfP",
      "original_commit_id" : "6052f4915015975f68f7a835551f0f231effd88b",
      "original_line" : 765,
      "original_position" : 21,
      "original_start_line" : null,
      "path" : "src/bitcoin-cli.cpp",
      "position" : null,
      "pull_request_review_id" : 1911703307,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29521",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1509332943/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-03-01T17:45:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1509332943",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/106488469?v=4",
         "events_url" : "https://api.github.com/users/tdb3/events{/privacy}",
         "followers_url" : "https://api.github.com/users/tdb3/followers",
         "following_url" : "https://api.github.com/users/tdb3/following{/other_user}",
         "gists_url" : "https://api.github.com/users/tdb3/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/tdb3",
         "id" : 106488469,
         "login" : "tdb3",
         "node_id" : "U_kgDOBljilQ",
         "organizations_url" : "https://api.github.com/users/tdb3/orgs",
         "received_events_url" : "https://api.github.com/users/tdb3/received_events",
         "repos_url" : "https://api.github.com/users/tdb3/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/tdb3/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/tdb3/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/tdb3"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29521#discussion_r1520258389"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29521"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520258389"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Nice to have: a check for oversized ports\r\n```diff\r\n+ assert_raises_process_error(1, \"Invalid port provided in -rpcconnect: 127.0.0.1:65536\", self.nodes[0].cli(\"-rpcconnect=127.0.0.1:65536\").echo)\r\n+\r\n```\r\n\r\nBelow as well",
      "commit_id" : "46c91a25d93595e3934418b1001fabe906326061",
      "created_at" : "2024-03-11T18:37:09Z",
      "diff_hunk" : "@@ -107,6 +108,23 @@ def run_test(self):\n         self.log.info(\"Test connecting to a non-existing server\")\n         assert_raises_process_error(1, \"Could not connect to the server\", self.nodes[0].cli('-rpcport=1').echo)\n \n+        self.log.info(\"Test rpcconnect handling of invalid ports\")\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcconnect: 127.0.0.1:notaport\", self.nodes[0].cli(\"-rpcconnect=127.0.0.1:notaport\").echo)\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcconnect: 127.0.0.1:-1\", self.nodes[0].cli(\"-rpcconnect=127.0.0.1:-1\").echo)\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcconnect: 127.0.0.1:0\", self.nodes[0].cli(\"-rpcconnect=127.0.0.1:0\").echo)\n+",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29521#discussion_r1520258389",
      "id" : 1520258389,
      "line" : 115,
      "node_id" : "PRRC_kwDOABII585anU1V",
      "original_commit_id" : "e73e76affbda331ba1e0eecea6c24a9051835d41",
      "original_line" : 115,
      "original_position" : 16,
      "original_start_line" : null,
      "path" : "test/functional/interface_bitcoin_cli.py",
      "position" : 16,
      "pull_request_review_id" : 1928787890,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29521",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520258389/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-03-11T18:37:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520258389",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2257631?v=4",
         "events_url" : "https://api.github.com/users/davidgumberg/events{/privacy}",
         "followers_url" : "https://api.github.com/users/davidgumberg/followers",
         "following_url" : "https://api.github.com/users/davidgumberg/following{/other_user}",
         "gists_url" : "https://api.github.com/users/davidgumberg/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/davidgumberg",
         "id" : 2257631,
         "login" : "davidgumberg",
         "node_id" : "MDQ6VXNlcjIyNTc2MzE=",
         "organizations_url" : "https://api.github.com/users/davidgumberg/orgs",
         "received_events_url" : "https://api.github.com/users/davidgumberg/received_events",
         "repos_url" : "https://api.github.com/users/davidgumberg/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/davidgumberg/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/davidgumberg/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/davidgumberg"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29521#discussion_r1520291747"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29521"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520291747"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Also nice to have would be a test when no port is provided that we fall back to `BaseParams().RPCPort()`, it isn't obvious to me how that could be done here though.",
      "commit_id" : "46c91a25d93595e3934418b1001fabe906326061",
      "created_at" : "2024-03-11T19:07:15Z",
      "diff_hunk" : "@@ -107,6 +108,23 @@ def run_test(self):\n         self.log.info(\"Test connecting to a non-existing server\")\n         assert_raises_process_error(1, \"Could not connect to the server\", self.nodes[0].cli('-rpcport=1').echo)\n \n+        self.log.info(\"Test rpcconnect handling of invalid ports\")\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcconnect: 127.0.0.1:notaport\", self.nodes[0].cli(\"-rpcconnect=127.0.0.1:notaport\").echo)\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcconnect: 127.0.0.1:-1\", self.nodes[0].cli(\"-rpcconnect=127.0.0.1:-1\").echo)\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcconnect: 127.0.0.1:0\", self.nodes[0].cli(\"-rpcconnect=127.0.0.1:0\").echo)\n+\n+        self.log.info(\"Test rpcport handling of invalid ports\")\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcport: notaport\", self.nodes[0].cli(\"-rpcport=notaport\").echo)\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcport: -1\", self.nodes[0].cli(\"-rpcport=-1\").echo)\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcport: 0\", self.nodes[0].cli(\"-rpcport=0\").echo)\n+\n+        self.log.info(\"Test preference of port in rpcport over rpcconnect\")\n+        node_rpc_port = rpc_port(self.nodes[0].index)\n+        assert_raises_process_error(1, \"Could not connect to the server\", self.nodes[0].cli(f\"-rpcconnect=127.0.0.1:{node_rpc_port}\", \"-rpcport=1\").echo)\n+        assert_equal(BLOCKS, self.nodes[0].cli(\"-rpcconnect=127.0.0.1:18999\", f'-rpcport={node_rpc_port}').getblockcount())\n+        assert_equal(BLOCKS, self.nodes[0].cli(f\"-rpcconnect=127.0.0.1:{node_rpc_port}\").getblockcount())\n+        assert_equal(BLOCKS, self.nodes[0].cli(f'-rpcport={node_rpc_port}').getblockcount())\n+",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29521#discussion_r1520291747",
      "id" : 1520291747,
      "line" : 127,
      "node_id" : "PRRC_kwDOABII585anc-j",
      "original_commit_id" : "46c91a25d93595e3934418b1001fabe906326061",
      "original_line" : 127,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "test/functional/interface_bitcoin_cli.py",
      "position" : 28,
      "pull_request_review_id" : 1928880883,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29521",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520291747/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-03-11T19:07:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520291747",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2257631?v=4",
         "events_url" : "https://api.github.com/users/davidgumberg/events{/privacy}",
         "followers_url" : "https://api.github.com/users/davidgumberg/followers",
         "following_url" : "https://api.github.com/users/davidgumberg/following{/other_user}",
         "gists_url" : "https://api.github.com/users/davidgumberg/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/davidgumberg",
         "id" : 2257631,
         "login" : "davidgumberg",
         "node_id" : "MDQ6VXNlcjIyNTc2MzE=",
         "organizations_url" : "https://api.github.com/users/davidgumberg/orgs",
         "received_events_url" : "https://api.github.com/users/davidgumberg/received_events",
         "repos_url" : "https://api.github.com/users/davidgumberg/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/davidgumberg/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/davidgumberg/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/davidgumberg"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "crACK https://github.com/bitcoin/bitcoin/pull/29521/commits/46c91a25d93595e3934418b1001fabe906326061",
      "created_at" : "2024-03-11T19:11:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29521#issuecomment-1989237077",
      "id" : 1989237077,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29521",
      "node_id" : "IC_kwDOABII5852kVlV",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1989237077/reactions"
      },
      "updated_at" : "2024-03-11T19:11:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1989237077",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2257631?v=4",
         "events_url" : "https://api.github.com/users/davidgumberg/events{/privacy}",
         "followers_url" : "https://api.github.com/users/davidgumberg/followers",
         "following_url" : "https://api.github.com/users/davidgumberg/following{/other_user}",
         "gists_url" : "https://api.github.com/users/davidgumberg/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/davidgumberg",
         "id" : 2257631,
         "login" : "davidgumberg",
         "node_id" : "MDQ6VXNlcjIyNTc2MzE=",
         "organizations_url" : "https://api.github.com/users/davidgumberg/orgs",
         "received_events_url" : "https://api.github.com/users/davidgumberg/received_events",
         "repos_url" : "https://api.github.com/users/davidgumberg/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/davidgumberg/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/davidgumberg/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/davidgumberg"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Thanks for the review @davidgumberg!\r\nAdded the suggestions (force pushed).\r\nResponses inline.",
      "created_at" : "2024-03-12T21:46:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29521#issuecomment-1992640947",
      "id" : 1992640947,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29521",
      "node_id" : "IC_kwDOABII5852xUmz",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1992640947/reactions"
      },
      "updated_at" : "2024-03-12T21:46:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1992640947",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/106488469?v=4",
         "events_url" : "https://api.github.com/users/tdb3/events{/privacy}",
         "followers_url" : "https://api.github.com/users/tdb3/followers",
         "following_url" : "https://api.github.com/users/tdb3/following{/other_user}",
         "gists_url" : "https://api.github.com/users/tdb3/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/tdb3",
         "id" : 106488469,
         "login" : "tdb3",
         "node_id" : "U_kgDOBljilQ",
         "organizations_url" : "https://api.github.com/users/tdb3/orgs",
         "received_events_url" : "https://api.github.com/users/tdb3/received_events",
         "repos_url" : "https://api.github.com/users/tdb3/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/tdb3/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/tdb3/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/tdb3"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29521#discussion_r1522155865"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29521"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1522155865"
         }
      },
      "author_association" : "NONE",
      "body" : "Thanks.  Added.\r\nTesting upperbound makes sense.",
      "commit_id" : "6e779d83232025ba83e2bd79bd07d2299410193d",
      "created_at" : "2024-03-12T21:47:12Z",
      "diff_hunk" : "@@ -107,6 +108,23 @@ def run_test(self):\n         self.log.info(\"Test connecting to a non-existing server\")\n         assert_raises_process_error(1, \"Could not connect to the server\", self.nodes[0].cli('-rpcport=1').echo)\n \n+        self.log.info(\"Test rpcconnect handling of invalid ports\")\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcconnect: 127.0.0.1:notaport\", self.nodes[0].cli(\"-rpcconnect=127.0.0.1:notaport\").echo)\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcconnect: 127.0.0.1:-1\", self.nodes[0].cli(\"-rpcconnect=127.0.0.1:-1\").echo)\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcconnect: 127.0.0.1:0\", self.nodes[0].cli(\"-rpcconnect=127.0.0.1:0\").echo)\n+",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29521#discussion_r1522155865",
      "id" : 1522155865,
      "in_reply_to_id" : 1520258389,
      "line" : 116,
      "node_id" : "PRRC_kwDOABII585aukFZ",
      "original_commit_id" : "e73e76affbda331ba1e0eecea6c24a9051835d41",
      "original_line" : 116,
      "original_position" : 16,
      "original_start_line" : null,
      "path" : "test/functional/interface_bitcoin_cli.py",
      "position" : 17,
      "pull_request_review_id" : 1932748466,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29521",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1522155865/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-03-12T21:47:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1522155865",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/106488469?v=4",
         "events_url" : "https://api.github.com/users/tdb3/events{/privacy}",
         "followers_url" : "https://api.github.com/users/tdb3/followers",
         "following_url" : "https://api.github.com/users/tdb3/following{/other_user}",
         "gists_url" : "https://api.github.com/users/tdb3/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/tdb3",
         "id" : 106488469,
         "login" : "tdb3",
         "node_id" : "U_kgDOBljilQ",
         "organizations_url" : "https://api.github.com/users/tdb3/orgs",
         "received_events_url" : "https://api.github.com/users/tdb3/received_events",
         "repos_url" : "https://api.github.com/users/tdb3/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/tdb3/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/tdb3/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/tdb3"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29521#discussion_r1522156537"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29521"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1522156537"
         }
      },
      "author_association" : "NONE",
      "body" : "Added test for default port in regtest.\r\n\r\nThank you for drawing attention to this!  Looks like explicitly defined `-rpcport` during the creation of the node's bitcoin.conf was causing bitcoin-cli to use the conf-provided rpcport when using rpcconnect without rpcport in command line arguments.  One of the tests (involving `f\"-rpcconnect=127.0.0.1:{node_rpc_port}\"`) would always pass because of this (i.e. the test wouldn't fail even if a valid but unused port is specified in rpcconnect).  This was verified by creating a temporary test `f\"-rpcconnect=127.0.0.1:1234\"` that should have failed but didn't.\r\n\r\nThis was remedied by using `replace_in_config()`.\r\n",
      "commit_id" : "6e779d83232025ba83e2bd79bd07d2299410193d",
      "created_at" : "2024-03-12T21:48:00Z",
      "diff_hunk" : "@@ -107,6 +108,23 @@ def run_test(self):\n         self.log.info(\"Test connecting to a non-existing server\")\n         assert_raises_process_error(1, \"Could not connect to the server\", self.nodes[0].cli('-rpcport=1').echo)\n \n+        self.log.info(\"Test rpcconnect handling of invalid ports\")\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcconnect: 127.0.0.1:notaport\", self.nodes[0].cli(\"-rpcconnect=127.0.0.1:notaport\").echo)\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcconnect: 127.0.0.1:-1\", self.nodes[0].cli(\"-rpcconnect=127.0.0.1:-1\").echo)\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcconnect: 127.0.0.1:0\", self.nodes[0].cli(\"-rpcconnect=127.0.0.1:0\").echo)\n+\n+        self.log.info(\"Test rpcport handling of invalid ports\")\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcport: notaport\", self.nodes[0].cli(\"-rpcport=notaport\").echo)\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcport: -1\", self.nodes[0].cli(\"-rpcport=-1\").echo)\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcport: 0\", self.nodes[0].cli(\"-rpcport=0\").echo)\n+\n+        self.log.info(\"Test preference of port in rpcport over rpcconnect\")\n+        node_rpc_port = rpc_port(self.nodes[0].index)\n+        assert_raises_process_error(1, \"Could not connect to the server\", self.nodes[0].cli(f\"-rpcconnect=127.0.0.1:{node_rpc_port}\", \"-rpcport=1\").echo)\n+        assert_equal(BLOCKS, self.nodes[0].cli(\"-rpcconnect=127.0.0.1:18999\", f'-rpcport={node_rpc_port}').getblockcount())\n+        assert_equal(BLOCKS, self.nodes[0].cli(f\"-rpcconnect=127.0.0.1:{node_rpc_port}\").getblockcount())\n+        assert_equal(BLOCKS, self.nodes[0].cli(f'-rpcport={node_rpc_port}').getblockcount())\n+",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29521#discussion_r1522156537",
      "id" : 1522156537,
      "in_reply_to_id" : 1520291747,
      "line" : 139,
      "node_id" : "PRRC_kwDOABII585aukP5",
      "original_commit_id" : "46c91a25d93595e3934418b1001fabe906326061",
      "original_line" : 139,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "test/functional/interface_bitcoin_cli.py",
      "position" : 40,
      "pull_request_review_id" : 1932750521,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29521",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1522156537/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-03-12T21:48:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1522156537",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/106488469?v=4",
         "events_url" : "https://api.github.com/users/tdb3/events{/privacy}",
         "followers_url" : "https://api.github.com/users/tdb3/followers",
         "following_url" : "https://api.github.com/users/tdb3/following{/other_user}",
         "gists_url" : "https://api.github.com/users/tdb3/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/tdb3",
         "id" : 106488469,
         "login" : "tdb3",
         "node_id" : "U_kgDOBljilQ",
         "organizations_url" : "https://api.github.com/users/tdb3/orgs",
         "received_events_url" : "https://api.github.com/users/tdb3/received_events",
         "repos_url" : "https://api.github.com/users/tdb3/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/tdb3/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/tdb3/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/tdb3"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29521#discussion_r1544283882"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29521"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1544283882"
         }
      },
      "author_association" : "NONE",
      "body" : "Style: narrow scope of `rpcport_arg` since it is only used inside the if-block. (In this case the outer scope ends it anyway, this is just a general rule of thumb).\r\n\r\nNaming: `rpcport_port` -> `rpcport_int` since the former is a bit repetitive and the latter at least describes its purpose somewhat, despite being a bit Hungarian.\r\n\r\n```suggestion\r\n        if (std::optional<std::string> rpcport_arg = gArgs.GetArg(\"-rpcport\")) {\r\n            std::optional<uint16_t> rpcport_int{ToIntegral<uint16_t>(rpcport_arg.value())};\r\n            if (!rpcport_int.has_value() || rpcport_int.value() == 0) {\r\n                throw std::runtime_error(strprintf(\"Invalid port provided in -rpcport: %s\", rpcport_arg.value()));\r\n            }\r\n\r\n            // Use the valid port provided\r\n            port = rpcport_int.value();\r\n```",
      "commit_id" : "cb4f9fc5847a7e53fe45d54b1fddf504dee5af82",
      "created_at" : "2024-03-29T09:28:38Z",
      "diff_hunk" : "@@ -747,8 +747,35 @@ static UniValue CallRPC(BaseRequestHandler* rh, const std::string& strMethod, co\n     //     2. port in -rpcconnect (ie following : in ipv4 or ]: in ipv6)\n     //     3. default port for chain\n     uint16_t port{BaseParams().RPCPort()};\n-    SplitHostPort(gArgs.GetArg(\"-rpcconnect\", DEFAULT_RPCCONNECT), port, host);\n-    port = static_cast<uint16_t>(gArgs.GetIntArg(\"-rpcport\", port));\n+    {\n+        uint16_t rpcconnect_port{0};\n+        const std::string rpcconnect_str = gArgs.GetArg(\"-rpcconnect\", DEFAULT_RPCCONNECT);\n+        if (!SplitHostPort(rpcconnect_str, rpcconnect_port, host)) {\n+            throw std::runtime_error(strprintf(\"Invalid port provided in -rpcconnect: %s\", rpcconnect_str));\n+        } else {\n+            if (rpcconnect_port != 0) {\n+                // Use the valid port provided in rpcconnect\n+                port = rpcconnect_port;\n+            } // else, no port was provided in rpcconnect (continue using default one)\n+        }\n+\n+        std::optional<std::string> rpcport_arg = gArgs.GetArg(\"-rpcport\");\n+        if (rpcport_arg.has_value()) {\n+            std::optional<uint16_t> rpcport_port{ToIntegral<uint16_t>(rpcport_arg.value())};\n+            if (!rpcport_port.has_value() || rpcport_port.value() == 0) {\n+                throw std::runtime_error(strprintf(\"Invalid port provided in -rpcport: %s\", rpcport_arg.value()));\n+            }\n+\n+            // Use the valid port provided\n+            port = rpcport_port.value();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29521#discussion_r1544283882",
      "id" : 1544283882,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585cC-bq",
      "original_commit_id" : "6e779d83232025ba83e2bd79bd07d2299410193d",
      "original_line" : 770,
      "original_position" : 26,
      "original_start_line" : 762,
      "path" : "src/bitcoin-cli.cpp",
      "position" : null,
      "pull_request_review_id" : 1968183010,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29521",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1544283882/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2024-03-29T12:55:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1544283882",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/581308?v=4",
         "events_url" : "https://api.github.com/users/cbergqvist/events{/privacy}",
         "followers_url" : "https://api.github.com/users/cbergqvist/followers",
         "following_url" : "https://api.github.com/users/cbergqvist/following{/other_user}",
         "gists_url" : "https://api.github.com/users/cbergqvist/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/cbergqvist",
         "id" : 581308,
         "login" : "cbergqvist",
         "node_id" : "MDQ6VXNlcjU4MTMwOA==",
         "organizations_url" : "https://api.github.com/users/cbergqvist/orgs",
         "received_events_url" : "https://api.github.com/users/cbergqvist/received_events",
         "repos_url" : "https://api.github.com/users/cbergqvist/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/cbergqvist/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/cbergqvist/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/cbergqvist"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29521#discussion_r1545000628"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29521"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1545000628"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Good suggestions.  I've implemented these changes and added a small comment to increase readability (since operator bool of std::optional is being used).",
      "commit_id" : "cb4f9fc5847a7e53fe45d54b1fddf504dee5af82",
      "created_at" : "2024-03-30T01:34:16Z",
      "diff_hunk" : "@@ -747,8 +747,35 @@ static UniValue CallRPC(BaseRequestHandler* rh, const std::string& strMethod, co\n     //     2. port in -rpcconnect (ie following : in ipv4 or ]: in ipv6)\n     //     3. default port for chain\n     uint16_t port{BaseParams().RPCPort()};\n-    SplitHostPort(gArgs.GetArg(\"-rpcconnect\", DEFAULT_RPCCONNECT), port, host);\n-    port = static_cast<uint16_t>(gArgs.GetIntArg(\"-rpcport\", port));\n+    {\n+        uint16_t rpcconnect_port{0};\n+        const std::string rpcconnect_str = gArgs.GetArg(\"-rpcconnect\", DEFAULT_RPCCONNECT);\n+        if (!SplitHostPort(rpcconnect_str, rpcconnect_port, host)) {\n+            throw std::runtime_error(strprintf(\"Invalid port provided in -rpcconnect: %s\", rpcconnect_str));\n+        } else {\n+            if (rpcconnect_port != 0) {\n+                // Use the valid port provided in rpcconnect\n+                port = rpcconnect_port;\n+            } // else, no port was provided in rpcconnect (continue using default one)\n+        }\n+\n+        std::optional<std::string> rpcport_arg = gArgs.GetArg(\"-rpcport\");\n+        if (rpcport_arg.has_value()) {\n+            std::optional<uint16_t> rpcport_port{ToIntegral<uint16_t>(rpcport_arg.value())};\n+            if (!rpcport_port.has_value() || rpcport_port.value() == 0) {\n+                throw std::runtime_error(strprintf(\"Invalid port provided in -rpcport: %s\", rpcport_arg.value()));\n+            }\n+\n+            // Use the valid port provided\n+            port = rpcport_port.value();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29521#discussion_r1545000628",
      "id" : 1545000628,
      "in_reply_to_id" : 1544283882,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585cFta0",
      "original_commit_id" : "6e779d83232025ba83e2bd79bd07d2299410193d",
      "original_line" : 770,
      "original_position" : 26,
      "original_start_line" : 762,
      "path" : "src/bitcoin-cli.cpp",
      "position" : null,
      "pull_request_review_id" : 1969714143,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29521",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1545000628/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2024-03-30T01:59:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1545000628",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/106488469?v=4",
         "events_url" : "https://api.github.com/users/tdb3/events{/privacy}",
         "followers_url" : "https://api.github.com/users/tdb3/followers",
         "following_url" : "https://api.github.com/users/tdb3/following{/other_user}",
         "gists_url" : "https://api.github.com/users/tdb3/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/tdb3",
         "id" : 106488469,
         "login" : "tdb3",
         "node_id" : "U_kgDOBljilQ",
         "organizations_url" : "https://api.github.com/users/tdb3/orgs",
         "received_events_url" : "https://api.github.com/users/tdb3/received_events",
         "repos_url" : "https://api.github.com/users/tdb3/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/tdb3/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/tdb3/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/tdb3"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Thank you for the review @cbergqvist!\r\nImplemented your suggestions and rebased.",
      "created_at" : "2024-03-30T01:34:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29521#issuecomment-2027863063",
      "id" : 2027863063,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29521",
      "node_id" : "IC_kwDOABII58543rwX",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2027863063/reactions"
      },
      "updated_at" : "2024-03-30T01:34:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2027863063",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/106488469?v=4",
         "events_url" : "https://api.github.com/users/tdb3/events{/privacy}",
         "followers_url" : "https://api.github.com/users/tdb3/followers",
         "following_url" : "https://api.github.com/users/tdb3/following{/other_user}",
         "gists_url" : "https://api.github.com/users/tdb3/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/tdb3",
         "id" : 106488469,
         "login" : "tdb3",
         "node_id" : "U_kgDOBljilQ",
         "organizations_url" : "https://api.github.com/users/tdb3/orgs",
         "received_events_url" : "https://api.github.com/users/tdb3/received_events",
         "repos_url" : "https://api.github.com/users/tdb3/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/tdb3/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/tdb3/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/tdb3"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29521#discussion_r1545206102"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29521"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1545206102"
         }
      },
      "author_association" : "NONE",
      "body" : "Curious as to why all this is inside a block - so that the variables declared inside are not exposed for the rest of the function?",
      "commit_id" : "cb4f9fc5847a7e53fe45d54b1fddf504dee5af82",
      "created_at" : "2024-03-30T07:59:38Z",
      "diff_hunk" : "@@ -747,8 +747,35 @@ static UniValue CallRPC(BaseRequestHandler* rh, const std::string& strMethod, co\n     //     2. port in -rpcconnect (ie following : in ipv4 or ]: in ipv6)\n     //     3. default port for chain\n     uint16_t port{BaseParams().RPCPort()};\n-    SplitHostPort(gArgs.GetArg(\"-rpcconnect\", DEFAULT_RPCCONNECT), port, host);\n-    port = static_cast<uint16_t>(gArgs.GetIntArg(\"-rpcport\", port));\n+    {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29521#discussion_r1545206102",
      "id" : 1545206102,
      "line" : 750,
      "node_id" : "PRRC_kwDOABII585cGflW",
      "original_commit_id" : "cb4f9fc5847a7e53fe45d54b1fddf504dee5af82",
      "original_line" : 750,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/bitcoin-cli.cpp",
      "position" : 6,
      "pull_request_review_id" : 1969853622,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29521",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1545206102/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-03-30T08:05:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1545206102",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5960750?v=4",
         "events_url" : "https://api.github.com/users/rkrux/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rkrux/followers",
         "following_url" : "https://api.github.com/users/rkrux/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rkrux/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rkrux",
         "id" : 5960750,
         "login" : "rkrux",
         "node_id" : "MDQ6VXNlcjU5NjA3NTA=",
         "organizations_url" : "https://api.github.com/users/rkrux/orgs",
         "received_events_url" : "https://api.github.com/users/rkrux/received_events",
         "repos_url" : "https://api.github.com/users/rkrux/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rkrux/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rkrux/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rkrux"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29521#discussion_r1545208343"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29521"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1545208343"
         }
      },
      "author_association" : "NONE",
      "body" : "Interesting to find out that why the use of port number 0 is discouraged: https://www.lifewire.com/port-0-in-tcp-and-udp-818145",
      "commit_id" : "cb4f9fc5847a7e53fe45d54b1fddf504dee5af82",
      "created_at" : "2024-03-30T08:03:42Z",
      "diff_hunk" : "@@ -747,8 +747,35 @@ static UniValue CallRPC(BaseRequestHandler* rh, const std::string& strMethod, co\n     //     2. port in -rpcconnect (ie following : in ipv4 or ]: in ipv6)\n     //     3. default port for chain\n     uint16_t port{BaseParams().RPCPort()};\n-    SplitHostPort(gArgs.GetArg(\"-rpcconnect\", DEFAULT_RPCCONNECT), port, host);\n-    port = static_cast<uint16_t>(gArgs.GetIntArg(\"-rpcport\", port));\n+    {\n+        uint16_t rpcconnect_port{0};\n+        const std::string rpcconnect_str = gArgs.GetArg(\"-rpcconnect\", DEFAULT_RPCCONNECT);\n+        if (!SplitHostPort(rpcconnect_str, rpcconnect_port, host)) {\n+            throw std::runtime_error(strprintf(\"Invalid port provided in -rpcconnect: %s\", rpcconnect_str));\n+        } else {\n+            if (rpcconnect_port != 0) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29521#discussion_r1545208343",
      "id" : 1545208343,
      "line" : 756,
      "node_id" : "PRRC_kwDOABII585cGgIX",
      "original_commit_id" : "cb4f9fc5847a7e53fe45d54b1fddf504dee5af82",
      "original_line" : 756,
      "original_position" : 12,
      "original_start_line" : null,
      "path" : "src/bitcoin-cli.cpp",
      "position" : 12,
      "pull_request_review_id" : 1969853622,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29521",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1545208343/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-03-30T08:05:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1545208343",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5960750?v=4",
         "events_url" : "https://api.github.com/users/rkrux/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rkrux/followers",
         "following_url" : "https://api.github.com/users/rkrux/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rkrux/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rkrux",
         "id" : 5960750,
         "login" : "rkrux",
         "node_id" : "MDQ6VXNlcjU5NjA3NTA=",
         "organizations_url" : "https://api.github.com/users/rkrux/orgs",
         "received_events_url" : "https://api.github.com/users/rkrux/received_events",
         "repos_url" : "https://api.github.com/users/rkrux/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rkrux/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rkrux/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rkrux"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29521#discussion_r1545303312"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29521"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1545303312"
         }
      },
      "author_association" : "NONE",
      "body" : "Interesting article. Wonder what the behavior is before this PR when specifying 0..",
      "commit_id" : "cb4f9fc5847a7e53fe45d54b1fddf504dee5af82",
      "created_at" : "2024-03-30T11:38:34Z",
      "diff_hunk" : "@@ -747,8 +747,35 @@ static UniValue CallRPC(BaseRequestHandler* rh, const std::string& strMethod, co\n     //     2. port in -rpcconnect (ie following : in ipv4 or ]: in ipv6)\n     //     3. default port for chain\n     uint16_t port{BaseParams().RPCPort()};\n-    SplitHostPort(gArgs.GetArg(\"-rpcconnect\", DEFAULT_RPCCONNECT), port, host);\n-    port = static_cast<uint16_t>(gArgs.GetIntArg(\"-rpcport\", port));\n+    {\n+        uint16_t rpcconnect_port{0};\n+        const std::string rpcconnect_str = gArgs.GetArg(\"-rpcconnect\", DEFAULT_RPCCONNECT);\n+        if (!SplitHostPort(rpcconnect_str, rpcconnect_port, host)) {\n+            throw std::runtime_error(strprintf(\"Invalid port provided in -rpcconnect: %s\", rpcconnect_str));\n+        } else {\n+            if (rpcconnect_port != 0) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29521#discussion_r1545303312",
      "id" : 1545303312,
      "in_reply_to_id" : 1545208343,
      "line" : 756,
      "node_id" : "PRRC_kwDOABII585cG3UQ",
      "original_commit_id" : "cb4f9fc5847a7e53fe45d54b1fddf504dee5af82",
      "original_line" : 756,
      "original_position" : 12,
      "original_start_line" : null,
      "path" : "src/bitcoin-cli.cpp",
      "position" : 12,
      "pull_request_review_id" : 1969893551,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29521",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1545303312/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-03-30T11:38:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1545303312",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/581308?v=4",
         "events_url" : "https://api.github.com/users/cbergqvist/events{/privacy}",
         "followers_url" : "https://api.github.com/users/cbergqvist/followers",
         "following_url" : "https://api.github.com/users/cbergqvist/following{/other_user}",
         "gists_url" : "https://api.github.com/users/cbergqvist/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/cbergqvist",
         "id" : 581308,
         "login" : "cbergqvist",
         "node_id" : "MDQ6VXNlcjU4MTMwOA==",
         "organizations_url" : "https://api.github.com/users/cbergqvist/orgs",
         "received_events_url" : "https://api.github.com/users/cbergqvist/received_events",
         "repos_url" : "https://api.github.com/users/cbergqvist/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/cbergqvist/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/cbergqvist/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/cbergqvist"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> ACK [cb4f9fc](https://github.com/bitcoin/bitcoin/pull/29521/commits/cb4f9fc5847a7e53fe45d54b1fddf504dee5af82)\r\n\r\nThank you for the review and testing @rkrux!\r\nWill add a note to the description about usage of port 0 now considered invalid.",
      "created_at" : "2024-03-30T11:50:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29521#issuecomment-2028025646",
      "id" : 2028025646,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29521",
      "node_id" : "IC_kwDOABII58544Tcu",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2028025646/reactions"
      },
      "updated_at" : "2024-03-30T12:03:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2028025646",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/106488469?v=4",
         "events_url" : "https://api.github.com/users/tdb3/events{/privacy}",
         "followers_url" : "https://api.github.com/users/tdb3/followers",
         "following_url" : "https://api.github.com/users/tdb3/following{/other_user}",
         "gists_url" : "https://api.github.com/users/tdb3/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/tdb3",
         "id" : 106488469,
         "login" : "tdb3",
         "node_id" : "U_kgDOBljilQ",
         "organizations_url" : "https://api.github.com/users/tdb3/orgs",
         "received_events_url" : "https://api.github.com/users/tdb3/received_events",
         "repos_url" : "https://api.github.com/users/tdb3/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/tdb3/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/tdb3/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/tdb3"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29521#discussion_r1545311669"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29521"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1545311669"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "```bash\r\n$ src/bitcoin-cli -rpcport=0 getblockchaininfo\r\nerror: timeout on transient error: Could not connect to the server 127.0.0.1:0\r\n\r\nMake sure the bitcoind server is running and that you are connecting to the correct RPC port.\r\n\r\n$ src/bitcoin-cli -rpcconnect=127.0.0.1:0 getblockchaininfo\r\nerror: timeout on transient error: Could not connect to the server 127.0.0.1:0\r\n\r\nMake sure the bitcoind server is running and that you are connecting to the correct RPC port.\r\n```\r\n\r\nThe client tries to reach port 0, which wouldn't be successful.",
      "commit_id" : "cb4f9fc5847a7e53fe45d54b1fddf504dee5af82",
      "created_at" : "2024-03-30T11:54:10Z",
      "diff_hunk" : "@@ -747,8 +747,35 @@ static UniValue CallRPC(BaseRequestHandler* rh, const std::string& strMethod, co\n     //     2. port in -rpcconnect (ie following : in ipv4 or ]: in ipv6)\n     //     3. default port for chain\n     uint16_t port{BaseParams().RPCPort()};\n-    SplitHostPort(gArgs.GetArg(\"-rpcconnect\", DEFAULT_RPCCONNECT), port, host);\n-    port = static_cast<uint16_t>(gArgs.GetIntArg(\"-rpcport\", port));\n+    {\n+        uint16_t rpcconnect_port{0};\n+        const std::string rpcconnect_str = gArgs.GetArg(\"-rpcconnect\", DEFAULT_RPCCONNECT);\n+        if (!SplitHostPort(rpcconnect_str, rpcconnect_port, host)) {\n+            throw std::runtime_error(strprintf(\"Invalid port provided in -rpcconnect: %s\", rpcconnect_str));\n+        } else {\n+            if (rpcconnect_port != 0) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29521#discussion_r1545311669",
      "id" : 1545311669,
      "in_reply_to_id" : 1545208343,
      "line" : 756,
      "node_id" : "PRRC_kwDOABII585cG5W1",
      "original_commit_id" : "cb4f9fc5847a7e53fe45d54b1fddf504dee5af82",
      "original_line" : 756,
      "original_position" : 12,
      "original_start_line" : null,
      "path" : "src/bitcoin-cli.cpp",
      "position" : 12,
      "pull_request_review_id" : 1969896124,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29521",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1545311669/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-03-30T11:54:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1545311669",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/106488469?v=4",
         "events_url" : "https://api.github.com/users/tdb3/events{/privacy}",
         "followers_url" : "https://api.github.com/users/tdb3/followers",
         "following_url" : "https://api.github.com/users/tdb3/following{/other_user}",
         "gists_url" : "https://api.github.com/users/tdb3/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/tdb3",
         "id" : 106488469,
         "login" : "tdb3",
         "node_id" : "U_kgDOBljilQ",
         "organizations_url" : "https://api.github.com/users/tdb3/orgs",
         "received_events_url" : "https://api.github.com/users/tdb3/received_events",
         "repos_url" : "https://api.github.com/users/tdb3/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/tdb3/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/tdb3/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/tdb3"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29521#discussion_r1545324933"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29521"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1545324933"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "yes, it enforces scope.  Not strictly necessary, but will leave it for now.",
      "commit_id" : "cb4f9fc5847a7e53fe45d54b1fddf504dee5af82",
      "created_at" : "2024-03-30T12:18:23Z",
      "diff_hunk" : "@@ -747,8 +747,35 @@ static UniValue CallRPC(BaseRequestHandler* rh, const std::string& strMethod, co\n     //     2. port in -rpcconnect (ie following : in ipv4 or ]: in ipv6)\n     //     3. default port for chain\n     uint16_t port{BaseParams().RPCPort()};\n-    SplitHostPort(gArgs.GetArg(\"-rpcconnect\", DEFAULT_RPCCONNECT), port, host);\n-    port = static_cast<uint16_t>(gArgs.GetIntArg(\"-rpcport\", port));\n+    {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29521#discussion_r1545324933",
      "id" : 1545324933,
      "in_reply_to_id" : 1545206102,
      "line" : 750,
      "node_id" : "PRRC_kwDOABII585cG8mF",
      "original_commit_id" : "cb4f9fc5847a7e53fe45d54b1fddf504dee5af82",
      "original_line" : 750,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/bitcoin-cli.cpp",
      "position" : 6,
      "pull_request_review_id" : 1969899783,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29521",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1545324933/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-03-30T12:18:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1545324933",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/106488469?v=4",
         "events_url" : "https://api.github.com/users/tdb3/events{/privacy}",
         "followers_url" : "https://api.github.com/users/tdb3/followers",
         "following_url" : "https://api.github.com/users/tdb3/following{/other_user}",
         "gists_url" : "https://api.github.com/users/tdb3/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/tdb3",
         "id" : 106488469,
         "login" : "tdb3",
         "node_id" : "U_kgDOBljilQ",
         "organizations_url" : "https://api.github.com/users/tdb3/orgs",
         "received_events_url" : "https://api.github.com/users/tdb3/received_events",
         "repos_url" : "https://api.github.com/users/tdb3/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/tdb3/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/tdb3/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/tdb3"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29521#discussion_r1545499235"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29521"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1545499235"
         }
      },
      "author_association" : "NONE",
      "body" : "Ah yeah, makes sense for the client. ð",
      "commit_id" : "cb4f9fc5847a7e53fe45d54b1fddf504dee5af82",
      "created_at" : "2024-03-30T21:33:03Z",
      "diff_hunk" : "@@ -747,8 +747,35 @@ static UniValue CallRPC(BaseRequestHandler* rh, const std::string& strMethod, co\n     //     2. port in -rpcconnect (ie following : in ipv4 or ]: in ipv6)\n     //     3. default port for chain\n     uint16_t port{BaseParams().RPCPort()};\n-    SplitHostPort(gArgs.GetArg(\"-rpcconnect\", DEFAULT_RPCCONNECT), port, host);\n-    port = static_cast<uint16_t>(gArgs.GetIntArg(\"-rpcport\", port));\n+    {\n+        uint16_t rpcconnect_port{0};\n+        const std::string rpcconnect_str = gArgs.GetArg(\"-rpcconnect\", DEFAULT_RPCCONNECT);\n+        if (!SplitHostPort(rpcconnect_str, rpcconnect_port, host)) {\n+            throw std::runtime_error(strprintf(\"Invalid port provided in -rpcconnect: %s\", rpcconnect_str));\n+        } else {\n+            if (rpcconnect_port != 0) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29521#discussion_r1545499235",
      "id" : 1545499235,
      "in_reply_to_id" : 1545208343,
      "line" : 756,
      "node_id" : "PRRC_kwDOABII585cHnJj",
      "original_commit_id" : "cb4f9fc5847a7e53fe45d54b1fddf504dee5af82",
      "original_line" : 756,
      "original_position" : 12,
      "original_start_line" : null,
      "path" : "src/bitcoin-cli.cpp",
      "position" : 12,
      "pull_request_review_id" : 1970060593,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29521",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1545499235/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-03-30T21:33:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1545499235",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/581308?v=4",
         "events_url" : "https://api.github.com/users/cbergqvist/events{/privacy}",
         "followers_url" : "https://api.github.com/users/cbergqvist/followers",
         "following_url" : "https://api.github.com/users/cbergqvist/following{/other_user}",
         "gists_url" : "https://api.github.com/users/cbergqvist/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/cbergqvist",
         "id" : 581308,
         "login" : "cbergqvist",
         "node_id" : "MDQ6VXNlcjU4MTMwOA==",
         "organizations_url" : "https://api.github.com/users/cbergqvist/orgs",
         "received_events_url" : "https://api.github.com/users/cbergqvist/received_events",
         "repos_url" : "https://api.github.com/users/cbergqvist/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/cbergqvist/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/cbergqvist/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/cbergqvist"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Tested ACK. The new error handling code looks good to me upon review. Ran the daemon and gave invalid values for `rpcconnect` and `rpcport` and the proper error messages came up. The behavior of port 0 being invalid is consistent with `src/init.cpp`. Ran `interface_bitcoin_cli.py` too and there were no issues with the added tests.\r\n\r\nThank you for reviewing, @marcofleon!",
      "created_at" : "2024-04-02T23:09:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29521#issuecomment-2033263056",
      "id" : 2033263056,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29521",
      "node_id" : "IC_kwDOABII5855MSHQ",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2033263056/reactions"
      },
      "updated_at" : "2024-04-02T23:09:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2033263056",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/106488469?v=4",
         "events_url" : "https://api.github.com/users/tdb3/events{/privacy}",
         "followers_url" : "https://api.github.com/users/tdb3/followers",
         "following_url" : "https://api.github.com/users/tdb3/following{/other_user}",
         "gists_url" : "https://api.github.com/users/tdb3/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/tdb3",
         "id" : 106488469,
         "login" : "tdb3",
         "node_id" : "U_kgDOBljilQ",
         "organizations_url" : "https://api.github.com/users/tdb3/orgs",
         "received_events_url" : "https://api.github.com/users/tdb3/received_events",
         "repos_url" : "https://api.github.com/users/tdb3/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/tdb3/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/tdb3/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/tdb3"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "ACK https://github.com/bitcoin/bitcoin/pull/29521/commits/cb4f9fc5847a7e53fe45d54b1fddf504dee5af82\r\n\r\nThe changes in `bitcoin-cli.cpp` since the last ACK look good to me, and the test coverage is more extensive.\r\n\r\nTested with `make check`  and running the functional test suite.\r\n\r\nI also verified that passing bad ports to `rpcconnect` and `rpcport` trigger the warning.",
      "created_at" : "2024-04-03T17:16:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29521#issuecomment-2035153866",
      "id" : 2035153866,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29521",
      "node_id" : "IC_kwDOABII5855TfvK",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2035153866/reactions"
      },
      "updated_at" : "2024-04-03T17:16:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2035153866",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2257631?v=4",
         "events_url" : "https://api.github.com/users/davidgumberg/events{/privacy}",
         "followers_url" : "https://api.github.com/users/davidgumberg/followers",
         "following_url" : "https://api.github.com/users/davidgumberg/following{/other_user}",
         "gists_url" : "https://api.github.com/users/davidgumberg/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/davidgumberg",
         "id" : 2257631,
         "login" : "davidgumberg",
         "node_id" : "MDQ6VXNlcjIyNTc2MzE=",
         "organizations_url" : "https://api.github.com/users/davidgumberg/orgs",
         "received_events_url" : "https://api.github.com/users/davidgumberg/received_events",
         "repos_url" : "https://api.github.com/users/davidgumberg/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/davidgumberg/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/davidgumberg/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/davidgumberg"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29521#discussion_r1575420781"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29521"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1575420781"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In caa5242f84a6e1ef90b8a44c1206c7b5b942a00c \"cli: Sanitize ports in rpcconnect and rpcport\"\r\n\r\nThis will fail if you just have a regtest node running independent of the test:\r\n\r\n```\r\n2024-04-22T22:30:22.751000Z TestFramework (ERROR): Assertion failed\r\nTraceback (most recent call last):\r\n  File \"/home/ava/bitcoin/bitcoin/29521/test/functional/test_framework/util.py\", line 122, in assert_raises_process_error\r\n    fun(*args, **kwds)\r\n  File \"/home/ava/bitcoin/bitcoin/29521/test/functional/test_framework/test_node.py\", line 821, in __call__\r\n    return self.cli.send_cli(self.command, *args, **kwargs)\r\n  File \"/home/ava/bitcoin/bitcoin/29521/test/functional/test_framework/test_node.py\", line 886, in send_cli\r\n    raise subprocess.CalledProcessError(returncode, self.binary, output=cli_stderr)\r\nsubprocess.CalledProcessError: Command '/home/ava/bitcoin/bitcoin/29521/src/bitcoin-cli' returned non-zero exit status 1.\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/home/ava/bitcoin/bitcoin/29521/test/functional/test_framework/test_framework.py\", line 132, in main\r\n    self.run_test()\r\n  File \"/home/ava/bitcoin/bitcoin/29521/test/functional/interface_bitcoin_cli.py\", line 136, in run_test\r\n    assert_raises_process_error(1, \"Could not connect to the server 127.0.0.1:18443\", self.nodes[0].cli(\"-rpcconnect=127.0.0.1\").echo)\r\n  File \"/home/ava/bitcoin/bitcoin/29521/test/functional/test_framework/util.py\", line 127, in assert_raises_process_error\r\n    raise AssertionError(\"Expected substring not found:\" + e.output)\r\nAssertionError: Expected substring not found:error: Authorization failed: Incorrect rpcuser or rpcpassword\r\n```",
      "commit_id" : "cb4f9fc5847a7e53fe45d54b1fddf504dee5af82",
      "created_at" : "2024-04-22T22:29:59Z",
      "diff_hunk" : "@@ -107,6 +108,35 @@ def run_test(self):\n         self.log.info(\"Test connecting to a non-existing server\")\n         assert_raises_process_error(1, \"Could not connect to the server\", self.nodes[0].cli('-rpcport=1').echo)\n \n+        self.log.info(\"Test handling of invalid ports in rpcconnect\")\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcconnect: 127.0.0.1:notaport\", self.nodes[0].cli(\"-rpcconnect=127.0.0.1:notaport\").echo)\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcconnect: 127.0.0.1:-1\", self.nodes[0].cli(\"-rpcconnect=127.0.0.1:-1\").echo)\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcconnect: 127.0.0.1:0\", self.nodes[0].cli(\"-rpcconnect=127.0.0.1:0\").echo)\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcconnect: 127.0.0.1:65536\", self.nodes[0].cli(\"-rpcconnect=127.0.0.1:65536\").echo)\n+\n+        self.log.info(\"Test handling of invalid ports in rpcport\")\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcport: notaport\", self.nodes[0].cli(\"-rpcport=notaport\").echo)\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcport: -1\", self.nodes[0].cli(\"-rpcport=-1\").echo)\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcport: 0\", self.nodes[0].cli(\"-rpcport=0\").echo)\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcport: 65536\", self.nodes[0].cli(\"-rpcport=65536\").echo)\n+\n+        self.log.info(\"Test port usage preferences\")\n+        node_rpc_port = rpc_port(self.nodes[0].index)\n+        # Prevent bitcoin-cli from using existing rpcport in conf\n+        conf_rpcport = \"rpcport=\" + str(node_rpc_port)\n+        self.nodes[0].replace_in_config([(conf_rpcport, \"#\" + conf_rpcport)])\n+        # prefer rpcport over rpcconnect\n+        assert_raises_process_error(1, \"Could not connect to the server 127.0.0.1:1\", self.nodes[0].cli(f\"-rpcconnect=127.0.0.1:{node_rpc_port}\", \"-rpcport=1\").echo)\n+        assert_equal(BLOCKS, self.nodes[0].cli(\"-rpcconnect=127.0.0.1:18999\", f'-rpcport={node_rpc_port}').getblockcount())\n+        # prefer rpcconnect port over default\n+        assert_equal(BLOCKS, self.nodes[0].cli(f\"-rpcconnect=127.0.0.1:{node_rpc_port}\").getblockcount())\n+        # prefer rpcport over default\n+        assert_equal(BLOCKS, self.nodes[0].cli(f'-rpcport={node_rpc_port}').getblockcount())\n+        # use default if nothing else available\n+        assert_raises_process_error(1, \"Could not connect to the server 127.0.0.1:18443\", self.nodes[0].cli(\"-rpcconnect=127.0.0.1\").echo)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29521#discussion_r1575420781",
      "id" : 1575420781,
      "line" : 136,
      "node_id" : "PRRC_kwDOABII585d5wNt",
      "original_commit_id" : "caa5242f84a6e1ef90b8a44c1206c7b5b942a00c",
      "original_line" : 136,
      "original_position" : 37,
      "original_start_line" : null,
      "path" : "test/functional/interface_bitcoin_cli.py",
      "position" : 37,
      "pull_request_review_id" : 2015900045,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29521",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1575420781/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-22T22:32:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1575420781",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29521#discussion_r1575519821"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29521"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1575519821"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks for taking a look and trying it out @achow101. Much appreciated.\r\n\r\nGood point. Yes, the test would fail if an independent node is running on 18443.\r\n\r\nAlthough not ideal, do you think this would be reasonable since a warning is provided when bitcoind is running independently? (i.e. `WARNING! There is already a bitcoind process running on this system. Tests may fail unexpectedly due to resource contention!`)\r\n\r\nAlternatively, the assert statement could be removed, but that seems a bit lacking, since it seems good to check for default port usage (even if the current check is limited to the default regtest port).\r\n\r\nCould also look into refactoring a bit, but that might lead to touching a bit more code than desirable.\r\n\r\nThoughts?",
      "commit_id" : "cb4f9fc5847a7e53fe45d54b1fddf504dee5af82",
      "created_at" : "2024-04-23T01:11:38Z",
      "diff_hunk" : "@@ -107,6 +108,35 @@ def run_test(self):\n         self.log.info(\"Test connecting to a non-existing server\")\n         assert_raises_process_error(1, \"Could not connect to the server\", self.nodes[0].cli('-rpcport=1').echo)\n \n+        self.log.info(\"Test handling of invalid ports in rpcconnect\")\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcconnect: 127.0.0.1:notaport\", self.nodes[0].cli(\"-rpcconnect=127.0.0.1:notaport\").echo)\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcconnect: 127.0.0.1:-1\", self.nodes[0].cli(\"-rpcconnect=127.0.0.1:-1\").echo)\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcconnect: 127.0.0.1:0\", self.nodes[0].cli(\"-rpcconnect=127.0.0.1:0\").echo)\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcconnect: 127.0.0.1:65536\", self.nodes[0].cli(\"-rpcconnect=127.0.0.1:65536\").echo)\n+\n+        self.log.info(\"Test handling of invalid ports in rpcport\")\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcport: notaport\", self.nodes[0].cli(\"-rpcport=notaport\").echo)\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcport: -1\", self.nodes[0].cli(\"-rpcport=-1\").echo)\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcport: 0\", self.nodes[0].cli(\"-rpcport=0\").echo)\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcport: 65536\", self.nodes[0].cli(\"-rpcport=65536\").echo)\n+\n+        self.log.info(\"Test port usage preferences\")\n+        node_rpc_port = rpc_port(self.nodes[0].index)\n+        # Prevent bitcoin-cli from using existing rpcport in conf\n+        conf_rpcport = \"rpcport=\" + str(node_rpc_port)\n+        self.nodes[0].replace_in_config([(conf_rpcport, \"#\" + conf_rpcport)])\n+        # prefer rpcport over rpcconnect\n+        assert_raises_process_error(1, \"Could not connect to the server 127.0.0.1:1\", self.nodes[0].cli(f\"-rpcconnect=127.0.0.1:{node_rpc_port}\", \"-rpcport=1\").echo)\n+        assert_equal(BLOCKS, self.nodes[0].cli(\"-rpcconnect=127.0.0.1:18999\", f'-rpcport={node_rpc_port}').getblockcount())\n+        # prefer rpcconnect port over default\n+        assert_equal(BLOCKS, self.nodes[0].cli(f\"-rpcconnect=127.0.0.1:{node_rpc_port}\").getblockcount())\n+        # prefer rpcport over default\n+        assert_equal(BLOCKS, self.nodes[0].cli(f'-rpcport={node_rpc_port}').getblockcount())\n+        # use default if nothing else available\n+        assert_raises_process_error(1, \"Could not connect to the server 127.0.0.1:18443\", self.nodes[0].cli(\"-rpcconnect=127.0.0.1\").echo)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29521#discussion_r1575519821",
      "id" : 1575519821,
      "in_reply_to_id" : 1575420781,
      "line" : 136,
      "node_id" : "PRRC_kwDOABII585d6IZN",
      "original_commit_id" : "caa5242f84a6e1ef90b8a44c1206c7b5b942a00c",
      "original_line" : 136,
      "original_position" : 37,
      "original_start_line" : null,
      "path" : "test/functional/interface_bitcoin_cli.py",
      "position" : 37,
      "pull_request_review_id" : 2016052642,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29521",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1575519821/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-23T01:11:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1575519821",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/106488469?v=4",
         "events_url" : "https://api.github.com/users/tdb3/events{/privacy}",
         "followers_url" : "https://api.github.com/users/tdb3/followers",
         "following_url" : "https://api.github.com/users/tdb3/following{/other_user}",
         "gists_url" : "https://api.github.com/users/tdb3/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/tdb3",
         "id" : 106488469,
         "login" : "tdb3",
         "node_id" : "U_kgDOBljilQ",
         "organizations_url" : "https://api.github.com/users/tdb3/orgs",
         "received_events_url" : "https://api.github.com/users/tdb3/received_events",
         "repos_url" : "https://api.github.com/users/tdb3/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/tdb3/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/tdb3/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/tdb3"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29521#discussion_r1575636802"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29521"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1575636802"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I'd say it should be avoided to use test outside of the allowed range assigned to this test case. Each test is assigned 12, or so, p2p and rpc ports. I think this test can be dropped, because if the default behavior changed, pretty much every developer would notice quickly anyway?",
      "commit_id" : "6c17bdeb7002104e473b5b425c64d557c663df2d",
      "created_at" : "2024-04-23T04:51:21Z",
      "diff_hunk" : "@@ -107,6 +108,35 @@ def run_test(self):\n         self.log.info(\"Test connecting to a non-existing server\")\n         assert_raises_process_error(1, \"Could not connect to the server\", self.nodes[0].cli('-rpcport=1').echo)\n \n+        self.log.info(\"Test handling of invalid ports in rpcconnect\")\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcconnect: 127.0.0.1:notaport\", self.nodes[0].cli(\"-rpcconnect=127.0.0.1:notaport\").echo)\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcconnect: 127.0.0.1:-1\", self.nodes[0].cli(\"-rpcconnect=127.0.0.1:-1\").echo)\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcconnect: 127.0.0.1:0\", self.nodes[0].cli(\"-rpcconnect=127.0.0.1:0\").echo)\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcconnect: 127.0.0.1:65536\", self.nodes[0].cli(\"-rpcconnect=127.0.0.1:65536\").echo)\n+\n+        self.log.info(\"Test handling of invalid ports in rpcport\")\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcport: notaport\", self.nodes[0].cli(\"-rpcport=notaport\").echo)\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcport: -1\", self.nodes[0].cli(\"-rpcport=-1\").echo)\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcport: 0\", self.nodes[0].cli(\"-rpcport=0\").echo)\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcport: 65536\", self.nodes[0].cli(\"-rpcport=65536\").echo)\n+\n+        self.log.info(\"Test port usage preferences\")\n+        node_rpc_port = rpc_port(self.nodes[0].index)\n+        # Prevent bitcoin-cli from using existing rpcport in conf\n+        conf_rpcport = \"rpcport=\" + str(node_rpc_port)\n+        self.nodes[0].replace_in_config([(conf_rpcport, \"#\" + conf_rpcport)])\n+        # prefer rpcport over rpcconnect\n+        assert_raises_process_error(1, \"Could not connect to the server 127.0.0.1:1\", self.nodes[0].cli(f\"-rpcconnect=127.0.0.1:{node_rpc_port}\", \"-rpcport=1\").echo)\n+        assert_equal(BLOCKS, self.nodes[0].cli(\"-rpcconnect=127.0.0.1:18999\", f'-rpcport={node_rpc_port}').getblockcount())\n+        # prefer rpcconnect port over default\n+        assert_equal(BLOCKS, self.nodes[0].cli(f\"-rpcconnect=127.0.0.1:{node_rpc_port}\").getblockcount())\n+        # prefer rpcport over default\n+        assert_equal(BLOCKS, self.nodes[0].cli(f'-rpcport={node_rpc_port}').getblockcount())\n+        # use default if nothing else available\n+        assert_raises_process_error(1, \"Could not connect to the server 127.0.0.1:18443\", self.nodes[0].cli(\"-rpcconnect=127.0.0.1\").echo)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29521#discussion_r1575636802",
      "id" : 1575636802,
      "in_reply_to_id" : 1575420781,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585d6k9C",
      "original_commit_id" : "caa5242f84a6e1ef90b8a44c1206c7b5b942a00c",
      "original_line" : 136,
      "original_position" : 37,
      "original_start_line" : null,
      "path" : "test/functional/interface_bitcoin_cli.py",
      "position" : null,
      "pull_request_review_id" : 2016231363,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29521",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1575636802/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-23T04:51:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1575636802",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29521#discussion_r1577085955"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29521"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1577085955"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Yes, that sounds reasonable.  Overall, port error checking and associated functional test cases introduce an improvement.  Removed the \"18443\"  test and pushed.",
      "commit_id" : "6c17bdeb7002104e473b5b425c64d557c663df2d",
      "created_at" : "2024-04-24T01:15:26Z",
      "diff_hunk" : "@@ -107,6 +108,35 @@ def run_test(self):\n         self.log.info(\"Test connecting to a non-existing server\")\n         assert_raises_process_error(1, \"Could not connect to the server\", self.nodes[0].cli('-rpcport=1').echo)\n \n+        self.log.info(\"Test handling of invalid ports in rpcconnect\")\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcconnect: 127.0.0.1:notaport\", self.nodes[0].cli(\"-rpcconnect=127.0.0.1:notaport\").echo)\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcconnect: 127.0.0.1:-1\", self.nodes[0].cli(\"-rpcconnect=127.0.0.1:-1\").echo)\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcconnect: 127.0.0.1:0\", self.nodes[0].cli(\"-rpcconnect=127.0.0.1:0\").echo)\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcconnect: 127.0.0.1:65536\", self.nodes[0].cli(\"-rpcconnect=127.0.0.1:65536\").echo)\n+\n+        self.log.info(\"Test handling of invalid ports in rpcport\")\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcport: notaport\", self.nodes[0].cli(\"-rpcport=notaport\").echo)\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcport: -1\", self.nodes[0].cli(\"-rpcport=-1\").echo)\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcport: 0\", self.nodes[0].cli(\"-rpcport=0\").echo)\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcport: 65536\", self.nodes[0].cli(\"-rpcport=65536\").echo)\n+\n+        self.log.info(\"Test port usage preferences\")\n+        node_rpc_port = rpc_port(self.nodes[0].index)\n+        # Prevent bitcoin-cli from using existing rpcport in conf\n+        conf_rpcport = \"rpcport=\" + str(node_rpc_port)\n+        self.nodes[0].replace_in_config([(conf_rpcport, \"#\" + conf_rpcport)])\n+        # prefer rpcport over rpcconnect\n+        assert_raises_process_error(1, \"Could not connect to the server 127.0.0.1:1\", self.nodes[0].cli(f\"-rpcconnect=127.0.0.1:{node_rpc_port}\", \"-rpcport=1\").echo)\n+        assert_equal(BLOCKS, self.nodes[0].cli(\"-rpcconnect=127.0.0.1:18999\", f'-rpcport={node_rpc_port}').getblockcount())\n+        # prefer rpcconnect port over default\n+        assert_equal(BLOCKS, self.nodes[0].cli(f\"-rpcconnect=127.0.0.1:{node_rpc_port}\").getblockcount())\n+        # prefer rpcport over default\n+        assert_equal(BLOCKS, self.nodes[0].cli(f'-rpcport={node_rpc_port}').getblockcount())\n+        # use default if nothing else available\n+        assert_raises_process_error(1, \"Could not connect to the server 127.0.0.1:18443\", self.nodes[0].cli(\"-rpcconnect=127.0.0.1\").echo)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29521#discussion_r1577085955",
      "id" : 1577085955,
      "in_reply_to_id" : 1575420781,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585eAGwD",
      "original_commit_id" : "caa5242f84a6e1ef90b8a44c1206c7b5b942a00c",
      "original_line" : 136,
      "original_position" : 37,
      "original_start_line" : null,
      "path" : "test/functional/interface_bitcoin_cli.py",
      "position" : null,
      "pull_request_review_id" : 2018597174,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29521",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1577085955/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-24T01:27:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1577085955",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/106488469?v=4",
         "events_url" : "https://api.github.com/users/tdb3/events{/privacy}",
         "followers_url" : "https://api.github.com/users/tdb3/followers",
         "following_url" : "https://api.github.com/users/tdb3/following{/other_user}",
         "gists_url" : "https://api.github.com/users/tdb3/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/tdb3",
         "id" : 106488469,
         "login" : "tdb3",
         "node_id" : "U_kgDOBljilQ",
         "organizations_url" : "https://api.github.com/users/tdb3/orgs",
         "received_events_url" : "https://api.github.com/users/tdb3/received_events",
         "repos_url" : "https://api.github.com/users/tdb3/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/tdb3/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/tdb3/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/tdb3"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29521#discussion_r1581145534"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29521"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1581145534"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I added this line and it seemed to pass\r\n```\r\nassert_raises_process_error(1, 'timeout on transient error: Could not connect to the server 127.0.0.1:::', self.nodes[0].cli(\"-rpcconnect=127.0.0.1::\").echo)\r\n```\r\nlooks like `SplitHostPort` does not throw an exception if there are two colons and no port provided\r\n\r\nI am unsure if that is needed logic in `SplitHostPort`\r\n\r\nI'm seeing the same error when I do \r\n`self.nodes[0].cli(\"-rpcconnect=127.0.0.256\")`\r\nprobably because 255 is the max value",
      "commit_id" : "867a673bcfd3ca254c306d8cf0c68d4ceb163f97",
      "created_at" : "2024-04-26T14:49:11Z",
      "diff_hunk" : "@@ -107,6 +108,33 @@ def run_test(self):\n         self.log.info(\"Test connecting to a non-existing server\")\n         assert_raises_process_error(1, \"Could not connect to the server\", self.nodes[0].cli('-rpcport=1').echo)\n \n+        self.log.info(\"Test handling of invalid ports in rpcconnect\")\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcconnect: 127.0.0.1:notaport\", self.nodes[0].cli(\"-rpcconnect=127.0.0.1:notaport\").echo)\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcconnect: 127.0.0.1:-1\", self.nodes[0].cli(\"-rpcconnect=127.0.0.1:-1\").echo)\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcconnect: 127.0.0.1:0\", self.nodes[0].cli(\"-rpcconnect=127.0.0.1:0\").echo)\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcconnect: 127.0.0.1:65536\", self.nodes[0].cli(\"-rpcconnect=127.0.0.1:65536\").echo)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29521#discussion_r1581145534",
      "id" : 1581145534,
      "line" : 116,
      "node_id" : "PRRC_kwDOABII585ePl2-",
      "original_commit_id" : "6c17bdeb7002104e473b5b425c64d557c663df2d",
      "original_line" : 116,
      "original_position" : 16,
      "original_start_line" : null,
      "path" : "test/functional/interface_bitcoin_cli.py",
      "position" : 24,
      "pull_request_review_id" : 2025237306,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29521",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1581145534/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-26T14:49:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1581145534",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/15950706?v=4",
         "events_url" : "https://api.github.com/users/kevkevinpal/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kevkevinpal/followers",
         "following_url" : "https://api.github.com/users/kevkevinpal/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kevkevinpal/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kevkevinpal",
         "id" : 15950706,
         "login" : "kevkevinpal",
         "node_id" : "MDQ6VXNlcjE1OTUwNzA2",
         "organizations_url" : "https://api.github.com/users/kevkevinpal/orgs",
         "received_events_url" : "https://api.github.com/users/kevkevinpal/received_events",
         "repos_url" : "https://api.github.com/users/kevkevinpal/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kevkevinpal/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kevkevinpal/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kevkevinpal"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29521#discussion_r1581915244"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29521"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1581915244"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks @kevkevinpal.  Good example of why review is valued.  Your findings nudged me to add some assert test statements (which otherwise wouldn't be present) to help cover cases involving IPv6 hosts.\r\n\r\nWe're experiencing the result of the scope of `SplitHostPort()`.  `SplitHostPort()` extracts the host and port.  Although the port is validated, host is not (and the function declaration comment header mentions validating the port, but doesn't mention validating the host).\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/7fee0ca014b1513e836d2550d1b7512739d5a79a/src/util/strencodings.h#L97-L106\r\n\r\n`SplitHostPort()` is treating \"127.0.0.1::\" as an IPv6 host since \"::\" is used for IPv6 address shortening.  `SplitHostPort()` detects no port as part of the input string, which would be why `Could not connect to the server 127.0.0.1:::18443` is the error provided for `src/bitcoin-cli -rpcconnect=127.0.0.1:: getblockcount` (the \":18443\" is tacked on the end because it's the default port for regtest).\r\n\r\nAn enhancement would be to perform a validation of the host received from `SplitHostPort()` before bitcoin-cli attempts to contact the host.  I'm thinking we would need to first define what is \"valid\" and what is \"invalid\" for use with bitcoin-cli.  The gist of this kind of checking seems to be present in `CNetAddr`.  In general, I would think bitcoin-cli shouldn't be overly restrictive in what it lets the user attempt to use as a host.\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/7fee0ca014b1513e836d2550d1b7512739d5a79a/src/netaddress.h#L157-L181\r\n\r\nFor now, it might make the most sense to leave the enhancement of host validation to a new PR since this PR is focused on port error detection.\r\n",
      "commit_id" : "867a673bcfd3ca254c306d8cf0c68d4ceb163f97",
      "created_at" : "2024-04-27T22:18:37Z",
      "diff_hunk" : "@@ -107,6 +108,33 @@ def run_test(self):\n         self.log.info(\"Test connecting to a non-existing server\")\n         assert_raises_process_error(1, \"Could not connect to the server\", self.nodes[0].cli('-rpcport=1').echo)\n \n+        self.log.info(\"Test handling of invalid ports in rpcconnect\")\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcconnect: 127.0.0.1:notaport\", self.nodes[0].cli(\"-rpcconnect=127.0.0.1:notaport\").echo)\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcconnect: 127.0.0.1:-1\", self.nodes[0].cli(\"-rpcconnect=127.0.0.1:-1\").echo)\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcconnect: 127.0.0.1:0\", self.nodes[0].cli(\"-rpcconnect=127.0.0.1:0\").echo)\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcconnect: 127.0.0.1:65536\", self.nodes[0].cli(\"-rpcconnect=127.0.0.1:65536\").echo)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29521#discussion_r1581915244",
      "id" : 1581915244,
      "in_reply_to_id" : 1581145534,
      "line" : 116,
      "node_id" : "PRRC_kwDOABII585eShxs",
      "original_commit_id" : "6c17bdeb7002104e473b5b425c64d557c663df2d",
      "original_line" : 116,
      "original_position" : 16,
      "original_start_line" : null,
      "path" : "test/functional/interface_bitcoin_cli.py",
      "position" : 24,
      "pull_request_review_id" : 2026753844,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29521",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1581915244/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-27T22:40:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1581915244",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/106488469?v=4",
         "events_url" : "https://api.github.com/users/tdb3/events{/privacy}",
         "followers_url" : "https://api.github.com/users/tdb3/followers",
         "following_url" : "https://api.github.com/users/tdb3/following{/other_user}",
         "gists_url" : "https://api.github.com/users/tdb3/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/tdb3",
         "id" : 106488469,
         "login" : "tdb3",
         "node_id" : "U_kgDOBljilQ",
         "organizations_url" : "https://api.github.com/users/tdb3/orgs",
         "received_events_url" : "https://api.github.com/users/tdb3/received_events",
         "repos_url" : "https://api.github.com/users/tdb3/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/tdb3/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/tdb3/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/tdb3"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29521#discussion_r1594717462"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29521"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1594717462"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "(IMO it's slightly cleaner to split the test into `--ipv4` and `--ipv6` variants similar to `rpc_bind.py`, that way it becomes explicit whether that part of the test coverage is being skipped or not. This being more of a parsing-test, I guess it is not on the critical end of the spectrum. Also it's just a minor part of `interface_bitcoin_cli.py` so I completely understand the resistance to breaking it out).",
      "commit_id" : "b331a607e474b0313efe11542d8eb817b2b3bfc7",
      "created_at" : "2024-05-08T21:34:17Z",
      "diff_hunk" : "@@ -107,6 +109,51 @@ def run_test(self):\n         self.log.info(\"Test connecting to a non-existing server\")\n         assert_raises_process_error(1, \"Could not connect to the server\", self.nodes[0].cli('-rpcport=1').echo)\n \n+        self.log.info(\"Test handling of invalid ports in rpcconnect\")\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcconnect: 127.0.0.1:notaport\", self.nodes[0].cli(\"-rpcconnect=127.0.0.1:notaport\").echo)\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcconnect: 127.0.0.1:-1\", self.nodes[0].cli(\"-rpcconnect=127.0.0.1:-1\").echo)\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcconnect: 127.0.0.1:0\", self.nodes[0].cli(\"-rpcconnect=127.0.0.1:0\").echo)\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcconnect: 127.0.0.1:65536\", self.nodes[0].cli(\"-rpcconnect=127.0.0.1:65536\").echo)\n+\n+        self.log.info(\"Check for ipv6\")\n+        have_ipv6 = test_ipv6_local()",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29521#discussion_r1594717462",
      "id" : 1594717462,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585fDXUW",
      "original_commit_id" : "867a673bcfd3ca254c306d8cf0c68d4ceb163f97",
      "original_line" : 119,
      "original_position" : 27,
      "original_start_line" : 118,
      "path" : "test/functional/interface_bitcoin_cli.py",
      "position" : null,
      "pull_request_review_id" : 2046768298,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29521",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1594717462/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2024-05-08T22:33:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1594717462",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/581308?v=4",
         "events_url" : "https://api.github.com/users/cbergqvist/events{/privacy}",
         "followers_url" : "https://api.github.com/users/cbergqvist/followers",
         "following_url" : "https://api.github.com/users/cbergqvist/following{/other_user}",
         "gists_url" : "https://api.github.com/users/cbergqvist/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/cbergqvist",
         "id" : 581308,
         "login" : "cbergqvist",
         "node_id" : "MDQ6VXNlcjU4MTMwOA==",
         "organizations_url" : "https://api.github.com/users/cbergqvist/orgs",
         "received_events_url" : "https://api.github.com/users/cbergqvist/received_events",
         "repos_url" : "https://api.github.com/users/cbergqvist/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/cbergqvist/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/cbergqvist/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/cbergqvist"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29521#discussion_r1597779699"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29521"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1597779699"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks @cbergqvist.  Good observation.\r\n\r\nLooks like rpc_bind.py uses `--ipv4` and `--ipv6` arguments to run the test exclusively with ipv4 or ipv6 (not both), which at first glance doesn't seem to be desirable for interface_bitcoin_cli.py (dependence on network type is a somewhat small part of the test).  I could see there being value in refactoring interface_bitcoin_cli.py to include wider coverage of bitcoin-cli with ipv4 and ipv6, but I'm thinking this sort of refactor would be a good follow-up PR rather than included in the scope of this PR.\r\n\r\nIn the interim, I did push a minor update to add a log message stating when ipv6 testing is being skipped (and also opportunistically rebased).",
      "commit_id" : "b331a607e474b0313efe11542d8eb817b2b3bfc7",
      "created_at" : "2024-05-13T01:31:52Z",
      "diff_hunk" : "@@ -107,6 +109,51 @@ def run_test(self):\n         self.log.info(\"Test connecting to a non-existing server\")\n         assert_raises_process_error(1, \"Could not connect to the server\", self.nodes[0].cli('-rpcport=1').echo)\n \n+        self.log.info(\"Test handling of invalid ports in rpcconnect\")\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcconnect: 127.0.0.1:notaport\", self.nodes[0].cli(\"-rpcconnect=127.0.0.1:notaport\").echo)\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcconnect: 127.0.0.1:-1\", self.nodes[0].cli(\"-rpcconnect=127.0.0.1:-1\").echo)\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcconnect: 127.0.0.1:0\", self.nodes[0].cli(\"-rpcconnect=127.0.0.1:0\").echo)\n+        assert_raises_process_error(1, \"Invalid port provided in -rpcconnect: 127.0.0.1:65536\", self.nodes[0].cli(\"-rpcconnect=127.0.0.1:65536\").echo)\n+\n+        self.log.info(\"Check for ipv6\")\n+        have_ipv6 = test_ipv6_local()",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29521#discussion_r1597779699",
      "id" : 1597779699,
      "in_reply_to_id" : 1594717462,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585fPC7z",
      "original_commit_id" : "867a673bcfd3ca254c306d8cf0c68d4ceb163f97",
      "original_line" : 119,
      "original_position" : 27,
      "original_start_line" : 118,
      "path" : "test/functional/interface_bitcoin_cli.py",
      "position" : null,
      "pull_request_review_id" : 2051547403,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29521",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1597779699/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2024-05-13T01:31:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1597779699",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/106488469?v=4",
         "events_url" : "https://api.github.com/users/tdb3/events{/privacy}",
         "followers_url" : "https://api.github.com/users/tdb3/followers",
         "following_url" : "https://api.github.com/users/tdb3/following{/other_user}",
         "gists_url" : "https://api.github.com/users/tdb3/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/tdb3",
         "id" : 106488469,
         "login" : "tdb3",
         "node_id" : "U_kgDOBljilQ",
         "organizations_url" : "https://api.github.com/users/tdb3/orgs",
         "received_events_url" : "https://api.github.com/users/tdb3/received_events",
         "repos_url" : "https://api.github.com/users/tdb3/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/tdb3/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/tdb3/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/tdb3"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Seeing a CI error for arm-linux-gnueabihf-g++ (on a line unchanged in this latest push).  Will look into this.\r\n\r\n```\r\nIn function âUniValue CallRPC(BaseRequestHandler*, const std::string&, const std::vector<std::__cxx11::basic_string<char> >&, const std::optional<std::__cxx11::basic_string<char> >&)â,\r\n    inlined from âUniValue ConnectAndCallRPC(BaseRequestHandler*, const std::string&, const std::vector<std::__cxx11::basic_string<char> >&, const std::optional<std::__cxx11::basic_string<char> >&)â at bitcoin-cli.cpp:908:31:\r\nbitcoin-cli.cpp:764:42: error: âresultâ may be used uninitialized [-Werror=maybe-uninitialized]\r\n  764 |             if (!rpcport_int.has_value() || rpcport_int.value() == 0) {\r\n      |                 ~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~\r\nIn file included from bitcoin-cli.cpp:23:\r\n./util/strencodings.h: In function âUniValue ConnectAndCallRPC(BaseRequestHandler*, const std::string&, const std::vector<std::__cxx11::basic_string<char> >&, const std::optional<std::__cxx11::basic_string<char> >&)â:\r\n./util/strencodings.h:184:7: note: âresultâ was declared here\r\n  184 |     T result;\r\n      |       ^~~~~~\r\ncc1plus: all warnings being treated as errors\r\n```",
      "created_at" : "2024-05-13T02:40:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29521#issuecomment-2106531828",
      "id" : 2106531828,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29521",
      "node_id" : "IC_kwDOABII5859jx_0",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 1,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2106531828/reactions"
      },
      "updated_at" : "2024-05-13T02:40:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2106531828",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/106488469?v=4",
         "events_url" : "https://api.github.com/users/tdb3/events{/privacy}",
         "followers_url" : "https://api.github.com/users/tdb3/followers",
         "following_url" : "https://api.github.com/users/tdb3/following{/other_user}",
         "gists_url" : "https://api.github.com/users/tdb3/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/tdb3",
         "id" : 106488469,
         "login" : "tdb3",
         "node_id" : "U_kgDOBljilQ",
         "organizations_url" : "https://api.github.com/users/tdb3/orgs",
         "received_events_url" : "https://api.github.com/users/tdb3/received_events",
         "repos_url" : "https://api.github.com/users/tdb3/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/tdb3/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/tdb3/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/tdb3"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--85328a0da195eb286784d51f73fa0af9-->\n\nð§ At least one of the CI tasks failed. Make sure to run all tests locally, according to the\ndocumentation.\n\nPossibly this is due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n<sub>Debug: https://github.com/bitcoin/bitcoin/runs/24877615319</sub>",
      "created_at" : "2024-05-13T02:53:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29521#issuecomment-2106542236",
      "id" : 2106542236,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29521",
      "node_id" : "IC_kwDOABII5859j0ic",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2106542236/reactions"
      },
      "updated_at" : "2024-05-13T02:53:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2106542236",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29521#discussion_r1597970957"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29521"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1597970957"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```suggestion\r\n            port=ToIntegral<uint16_t>(rpcport_arg).value_or(0);\r\n            if (port == 0) {\r\n```\r\n\r\nif you treat `0` as invalid, there is no need to also have nullopt be invalid as well, no?\r\n\r\nThis should also fix the false-positive compiler warning?\r\n\r\nAn alternative would be to suppress the false-positive warning in the CI task config.",
      "commit_id" : "b331a607e474b0313efe11542d8eb817b2b3bfc7",
      "created_at" : "2024-05-13T07:03:25Z",
      "diff_hunk" : "@@ -743,8 +743,41 @@ static UniValue CallRPC(BaseRequestHandler* rh, const std::string& strMethod, co\n     //     2. port in -rpcconnect (ie following : in ipv4 or ]: in ipv6)\n     //     3. default port for chain\n     uint16_t port{BaseParams().RPCPort()};\n-    SplitHostPort(gArgs.GetArg(\"-rpcconnect\", DEFAULT_RPCCONNECT), port, host);\n-    port = static_cast<uint16_t>(gArgs.GetIntArg(\"-rpcport\", port));\n+    {\n+        uint16_t rpcconnect_port{0};\n+        const std::string rpcconnect_str = gArgs.GetArg(\"-rpcconnect\", DEFAULT_RPCCONNECT);\n+        if (!SplitHostPort(rpcconnect_str, rpcconnect_port, host)) {\n+            // Uses argument provided as-is\n+            // (rather than value parsed)\n+            // to aid the user in troubleshooting\n+            throw std::runtime_error(strprintf(\"Invalid port provided in -rpcconnect: %s\", rpcconnect_str));\n+        } else {\n+            if (rpcconnect_port != 0) {\n+                // Use the valid port provided in rpcconnect\n+                port = rpcconnect_port;\n+            } // else, no port was provided in rpcconnect (continue using default one)\n+        }\n+\n+        if (std::optional<std::string> rpcport_arg = gArgs.GetArg(\"-rpcport\")) {\n+            // -rpcport was specified\n+            std::optional<uint16_t> rpcport_int{ToIntegral<uint16_t>(rpcport_arg.value())};\n+            if (!rpcport_int.has_value() || rpcport_int.value() == 0) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29521#discussion_r1597970957",
      "id" : 1597970957,
      "line" : 764,
      "node_id" : "PRRC_kwDOABII585fPxoN",
      "original_commit_id" : "b331a607e474b0313efe11542d8eb817b2b3bfc7",
      "original_line" : 764,
      "original_position" : 24,
      "original_start_line" : 763,
      "path" : "src/bitcoin-cli.cpp",
      "position" : 24,
      "pull_request_review_id" : 2051853237,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29521",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1597970957/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 763,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2024-05-13T12:58:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1597970957",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29521#discussion_r1598426841"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29521"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1598426841"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "`ToIntegral` itself returns a `std::optional` unfortunately so the suggested change won't compile as is Super-weird that this error popped up now.",
      "commit_id" : "b331a607e474b0313efe11542d8eb817b2b3bfc7",
      "created_at" : "2024-05-13T12:52:10Z",
      "diff_hunk" : "@@ -743,8 +743,41 @@ static UniValue CallRPC(BaseRequestHandler* rh, const std::string& strMethod, co\n     //     2. port in -rpcconnect (ie following : in ipv4 or ]: in ipv6)\n     //     3. default port for chain\n     uint16_t port{BaseParams().RPCPort()};\n-    SplitHostPort(gArgs.GetArg(\"-rpcconnect\", DEFAULT_RPCCONNECT), port, host);\n-    port = static_cast<uint16_t>(gArgs.GetIntArg(\"-rpcport\", port));\n+    {\n+        uint16_t rpcconnect_port{0};\n+        const std::string rpcconnect_str = gArgs.GetArg(\"-rpcconnect\", DEFAULT_RPCCONNECT);\n+        if (!SplitHostPort(rpcconnect_str, rpcconnect_port, host)) {\n+            // Uses argument provided as-is\n+            // (rather than value parsed)\n+            // to aid the user in troubleshooting\n+            throw std::runtime_error(strprintf(\"Invalid port provided in -rpcconnect: %s\", rpcconnect_str));\n+        } else {\n+            if (rpcconnect_port != 0) {\n+                // Use the valid port provided in rpcconnect\n+                port = rpcconnect_port;\n+            } // else, no port was provided in rpcconnect (continue using default one)\n+        }\n+\n+        if (std::optional<std::string> rpcport_arg = gArgs.GetArg(\"-rpcport\")) {\n+            // -rpcport was specified\n+            std::optional<uint16_t> rpcport_int{ToIntegral<uint16_t>(rpcport_arg.value())};\n+            if (!rpcport_int.has_value() || rpcport_int.value() == 0) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29521#discussion_r1598426841",
      "id" : 1598426841,
      "in_reply_to_id" : 1597970957,
      "line" : 764,
      "node_id" : "PRRC_kwDOABII585fRg7Z",
      "original_commit_id" : "b331a607e474b0313efe11542d8eb817b2b3bfc7",
      "original_line" : 764,
      "original_position" : 24,
      "original_start_line" : 763,
      "path" : "src/bitcoin-cli.cpp",
      "position" : 24,
      "pull_request_review_id" : 2052613067,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29521",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1598426841/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 763,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2024-05-13T12:52:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1598426841",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/581308?v=4",
         "events_url" : "https://api.github.com/users/cbergqvist/events{/privacy}",
         "followers_url" : "https://api.github.com/users/cbergqvist/followers",
         "following_url" : "https://api.github.com/users/cbergqvist/following{/other_user}",
         "gists_url" : "https://api.github.com/users/cbergqvist/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/cbergqvist",
         "id" : 581308,
         "login" : "cbergqvist",
         "node_id" : "MDQ6VXNlcjU4MTMwOA==",
         "organizations_url" : "https://api.github.com/users/cbergqvist/orgs",
         "received_events_url" : "https://api.github.com/users/cbergqvist/received_events",
         "repos_url" : "https://api.github.com/users/cbergqvist/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/cbergqvist/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/cbergqvist/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/cbergqvist"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29521#discussion_r1598437856"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29521"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1598437856"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I placed the `)` in the wrong place, I think. However, `value_or` exists and should be compile-able. See https://en.cppreference.com/w/cpp/utility/optional/value_or",
      "commit_id" : "b331a607e474b0313efe11542d8eb817b2b3bfc7",
      "created_at" : "2024-05-13T12:59:35Z",
      "diff_hunk" : "@@ -743,8 +743,41 @@ static UniValue CallRPC(BaseRequestHandler* rh, const std::string& strMethod, co\n     //     2. port in -rpcconnect (ie following : in ipv4 or ]: in ipv6)\n     //     3. default port for chain\n     uint16_t port{BaseParams().RPCPort()};\n-    SplitHostPort(gArgs.GetArg(\"-rpcconnect\", DEFAULT_RPCCONNECT), port, host);\n-    port = static_cast<uint16_t>(gArgs.GetIntArg(\"-rpcport\", port));\n+    {\n+        uint16_t rpcconnect_port{0};\n+        const std::string rpcconnect_str = gArgs.GetArg(\"-rpcconnect\", DEFAULT_RPCCONNECT);\n+        if (!SplitHostPort(rpcconnect_str, rpcconnect_port, host)) {\n+            // Uses argument provided as-is\n+            // (rather than value parsed)\n+            // to aid the user in troubleshooting\n+            throw std::runtime_error(strprintf(\"Invalid port provided in -rpcconnect: %s\", rpcconnect_str));\n+        } else {\n+            if (rpcconnect_port != 0) {\n+                // Use the valid port provided in rpcconnect\n+                port = rpcconnect_port;\n+            } // else, no port was provided in rpcconnect (continue using default one)\n+        }\n+\n+        if (std::optional<std::string> rpcport_arg = gArgs.GetArg(\"-rpcport\")) {\n+            // -rpcport was specified\n+            std::optional<uint16_t> rpcport_int{ToIntegral<uint16_t>(rpcport_arg.value())};\n+            if (!rpcport_int.has_value() || rpcport_int.value() == 0) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29521#discussion_r1598437856",
      "id" : 1598437856,
      "in_reply_to_id" : 1597970957,
      "line" : 764,
      "node_id" : "PRRC_kwDOABII585fRjng",
      "original_commit_id" : "b331a607e474b0313efe11542d8eb817b2b3bfc7",
      "original_line" : 764,
      "original_position" : 24,
      "original_start_line" : 763,
      "path" : "src/bitcoin-cli.cpp",
      "position" : 24,
      "pull_request_review_id" : 2052630605,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29521",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1598437856/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 763,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2024-05-13T12:59:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1598437856",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29521#discussion_r1598472302"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29521"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1598472302"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Yeah, that new version should work. Another possible variant.. but no way to know if the compiler becomes happier:\r\n```suggestion\r\n            const uint16_t rpcport_int{ToIntegral<uint16_t>(rpcport_arg.value()).value_or(0)};\r\n            if (rpcport_int == 0) {\r\n```",
      "commit_id" : "b331a607e474b0313efe11542d8eb817b2b3bfc7",
      "created_at" : "2024-05-13T13:23:54Z",
      "diff_hunk" : "@@ -743,8 +743,41 @@ static UniValue CallRPC(BaseRequestHandler* rh, const std::string& strMethod, co\n     //     2. port in -rpcconnect (ie following : in ipv4 or ]: in ipv6)\n     //     3. default port for chain\n     uint16_t port{BaseParams().RPCPort()};\n-    SplitHostPort(gArgs.GetArg(\"-rpcconnect\", DEFAULT_RPCCONNECT), port, host);\n-    port = static_cast<uint16_t>(gArgs.GetIntArg(\"-rpcport\", port));\n+    {\n+        uint16_t rpcconnect_port{0};\n+        const std::string rpcconnect_str = gArgs.GetArg(\"-rpcconnect\", DEFAULT_RPCCONNECT);\n+        if (!SplitHostPort(rpcconnect_str, rpcconnect_port, host)) {\n+            // Uses argument provided as-is\n+            // (rather than value parsed)\n+            // to aid the user in troubleshooting\n+            throw std::runtime_error(strprintf(\"Invalid port provided in -rpcconnect: %s\", rpcconnect_str));\n+        } else {\n+            if (rpcconnect_port != 0) {\n+                // Use the valid port provided in rpcconnect\n+                port = rpcconnect_port;\n+            } // else, no port was provided in rpcconnect (continue using default one)\n+        }\n+\n+        if (std::optional<std::string> rpcport_arg = gArgs.GetArg(\"-rpcport\")) {\n+            // -rpcport was specified\n+            std::optional<uint16_t> rpcport_int{ToIntegral<uint16_t>(rpcport_arg.value())};\n+            if (!rpcport_int.has_value() || rpcport_int.value() == 0) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29521#discussion_r1598472302",
      "id" : 1598472302,
      "in_reply_to_id" : 1597970957,
      "line" : 764,
      "node_id" : "PRRC_kwDOABII585fRsBu",
      "original_commit_id" : "b331a607e474b0313efe11542d8eb817b2b3bfc7",
      "original_line" : 764,
      "original_position" : 24,
      "original_start_line" : 763,
      "path" : "src/bitcoin-cli.cpp",
      "position" : 24,
      "pull_request_review_id" : 2052696239,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29521",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1598472302/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 763,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2024-05-13T13:23:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1598472302",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/581308?v=4",
         "events_url" : "https://api.github.com/users/cbergqvist/events{/privacy}",
         "followers_url" : "https://api.github.com/users/cbergqvist/followers",
         "following_url" : "https://api.github.com/users/cbergqvist/following{/other_user}",
         "gists_url" : "https://api.github.com/users/cbergqvist/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/cbergqvist",
         "id" : 581308,
         "login" : "cbergqvist",
         "node_id" : "MDQ6VXNlcjU4MTMwOA==",
         "organizations_url" : "https://api.github.com/users/cbergqvist/orgs",
         "received_events_url" : "https://api.github.com/users/cbergqvist/received_events",
         "repos_url" : "https://api.github.com/users/cbergqvist/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/cbergqvist/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/cbergqvist/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/cbergqvist"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29521#discussion_r1598483565"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29521"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1598483565"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> no way to know if the compiler becomes happier:\r\n\r\nIf it compiles locally, the code should be fine. If the CI warning persists, it should be disabled in the CI task config. (you can test by pushing, or running locally)",
      "commit_id" : "b331a607e474b0313efe11542d8eb817b2b3bfc7",
      "created_at" : "2024-05-13T13:30:55Z",
      "diff_hunk" : "@@ -743,8 +743,41 @@ static UniValue CallRPC(BaseRequestHandler* rh, const std::string& strMethod, co\n     //     2. port in -rpcconnect (ie following : in ipv4 or ]: in ipv6)\n     //     3. default port for chain\n     uint16_t port{BaseParams().RPCPort()};\n-    SplitHostPort(gArgs.GetArg(\"-rpcconnect\", DEFAULT_RPCCONNECT), port, host);\n-    port = static_cast<uint16_t>(gArgs.GetIntArg(\"-rpcport\", port));\n+    {\n+        uint16_t rpcconnect_port{0};\n+        const std::string rpcconnect_str = gArgs.GetArg(\"-rpcconnect\", DEFAULT_RPCCONNECT);\n+        if (!SplitHostPort(rpcconnect_str, rpcconnect_port, host)) {\n+            // Uses argument provided as-is\n+            // (rather than value parsed)\n+            // to aid the user in troubleshooting\n+            throw std::runtime_error(strprintf(\"Invalid port provided in -rpcconnect: %s\", rpcconnect_str));\n+        } else {\n+            if (rpcconnect_port != 0) {\n+                // Use the valid port provided in rpcconnect\n+                port = rpcconnect_port;\n+            } // else, no port was provided in rpcconnect (continue using default one)\n+        }\n+\n+        if (std::optional<std::string> rpcport_arg = gArgs.GetArg(\"-rpcport\")) {\n+            // -rpcport was specified\n+            std::optional<uint16_t> rpcport_int{ToIntegral<uint16_t>(rpcport_arg.value())};\n+            if (!rpcport_int.has_value() || rpcport_int.value() == 0) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29521#discussion_r1598483565",
      "id" : 1598483565,
      "in_reply_to_id" : 1597970957,
      "line" : 764,
      "node_id" : "PRRC_kwDOABII585fRuxt",
      "original_commit_id" : "b331a607e474b0313efe11542d8eb817b2b3bfc7",
      "original_line" : 764,
      "original_position" : 24,
      "original_start_line" : 763,
      "path" : "src/bitcoin-cli.cpp",
      "position" : 24,
      "pull_request_review_id" : 2052716612,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29521",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1598483565/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 763,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2024-05-13T13:30:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1598483565",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29521#discussion_r1598738005"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29521"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1598738005"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks all for the suggestions. Pushed an update.\r\nSince locally I have x86_64 (and not arm), I tried configuring/compiling with `--enable-werror` added to `./configure` (to minimize excess CI churn).  Interestingly enough, this didn't result in the same warning as seen on arm CI.",
      "commit_id" : "24bc46c83b39149f4845a575a82337eb46d91bdb",
      "created_at" : "2024-05-13T16:21:24Z",
      "diff_hunk" : "@@ -743,8 +743,41 @@ static UniValue CallRPC(BaseRequestHandler* rh, const std::string& strMethod, co\n     //     2. port in -rpcconnect (ie following : in ipv4 or ]: in ipv6)\n     //     3. default port for chain\n     uint16_t port{BaseParams().RPCPort()};\n-    SplitHostPort(gArgs.GetArg(\"-rpcconnect\", DEFAULT_RPCCONNECT), port, host);\n-    port = static_cast<uint16_t>(gArgs.GetIntArg(\"-rpcport\", port));\n+    {\n+        uint16_t rpcconnect_port{0};\n+        const std::string rpcconnect_str = gArgs.GetArg(\"-rpcconnect\", DEFAULT_RPCCONNECT);\n+        if (!SplitHostPort(rpcconnect_str, rpcconnect_port, host)) {\n+            // Uses argument provided as-is\n+            // (rather than value parsed)\n+            // to aid the user in troubleshooting\n+            throw std::runtime_error(strprintf(\"Invalid port provided in -rpcconnect: %s\", rpcconnect_str));\n+        } else {\n+            if (rpcconnect_port != 0) {\n+                // Use the valid port provided in rpcconnect\n+                port = rpcconnect_port;\n+            } // else, no port was provided in rpcconnect (continue using default one)\n+        }\n+\n+        if (std::optional<std::string> rpcport_arg = gArgs.GetArg(\"-rpcport\")) {\n+            // -rpcport was specified\n+            std::optional<uint16_t> rpcport_int{ToIntegral<uint16_t>(rpcport_arg.value())};\n+            if (!rpcport_int.has_value() || rpcport_int.value() == 0) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29521#discussion_r1598738005",
      "id" : 1598738005,
      "in_reply_to_id" : 1597970957,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585fSs5V",
      "original_commit_id" : "b331a607e474b0313efe11542d8eb817b2b3bfc7",
      "original_line" : 764,
      "original_position" : 24,
      "original_start_line" : 763,
      "path" : "src/bitcoin-cli.cpp",
      "position" : null,
      "pull_request_review_id" : 2053161508,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29521",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1598738005/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2024-05-13T16:21:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1598738005",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/106488469?v=4",
         "events_url" : "https://api.github.com/users/tdb3/events{/privacy}",
         "followers_url" : "https://api.github.com/users/tdb3/followers",
         "following_url" : "https://api.github.com/users/tdb3/following{/other_user}",
         "gists_url" : "https://api.github.com/users/tdb3/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/tdb3",
         "id" : 106488469,
         "login" : "tdb3",
         "node_id" : "U_kgDOBljilQ",
         "organizations_url" : "https://api.github.com/users/tdb3/orgs",
         "received_events_url" : "https://api.github.com/users/tdb3/received_events",
         "repos_url" : "https://api.github.com/users/tdb3/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/tdb3/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/tdb3/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/tdb3"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29521#discussion_r1599319918"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29521"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1599319918"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "No luck with the arm CI again.  Will try playing with the specific stage locally more (https://github.com/bitcoin/bitcoin/tree/master/ci).",
      "commit_id" : "24bc46c83b39149f4845a575a82337eb46d91bdb",
      "created_at" : "2024-05-14T03:12:48Z",
      "diff_hunk" : "@@ -743,8 +743,41 @@ static UniValue CallRPC(BaseRequestHandler* rh, const std::string& strMethod, co\n     //     2. port in -rpcconnect (ie following : in ipv4 or ]: in ipv6)\n     //     3. default port for chain\n     uint16_t port{BaseParams().RPCPort()};\n-    SplitHostPort(gArgs.GetArg(\"-rpcconnect\", DEFAULT_RPCCONNECT), port, host);\n-    port = static_cast<uint16_t>(gArgs.GetIntArg(\"-rpcport\", port));\n+    {\n+        uint16_t rpcconnect_port{0};\n+        const std::string rpcconnect_str = gArgs.GetArg(\"-rpcconnect\", DEFAULT_RPCCONNECT);\n+        if (!SplitHostPort(rpcconnect_str, rpcconnect_port, host)) {\n+            // Uses argument provided as-is\n+            // (rather than value parsed)\n+            // to aid the user in troubleshooting\n+            throw std::runtime_error(strprintf(\"Invalid port provided in -rpcconnect: %s\", rpcconnect_str));\n+        } else {\n+            if (rpcconnect_port != 0) {\n+                // Use the valid port provided in rpcconnect\n+                port = rpcconnect_port;\n+            } // else, no port was provided in rpcconnect (continue using default one)\n+        }\n+\n+        if (std::optional<std::string> rpcport_arg = gArgs.GetArg(\"-rpcport\")) {\n+            // -rpcport was specified\n+            std::optional<uint16_t> rpcport_int{ToIntegral<uint16_t>(rpcport_arg.value())};\n+            if (!rpcport_int.has_value() || rpcport_int.value() == 0) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29521#discussion_r1599319918",
      "id" : 1599319918,
      "in_reply_to_id" : 1597970957,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585fU69u",
      "original_commit_id" : "b331a607e474b0313efe11542d8eb817b2b3bfc7",
      "original_line" : 764,
      "original_position" : 24,
      "original_start_line" : 763,
      "path" : "src/bitcoin-cli.cpp",
      "position" : null,
      "pull_request_review_id" : 2054179661,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29521",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1599319918/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2024-05-14T03:13:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1599319918",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/106488469?v=4",
         "events_url" : "https://api.github.com/users/tdb3/events{/privacy}",
         "followers_url" : "https://api.github.com/users/tdb3/followers",
         "following_url" : "https://api.github.com/users/tdb3/following{/other_user}",
         "gists_url" : "https://api.github.com/users/tdb3/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/tdb3",
         "id" : 106488469,
         "login" : "tdb3",
         "node_id" : "U_kgDOBljilQ",
         "organizations_url" : "https://api.github.com/users/tdb3/orgs",
         "received_events_url" : "https://api.github.com/users/tdb3/received_events",
         "repos_url" : "https://api.github.com/users/tdb3/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/tdb3/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/tdb3/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/tdb3"
      }
   }
]
