[
   {
      "author_association" : "NONE",
      "body" : "Seems like this should solve it\r\n\r\n- `struct DatabaseOptions` in `src/wallet/db.h` needs a `writePermission` field of type `bool` with a default value of `false`\r\n- the method `Open` of class`SQLiteDatabase` in `src/wallet/sqlite.h` needs a flag argument of type `Int` added\r\n- the `SQLiteDatabase` constructor in `src/wallet/sqlite.cpp` needs to pass the flag `SQLITE_OPEN_READONLY` if `options.writePermission` is false else flag `SQLITE_OPEN_READWRITE`\r\n- in `src/wallet/wallettool.cpp` when `command ==` create, salvage, or createfromdump then `options.writePermission = true;`",
      "created_at" : "2024-03-04T20:14:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/29559#issuecomment-1977378151",
      "id" : 1977378151,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29559",
      "node_id" : "IC_kwDOABII58513GVn",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1977378151/reactions"
      },
      "updated_at" : "2024-03-04T20:14:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1977378151",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10747532?v=4",
         "events_url" : "https://api.github.com/users/BebeSparkelSparkel/events{/privacy}",
         "followers_url" : "https://api.github.com/users/BebeSparkelSparkel/followers",
         "following_url" : "https://api.github.com/users/BebeSparkelSparkel/following{/other_user}",
         "gists_url" : "https://api.github.com/users/BebeSparkelSparkel/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/BebeSparkelSparkel",
         "id" : 10747532,
         "login" : "BebeSparkelSparkel",
         "node_id" : "MDQ6VXNlcjEwNzQ3NTMy",
         "organizations_url" : "https://api.github.com/users/BebeSparkelSparkel/orgs",
         "received_events_url" : "https://api.github.com/users/BebeSparkelSparkel/received_events",
         "repos_url" : "https://api.github.com/users/BebeSparkelSparkel/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/BebeSparkelSparkel/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/BebeSparkelSparkel/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/BebeSparkelSparkel"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "I consider this permission issue is necesary to fix, and wanna contribute for it. Is it assigned for other guys or anyone is working on it right now?",
      "created_at" : "2024-03-05T09:12:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/29559#issuecomment-1978282275",
      "id" : 1978282275,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29559",
      "node_id" : "IC_kwDOABII58516jEj",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1978282275/reactions"
      },
      "updated_at" : "2024-03-05T09:12:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1978282275",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/45826386?v=4",
         "events_url" : "https://api.github.com/users/PeterWrighten/events{/privacy}",
         "followers_url" : "https://api.github.com/users/PeterWrighten/followers",
         "following_url" : "https://api.github.com/users/PeterWrighten/following{/other_user}",
         "gists_url" : "https://api.github.com/users/PeterWrighten/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/PeterWrighten",
         "id" : 45826386,
         "login" : "PeterWrighten",
         "node_id" : "MDQ6VXNlcjQ1ODI2Mzg2",
         "organizations_url" : "https://api.github.com/users/PeterWrighten/orgs",
         "received_events_url" : "https://api.github.com/users/PeterWrighten/received_events",
         "repos_url" : "https://api.github.com/users/PeterWrighten/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/PeterWrighten/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/PeterWrighten/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/PeterWrighten"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "> Seems like this should solve it\r\n> \r\n> * `struct DatabaseOptions` in `src/wallet/db.h` needs a `writePermission` field of type `bool` with a default value of `false`\r\n> * the method `Open` of class`SQLiteDatabase` in `src/wallet/sqlite.h` needs a flag argument of type `Int` added\r\n> * the `SQLiteDatabase` constructor in `src/wallet/sqlite.cpp` needs to pass the flag `SQLITE_OPEN_READONLY` if `options.writePermission` is false else flag `SQLITE_OPEN_READWRITE`\r\n> * in `src/wallet/wallettool.cpp` when `command ==` create, salvage, or createfromdump then `options.writePermission = true;`\r\n\r\nAs for me, I consider modifying the code to open write permission is actually an unsafe operation. If you just wanna access info, read-only permission seems sufficient. Perhaps there is also other issue...",
      "created_at" : "2024-03-05T09:29:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/29559#issuecomment-1978317149",
      "id" : 1978317149,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29559",
      "node_id" : "IC_kwDOABII58516rld",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1978317149/reactions"
      },
      "updated_at" : "2024-03-05T09:30:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1978317149",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/45826386?v=4",
         "events_url" : "https://api.github.com/users/PeterWrighten/events{/privacy}",
         "followers_url" : "https://api.github.com/users/PeterWrighten/followers",
         "following_url" : "https://api.github.com/users/PeterWrighten/following{/other_user}",
         "gists_url" : "https://api.github.com/users/PeterWrighten/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/PeterWrighten",
         "id" : 45826386,
         "login" : "PeterWrighten",
         "node_id" : "MDQ6VXNlcjQ1ODI2Mzg2",
         "organizations_url" : "https://api.github.com/users/PeterWrighten/orgs",
         "received_events_url" : "https://api.github.com/users/PeterWrighten/received_events",
         "repos_url" : "https://api.github.com/users/PeterWrighten/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/PeterWrighten/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/PeterWrighten/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/PeterWrighten"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "cc @achow101 \r\n\r\nIt seems like a good safety feature if commands like `bitcoin-wallet info` and `bitcoin-wallet dump` open the database in read-only mode.\r\n\r\n> Is it assigned for other guys or anyone is working on it right now?\r\n\r\nIssues are never assigned. There's no recent pull request open either. It's also not the end of the world if two people open a bug fix PR at the same time; reviewers can just pick the best solution.",
      "created_at" : "2024-03-05T10:59:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/29559#issuecomment-1978495999",
      "id" : 1978495999,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29559",
      "node_id" : "IC_kwDOABII58517XP_",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1978495999/reactions"
      },
      "updated_at" : "2024-03-05T11:00:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1978495999",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "> cc @achow101\r\n> \r\n> It seems like a good safety feature if commands like `bitcoin-wallet info` and `bitcoin-wallet dump` open the database in read-only mode.\r\n> \r\n> > Is it assigned for other guys or anyone is working on it right now?\r\n> \r\n> Issues are never assigned. There's no recent pull request open either. It's also not the end of the world if two people open a bug fix PR at the same time; reviewers can just pick the best solution.\r\n\r\nThanks! I would work on it and PR when finished it.",
      "created_at" : "2024-03-05T12:10:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/29559#issuecomment-1978622843",
      "id" : 1978622843,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29559",
      "node_id" : "IC_kwDOABII585172N7",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1978622843/reactions"
      },
      "updated_at" : "2024-03-05T12:10:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1978622843",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/45826386?v=4",
         "events_url" : "https://api.github.com/users/PeterWrighten/events{/privacy}",
         "followers_url" : "https://api.github.com/users/PeterWrighten/followers",
         "following_url" : "https://api.github.com/users/PeterWrighten/following{/other_user}",
         "gists_url" : "https://api.github.com/users/PeterWrighten/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/PeterWrighten",
         "id" : 45826386,
         "login" : "PeterWrighten",
         "node_id" : "MDQ6VXNlcjQ1ODI2Mzg2",
         "organizations_url" : "https://api.github.com/users/PeterWrighten/orgs",
         "received_events_url" : "https://api.github.com/users/PeterWrighten/received_events",
         "repos_url" : "https://api.github.com/users/PeterWrighten/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/PeterWrighten/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/PeterWrighten/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/PeterWrighten"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "This has been something I've looked at before, and it ended up being somewhat complicated and I didn't have the time to try to properly fix. Even if you can open the databases in readonly mode, you'd still have to make sure that nothing in the call stack is attempting to write the database. There are a couple of places during wallet loading where writes are actually made, and those might fail with a crash, or fail silently, both of which we don't want to happen.\r\n\r\nAlso, we have two database types, and both need to be passed the correct flags to open as readonly.",
      "created_at" : "2024-03-05T17:11:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/29559#issuecomment-1979250670",
      "id" : 1979250670,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29559",
      "node_id" : "IC_kwDOABII5851-Pfu",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1979250670/reactions"
      },
      "updated_at" : "2024-03-05T17:12:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1979250670",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "@PeterWrighten I have made some modifications but do not know c++ well enough to diagnose where sqlite is requiring write permissions. \r\n\r\nhttps://github.com/BebeSparkelSparkel/bitcoin/tree/readonly-db",
      "created_at" : "2024-03-06T17:19:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/29559#issuecomment-1981392632",
      "id" : 1981392632,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29559",
      "node_id" : "IC_kwDOABII5852Gab4",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1981392632/reactions"
      },
      "updated_at" : "2024-03-06T17:19:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1981392632",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10747532?v=4",
         "events_url" : "https://api.github.com/users/BebeSparkelSparkel/events{/privacy}",
         "followers_url" : "https://api.github.com/users/BebeSparkelSparkel/followers",
         "following_url" : "https://api.github.com/users/BebeSparkelSparkel/following{/other_user}",
         "gists_url" : "https://api.github.com/users/BebeSparkelSparkel/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/BebeSparkelSparkel",
         "id" : 10747532,
         "login" : "BebeSparkelSparkel",
         "node_id" : "MDQ6VXNlcjEwNzQ3NTMy",
         "organizations_url" : "https://api.github.com/users/BebeSparkelSparkel/orgs",
         "received_events_url" : "https://api.github.com/users/BebeSparkelSparkel/received_events",
         "repos_url" : "https://api.github.com/users/BebeSparkelSparkel/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/BebeSparkelSparkel/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/BebeSparkelSparkel/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/BebeSparkelSparkel"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "> @PeterWrighten I have made some modifications but do not know c++ well enough to diagnose where sqlite is requiring write permissions. \n> \n> \n> \n> https://github.com/BebeSparkelSparkel/bitcoin/tree/readonly-db\n\nSeems good for sqlite db. But I consider adding permissions in DatabaseOptions is not a good idea. Perhaps adding an OpenReadOnly() Function in SqliteDatabase is better.",
      "created_at" : "2024-03-06T20:14:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/29559#issuecomment-1981705437",
      "id" : 1981705437,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29559",
      "node_id" : "IC_kwDOABII5852Hmzd",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1981705437/reactions"
      },
      "updated_at" : "2024-03-06T20:24:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1981705437",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/45826386?v=4",
         "events_url" : "https://api.github.com/users/PeterWrighten/events{/privacy}",
         "followers_url" : "https://api.github.com/users/PeterWrighten/followers",
         "following_url" : "https://api.github.com/users/PeterWrighten/following{/other_user}",
         "gists_url" : "https://api.github.com/users/PeterWrighten/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/PeterWrighten",
         "id" : 45826386,
         "login" : "PeterWrighten",
         "node_id" : "MDQ6VXNlcjQ1ODI2Mzg2",
         "organizations_url" : "https://api.github.com/users/PeterWrighten/orgs",
         "received_events_url" : "https://api.github.com/users/PeterWrighten/received_events",
         "repos_url" : "https://api.github.com/users/PeterWrighten/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/PeterWrighten/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/PeterWrighten/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/PeterWrighten"
      }
   }
]
