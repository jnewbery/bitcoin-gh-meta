{
   "active_lock_reason" : null,
   "assignee" : null,
   "assignees" : [],
   "author_association" : "MEMBER",
   "body" : "Looking at libc sources, apple and openbsd implementations match our naive fallback. Only FreeBSD (and only x86_64) seems to [implement an optimized version](https://github.com/freebsd/freebsd-src/blob/main/lib/libc/amd64/string/timingsafe_bcmp.S).\r\n\r\nIt's not worth the hassle of using a platform-specific function for such little gain.\r\n\r\nAdditionally, as mentioned below, this is the only case outside of sha2 that requires an autoconf check, and I have upcoming PRs to remove the sha2 ones.\r\n\r\n\r\nApple's [impl is unoptimized](https://opensource.apple.com/source/Libc/Libc-1244.1.7/string/FreeBSD/timingsafe_bcmp.c.auto.html).\r\n\r\nAs-is [OpenBSD's impl](https://github.com/openbsd/src/blob/master/lib/libc/string/timingsafe_bcmp.c).\r\n\r\nRelevant IRC conversation with sipa:\r\n\r\n\r\n> \\<cfields\\> sipa: chacha20poly1305.cpp uses libc's timingsafe_bcmp when possible. But looking around at apple/freebsd/openbsd, I don't see any impl that doesn't use the naive implementation that matches our fallback...\r\n> \\<cfields\\> is there any reason to belive there's an optimized impl somewhere that we're actually hitting?\r\n> \\<cfields\\> asking because after cleaning up sha2, timingsafe_bcmp is the last autoconf check that remains in all of crypto. It'd make life easy if we could just always use our internal one.\r\n> \\<cfields\\> *all of crypto/\r\n> \\<sipa\\> cfields: let's get rid of the dependency then\r\n> \\<sipa\\> it's a trivial function\r\n> \\<sipa\\> and if we need it for some platforms, no real reason not to use it on all\r\n\r\nAfter the above discusstion, I did end up finding the x86_64-optimized FreeBSD impl, but I don't think that's all that significant.",
   "closed_at" : null,
   "closed_by" : null,
   "comments" : 5,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29815/comments",
   "created_at" : "2024-04-05T16:06:32Z",
   "draft" : false,
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29815/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/pull/29815",
   "id" : 2228379294,
   "labels" : [
      {
         "color" : "5319e7",
         "default" : false,
         "description" : "",
         "id" : 241832923,
         "name" : "Utils/log/libs",
         "node_id" : "MDU6TGFiZWwyNDE4MzI5MjM=",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Utils/log/libs"
      }
   ],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29815/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "node_id" : "PR_kwDOABII585r3Rye",
   "number" : 29815,
   "performed_via_github_app" : null,
   "pull_request" : {
      "diff_url" : "https://github.com/bitcoin/bitcoin/pull/29815.diff",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29815",
      "merged_at" : null,
      "patch_url" : "https://github.com/bitcoin/bitcoin/pull/29815.patch",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29815"
   },
   "reactions" : {
      "+1" : 0,
      "-1" : 0,
      "confused" : 0,
      "eyes" : 0,
      "heart" : 0,
      "hooray" : 0,
      "laugh" : 0,
      "rocket" : 0,
      "total_count" : 0,
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29815/reactions"
   },
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "open",
   "state_reason" : null,
   "timeline_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29815/timeline",
   "title" : "crypto: chacha20: always use our fallback timingsafe_bcmp rather than libc's",
   "updated_at" : "2024-04-05T17:45:52Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29815",
   "user" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=4",
      "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
      "followers_url" : "https://api.github.com/users/theuni/followers",
      "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/theuni",
      "id" : 417043,
      "login" : "theuni",
      "node_id" : "MDQ6VXNlcjQxNzA0Mw==",
      "organizations_url" : "https://api.github.com/users/theuni/orgs",
      "received_events_url" : "https://api.github.com/users/theuni/received_events",
      "repos_url" : "https://api.github.com/users/theuni/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/theuni"
   }
}
