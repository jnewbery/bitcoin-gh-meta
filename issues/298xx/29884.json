{
   "active_lock_reason" : null,
   "assignee" : null,
   "assignees" : [],
   "author_association" : "MEMBER",
   "body" : "While testing bitcoin/bitcoin#29484, which seems not related to this bug, I've notice the following failure:\r\n```\r\n$ ./autogen.sh\r\n$ ./configure\r\n$ gmake -C src test/test_bitcoin\r\n...\r\n  CXX      test/test_bitcoin-streams_tests.o\r\nIn file included from test/streams_tests.cpp:5:\r\n./streams.h: In instantiation of 'SpanReader& SpanReader::operator>>(T&&) [with T = signed char&]':\r\ntest/streams_tests.cpp:148:15:   required from here\r\n./streams.h:114:22: error: no matching function for call to 'Unserialize(SpanReader&, signed char&)'\r\n  114 |         ::Unserialize(*this, obj);\r\n      |         ~~~~~~~~~~~~~^~~~~~~~~~~~\r\nIn file included from ./streams.h:9:\r\n./serialize.h:284:48: note: candidate: 'template<class Stream, class V>  requires  CharNotInt8<V> void Unserialize(Stream&, V)' (deleted)\r\n  284 | template <typename Stream, CharNotInt8 V> void Unserialize(Stream&, V) = delete; // char serialization forbidden. Use uint8_t or int8_t\r\n      |                                                ^~~~~~~~~~~\r\n./serialize.h:284:48: note:   template argument deduction/substitution failed:\r\n./serialize.h:284:48: note: constraints not satisfied\r\nIn file included from /usr/gcc/13/include/c++/13.2.0/compare:37,\r\n                 from /usr/gcc/13/include/c++/13.2.0/bits/stl_pair.h:65,\r\n                 from /usr/gcc/13/include/c++/13.2.0/bits/stl_algobase.h:64,\r\n                 from /usr/gcc/13/include/c++/13.2.0/algorithm:60,\r\n                 from ./prevector.h:13,\r\n                 from ./serialize.h:12:\r\n/usr/gcc/13/include/c++/13.2.0/concepts: In substitution of 'template<class Stream, class V>  requires  CharNotInt8<V> void Unserialize(Stream&, V) [with Stream = SpanReader; V = signed char]':\r\n./streams.h:114:22:   required from 'SpanReader& SpanReader::operator>>(T&&) [with T = signed char&]'\r\ntest/streams_tests.cpp:148:15:   required from here\r\n/usr/gcc/13/include/c++/13.2.0/concepts:57:15:   required for the satisfaction of '__same_as<_Tp, _Up>' [with _Tp = signed char; _Up = char]\r\n/usr/gcc/13/include/c++/13.2.0/concepts:62:13:   required for the satisfaction of 'same_as<T, char>' [with T = signed char]\r\n./serialize.h:268:9:   required for the satisfaction of 'CharNotInt8<V>' [with V = signed char]\r\n/usr/gcc/13/include/c++/13.2.0/concepts:57:32: note: the expression 'is_same_v<_Tp, _Up> [with _Tp = signed char; _Up = char]' evaluated to 'false'\r\n   57 |       concept __same_as = std::is_same_v<_Tp, _Up>;\r\n      |                           ~~~~~^~~~~~~~~~~~~~~~~~~\r\n./streams.h: In instantiation of 'SpanReader& SpanReader::operator>>(T&&) [with T = signed char&]':\r\ntest/streams_tests.cpp:148:15:   required from here\r\n./serialize.h:285:33: note: candidate: 'template<class Stream> void Unserialize(Stream&, std::byte&)'\r\n  285 | template <typename Stream> void Unserialize(Stream& s, std::byte& a) { a = std::byte{ser_readdata8(s)}; }\r\n      |                                 ^~~~~~~~~~~\r\n./serialize.h:285:33: note:   template argument deduction/substitution failed:\r\n./streams.h:114:22: note:   cannot convert 'obj' (type 'signed char') to type 'std::byte&'\r\n  114 |         ::Unserialize(*this, obj);\r\n      |         ~~~~~~~~~~~~~^~~~~~~~~~~~\r\n./serialize.h:286:39: note: candidate: 'template<class Stream> void Unserialize(Stream&, int8_t&)'\r\n  286 | template<typename Stream> inline void Unserialize(Stream& s, int8_t& a  ) { a = ser_readdata8(s); }\r\n      |                                       ^~~~~~~~~~~\r\n./serialize.h:286:39: note:   template argument deduction/substitution failed:\r\n./streams.h:114:22: note:   cannot convert 'obj' (type 'signed char') to type 'int8_t&' {aka 'char&'}\r\n  114 |         ::Unserialize(*this, obj);\r\n      |         ~~~~~~~~~~~~~^~~~~~~~~~~~\r\n./serialize.h:287:39: note: candidate: 'template<class Stream> void Unserialize(Stream&, uint8_t&)'\r\n  287 | template<typename Stream> inline void Unserialize(Stream& s, uint8_t& a ) { a = ser_readdata8(s); }\r\n      |                                       ^~~~~~~~~~~\r\n./serialize.h:287:39: note:   template argument deduction/substitution failed:\r\n./streams.h:114:22: note:   cannot convert 'obj' (type 'signed char') to type 'uint8_t&' {aka 'unsigned char&'}\r\n  114 |         ::Unserialize(*this, obj);\r\n      |         ~~~~~~~~~~~~~^~~~~~~~~~~~\r\n./serialize.h:288:39: note: candidate: 'template<class Stream> void Unserialize(Stream&, int16_t&)'\r\n  288 | template<typename Stream> inline void Unserialize(Stream& s, int16_t& a ) { a = ser_readdata16(s); }\r\n      |                                       ^~~~~~~~~~~\r\n./serialize.h:288:39: note:   template argument deduction/substitution failed:\r\n./streams.h:114:22: note:   cannot convert 'obj' (type 'signed char') to type 'int16_t&' {aka 'short int&'}\r\n  114 |         ::Unserialize(*this, obj);\r\n      |         ~~~~~~~~~~~~~^~~~~~~~~~~~\r\n./serialize.h:289:39: note: candidate: 'template<class Stream> void Unserialize(Stream&, uint16_t&)'\r\n  289 | template<typename Stream> inline void Unserialize(Stream& s, uint16_t& a) { a = ser_readdata16(s); }\r\n      |                                       ^~~~~~~~~~~\r\n./serialize.h:289:39: note:   template argument deduction/substitution failed:\r\n./streams.h:114:22: note:   cannot convert 'obj' (type 'signed char') to type 'uint16_t&' {aka 'short unsigned int&'}\r\n  114 |         ::Unserialize(*this, obj);\r\n      |         ~~~~~~~~~~~~~^~~~~~~~~~~~\r\n./serialize.h:290:39: note: candidate: 'template<class Stream> void Unserialize(Stream&, int32_t&)'\r\n  290 | template<typename Stream> inline void Unserialize(Stream& s, int32_t& a ) { a = ser_readdata32(s); }\r\n      |                                       ^~~~~~~~~~~\r\n./serialize.h:290:39: note:   template argument deduction/substitution failed:\r\n./streams.h:114:22: note:   cannot convert 'obj' (type 'signed char') to type 'int32_t&' {aka 'int&'}\r\n  114 |         ::Unserialize(*this, obj);\r\n      |         ~~~~~~~~~~~~~^~~~~~~~~~~~\r\n./serialize.h:291:39: note: candidate: 'template<class Stream> void Unserialize(Stream&, uint32_t&)'\r\n  291 | template<typename Stream> inline void Unserialize(Stream& s, uint32_t& a) { a = ser_readdata32(s); }\r\n      |                                       ^~~~~~~~~~~\r\n./serialize.h:291:39: note:   template argument deduction/substitution failed:\r\n./streams.h:114:22: note:   cannot convert 'obj' (type 'signed char') to type 'uint32_t&' {aka 'unsigned int&'}\r\n  114 |         ::Unserialize(*this, obj);\r\n      |         ~~~~~~~~~~~~~^~~~~~~~~~~~\r\n./serialize.h:292:39: note: candidate: 'template<class Stream> void Unserialize(Stream&, int64_t&)'\r\n  292 | template<typename Stream> inline void Unserialize(Stream& s, int64_t& a ) { a = ser_readdata64(s); }\r\n      |                                       ^~~~~~~~~~~\r\n./serialize.h:292:39: note:   template argument deduction/substitution failed:\r\n./streams.h:114:22: note:   cannot convert 'obj' (type 'signed char') to type 'int64_t&' {aka 'long int&'}\r\n  114 |         ::Unserialize(*this, obj);\r\n      |         ~~~~~~~~~~~~~^~~~~~~~~~~~\r\n./serialize.h:293:39: note: candidate: 'template<class Stream> void Unserialize(Stream&, uint64_t&)'\r\n  293 | template<typename Stream> inline void Unserialize(Stream& s, uint64_t& a) { a = ser_readdata64(s); }\r\n      |                                       ^~~~~~~~~~~\r\n./serialize.h:293:39: note:   template argument deduction/substitution failed:\r\n./streams.h:114:22: note:   cannot convert 'obj' (type 'signed char') to type 'uint64_t&' {aka 'long unsigned int&'}\r\n  114 |         ::Unserialize(*this, obj);\r\n      |         ~~~~~~~~~~~~~^~~~~~~~~~~~\r\n./serialize.h:294:53: note: candidate: 'template<class Stream, class B, int N>  requires  BasicByte<B> void Unserialize(Stream&, B (&)[N])'\r\n  294 | template <typename Stream, BasicByte B, int N> void Unserialize(Stream& s, B (&a)[N]) { s.read(MakeWritableByteSpan(a)); }\r\n      |                                                     ^~~~~~~~~~~\r\n./serialize.h:294:53: note:   template argument deduction/substitution failed:\r\n./streams.h:114:22: note:   mismatched types 'B [N]' and 'signed char'\r\n  114 |         ::Unserialize(*this, obj);\r\n      |         ~~~~~~~~~~~~~^~~~~~~~~~~~\r\n./serialize.h:295:61: note: candidate: 'template<class Stream, class B, long unsigned int N>  requires  BasicByte<B> void Unserialize(Stream&, std::array<_Tp, _Nm>&)'\r\n  295 | template <typename Stream, BasicByte B, std::size_t N> void Unserialize(Stream& s, std::array<B, N>& a) { s.read(MakeWritableByteSpan(a)); }\r\n      |                                                             ^~~~~~~~~~~\r\n./serialize.h:295:61: note:   template argument deduction/substitution failed:\r\n./streams.h:114:22: note:   mismatched types 'std::array<_Tp, _Nm>' and 'signed char'\r\n  114 |         ::Unserialize(*this, obj);\r\n      |         ~~~~~~~~~~~~~^~~~~~~~~~~~\r\n./serialize.h:296:46: note: candidate: 'template<class Stream, class B>  requires  BasicByte<B> void Unserialize(Stream&, Span<O>)'\r\n  296 | template <typename Stream, BasicByte B> void Unserialize(Stream& s, Span<B> span) { s.read(AsWritableBytes(span)); }\r\n      |                                              ^~~~~~~~~~~\r\n./serialize.h:296:46: note:   template argument deduction/substitution failed:\r\n./streams.h:114:22: note:   mismatched types 'Span<O>' and 'signed char'\r\n  114 |         ::Unserialize(*this, obj);\r\n      |         ~~~~~~~~~~~~~^~~~~~~~~~~~\r\n./serialize.h:299:40: note: candidate: 'template<class Stream> void Unserialize(Stream&, bool&)'\r\n  299 | template <typename Stream> inline void Unserialize(Stream& s, bool& a) { uint8_t f = ser_readdata8(s); a = f; }\r\n      |                                        ^~~~~~~~~~~\r\n./serialize.h:299:40: note:   template argument deduction/substitution failed:\r\n./streams.h:114:22: note:   cannot convert 'obj' (type 'signed char') to type 'bool&'\r\n  114 |         ::Unserialize(*this, obj);\r\n      |         ~~~~~~~~~~~~~^~~~~~~~~~~~\r\n./serialize.h:809:6: note: candidate: 'template<class Stream, class C> void Unserialize(Stream&, std::__cxx11::basic_string<C>&)'\r\n  809 | void Unserialize(Stream& is, std::basic_string<C>& str)\r\n      |      ^~~~~~~~~~~\r\n./serialize.h:809:6: note:   template argument deduction/substitution failed:\r\n./streams.h:114:22: note:   mismatched types 'std::__cxx11::basic_string<C>' and 'signed char'\r\n  114 |         ::Unserialize(*this, obj);\r\n      |         ~~~~~~~~~~~~~^~~~~~~~~~~~\r\n./serialize.h:835:6: note: candidate: 'template<class Stream, unsigned int N, class T> void Unserialize(Stream&, prevector<N, T>&)'\r\n  835 | void Unserialize(Stream& is, prevector<N, T>& v)\r\n      |      ^~~~~~~~~~~\r\n./serialize.h:835:6: note:   template argument deduction/substitution failed:\r\n./streams.h:114:22: note:   mismatched types 'prevector<N, T>' and 'signed char'\r\n  114 |         ::Unserialize(*this, obj);\r\n      |         ~~~~~~~~~~~~~^~~~~~~~~~~~\r\n./serialize.h:878:6: note: candidate: 'template<class Stream, class T, class A> void Unserialize(Stream&, std::vector<_ValT, _Allocator>&)'\r\n  878 | void Unserialize(Stream& is, std::vector<T, A>& v)\r\n      |      ^~~~~~~~~~~\r\n./serialize.h:878:6: note:   template argument deduction/substitution failed:\r\n./streams.h:114:22: note:   mismatched types 'std::vector<_ValT, _Allocator>' and 'signed char'\r\n  114 |         ::Unserialize(*this, obj);\r\n      |         ~~~~~~~~~~~~~^~~~~~~~~~~~\r\n./serialize.h:908:6: note: candidate: 'template<class Stream, class K, class T> void Unserialize(Stream&, std::pair<_Tp1, _Tp2>&)'\r\n  908 | void Unserialize(Stream& is, std::pair<K, T>& item)\r\n      |      ^~~~~~~~~~~\r\n./serialize.h:908:6: note:   template argument deduction/substitution failed:\r\n./streams.h:114:22: note:   mismatched types 'std::pair<_Tp1, _Tp2>' and 'signed char'\r\n  114 |         ::Unserialize(*this, obj);\r\n      |         ~~~~~~~~~~~~~^~~~~~~~~~~~\r\n./serialize.h:928:6: note: candidate: 'template<class Stream, class K, class T, class Pred, class A> void Unserialize(Stream&, std::map<K, T, Pred, A>&)'\r\n  928 | void Unserialize(Stream& is, std::map<K, T, Pred, A>& m)\r\n      |      ^~~~~~~~~~~\r\n./serialize.h:928:6: note:   template argument deduction/substitution failed:\r\n./streams.h:114:22: note:   mismatched types 'std::map<K, T, Pred, A>' and 'signed char'\r\n  114 |         ::Unserialize(*this, obj);\r\n      |         ~~~~~~~~~~~~~^~~~~~~~~~~~\r\n./serialize.h:955:6: note: candidate: 'template<class Stream, class K, class Pred, class A> void Unserialize(Stream&, std::set<K, Pred, A>&)'\r\n  955 | void Unserialize(Stream& is, std::set<K, Pred, A>& m)\r\n      |      ^~~~~~~~~~~\r\n./serialize.h:955:6: note:   template argument deduction/substitution failed:\r\n./streams.h:114:22: note:   mismatched types 'std::set<K, Pred, A>' and 'signed char'\r\n  114 |         ::Unserialize(*this, obj);\r\n      |         ~~~~~~~~~~~~~^~~~~~~~~~~~\r\n./serialize.h:997:6: note: candidate: 'template<class Stream, class T> void Unserialize(Stream&, std::shared_ptr<const T>&)'\r\n  997 | void Unserialize(Stream& is, std::shared_ptr<const T>& p)\r\n      |      ^~~~~~~~~~~\r\n./serialize.h:997:6: note:   template argument deduction/substitution failed:\r\n./streams.h:114:22: note:   mismatched types 'std::shared_ptr<const T>' and 'signed char'\r\n  114 |         ::Unserialize(*this, obj);\r\n      |         ~~~~~~~~~~~~~^~~~~~~~~~~~\r\n./serialize.h:980:6: note: candidate: 'template<class Stream, class T> void Unserialize(Stream&, std::unique_ptr<const T>&)'\r\n  980 | void Unserialize(Stream& is, std::unique_ptr<const T>& p)\r\n      |      ^~~~~~~~~~~\r\n./serialize.h:980:6: note:   template argument deduction/substitution failed:\r\n./streams.h:114:22: note:   mismatched types 'std::unique_ptr<const T>' and 'signed char'\r\n  114 |         ::Unserialize(*this, obj);\r\n      |         ~~~~~~~~~~~~~^~~~~~~~~~~~\r\n./serialize.h:774:6: note: candidate: 'template<class Stream, class T>  requires  Unserializable<T, Stream> void Unserialize(Stream&, T&&)'\r\n  774 | void Unserialize(Stream& is, T&& a)\r\n      |      ^~~~~~~~~~~\r\n./serialize.h:774:6: note:   template argument deduction/substitution failed:\r\n./serialize.h:774:6: note: constraints not satisfied\r\n./serialize.h: In substitution of 'template<class Stream, class T>  requires  Unserializable<T, Stream> void Unserialize(Stream&, T&&) [with Stream = SpanReader; T = signed char&]':\r\n./streams.h:114:22:   required from 'SpanReader& SpanReader::operator>>(T&&) [with T = signed char&]'\r\ntest/streams_tests.cpp:148:15:   required from here\r\n./serialize.h:771:9:   required for the satisfaction of 'Unserializable<T, Stream>' [with T = signed char&; Stream = SpanReader]\r\n./serialize.h:771:26:   in requirements with 'T a', 'Stream s' [with T = signed char&; Stream = SpanReader]\r\n./serialize.h:771:65: note: the required expression 'a.Unserialize(s)' is invalid\r\n  771 | concept Unserializable = requires(T a, Stream s) { a.Unserialize(s); };\r\n      |                                                    ~~~~~~~~~~~~~^~~\r\n./streams.h: In instantiation of 'SpanReader& SpanReader::operator>>(T&&) [with T = signed char&]':\r\ntest/streams_tests.cpp:148:15:   required from here\r\n...\r\n```\r\n\r\nI believe, it has been broken since https://github.com/bitcoin/bitcoin/pull/12254.\r\n\r\n---\r\n\r\nSystem and compiler details:\r\n```\r\n$ uname -a\r\nSunOS openindiana 5.11 illumos-064d431af1 i86pc i386 i86pc\r\n$ g++ --version\r\ng++ (OpenIndiana 13.2.0-oi-3) 13.2.0\r\nCopyright (C) 2023 Free Software Foundation, Inc.\r\nThis is free software; see the source for copying conditions.  There is NO\r\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\r\n\r\n```",
   "closed_at" : null,
   "closed_by" : null,
   "comments" : 3,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29884/comments",
   "created_at" : "2024-04-15T21:02:12Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29884/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/issues/29884",
   "id" : 2244613792,
   "labels" : [
      {
         "color" : "FBBAAB",
         "default" : false,
         "description" : null,
         "id" : 64585,
         "name" : "Bug",
         "node_id" : "MDU6TGFiZWw2NDU4NQ==",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Bug"
      },
      {
         "color" : "770000",
         "default" : false,
         "description" : null,
         "id" : 234878,
         "name" : "Linux/Unix",
         "node_id" : "MDU6TGFiZWwyMzQ4Nzg=",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Linux/Unix"
      },
      {
         "color" : "5319e7",
         "default" : false,
         "description" : null,
         "id" : 61889416,
         "name" : "Build system",
         "node_id" : "MDU6TGFiZWw2MTg4OTQxNg==",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Build%20system"
      }
   ],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29884/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "node_id" : "I_kwDOABII586Fyhag",
   "number" : 29884,
   "performed_via_github_app" : null,
   "reactions" : {
      "+1" : 0,
      "-1" : 0,
      "confused" : 0,
      "eyes" : 0,
      "heart" : 0,
      "hooray" : 0,
      "laugh" : 0,
      "rocket" : 0,
      "total_count" : 0,
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29884/reactions"
   },
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "open",
   "state_reason" : null,
   "timeline_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29884/timeline",
   "title" : "`test/streams_tests.cpp` fails to compile on SunOS / illumos",
   "updated_at" : "2024-04-16T09:04:23Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29884",
   "user" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/32963518?v=4",
      "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
      "followers_url" : "https://api.github.com/users/hebasto/followers",
      "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/hebasto",
      "id" : 32963518,
      "login" : "hebasto",
      "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
      "organizations_url" : "https://api.github.com/users/hebasto/orgs",
      "received_events_url" : "https://api.github.com/users/hebasto/received_events",
      "repos_url" : "https://api.github.com/users/hebasto/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/hebasto"
   }
}
