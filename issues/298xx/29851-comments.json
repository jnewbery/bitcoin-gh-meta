[
   {
      "author_association" : "MEMBER",
      "body" : "The `CHECK_NONFATAL` is in `FromPKBytes`: https://github.com/bitcoin/bitcoin/blob/bdb33ec51986570ea17406c83bad2c955ae23186/src/script/sign.cpp#L298 which is called when getting the miniscript for a script.\r\n\r\nThis particular script is `173d36c8c9c9c9ffffffffffff0200000000021e1e37373721361818181818181e1e1e1e19000000000000000000b19292929292926b006c9b9b9292`",
      "created_at" : "2024-04-11T12:58:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/29851#issuecomment-2049639006",
      "id" : 2049639006,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29851",
      "node_id" : "IC_kwDOABII5856KwJe",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2049639006/reactions"
      },
      "updated_at" : "2024-04-11T12:58:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2049639006",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "cc @darosior ",
      "created_at" : "2024-04-11T12:59:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/29851#issuecomment-2049640339",
      "id" : 2049640339,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29851",
      "node_id" : "IC_kwDOABII5856KweT",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2049640339/reactions"
      },
      "updated_at" : "2024-04-11T12:59:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2049640339",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I don't think this is a fuzz issue. The RPC is `finalizepsbt` and it should be possible to hit it in `finalizepsbt` RPC as well.",
      "created_at" : "2024-04-11T13:03:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/29851#issuecomment-2049649573",
      "id" : 2049649573,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29851",
      "node_id" : "IC_kwDOABII5856Kyul",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2049649573/reactions"
      },
      "updated_at" : "2024-04-11T13:03:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2049649573",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Somewhat smaller input for the RPC:\r\n\r\n```\r\n$ ./src/bitcoin-cli finalizepsbt cHNidP8BAKOro2MDAwMDA5gAAAbVAAUAAGNsZWFyYgwAAAAAAAAAYAD1////AOgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkwAAAAAAAAAAAAAAYAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAADwAAAAAAAAAAAAAAAAAAAAAAAAMKAwMDAwMDAwMDAwMACvMBAwBxZAAAAAAAAAAAAGUAAAAODgAAAAEBKwL/ZABlcAAAIlEgAwMcHBwDAwAL8wEDJnBmAQAAAAAAAAAAAAAAAAAAgACiFQILCwsAAAAAAAAAAP////8AAACODg4ODg4ODg4ODgAADg5wAAAiUSADAxwcHAMDAAvzAQMmcGYBAAAAAAAAAAAAAAAAAACAAAAAAAAAACSJiYmJyon6AAAAgAAAAAAAAADw/3T/aQMxMySJiYmJyon6AGxByon68P90/2kDMTMkiYmJicqJ+tzc3MnJycnCwsLCwsLCwsLCwsLCwsI8PT09PRc9NsjJycn///////8CAAAAAAIeHjc3NyE2GBgYGBgYHh4eHhkAAAAAAAAAAACxkpKSkpKSawBsm5uSksAAAAAAAAA= \r\n\r\nerror code: -1\r\nerror message:\r\nInternal bug detected: last - first == 32\r\nscript/sign.cpp:298 (FromPKBytes)\r\nBitcoin Core v27.99.0-3f6a6da3b08d-dirty\r\n\r\n\r\n",
      "created_at" : "2024-04-11T13:18:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/29851#issuecomment-2049678227",
      "id" : 2049678227,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29851",
      "node_id" : "IC_kwDOABII5856K5uT",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2049678227/reactions"
      },
      "updated_at" : "2024-04-11T13:18:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2049678227",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "A repro as a unit test:\r\n```cpp\r\nBOOST_AUTO_TEST_CASE(sign_invalid_miniscript)\r\n{\r\n    FillableSigningProvider keystore;\r\n    SignatureData sig_data;\r\n    CMutableTransaction prev, curr;\r\n\r\n    const auto invalid_pubkey{ParseHex(\"173d36c8c9c9c9ffffffffffff0200000000021e1e37373721361818181818181e1e1e1e19000000000000000000b19292929292926b006c9b9b9292\")};\r\n    TaprootBuilder builder;\r\n    builder.Add(0, {invalid_pubkey}, 0xc0);\r\n    XOnlyPubKey dummy{ParseHex(\"50929b74c1a04954b78b4b6035e97a5e078a5a0f28ec96d547bfee9ace803ac0\")};\r\n    builder.Finalize(dummy);\r\n    prev.vout.emplace_back(0, GetScriptForDestination(builder.GetOutput()));\r\n    curr.vin.emplace_back(COutPoint{prev.GetHash(), 0});\r\n    sig_data.tr_spenddata = builder.GetSpendData();\r\n\r\n    SignSignature(keystore, CTransaction(prev), curr, 0, SIGHASH_ALL, sig_data);\r\n}\r\n```",
      "created_at" : "2024-04-11T14:01:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/29851#issuecomment-2049765453",
      "id" : 2049765453,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29851",
      "node_id" : "IC_kwDOABII5856LPBN",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2049765453/reactions"
      },
      "updated_at" : "2024-04-11T14:01:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2049765453",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   }
]
