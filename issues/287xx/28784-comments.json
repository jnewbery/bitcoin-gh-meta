[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage\nFor detailed information about the code coverage, see the [test coverage report](https://corecheck.dev/bitcoin/bitcoin/pulls/28784).\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [kristapsk](https://github.com/bitcoin/bitcoin/pull/28784#pullrequestreview-1721753043), [luke-jr](https://github.com/bitcoin/bitcoin/pull/28784#issuecomment-1804813578) |\n\nIf your review is incorrectly listed, please react with ð to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#28167](https://github.com/bitcoin/bitcoin/pull/28167) (init: Add option for rpccookie permissions (replace 26088) by willcl-ark)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "created_at" : "2023-11-03T15:30:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28784#issuecomment-1792654294",
      "id" : 1792654294,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28784",
      "node_id" : "IC_kwDOABII585q2bvW",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1792654294/reactions"
      },
      "updated_at" : "2023-11-09T22:57:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1792654294",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "The bug can be reproduced manually by starting `bitcoind` twice, resulting in a missing `.cookie` file:\r\n```\r\n$ bitcoind -signet &\r\n...\r\n2023-11-03T15:38:09Z Using random cookie authentication.\r\n2023-11-03T15:38:09Z Generated RPC authentication cookie /home/user/.bitcoin/signet/.cookie\r\n...\r\n\r\n$ ls ~/.bitcoin/signet/.cookie \r\n/home/user/.bitcoin/signet/.cookie\r\n\r\n$ bitcoind -signet\r\nError: Cannot obtain a lock on data directory /home/user/.bitcoin/signet. Bitcoin Core is probably already running.\r\n\r\n$ ls /home/user/.bitcoin/signet/.cookie \r\nls: cannot access '/home/user/.bitcoin/signet/.cookie': No such file or directory\r\n\r\n```",
      "created_at" : "2023-11-03T15:41:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28784#issuecomment-1792671356",
      "id" : 1792671356,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28784",
      "node_id" : "IC_kwDOABII585q2f58",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1792671356/reactions"
      },
      "updated_at" : "2023-11-03T15:41:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1792671356",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/9900?v=4",
         "events_url" : "https://api.github.com/users/romanz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/romanz/followers",
         "following_url" : "https://api.github.com/users/romanz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/romanz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/romanz",
         "id" : 9900,
         "login" : "romanz",
         "node_id" : "MDQ6VXNlcjk5MDA=",
         "organizations_url" : "https://api.github.com/users/romanz/orgs",
         "received_events_url" : "https://api.github.com/users/romanz/received_events",
         "repos_url" : "https://api.github.com/users/romanz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/romanz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/romanz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/romanz"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks for the review!\r\nSquashed and force-pushed d95dde9441fb791046394ed3784a840a54ef2ab9.",
      "created_at" : "2023-11-09T03:50:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28784#issuecomment-1803120456",
      "id" : 1803120456,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28784",
      "node_id" : "IC_kwDOABII585reW9I",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1803120456/reactions"
      },
      "updated_at" : "2023-11-09T03:50:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1803120456",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/9900?v=4",
         "events_url" : "https://api.github.com/users/romanz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/romanz/followers",
         "following_url" : "https://api.github.com/users/romanz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/romanz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/romanz",
         "id" : 9900,
         "login" : "romanz",
         "node_id" : "MDQ6VXNlcjk5MDA=",
         "organizations_url" : "https://api.github.com/users/romanz/orgs",
         "received_events_url" : "https://api.github.com/users/romanz/received_events",
         "repos_url" : "https://api.github.com/users/romanz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/romanz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/romanz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/romanz"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "re-ACK d95dde9441fb791046394ed3784a840a54ef2ab9",
      "created_at" : "2023-11-09T22:57:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28784#issuecomment-1804813578",
      "id" : 1804813578,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28784",
      "node_id" : "IC_kwDOABII585rk0UK",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1804813578/reactions"
      },
      "updated_at" : "2023-11-09T22:57:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1804813578",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Just wanted to ask whether there are any other outstanding issues? :)",
      "created_at" : "2023-11-16T18:44:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28784#issuecomment-1815031414",
      "id" : 1815031414,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28784",
      "node_id" : "IC_kwDOABII585sLy52",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1815031414/reactions"
      },
      "updated_at" : "2023-11-16T18:44:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1815031414",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/9900?v=4",
         "events_url" : "https://api.github.com/users/romanz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/romanz/followers",
         "following_url" : "https://api.github.com/users/romanz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/romanz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/romanz",
         "id" : 9900,
         "login" : "romanz",
         "node_id" : "MDQ6VXNlcjk5MDA=",
         "organizations_url" : "https://api.github.com/users/romanz/orgs",
         "received_events_url" : "https://api.github.com/users/romanz/received_events",
         "repos_url" : "https://api.github.com/users/romanz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/romanz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/romanz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/romanz"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Ping :)",
      "created_at" : "2023-11-24T19:15:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28784#issuecomment-1826010595",
      "id" : 1826010595,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28784",
      "node_id" : "IC_kwDOABII585s1rXj",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1826010595/reactions"
      },
      "updated_at" : "2023-11-24T19:15:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1826010595",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/9900?v=4",
         "events_url" : "https://api.github.com/users/romanz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/romanz/followers",
         "following_url" : "https://api.github.com/users/romanz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/romanz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/romanz",
         "id" : 9900,
         "login" : "romanz",
         "node_id" : "MDQ6VXNlcjk5MDA=",
         "organizations_url" : "https://api.github.com/users/romanz/orgs",
         "received_events_url" : "https://api.github.com/users/romanz/received_events",
         "repos_url" : "https://api.github.com/users/romanz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/romanz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/romanz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/romanz"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28784#discussion_r1406306423"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28784"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1406306423"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "If `g_generated_cookie` is not `nullopt`, will `g_generated_cookie == existing_cookie` ever be `false`? I don't think so, and I think that makes this check a bit misleading. I would thus either convert `g_generated_cookie` into a `bool` (as e.g. motivated [here](https://github.com/bitcoin/bitcoin/pull/28946#discussion_r1406275659)), or as suggested by myself in https://github.com/bitcoin/bitcoin/pull/28946#discussion_r1406262955 use a `std::optional<fs::path>` but then perform this check only on the truthiness of `g_generated_cookie`, and not its value.\r\n\r\n<details>\r\n<summary>git diff on d95dde9441</summary>\r\n\r\n```diff\r\ndiff --git a/src/rpc/request.cpp b/src/rpc/request.cpp\r\nindex c706ddf8d5..937a3a7dd3 100644\r\n--- a/src/rpc/request.cpp\r\n+++ b/src/rpc/request.cpp\r\n@@ -80,7 +80,7 @@ static fs::path GetAuthCookieFile(bool temp=false)\r\n     return AbsPathForConfigVal(gArgs, arg);\r\n }\r\n \r\n-static std::optional<std::string> g_generated_cookie;\r\n+static std::optional<fs::path> g_generated_cookie;\r\n \r\n bool GenerateAuthCookie(std::string *cookie_out)\r\n {\r\n@@ -107,7 +107,7 @@ bool GenerateAuthCookie(std::string *cookie_out)\r\n         LogPrintf(\"Unable to rename cookie authentication file %s to %s\\n\", fs::PathToString(filepath_tmp), fs::PathToString(filepath));\r\n         return false;\r\n     }\r\n-    g_generated_cookie = cookie;\r\n+    g_generated_cookie = filepath;\r\n     LogPrintf(\"Generated RPC authentication cookie %s\\n\", fs::PathToString(filepath));\r\n \r\n     if (cookie_out)\r\n@@ -133,12 +133,10 @@ bool GetAuthCookie(std::string *cookie_out)\r\n \r\n void DeleteAuthCookie()\r\n {\r\n+    // Delete the cookie file if it exists and was generated by this process\r\n+    if (!g_generated_cookie) return;\r\n     try {\r\n-        std::string existing_cookie;\r\n-        if (GetAuthCookie(&existing_cookie) && g_generated_cookie == existing_cookie) {\r\n-            // Delete the cookie file if it exists and was generated by this process\r\n-            fs::remove(GetAuthCookieFile());\r\n-        }\r\n+            fs::remove(g_generated_cookie.value());\r\n     } catch (const fs::filesystem_error& e) {\r\n         LogPrintf(\"%s: Unable to remove random auth cookie file: %s\\n\", __func__, fsbridge::get_filesystem_error_message(e));\r\n     }\r\n\r\n```\r\n</details>\r\n",
      "commit_id" : "d95dde9441fb791046394ed3784a840a54ef2ab9",
      "created_at" : "2023-11-27T15:08:58Z",
      "diff_hunk" : "@@ -131,7 +134,11 @@ bool GetAuthCookie(std::string *cookie_out)\n void DeleteAuthCookie()\n {\n     try {\n-        fs::remove(GetAuthCookieFile());\n+        std::string existing_cookie;\n+        if (GetAuthCookie(&existing_cookie) && g_generated_cookie == existing_cookie) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28784#discussion_r1406306423",
      "id" : 1406306423,
      "line" : 138,
      "node_id" : "PRRC_kwDOABII585T0oh3",
      "original_commit_id" : "d95dde9441fb791046394ed3784a840a54ef2ab9",
      "original_line" : 138,
      "original_position" : 23,
      "original_start_line" : null,
      "path" : "src/rpc/request.cpp",
      "position" : 23,
      "pull_request_review_id" : 1750667895,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28784",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1406306423/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-11-27T15:36:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1406306423",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28784#discussion_r1406318767"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28784"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1406318767"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Or combining this with a `fs::remove` simplification:\r\n\r\n<details>\r\n<summary>git diff on d95dde9441</summary>\r\n\r\n```diff\r\ndiff --git a/src/rpc/request.cpp b/src/rpc/request.cpp\r\nindex c706ddf8d5..06962d2b87 100644\r\n--- a/src/rpc/request.cpp\r\n+++ b/src/rpc/request.cpp\r\n@@ -80,7 +80,7 @@ static fs::path GetAuthCookieFile(bool temp=false)\r\n     return AbsPathForConfigVal(gArgs, arg);\r\n }\r\n \r\n-static std::optional<std::string> g_generated_cookie;\r\n+static std::optional<fs::path> g_generated_cookie;\r\n \r\n bool GenerateAuthCookie(std::string *cookie_out)\r\n {\r\n@@ -107,7 +107,7 @@ bool GenerateAuthCookie(std::string *cookie_out)\r\n         LogPrintf(\"Unable to rename cookie authentication file %s to %s\\n\", fs::PathToString(filepath_tmp), fs::PathToString(filepath));\r\n         return false;\r\n     }\r\n-    g_generated_cookie = cookie;\r\n+    g_generated_cookie = filepath;\r\n     LogPrintf(\"Generated RPC authentication cookie %s\\n\", fs::PathToString(filepath));\r\n \r\n     if (cookie_out)\r\n@@ -133,14 +133,10 @@ bool GetAuthCookie(std::string *cookie_out)\r\n \r\n void DeleteAuthCookie()\r\n {\r\n-    try {\r\n-        std::string existing_cookie;\r\n-        if (GetAuthCookie(&existing_cookie) && g_generated_cookie == existing_cookie) {\r\n-            // Delete the cookie file if it exists and was generated by this process\r\n-            fs::remove(GetAuthCookieFile());\r\n-        }\r\n-    } catch (const fs::filesystem_error& e) {\r\n-        LogPrintf(\"%s: Unable to remove random auth cookie file: %s\\n\", __func__, fsbridge::get_filesystem_error_message(e));\r\n+    // Delete the cookie file if it exists and was generated by this process\r\n+    if (!g_generated_cookie) return;\r\n+    if (std::error_code error; !fs::remove(g_generated_cookie.value(), error) && error) {\r\n+        LogPrintf(\"%s: Unable to remove random auth cookie file: %s\\n\", error.message());\r\n     }\r\n }\r\n \r\n\r\n```\r\n</details>\r\n",
      "commit_id" : "d95dde9441fb791046394ed3784a840a54ef2ab9",
      "created_at" : "2023-11-27T15:17:00Z",
      "diff_hunk" : "@@ -131,7 +134,11 @@ bool GetAuthCookie(std::string *cookie_out)\n void DeleteAuthCookie()\n {\n     try {\n-        fs::remove(GetAuthCookieFile());\n+        std::string existing_cookie;\n+        if (GetAuthCookie(&existing_cookie) && g_generated_cookie == existing_cookie) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28784#discussion_r1406318767",
      "id" : 1406318767,
      "in_reply_to_id" : 1406306423,
      "line" : 138,
      "node_id" : "PRRC_kwDOABII585T0riv",
      "original_commit_id" : "d95dde9441fb791046394ed3784a840a54ef2ab9",
      "original_line" : 138,
      "original_position" : 23,
      "original_start_line" : null,
      "path" : "src/rpc/request.cpp",
      "position" : 23,
      "pull_request_review_id" : 1750667895,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28784",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1406318767/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-11-27T15:36:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1406318767",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28784#discussion_r1406614696"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28784"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1406614696"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Initially I used a boolean flag (https://github.com/bitcoin/bitcoin/commit/7cb9367157eb42ee06bc6fa024522cc14a80138d) but following [this comment](https://github.com/bitcoin/bitcoin/pull/28784#pullrequestreview-1720677514) it was changed to contain the cookie contents.\r\n\r\nI agree that `g_generated_cookie == existing_cookie` can be `false` only if the cookie was somehow overwritten by some other process (i.e. not by `bitcoind`), so indeed it would be simpler to use the patches suggested above.\r\n\r\n@luke-jr what do you think?",
      "commit_id" : "d95dde9441fb791046394ed3784a840a54ef2ab9",
      "created_at" : "2023-11-27T18:57:26Z",
      "diff_hunk" : "@@ -131,7 +134,11 @@ bool GetAuthCookie(std::string *cookie_out)\n void DeleteAuthCookie()\n {\n     try {\n-        fs::remove(GetAuthCookieFile());\n+        std::string existing_cookie;\n+        if (GetAuthCookie(&existing_cookie) && g_generated_cookie == existing_cookie) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28784#discussion_r1406614696",
      "id" : 1406614696,
      "in_reply_to_id" : 1406306423,
      "line" : 138,
      "node_id" : "PRRC_kwDOABII585T1zyo",
      "original_commit_id" : "d95dde9441fb791046394ed3784a840a54ef2ab9",
      "original_line" : 138,
      "original_position" : 23,
      "original_start_line" : null,
      "path" : "src/rpc/request.cpp",
      "position" : 23,
      "pull_request_review_id" : 1751153551,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28784",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1406614696/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-11-27T18:57:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1406614696",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/9900?v=4",
         "events_url" : "https://api.github.com/users/romanz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/romanz/followers",
         "following_url" : "https://api.github.com/users/romanz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/romanz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/romanz",
         "id" : 9900,
         "login" : "romanz",
         "node_id" : "MDQ6VXNlcjk5MDA=",
         "organizations_url" : "https://api.github.com/users/romanz/orgs",
         "received_events_url" : "https://api.github.com/users/romanz/received_events",
         "repos_url" : "https://api.github.com/users/romanz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/romanz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/romanz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/romanz"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28784#discussion_r1406650143"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28784"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1406650143"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "@willcl-ark I also prefer to be consistent with the solution chosen for https://github.com/bitcoin/bitcoin/pull/28946, so please let me know which fix is preferred. ",
      "commit_id" : "d95dde9441fb791046394ed3784a840a54ef2ab9",
      "created_at" : "2023-11-27T19:31:49Z",
      "diff_hunk" : "@@ -131,7 +134,11 @@ bool GetAuthCookie(std::string *cookie_out)\n void DeleteAuthCookie()\n {\n     try {\n-        fs::remove(GetAuthCookieFile());\n+        std::string existing_cookie;\n+        if (GetAuthCookie(&existing_cookie) && g_generated_cookie == existing_cookie) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28784#discussion_r1406650143",
      "id" : 1406650143,
      "in_reply_to_id" : 1406306423,
      "line" : 138,
      "node_id" : "PRRC_kwDOABII585T18cf",
      "original_commit_id" : "d95dde9441fb791046394ed3784a840a54ef2ab9",
      "original_line" : 138,
      "original_position" : 23,
      "original_start_line" : null,
      "path" : "src/rpc/request.cpp",
      "position" : 23,
      "pull_request_review_id" : 1751210568,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28784",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1406650143/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-11-27T19:31:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1406650143",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/9900?v=4",
         "events_url" : "https://api.github.com/users/romanz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/romanz/followers",
         "following_url" : "https://api.github.com/users/romanz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/romanz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/romanz",
         "id" : 9900,
         "login" : "romanz",
         "node_id" : "MDQ6VXNlcjk5MDA=",
         "organizations_url" : "https://api.github.com/users/romanz/orgs",
         "received_events_url" : "https://api.github.com/users/romanz/received_events",
         "repos_url" : "https://api.github.com/users/romanz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/romanz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/romanz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/romanz"
      }
   }
]
