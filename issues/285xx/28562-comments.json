[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Stale ACK | [jamesob](https://github.com/bitcoin/bitcoin/pull/28562#pullrequestreview-1654694833) |\n\nIf your review is incorrectly listed, please react with ð to this comment and the bot will ignore it on the next update.\n",
      "created_at" : "2023-10-02T22:42:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28562#issuecomment-1743872233",
      "id" : 1743872233,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28562",
      "node_id" : "IC_kwDOABII585n8WDp",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1743872233/reactions"
      },
      "updated_at" : "2023-10-03T09:15:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1743872233",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28562#discussion_r1343752096"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28562"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1343752096"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Didn't @ryanofsky say it might be good to `return true;` here in order to avoid spurious warnings?",
      "commit_id" : "0081d1298e08a2e3ecfb770caa73b32f448aca9d",
      "created_at" : "2023-10-03T08:55:48Z",
      "diff_hunk" : "@@ -756,9 +756,10 @@ bool BlockManager::FlushChainstateBlockFile(int tip_height)\n {\n     LOCK(cs_LastBlockFile);\n     auto& cursor = m_blockfile_cursors[BlockfileTypeForHeight(tip_height)];\n+    // If the cursor does not exist, it means an assumeutxo snapshot is loaded,\n+    // but no blocks past the snapshot height have been written yet, so there\n+    // is no data associated with the chainstate, and it is safe not to flush.\n     if (cursor) {\n-        // The cursor may not exist after a snapshot has been loaded but before any\n-        // blocks have been downloaded.\n         return FlushBlockFile(cursor->file_num, /*fFinalize=*/false, /*finalize_undo=*/false);\n     }\n     return false;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28562#discussion_r1343752096",
      "id" : 1343752096,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585QGAeg",
      "original_commit_id" : "26c815b60c8c4aec27de3fc6c7849ea3c7bdd91e",
      "original_line" : 765,
      "original_position" : 12,
      "original_start_line" : null,
      "path" : "src/node/blockstorage.cpp",
      "position" : null,
      "pull_request_review_id" : 1654694833,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28562",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1343752096/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-10-03T08:55:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1343752096",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/73197?v=4",
         "events_url" : "https://api.github.com/users/jamesob/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jamesob/followers",
         "following_url" : "https://api.github.com/users/jamesob/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jamesob/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jamesob",
         "id" : 73197,
         "login" : "jamesob",
         "node_id" : "MDQ6VXNlcjczMTk3",
         "organizations_url" : "https://api.github.com/users/jamesob/orgs",
         "received_events_url" : "https://api.github.com/users/jamesob/received_events",
         "repos_url" : "https://api.github.com/users/jamesob/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jamesob/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jamesob"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28562#discussion_r1343784377"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28562"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1343784377"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Right, I saw it but then missed to addressed it. Now added.",
      "commit_id" : "0081d1298e08a2e3ecfb770caa73b32f448aca9d",
      "created_at" : "2023-10-03T09:17:14Z",
      "diff_hunk" : "@@ -756,9 +756,10 @@ bool BlockManager::FlushChainstateBlockFile(int tip_height)\n {\n     LOCK(cs_LastBlockFile);\n     auto& cursor = m_blockfile_cursors[BlockfileTypeForHeight(tip_height)];\n+    // If the cursor does not exist, it means an assumeutxo snapshot is loaded,\n+    // but no blocks past the snapshot height have been written yet, so there\n+    // is no data associated with the chainstate, and it is safe not to flush.\n     if (cursor) {\n-        // The cursor may not exist after a snapshot has been loaded but before any\n-        // blocks have been downloaded.\n         return FlushBlockFile(cursor->file_num, /*fFinalize=*/false, /*finalize_undo=*/false);\n     }\n     return false;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28562#discussion_r1343784377",
      "id" : 1343784377,
      "in_reply_to_id" : 1343752096,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585QGIW5",
      "original_commit_id" : "26c815b60c8c4aec27de3fc6c7849ea3c7bdd91e",
      "original_line" : 765,
      "original_position" : 12,
      "original_start_line" : null,
      "path" : "src/node/blockstorage.cpp",
      "position" : null,
      "pull_request_review_id" : 1654741618,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28562",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1343784377/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-10-03T09:17:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1343784377",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28562#discussion_r1343967715"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28562"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1343967715"
         }
      },
      "author_association" : "MEMBER",
      "body" : "not a fan of overwriting and hard-coding the user-picked timeout factor. Why not use `self.wait_until`?\r\n\r\nI think it could make sense to rename `wait_until_helper` to `wait_until_helper_internal`?",
      "commit_id" : "69fbb77cff92649c51d5d22e06b3853db928b8e1",
      "created_at" : "2023-10-03T11:45:03Z",
      "diff_hunk" : "@@ -156,19 +156,19 @@ def no_sync():\n         self.connect_nodes(0, 1)\n \n         self.log.info(f\"Ensuring snapshot chain syncs to tip. ({FINAL_HEIGHT})\")\n-        wait_until_helper(lambda: n1.getchainstates()['snapshot']['blocks'] == FINAL_HEIGHT)\n+        wait_until_helper(lambda: n1.getchainstates()['snapshot']['blocks'] == FINAL_HEIGHT, timeout_factor=2)\n         self.sync_blocks(nodes=(n0, n1))\n \n         self.log.info(\"Ensuring background validation completes\")\n         # N.B.: the `snapshot` key disappears once the background validation is complete.\n-        wait_until_helper(lambda: not n1.getchainstates().get('snapshot'))\n+        wait_until_helper(lambda: not n1.getchainstates().get('snapshot'), timeout_factor=2)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28562#discussion_r1343967715",
      "id" : 1343967715,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585QG1Hj",
      "original_commit_id" : "0081d1298e08a2e3ecfb770caa73b32f448aca9d",
      "original_line" : 164,
      "original_position" : 20,
      "original_start_line" : null,
      "path" : "test/functional/feature_assumeutxo.py",
      "position" : null,
      "pull_request_review_id" : 1655001137,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28562",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1343967715/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-10-03T11:45:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1343967715",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28562#discussion_r1344154808"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28562"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1344154808"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"doc: Add and edit some comments around assumeutxo\" (42d585d981350052b00001fa52a895ddca642c11)\r\n\r\nIt does not seem accurate that a user would not care if there is a snapshot chainstate, otherwise why would they have loaded a snapshot to begin with?\r\n\r\nI'm not sure exactly which question this comment is trying to answer, but if the goal is just to explain the code maybe it can say \"// If a chainstate has m_from_snapshot_blockhash set and there is more than one chainstate, then it a partially validated snapshot chainstate. Otherwise it is a fully validated normal chainstate.\"",
      "commit_id" : "69fbb77cff92649c51d5d22e06b3853db928b8e1",
      "created_at" : "2023-10-03T13:58:23Z",
      "diff_hunk" : "@@ -2855,6 +2855,9 @@ return RPCHelpMan{\n         return data;\n     };\n \n+    // We present the IBD/background chainstate as \"normal\" to users, since\n+    // it should not matter to them if there is also a snapshot chainstate.\n+    // To users, the IBD chainstate should always be considered \"normal\".",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28562#discussion_r1344154808",
      "id" : 1344154808,
      "line" : 2860,
      "node_id" : "PRRC_kwDOABII585QHiy4",
      "original_commit_id" : "42d585d981350052b00001fa52a895ddca642c11",
      "original_line" : 2860,
      "original_position" : 6,
      "original_start_line" : 2858,
      "path" : "src/rpc/blockchain.cpp",
      "position" : 24,
      "pull_request_review_id" : 1655287137,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28562",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1344154808/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 2858,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-10-03T19:35:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1344154808",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28562#discussion_r1344415254"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28562"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1344415254"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "all done",
      "commit_id" : "69fbb77cff92649c51d5d22e06b3853db928b8e1",
      "created_at" : "2023-10-03T16:36:46Z",
      "diff_hunk" : "@@ -156,19 +156,19 @@ def no_sync():\n         self.connect_nodes(0, 1)\n \n         self.log.info(f\"Ensuring snapshot chain syncs to tip. ({FINAL_HEIGHT})\")\n-        wait_until_helper(lambda: n1.getchainstates()['snapshot']['blocks'] == FINAL_HEIGHT)\n+        wait_until_helper(lambda: n1.getchainstates()['snapshot']['blocks'] == FINAL_HEIGHT, timeout_factor=2)\n         self.sync_blocks(nodes=(n0, n1))\n \n         self.log.info(\"Ensuring background validation completes\")\n         # N.B.: the `snapshot` key disappears once the background validation is complete.\n-        wait_until_helper(lambda: not n1.getchainstates().get('snapshot'))\n+        wait_until_helper(lambda: not n1.getchainstates().get('snapshot'), timeout_factor=2)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28562#discussion_r1344415254",
      "id" : 1344415254,
      "in_reply_to_id" : 1343967715,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585QIiYW",
      "original_commit_id" : "0081d1298e08a2e3ecfb770caa73b32f448aca9d",
      "original_line" : 164,
      "original_position" : 20,
      "original_start_line" : null,
      "path" : "test/functional/feature_assumeutxo.py",
      "position" : null,
      "pull_request_review_id" : 1655672218,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28562",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1344415254/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-10-03T16:36:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1344415254",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Addressed feedback from @MarcoFalke ",
      "created_at" : "2023-10-03T16:37:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28562#issuecomment-1745344476",
      "id" : 1745344476,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28562",
      "node_id" : "IC_kwDOABII585oB9fc",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1745344476/reactions"
      },
      "updated_at" : "2023-10-03T16:37:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1745344476",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28562#discussion_r1344568861"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28562"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1344568861"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"test: Increase timeout tolerance of feature_assumeutxo\" (613e8317275ecb0051f9dcea57786aabe7dfdb27)\r\n\r\nThis seem strange since it is just referencing the function without calling it. Is it missing `()`? Also, it's not clear why no_op is better than pass. Would be helpful to have a comment.",
      "commit_id" : "69fbb77cff92649c51d5d22e06b3853db928b8e1",
      "created_at" : "2023-10-03T18:48:51Z",
      "diff_hunk" : "@@ -81,7 +81,7 @@ def run_test(self):\n         self.sync_blocks()\n \n         def no_sync():\n-            pass\n+            self.no_op",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28562#discussion_r1344568861",
      "id" : 1344568861,
      "line" : 84,
      "node_id" : "PRRC_kwDOABII585QJH4d",
      "original_commit_id" : "ce120f73e61977c9eb174ea19c64b260f13b086f",
      "original_line" : 84,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "test/functional/feature_assumeutxo.py",
      "position" : 14,
      "pull_request_review_id" : 1655287137,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28562",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1344568861/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-10-03T19:35:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1344568861",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28562#discussion_r1344571683"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28562"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1344571683"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"test: Increase timeout tolerance of feature_assumeutxo\" (613e8317275ecb0051f9dcea57786aabe7dfdb27)\r\n\r\nIt would be great to eliminate all these duplicate 120s. I'm surprised the test framework doesn't provide a way to set a default time within the unit tests, but if it doesn't I think it would be better to just declare a `WAIT_TIMEOUT = 120` constant at the top of the test, or add a helper method that calls wait_until.",
      "commit_id" : "69fbb77cff92649c51d5d22e06b3853db928b8e1",
      "created_at" : "2023-10-03T18:51:33Z",
      "diff_hunk" : "@@ -156,19 +156,19 @@ def no_sync():\n         self.connect_nodes(0, 1)\n \n         self.log.info(f\"Ensuring snapshot chain syncs to tip. ({FINAL_HEIGHT})\")\n-        wait_until_helper(lambda: n1.getchainstates()['snapshot']['blocks'] == FINAL_HEIGHT)\n+        self.wait_until(lambda: n1.getchainstates()['snapshot']['blocks'] == FINAL_HEIGHT, timeout=120)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28562#discussion_r1344571683",
      "id" : 1344571683,
      "line" : 159,
      "node_id" : "PRRC_kwDOABII585QJIkj",
      "original_commit_id" : "ce120f73e61977c9eb174ea19c64b260f13b086f",
      "original_line" : 159,
      "original_position" : 23,
      "original_start_line" : null,
      "path" : "test/functional/feature_assumeutxo.py",
      "position" : 23,
      "pull_request_review_id" : 1655287137,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28562",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1344571683/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-10-03T19:35:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1344571683",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28562#discussion_r1344606637"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28562"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1344606637"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"doc: Add snapshot chainstate removal warning to reindexing documentation\" (2bd1d39491f8ad811dcb6d3787e1e18ca0b928ad)\r\n\r\nThese warnings seem too alarmist, and also not very actionable. The point of reindex commands is to wipe state and rebuild it. So it should not be surprising that state loaded from an assumeutxo snapshot is also wiped. I think it would be a better to add a clarification instead of a warning here, and a suggestion to reload the snapshot. Maybe: \"If an assumeutxo snapshot was loaded and not yet validated, it will need to be reloaded for its chain state to be rebuilt.\"",
      "commit_id" : "69fbb77cff92649c51d5d22e06b3853db928b8e1",
      "created_at" : "2023-10-03T19:12:02Z",
      "diff_hunk" : "@@ -462,8 +462,8 @@ void SetupServerArgs(ArgsManager& argsman)\n     argsman.AddArg(\"-prune=<n>\", strprintf(\"Reduce storage requirements by enabling pruning (deleting) of old blocks. This allows the pruneblockchain RPC to be called to delete specific blocks and enables automatic pruning of old blocks if a target size in MiB is provided. This mode is incompatible with -txindex. \"\n             \"Warning: Reverting this setting requires re-downloading the entire blockchain. \"\n             \"(default: 0 = disable pruning blocks, 1 = allow manual pruning via RPC, >=%u = automatically prune block files to stay under the specified target size in MiB)\", MIN_DISK_SPACE_FOR_BLOCK_FILES / 1024 / 1024), ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);\n-    argsman.AddArg(\"-reindex\", \"Rebuild chain state and block index from the blk*.dat files on disk. This will also rebuild active optional indexes.\", ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);\n-    argsman.AddArg(\"-reindex-chainstate\", \"Rebuild chain state from the currently indexed blocks. When in pruning mode or if blocks on disk might be corrupted, use full -reindex instead.\", ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);\n+    argsman.AddArg(\"-reindex\", \"Rebuild chain state and block index from the blk*.dat files on disk. This will also rebuild active optional indexes. Warning: Not yet validated snapshot chainstates will be removed.\", ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);\n+    argsman.AddArg(\"-reindex-chainstate\", \"Rebuild chain state from the currently indexed blocks. When in pruning mode or if blocks on disk might be corrupted, use full -reindex instead. Warning: Not yet validated snapshot chainstates will be removed.\", ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28562#discussion_r1344606637",
      "id" : 1344606637,
      "line" : 466,
      "node_id" : "PRRC_kwDOABII585QJRGt",
      "original_commit_id" : "949be74b0cb9e0f8adbaf1401c1c937b5b9a3bd2",
      "original_line" : 466,
      "original_position" : 7,
      "original_start_line" : 465,
      "path" : "src/init.cpp",
      "position" : 7,
      "pull_request_review_id" : 1655287137,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28562",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1344606637/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 465,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-10-03T19:35:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1344606637",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   }
]
