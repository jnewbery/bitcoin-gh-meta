[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#27865](https://github.com/bitcoin/bitcoin/pull/27865) (wallet: Track no-longer-spendable TXOs separately by achow101)\n* [#27307](https://github.com/bitcoin/bitcoin/pull/27307) (wallet: track mempool conflicts with wallet transactions by ishaanam)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "created_at" : "2023-09-27T17:22:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28546#issuecomment-1737800496",
      "id" : 1737800496,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28546",
      "node_id" : "IC_kwDOABII585nlLsw",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1737800496/reactions"
      },
      "updated_at" : "2023-09-27T20:35:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1737800496",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Updated 3bb306142b7a66c8727bd19e8f0fb72c582bcdc2 -> e03b0fe72a8b1034e5221c8aed6fb31ddd056603 ([`pr/mig.1`](https://github.com/ryanofsky/bitcoin/commits/pr/mig.1) -> [`pr/mig.2`](https://github.com/ryanofsky/bitcoin/commits/pr/mig.2), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/mig.1..pr/mig.2)) just adding code comment",
      "created_at" : "2023-09-28T17:45:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28546#issuecomment-1739760491",
      "id" : 1739760491,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28546",
      "node_id" : "IC_kwDOABII585nsqNr",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1739760491/reactions"
      },
      "updated_at" : "2023-09-28T17:45:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1739760491",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28546#discussion_r1350322154"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28546"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1350322154"
         }
      },
      "author_association" : "MEMBER",
      "body" : "not really for this PR but.. shouldn't we also need to transfer the other wtx members too?\r\nLike `mapValue` (for the \"replaced_by_txid\" and \"replaces_txid\"), `nTimeReceived`, `nTimeSmart`, `fFromMe`.",
      "commit_id" : "dbed701d75a4a55cb34d797cfbae6910075ebec0",
      "created_at" : "2023-10-09T13:37:44Z",
      "diff_hunk" : "@@ -3908,6 +3894,15 @@ bool CWallet::ApplyMigrationData(MigrationData& data, bilingual_str& error)\n             if (data.watchonly_wallet) {\n                 LOCK(data.watchonly_wallet->cs_wallet);\n                 if (data.watchonly_wallet->IsMine(*wtx->tx) || data.watchonly_wallet->IsFromMe(*wtx->tx)) {\n+                    // Need to update WalletTx state before moving the\n+                    // transaction from the main wallet to the watchonly wallet,\n+                    // because the main wallet is an offline wallet created with\n+                    // a dummy context, and doesn't know heights of confirmed\n+                    // and conflicted blocks (values are set to -1). Calling\n+                    // updateState will look up missing height values so the\n+                    // watchonly wallet can function correctly after the\n+                    // migration without needing to be reloaded.\n+                    wtx->updateState(data.watchonly_wallet->chain());\n                     // Add to watchonly wallet\n                     if (!data.watchonly_wallet->AddToWallet(wtx->tx, wtx->m_state)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28546#discussion_r1350322154",
      "id" : 1350322154,
      "line" : 3907,
      "node_id" : "PRRC_kwDOABII585QfEfq",
      "original_commit_id" : "dbed701d75a4a55cb34d797cfbae6910075ebec0",
      "original_line" : 3907,
      "original_position" : 50,
      "original_start_line" : 3905,
      "path" : "src/wallet/wallet.cpp",
      "position" : 50,
      "pull_request_review_id" : 1664474576,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28546",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1350322154/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 3905,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-10-09T13:38:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1350322154",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   }
]
