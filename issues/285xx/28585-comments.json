[
   {
      "author_association" : "MEMBER",
      "body" : "cc @jamesob ",
      "created_at" : "2023-10-04T14:18:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/28585#issuecomment-1746975194",
      "id" : 1746975194,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28585",
      "node_id" : "IC_kwDOABII585oILna",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1746975194/reactions"
      },
      "updated_at" : "2023-10-04T14:18:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1746975194",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@fjahr Maybe it could make sense to split out the test fix into a separate pull to avoid a delay in merging the bugfix?",
      "created_at" : "2023-10-04T14:25:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/28585#issuecomment-1746988844",
      "id" : 1746988844,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28585",
      "node_id" : "IC_kwDOABII585oIO8s",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1746988844/reactions"
      },
      "updated_at" : "2023-10-04T14:25:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1746988844",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Hm, I thought this was a timeout issue but 2400 seconds is a really long time! Maybe there's a more fundamental issue here?",
      "created_at" : "2023-10-04T14:34:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/28585#issuecomment-1747004878",
      "id" : 1747004878,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28585",
      "node_id" : "IC_kwDOABII585oIS3O",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 2,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 2,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1747004878/reactions"
      },
      "updated_at" : "2023-10-04T14:34:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1747004878",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/73197?v=4",
         "events_url" : "https://api.github.com/users/jamesob/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jamesob/followers",
         "following_url" : "https://api.github.com/users/jamesob/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jamesob/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jamesob",
         "id" : 73197,
         "login" : "jamesob",
         "node_id" : "MDQ6VXNlcjczMTk3",
         "organizations_url" : "https://api.github.com/users/jamesob/orgs",
         "received_events_url" : "https://api.github.com/users/jamesob/received_events",
         "repos_url" : "https://api.github.com/users/jamesob/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jamesob/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jamesob"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> @fjahr Maybe it could make sense to split out the test fix into a separate pull to avoid a delay in merging the bugfix?\r\n\r\nSure, done at #28586 . Please let me know what you think about the default timeout idea, otherwise, I will simply hardcode the timeout value for now.",
      "created_at" : "2023-10-04T14:38:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/28585#issuecomment-1747014073",
      "id" : 1747014073,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28585",
      "node_id" : "IC_kwDOABII585oIVG5",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1747014073/reactions"
      },
      "updated_at" : "2023-10-04T14:38:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1747014073",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Hm, I thought this was a timeout issue but 2400 seconds is a really long time! Maybe there's a more fundamental issue here?\r\n\r\nYeah, it is not possible to use `-stopatheight=` and then assume the node does not stop",
      "created_at" : "2023-10-04T14:46:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/28585#issuecomment-1747029324",
      "id" : 1747029324,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28585",
      "node_id" : "IC_kwDOABII585oIY1M",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1747029324/reactions"
      },
      "updated_at" : "2023-10-04T14:46:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1747029324",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Yeah, it is not possible to use -stopatheight= and then assume the node does not stop\r\n\r\nBut, at least when I wrote the test, the node being restarted (`n1`) with the `-stopatheight=` configuration shouldn't have enough blocks to actually trip that stopatheight until it is connected to a peer with the blocks necessary (`node0`). I think this is a deeper issue with race between the contents of `connect_nodes` and the use of `-stopatheight`. ",
      "created_at" : "2023-10-04T14:58:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/28585#issuecomment-1747053616",
      "id" : 1747053616,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28585",
      "node_id" : "IC_kwDOABII585oIeww",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1747053616/reactions"
      },
      "updated_at" : "2023-10-04T14:58:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1747053616",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/73197?v=4",
         "events_url" : "https://api.github.com/users/jamesob/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jamesob/followers",
         "following_url" : "https://api.github.com/users/jamesob/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jamesob/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jamesob",
         "id" : 73197,
         "login" : "jamesob",
         "node_id" : "MDQ6VXNlcjczMTk3",
         "organizations_url" : "https://api.github.com/users/jamesob/orgs",
         "received_events_url" : "https://api.github.com/users/jamesob/received_events",
         "repos_url" : "https://api.github.com/users/jamesob/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jamesob/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jamesob"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Running in a loop locally, I'm detecting another race:\r\n\r\n```\r\n2023-10-04T15:13:33.740000Z TestFramework (INFO): PRNG seed is: 4294214471523398112\r\n2023-10-04T15:13:33.741000Z TestFramework (INFO): Initializing test directory /tmp/bitcoin_func_test_3iqhon05\r\n2023-10-04T15:13:34.187000Z TestFramework (INFO): -- Testing assumeutxo + some indexes + pruning\r\n2023-10-04T15:13:34.187000Z TestFramework (INFO): Creating a UTXO snapshot at height 299\r\n2023-10-04T15:13:34.237000Z TestFramework (INFO): Loading snapshot into second node from /tmp/bitcoin_func_test_3iqhon05/node0/regtest/utxos.dat\r\n2023-10-04T15:13:34.240000Z TestFramework (INFO): Restarting node to stop at height 359\r\n2023-10-04T15:13:34.693000Z TestFramework (INFO): Checking that blocks are segmented on disk\r\n2023-10-04T15:13:34.693000Z TestFramework (INFO): Restarted node before snapshot validation completed, reloading...\r\n2023-10-04T15:13:34.999000Z TestFramework (INFO): Ensuring snapshot chain syncs to tip. (399)\r\n2023-10-04T15:13:35.050000Z TestFramework (ERROR): Key error\r\nTraceback (most recent call last):\r\n  File \"/home/james/src/bitcoin/test/functional/test_framework/test_framework.py\", line 131, in main\r\n    self.run_test()\r\n  File \"/home/james/src/bitcoin/./test/functional/feature_assumeutxo.py\", line 162, in run_test\r\n    wait_until_helper(lambda: n1.getchainstates()['snapshot']['blocks'] == FINAL_HEIGHT)\r\n  File \"/home/james/src/bitcoin/test/functional/test_framework/util.py\", line 265, in wait_until_helper\r\n    if predicate():\r\n       ^^^^^^^^^^^\r\n  File \"/home/james/src/bitcoin/./test/functional/feature_assumeutxo.py\", line 162, in <lambda>\r\n    wait_until_helper(lambda: n1.getchainstates()['snapshot']['blocks'] == FINAL_HEIGHT)\r\n                              ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^\r\nKeyError: 'snapshot'\r\n2023-10-04T15:13:35.100000Z TestFramework (INFO): Stopping nodes\r\n```\r\n\r\nInvestigating...",
      "created_at" : "2023-10-04T15:13:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/28585#issuecomment-1747097691",
      "id" : 1747097691,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28585",
      "node_id" : "IC_kwDOABII585oIphb",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1747097691/reactions"
      },
      "updated_at" : "2023-10-04T15:13:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1747097691",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/73197?v=4",
         "events_url" : "https://api.github.com/users/jamesob/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jamesob/followers",
         "following_url" : "https://api.github.com/users/jamesob/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jamesob/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jamesob",
         "id" : 73197,
         "login" : "jamesob",
         "node_id" : "MDQ6VXNlcjczMTk3",
         "organizations_url" : "https://api.github.com/users/jamesob/orgs",
         "received_events_url" : "https://api.github.com/users/jamesob/received_events",
         "repos_url" : "https://api.github.com/users/jamesob/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jamesob/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jamesob"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Investigating...\r\n\r\nOkay, pushed a fix for that as well to #28589 (https://github.com/bitcoin/bitcoin/pull/28589/commits/eae98ccef53eecf678a76adb5f26e87200d7c34d).",
      "created_at" : "2023-10-04T15:20:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/28585#issuecomment-1747111491",
      "id" : 1747111491,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28585",
      "node_id" : "IC_kwDOABII585oIs5D",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1747111491/reactions"
      },
      "updated_at" : "2023-10-04T15:20:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1747111491",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/73197?v=4",
         "events_url" : "https://api.github.com/users/jamesob/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jamesob/followers",
         "following_url" : "https://api.github.com/users/jamesob/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jamesob/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jamesob",
         "id" : 73197,
         "login" : "jamesob",
         "node_id" : "MDQ6VXNlcjczMTk3",
         "organizations_url" : "https://api.github.com/users/jamesob/orgs",
         "received_events_url" : "https://api.github.com/users/jamesob/received_events",
         "repos_url" : "https://api.github.com/users/jamesob/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jamesob/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jamesob"
      }
   }
]
