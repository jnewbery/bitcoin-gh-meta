[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage\nFor detailed information about the code coverage, see the [test coverage report](https://corecheck.dev/bitcoin/bitcoin/pulls/29736).\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [brunoerg](https://github.com/bitcoin/bitcoin/pull/29736#pullrequestreview-1963220463) |\n| Concept ACK | [kevkevinpal](https://github.com/bitcoin/bitcoin/pull/29736#issuecomment-2021745380) |\n\nIf your review is incorrectly listed, please react with ð to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#29575](https://github.com/bitcoin/bitcoin/pull/29575) (net_processing: make any misbehavior trigger immediate discouragement by sipa)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "created_at" : "2024-03-26T15:12:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29736#issuecomment-2020702484",
      "id" : 2020702484,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29736",
      "node_id" : "IC_kwDOABII5854cXkU",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2020702484/reactions"
      },
      "updated_at" : "2024-03-27T12:47:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2020702484",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I've added a default case for `block_hash=None`, for the cases in which we may care about a message being received (for flow control), but not really about the content of it. `FullBlockTest::bootstrap_p2p` in `feature_block.py` is a good example of this.",
      "created_at" : "2024-03-26T15:14:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29736#issuecomment-2020707330",
      "id" : 2020707330,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29736",
      "node_id" : "IC_kwDOABII5854cYwC",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2020707330/reactions"
      },
      "updated_at" : "2024-03-26T15:14:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2020707330",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6665628?v=4",
         "events_url" : "https://api.github.com/users/sr-gi/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sr-gi/followers",
         "following_url" : "https://api.github.com/users/sr-gi/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sr-gi/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sr-gi",
         "id" : 6665628,
         "login" : "sr-gi",
         "node_id" : "MDQ6VXNlcjY2NjU2Mjg=",
         "organizations_url" : "https://api.github.com/users/sr-gi/orgs",
         "received_events_url" : "https://api.github.com/users/sr-gi/received_events",
         "repos_url" : "https://api.github.com/users/sr-gi/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sr-gi/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sr-gi/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sr-gi"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--85328a0da195eb286784d51f73fa0af9-->\n\nð§ At least one of the CI tasks failed. Make sure to run all tests locally, according to the\ndocumentation.\n\nPossibly this is due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n<sub>Debug: https://github.com/bitcoin/bitcoin/runs/23110398265</sub>",
      "created_at" : "2024-03-26T15:17:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29736#issuecomment-2020716663",
      "id" : 2020716663,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29736",
      "node_id" : "IC_kwDOABII5854cbB3",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2020716663/reactions"
      },
      "updated_at" : "2024-03-26T15:17:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2020716663",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Something that may be worth discussing is whether we want to assert that the desired block hash is within the hashes reported on the `getheaders` message (current approach), or if we want to make sure it matches the first one (i.e. the closest to the tip).\r\n\r\nFor the patched tests, I've made sure that it was the case it matched the closest to the tip, but its parent would also have made the test pass. ",
      "created_at" : "2024-03-26T15:52:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29736#issuecomment-2020812710",
      "id" : 2020812710,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29736",
      "node_id" : "IC_kwDOABII5854cyem",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2020812710/reactions"
      },
      "updated_at" : "2024-03-26T15:52:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2020812710",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6665628?v=4",
         "events_url" : "https://api.github.com/users/sr-gi/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sr-gi/followers",
         "following_url" : "https://api.github.com/users/sr-gi/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sr-gi/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sr-gi",
         "id" : 6665628,
         "login" : "sr-gi",
         "node_id" : "MDQ6VXNlcjY2NjU2Mjg=",
         "organizations_url" : "https://api.github.com/users/sr-gi/orgs",
         "received_events_url" : "https://api.github.com/users/sr-gi/received_events",
         "repos_url" : "https://api.github.com/users/sr-gi/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sr-gi/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sr-gi/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sr-gi"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@maflcko @stratospher",
      "created_at" : "2024-03-26T16:27:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29736#issuecomment-2020909980",
      "id" : 2020909980,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29736",
      "node_id" : "IC_kwDOABII5854dKOc",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2020909980/reactions"
      },
      "updated_at" : "2024-03-26T16:27:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2020909980",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6665628?v=4",
         "events_url" : "https://api.github.com/users/sr-gi/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sr-gi/followers",
         "following_url" : "https://api.github.com/users/sr-gi/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sr-gi/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sr-gi",
         "id" : 6665628,
         "login" : "sr-gi",
         "node_id" : "MDQ6VXNlcjY2NjU2Mjg=",
         "organizations_url" : "https://api.github.com/users/sr-gi/orgs",
         "received_events_url" : "https://api.github.com/users/sr-gi/received_events",
         "repos_url" : "https://api.github.com/users/sr-gi/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sr-gi/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sr-gi/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sr-gi"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK [3520d28](https://github.com/bitcoin/bitcoin/pull/29736/commits/3520d28a6e9ff704eabd8d445ad8f6fe4154e5c8)\r\n\r\njust an observation, It seems like we only use `block_hash=None` in `feature_block.py`\r\n\r\n> Something that may be worth discussing is whether we want to assert that the desired block hash is within the hashes reported on the `getheaders` message (current approach), or if we want to make sure it matches the first one (i.e. the closest to the tip).\r\n\r\nIf we're looking for the `block_hash` as the tip value is there a chance we can miss the correct `block_hash` being the tip causing the test to fail?\r\n\r\n\r\n",
      "created_at" : "2024-03-27T01:13:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29736#issuecomment-2021745380",
      "id" : 2021745380,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29736",
      "node_id" : "IC_kwDOABII5854gWLk",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2021745380/reactions"
      },
      "updated_at" : "2024-03-27T01:13:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2021745380",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/15950706?v=4",
         "events_url" : "https://api.github.com/users/kevkevinpal/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kevkevinpal/followers",
         "following_url" : "https://api.github.com/users/kevkevinpal/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kevkevinpal/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kevkevinpal",
         "id" : 15950706,
         "login" : "kevkevinpal",
         "node_id" : "MDQ6VXNlcjE1OTUwNzA2",
         "organizations_url" : "https://api.github.com/users/kevkevinpal/orgs",
         "received_events_url" : "https://api.github.com/users/kevkevinpal/received_events",
         "repos_url" : "https://api.github.com/users/kevkevinpal/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kevkevinpal/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kevkevinpal/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kevkevinpal"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29736#discussion_r1540654057"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29736"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1540654057"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```suggestion\r\n    def wait_for_getheaders(self, block_hash=None, *, timeout=60):\r\n```\r\n\r\nunrelated style nit, while touching this: Could make `timeout` a keyword-only argument?",
      "commit_id" : "3520d28a6e9ff704eabd8d445ad8f6fe4154e5c8",
      "created_at" : "2024-03-27T08:25:53Z",
      "diff_hunk" : "@@ -644,15 +644,17 @@ def test_function():\n \n         self.wait_until(test_function, timeout=timeout)\n \n-    def wait_for_getheaders(self, timeout=60):\n-        \"\"\"Waits for a getheaders message.\n+    def wait_for_getheaders(self, block_hash=None, timeout=60):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29736#discussion_r1540654057",
      "id" : 1540654057,
      "line" : 647,
      "node_id" : "PRRC_kwDOABII585b1IPp",
      "original_commit_id" : "3520d28a6e9ff704eabd8d445ad8f6fe4154e5c8",
      "original_line" : 647,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/p2p.py",
      "position" : 6,
      "pull_request_review_id" : 1962604648,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29736",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1540654057/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-03-27T08:28:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1540654057",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29736#discussion_r1540662565"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29736"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1540662565"
         }
      },
      "author_association" : "MEMBER",
      "body" : "unrelated question: What does \"drop\" mean in the comment? I think nothing is dropped?",
      "commit_id" : "3520d28a6e9ff704eabd8d445ad8f6fe4154e5c8",
      "created_at" : "2024-03-27T08:31:41Z",
      "diff_hunk" : "@@ -308,7 +308,7 @@ def chain_tip(b_hash, *, status='headers-only', branchlen=1):\n \n         # Should ask for the block from a p2p node, if they announce the header as well:\n         peer = node.add_p2p_connection(P2PDataStore())\n-        peer.wait_for_getheaders(timeout=5)  # Drop the first getheaders\n+        peer.wait_for_getheaders(timeout=5, block_hash=block.hashPrevBlock)  # Drop the first getheaders",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29736#discussion_r1540662565",
      "id" : 1540662565,
      "line" : 311,
      "node_id" : "PRRC_kwDOABII585b1KUl",
      "original_commit_id" : "3520d28a6e9ff704eabd8d445ad8f6fe4154e5c8",
      "original_line" : 311,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "test/functional/mining_basic.py",
      "position" : 5,
      "pull_request_review_id" : 1962616983,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29736",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1540662565/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-03-27T08:31:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1540662565",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> lgtm\r\n> \r\n> > Partially fixes #18614\r\n> \r\n> I think this fully solves the remainder, or is something left to be done afterwards?\r\n\r\nYou're right, I thought there may be other methods that also needed patching (and didn't check that was not the case ð ).\r\n\r\nI'm working on a cleanup PR for things that were left out after #18690, but that should be unrelated",
      "created_at" : "2024-03-27T09:23:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29736#issuecomment-2022292858",
      "id" : 2022292858,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29736",
      "node_id" : "IC_kwDOABII5854ib16",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2022292858/reactions"
      },
      "updated_at" : "2024-03-27T09:26:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2022292858",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6665628?v=4",
         "events_url" : "https://api.github.com/users/sr-gi/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sr-gi/followers",
         "following_url" : "https://api.github.com/users/sr-gi/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sr-gi/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sr-gi",
         "id" : 6665628,
         "login" : "sr-gi",
         "node_id" : "MDQ6VXNlcjY2NjU2Mjg=",
         "organizations_url" : "https://api.github.com/users/sr-gi/orgs",
         "received_events_url" : "https://api.github.com/users/sr-gi/received_events",
         "repos_url" : "https://api.github.com/users/sr-gi/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sr-gi/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sr-gi/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sr-gi"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK",
      "created_at" : "2024-03-27T09:24:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29736#issuecomment-2022294131",
      "id" : 2022294131,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29736",
      "node_id" : "IC_kwDOABII5854icJz",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2022294131/reactions"
      },
      "updated_at" : "2024-03-27T09:24:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2022294131",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19480819?v=4",
         "events_url" : "https://api.github.com/users/brunoerg/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brunoerg/followers",
         "following_url" : "https://api.github.com/users/brunoerg/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brunoerg/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brunoerg",
         "id" : 19480819,
         "login" : "brunoerg",
         "node_id" : "MDQ6VXNlcjE5NDgwODE5",
         "organizations_url" : "https://api.github.com/users/brunoerg/orgs",
         "received_events_url" : "https://api.github.com/users/brunoerg/received_events",
         "repos_url" : "https://api.github.com/users/brunoerg/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brunoerg/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brunoerg/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brunoerg"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29736#discussion_r1540743089"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29736"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1540743089"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Interesting, no other `wait_for_*` method has it like that. What's the rationale?",
      "commit_id" : "3520d28a6e9ff704eabd8d445ad8f6fe4154e5c8",
      "created_at" : "2024-03-27T09:29:21Z",
      "diff_hunk" : "@@ -644,15 +644,17 @@ def test_function():\n \n         self.wait_until(test_function, timeout=timeout)\n \n-    def wait_for_getheaders(self, timeout=60):\n-        \"\"\"Waits for a getheaders message.\n+    def wait_for_getheaders(self, block_hash=None, timeout=60):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29736#discussion_r1540743089",
      "id" : 1540743089,
      "in_reply_to_id" : 1540654057,
      "line" : 647,
      "node_id" : "PRRC_kwDOABII585b1d-x",
      "original_commit_id" : "3520d28a6e9ff704eabd8d445ad8f6fe4154e5c8",
      "original_line" : 647,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/p2p.py",
      "position" : 6,
      "pull_request_review_id" : 1962751677,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29736",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1540743089/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-03-27T09:29:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1540743089",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6665628?v=4",
         "events_url" : "https://api.github.com/users/sr-gi/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sr-gi/followers",
         "following_url" : "https://api.github.com/users/sr-gi/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sr-gi/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sr-gi",
         "id" : 6665628,
         "login" : "sr-gi",
         "node_id" : "MDQ6VXNlcjY2NjU2Mjg=",
         "organizations_url" : "https://api.github.com/users/sr-gi/orgs",
         "received_events_url" : "https://api.github.com/users/sr-gi/received_events",
         "repos_url" : "https://api.github.com/users/sr-gi/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sr-gi/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sr-gi/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sr-gi"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29736#discussion_r1540747142"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29736"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1540747142"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think that may be an old comment, given there is no dropping (there nor later by manually accessing `last_message`). I'll get rid of it.",
      "commit_id" : "3520d28a6e9ff704eabd8d445ad8f6fe4154e5c8",
      "created_at" : "2024-03-27T09:31:36Z",
      "diff_hunk" : "@@ -308,7 +308,7 @@ def chain_tip(b_hash, *, status='headers-only', branchlen=1):\n \n         # Should ask for the block from a p2p node, if they announce the header as well:\n         peer = node.add_p2p_connection(P2PDataStore())\n-        peer.wait_for_getheaders(timeout=5)  # Drop the first getheaders\n+        peer.wait_for_getheaders(timeout=5, block_hash=block.hashPrevBlock)  # Drop the first getheaders",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29736#discussion_r1540747142",
      "id" : 1540747142,
      "in_reply_to_id" : 1540662565,
      "line" : 311,
      "node_id" : "PRRC_kwDOABII585b1e-G",
      "original_commit_id" : "3520d28a6e9ff704eabd8d445ad8f6fe4154e5c8",
      "original_line" : 311,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "test/functional/mining_basic.py",
      "position" : 5,
      "pull_request_review_id" : 1962758384,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29736",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1540747142/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-03-27T09:31:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1540747142",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6665628?v=4",
         "events_url" : "https://api.github.com/users/sr-gi/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sr-gi/followers",
         "following_url" : "https://api.github.com/users/sr-gi/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sr-gi/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sr-gi",
         "id" : 6665628,
         "login" : "sr-gi",
         "node_id" : "MDQ6VXNlcjY2NjU2Mjg=",
         "organizations_url" : "https://api.github.com/users/sr-gi/orgs",
         "received_events_url" : "https://api.github.com/users/sr-gi/received_events",
         "repos_url" : "https://api.github.com/users/sr-gi/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sr-gi/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sr-gi/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sr-gi"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Concept ACK [3520d28](https://github.com/bitcoin/bitcoin/pull/29736/commits/3520d28a6e9ff704eabd8d445ad8f6fe4154e5c8)\r\n> \r\n> just an observation, It seems like we only use `block_hash=None` in `feature_block.py`\r\n\r\nYeah, that's done on purpose. The `getheaders` received in `feature_block.py` is part of the reconnection. The test is not really expecting that a `getheaders` with a specific block hash is received, but that the message is received as part of the connection flow. Trying to make it assert an specific block hash would make the test more verbose with no apparent benefits\r\n\r\n> > Something that may be worth discussing is whether we want to assert that the desired block hash is within the hashes reported on the `getheaders` message (current approach), or if we want to make sure it matches the first one (i.e. the closest to the tip).\r\n> \r\n> If we're looking for the `block_hash` as the tip value is there a chance we can miss the correct `block_hash` being the tip causing the test to fail?\r\n\r\nThat could imply that the test is wrong. The current approach is more permissive, but it means that a test could pass unexpectedly. e.g; Imagine our current chain looks like this:\r\n\r\n```\r\nGenesis - B1 - ... - BN - BN+1 - BN+2 (tip)\r\n```\r\n\r\nWe wait to receive a `getheaders` containing `BN`, and we receive:\r\n\r\n```\r\n[BN+1, BN, ..., Genesis]\r\n```\r\n\r\nIn this case, the test will pass because our expected hash is within the received hashes, but likely the test should have waited for `BN+1`.\r\n\r\nIt really depends on what we want to check, and the flexibility we want to give to the method though",
      "created_at" : "2024-03-27T09:39:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29736#issuecomment-2022321286",
      "id" : 2022321286,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29736",
      "node_id" : "IC_kwDOABII5854iiyG",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2022321286/reactions"
      },
      "updated_at" : "2024-03-27T09:39:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2022321286",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6665628?v=4",
         "events_url" : "https://api.github.com/users/sr-gi/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sr-gi/followers",
         "following_url" : "https://api.github.com/users/sr-gi/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sr-gi/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sr-gi",
         "id" : 6665628,
         "login" : "sr-gi",
         "node_id" : "MDQ6VXNlcjY2NjU2Mjg=",
         "organizations_url" : "https://api.github.com/users/sr-gi/orgs",
         "received_events_url" : "https://api.github.com/users/sr-gi/received_events",
         "repos_url" : "https://api.github.com/users/sr-gi/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sr-gi/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sr-gi/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sr-gi"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29736#discussion_r1540774250"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29736"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1540774250"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Generally, I find it preferable when code is self-documenting. Forcing named arguments ensures that arguments are named at the call site, especially when they are integral literals.\r\n\r\nFor example:\r\n\r\n```py\r\npeer.wait_for_getheaders(tip, 99)\r\n```\r\n\r\nmay be questionable as to what it means, and even brittle, if in the future the function takes another integral parameter. However,\r\n\r\n```py\r\npeer.wait_for_getheaders(tip, timeout=99)\r\n```\r\n\r\nmakes it clear that `99` means `timeout`, with or without the function taking other parameters of the same type (or types that can silently decay into `int` in python).\r\n\r\n",
      "commit_id" : "3520d28a6e9ff704eabd8d445ad8f6fe4154e5c8",
      "created_at" : "2024-03-27T09:50:43Z",
      "diff_hunk" : "@@ -644,15 +644,17 @@ def test_function():\n \n         self.wait_until(test_function, timeout=timeout)\n \n-    def wait_for_getheaders(self, timeout=60):\n-        \"\"\"Waits for a getheaders message.\n+    def wait_for_getheaders(self, block_hash=None, timeout=60):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29736#discussion_r1540774250",
      "id" : 1540774250,
      "in_reply_to_id" : 1540654057,
      "line" : 647,
      "node_id" : "PRRC_kwDOABII585b1llq",
      "original_commit_id" : "3520d28a6e9ff704eabd8d445ad8f6fe4154e5c8",
      "original_line" : 647,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/p2p.py",
      "position" : 6,
      "pull_request_review_id" : 1962801455,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29736",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1540774250/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-03-27T09:50:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1540774250",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29736#discussion_r1540776263"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29736"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1540776263"
         }
      },
      "author_association" : "MEMBER",
      "body" : "(Another reason is that the timeout should rarely be overwritten from the default value, so forcing the code to be longer is a way to force developers to re-think whether it is needed)",
      "commit_id" : "3520d28a6e9ff704eabd8d445ad8f6fe4154e5c8",
      "created_at" : "2024-03-27T09:52:14Z",
      "diff_hunk" : "@@ -644,15 +644,17 @@ def test_function():\n \n         self.wait_until(test_function, timeout=timeout)\n \n-    def wait_for_getheaders(self, timeout=60):\n-        \"\"\"Waits for a getheaders message.\n+    def wait_for_getheaders(self, block_hash=None, timeout=60):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29736#discussion_r1540776263",
      "id" : 1540776263,
      "in_reply_to_id" : 1540654057,
      "line" : 647,
      "node_id" : "PRRC_kwDOABII585b1mFH",
      "original_commit_id" : "3520d28a6e9ff704eabd8d445ad8f6fe4154e5c8",
      "original_line" : 647,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/p2p.py",
      "position" : 6,
      "pull_request_review_id" : 1962804932,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29736",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1540776263/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-03-27T09:52:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1540776263",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29736#discussion_r1540779210"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29736"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1540779210"
         }
      },
      "author_association" : "MEMBER",
      "body" : "According to fa091b001605c4481fb4eca415929a98d3478549, it was written by me :man_facepalming: ",
      "commit_id" : "3520d28a6e9ff704eabd8d445ad8f6fe4154e5c8",
      "created_at" : "2024-03-27T09:54:12Z",
      "diff_hunk" : "@@ -308,7 +308,7 @@ def chain_tip(b_hash, *, status='headers-only', branchlen=1):\n \n         # Should ask for the block from a p2p node, if they announce the header as well:\n         peer = node.add_p2p_connection(P2PDataStore())\n-        peer.wait_for_getheaders(timeout=5)  # Drop the first getheaders\n+        peer.wait_for_getheaders(timeout=5, block_hash=block.hashPrevBlock)  # Drop the first getheaders",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29736#discussion_r1540779210",
      "id" : 1540779210,
      "in_reply_to_id" : 1540662565,
      "line" : 311,
      "node_id" : "PRRC_kwDOABII585b1mzK",
      "original_commit_id" : "3520d28a6e9ff704eabd8d445ad8f6fe4154e5c8",
      "original_line" : 311,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "test/functional/mining_basic.py",
      "position" : 5,
      "pull_request_review_id" : 1962809388,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29736",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 1,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1540779210/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-03-27T09:54:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1540779210",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29736#discussion_r1540801883"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29736"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1540801883"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Oh, I agree with you, my point is why do we want to do it for this one but not for any of the others `wait_for_*` methods?",
      "commit_id" : "3520d28a6e9ff704eabd8d445ad8f6fe4154e5c8",
      "created_at" : "2024-03-27T10:07:37Z",
      "diff_hunk" : "@@ -644,15 +644,17 @@ def test_function():\n \n         self.wait_until(test_function, timeout=timeout)\n \n-    def wait_for_getheaders(self, timeout=60):\n-        \"\"\"Waits for a getheaders message.\n+    def wait_for_getheaders(self, block_hash=None, timeout=60):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29736#discussion_r1540801883",
      "id" : 1540801883,
      "in_reply_to_id" : 1540654057,
      "line" : 647,
      "node_id" : "PRRC_kwDOABII585b1sVb",
      "original_commit_id" : "3520d28a6e9ff704eabd8d445ad8f6fe4154e5c8",
      "original_line" : 647,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/p2p.py",
      "position" : 6,
      "pull_request_review_id" : 1962844190,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29736",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1540801883/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-03-27T10:07:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1540801883",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6665628?v=4",
         "events_url" : "https://api.github.com/users/sr-gi/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sr-gi/followers",
         "following_url" : "https://api.github.com/users/sr-gi/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sr-gi/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sr-gi",
         "id" : 6665628,
         "login" : "sr-gi",
         "node_id" : "MDQ6VXNlcjY2NjU2Mjg=",
         "organizations_url" : "https://api.github.com/users/sr-gi/orgs",
         "received_events_url" : "https://api.github.com/users/sr-gi/received_events",
         "repos_url" : "https://api.github.com/users/sr-gi/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sr-gi/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sr-gi/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sr-gi"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29736#discussion_r1540811380"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29736"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1540811380"
         }
      },
      "author_association" : "MEMBER",
      "body" : "If you want to do it for the others as well, it'd be great. Make sure to put it into a separate commit, to aid review.",
      "commit_id" : "3520d28a6e9ff704eabd8d445ad8f6fe4154e5c8",
      "created_at" : "2024-03-27T10:14:41Z",
      "diff_hunk" : "@@ -644,15 +644,17 @@ def test_function():\n \n         self.wait_until(test_function, timeout=timeout)\n \n-    def wait_for_getheaders(self, timeout=60):\n-        \"\"\"Waits for a getheaders message.\n+    def wait_for_getheaders(self, block_hash=None, timeout=60):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29736#discussion_r1540811380",
      "id" : 1540811380,
      "in_reply_to_id" : 1540654057,
      "line" : 647,
      "node_id" : "PRRC_kwDOABII585b1up0",
      "original_commit_id" : "3520d28a6e9ff704eabd8d445ad8f6fe4154e5c8",
      "original_line" : 647,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/p2p.py",
      "position" : 6,
      "pull_request_review_id" : 1962866920,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29736",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1540811380/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-03-27T10:14:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1540811380",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29736#discussion_r1540949742"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29736"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1540949742"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Do you think this should be part of the same PR, or should I open a separate one to cover all cases?",
      "commit_id" : "fb9eb7a19d87e1a896ebfb16a09c36cdf3816228",
      "created_at" : "2024-03-27T11:41:39Z",
      "diff_hunk" : "@@ -644,15 +644,17 @@ def test_function():\n \n         self.wait_until(test_function, timeout=timeout)\n \n-    def wait_for_getheaders(self, timeout=60):\n-        \"\"\"Waits for a getheaders message.\n+    def wait_for_getheaders(self, block_hash=None, timeout=60):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29736#discussion_r1540949742",
      "id" : 1540949742,
      "in_reply_to_id" : 1540654057,
      "line" : 647,
      "node_id" : "PRRC_kwDOABII585b2Qbu",
      "original_commit_id" : "3520d28a6e9ff704eabd8d445ad8f6fe4154e5c8",
      "original_line" : 647,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/p2p.py",
      "position" : 6,
      "pull_request_review_id" : 1963073996,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29736",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1540949742/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-03-27T11:41:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1540949742",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6665628?v=4",
         "events_url" : "https://api.github.com/users/sr-gi/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sr-gi/followers",
         "following_url" : "https://api.github.com/users/sr-gi/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sr-gi/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sr-gi",
         "id" : 6665628,
         "login" : "sr-gi",
         "node_id" : "MDQ6VXNlcjY2NjU2Mjg=",
         "organizations_url" : "https://api.github.com/users/sr-gi/orgs",
         "received_events_url" : "https://api.github.com/users/sr-gi/received_events",
         "repos_url" : "https://api.github.com/users/sr-gi/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sr-gi/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sr-gi/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sr-gi"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29736#discussion_r1540970315"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29736"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1540970315"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Up to you :)",
      "commit_id" : "fb9eb7a19d87e1a896ebfb16a09c36cdf3816228",
      "created_at" : "2024-03-27T11:58:17Z",
      "diff_hunk" : "@@ -644,15 +644,17 @@ def test_function():\n \n         self.wait_until(test_function, timeout=timeout)\n \n-    def wait_for_getheaders(self, timeout=60):\n-        \"\"\"Waits for a getheaders message.\n+    def wait_for_getheaders(self, block_hash=None, timeout=60):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29736#discussion_r1540970315",
      "id" : 1540970315,
      "in_reply_to_id" : 1540654057,
      "line" : 647,
      "node_id" : "PRRC_kwDOABII585b2VdL",
      "original_commit_id" : "3520d28a6e9ff704eabd8d445ad8f6fe4154e5c8",
      "original_line" : 647,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/p2p.py",
      "position" : 6,
      "pull_request_review_id" : 1963106994,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29736",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1540970315/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-03-27T11:58:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1540970315",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29736#discussion_r1541001039"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29736"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1541001039"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In 247c5a54c028bde21d010299cd447397b25c31ba: `vHave` is a list so we could do:\r\n```suggestion\r\n            return block_hash in last_getheaders.locator.vHave\r\n```",
      "commit_id" : "fb9eb7a19d87e1a896ebfb16a09c36cdf3816228",
      "created_at" : "2024-03-27T12:21:36Z",
      "diff_hunk" : "@@ -644,15 +644,17 @@ def test_function():\n \n         self.wait_until(test_function, timeout=timeout)\n \n-    def wait_for_getheaders(self, timeout=60):\n-        \"\"\"Waits for a getheaders message.\n+    def wait_for_getheaders(self, block_hash=None, *, timeout=60):\n+        \"\"\"Waits for a getheaders message containing a specific block hash.\n \n-        Receiving any getheaders message will satisfy the predicate. the last_message[\"getheaders\"]\n-        value must be explicitly cleared before calling this method, or this will return\n-        immediately with success. TODO: change this method to take a hash value and only\n-        return true if the correct block header has been requested.\"\"\"\n+        If no block hash is provided, checks whether any getheaders message has been received by the node.\"\"\"\n         def test_function():\n-            return self.last_message.get(\"getheaders\")\n+            last_getheaders = self.last_message.get(\"getheaders\")\n+            if block_hash is None:\n+                 return last_getheaders\n+            if last_getheaders is None:\n+                return False\n+            return block_hash in [hash for hash in last_getheaders.locator.vHave]",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29736#discussion_r1541001039",
      "id" : 1541001039,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585b2c9P",
      "original_commit_id" : "247c5a54c028bde21d010299cd447397b25c31ba",
      "original_line" : 657,
      "original_position" : 21,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/p2p.py",
      "position" : null,
      "pull_request_review_id" : 1963156347,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29736",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1541001039/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-03-27T12:21:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1541001039",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19480819?v=4",
         "events_url" : "https://api.github.com/users/brunoerg/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brunoerg/followers",
         "following_url" : "https://api.github.com/users/brunoerg/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brunoerg/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brunoerg",
         "id" : 19480819,
         "login" : "brunoerg",
         "node_id" : "MDQ6VXNlcjE5NDgwODE5",
         "organizations_url" : "https://api.github.com/users/brunoerg/orgs",
         "received_events_url" : "https://api.github.com/users/brunoerg/received_events",
         "repos_url" : "https://api.github.com/users/brunoerg/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brunoerg/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brunoerg/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brunoerg"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29736#discussion_r1541033816"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29736"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1541033816"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Covered in [fb9eb7a](https://github.com/bitcoin/bitcoin/pull/29736/commits/fb9eb7a19d87e1a896ebfb16a09c36cdf3816228)",
      "commit_id" : "fb9eb7a19d87e1a896ebfb16a09c36cdf3816228",
      "created_at" : "2024-03-27T12:41:38Z",
      "diff_hunk" : "@@ -644,15 +644,17 @@ def test_function():\n \n         self.wait_until(test_function, timeout=timeout)\n \n-    def wait_for_getheaders(self, timeout=60):\n-        \"\"\"Waits for a getheaders message.\n+    def wait_for_getheaders(self, block_hash=None, *, timeout=60):\n+        \"\"\"Waits for a getheaders message containing a specific block hash.\n \n-        Receiving any getheaders message will satisfy the predicate. the last_message[\"getheaders\"]\n-        value must be explicitly cleared before calling this method, or this will return\n-        immediately with success. TODO: change this method to take a hash value and only\n-        return true if the correct block header has been requested.\"\"\"\n+        If no block hash is provided, checks whether any getheaders message has been received by the node.\"\"\"\n         def test_function():\n-            return self.last_message.get(\"getheaders\")\n+            last_getheaders = self.last_message.get(\"getheaders\")\n+            if block_hash is None:\n+                 return last_getheaders\n+            if last_getheaders is None:\n+                return False\n+            return block_hash in [hash for hash in last_getheaders.locator.vHave]",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29736#discussion_r1541033816",
      "id" : 1541033816,
      "in_reply_to_id" : 1541001039,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585b2k9Y",
      "original_commit_id" : "247c5a54c028bde21d010299cd447397b25c31ba",
      "original_line" : 657,
      "original_position" : 21,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/p2p.py",
      "position" : null,
      "pull_request_review_id" : 1963205321,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29736",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1541033816/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-03-27T12:41:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1541033816",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6665628?v=4",
         "events_url" : "https://api.github.com/users/sr-gi/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sr-gi/followers",
         "following_url" : "https://api.github.com/users/sr-gi/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sr-gi/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sr-gi",
         "id" : 6665628,
         "login" : "sr-gi",
         "node_id" : "MDQ6VXNlcjY2NjU2Mjg=",
         "organizations_url" : "https://api.github.com/users/sr-gi/orgs",
         "received_events_url" : "https://api.github.com/users/sr-gi/received_events",
         "repos_url" : "https://api.github.com/users/sr-gi/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sr-gi/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sr-gi/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sr-gi"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29736#discussion_r1541035168"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29736"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1541035168"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Tackled in #29750",
      "commit_id" : "fb9eb7a19d87e1a896ebfb16a09c36cdf3816228",
      "created_at" : "2024-03-27T12:42:38Z",
      "diff_hunk" : "@@ -644,15 +644,17 @@ def test_function():\n \n         self.wait_until(test_function, timeout=timeout)\n \n-    def wait_for_getheaders(self, timeout=60):\n-        \"\"\"Waits for a getheaders message.\n+    def wait_for_getheaders(self, block_hash=None, timeout=60):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29736#discussion_r1541035168",
      "id" : 1541035168,
      "in_reply_to_id" : 1540654057,
      "line" : 647,
      "node_id" : "PRRC_kwDOABII585b2lSg",
      "original_commit_id" : "3520d28a6e9ff704eabd8d445ad8f6fe4154e5c8",
      "original_line" : 647,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/p2p.py",
      "position" : 6,
      "pull_request_review_id" : 1963207330,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29736",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1541035168/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-03-27T12:42:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1541035168",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6665628?v=4",
         "events_url" : "https://api.github.com/users/sr-gi/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sr-gi/followers",
         "following_url" : "https://api.github.com/users/sr-gi/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sr-gi/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sr-gi",
         "id" : 6665628,
         "login" : "sr-gi",
         "node_id" : "MDQ6VXNlcjY2NjU2Mjg=",
         "organizations_url" : "https://api.github.com/users/sr-gi/orgs",
         "received_events_url" : "https://api.github.com/users/sr-gi/received_events",
         "repos_url" : "https://api.github.com/users/sr-gi/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sr-gi/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sr-gi/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sr-gi"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I just tried with `return block_hash == last_getheaders.locator.vHave[0]` and the tests seemed to have run fine for me. So I have no problem just checking the last `block_hash` ",
      "created_at" : "2024-03-27T12:48:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29736#issuecomment-2022687247",
      "id" : 2022687247,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29736",
      "node_id" : "IC_kwDOABII5854j8IP",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2022687247/reactions"
      },
      "updated_at" : "2024-03-27T12:48:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2022687247",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/15950706?v=4",
         "events_url" : "https://api.github.com/users/kevkevinpal/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kevkevinpal/followers",
         "following_url" : "https://api.github.com/users/kevkevinpal/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kevkevinpal/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kevkevinpal",
         "id" : 15950706,
         "login" : "kevkevinpal",
         "node_id" : "MDQ6VXNlcjE1OTUwNzA2",
         "organizations_url" : "https://api.github.com/users/kevkevinpal/orgs",
         "received_events_url" : "https://api.github.com/users/kevkevinpal/received_events",
         "repos_url" : "https://api.github.com/users/kevkevinpal/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kevkevinpal/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kevkevinpal/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kevkevinpal"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> I just tried with `return block_hash == last_getheaders.locator.vHave[0]` and the tests seemed to have run fine for me. So I have no problem just checking the last `block_hash`\r\n\r\nYeah, for all patched tests I\"ve made sure that was the case. The question was more if generally that would be the expected case",
      "created_at" : "2024-03-27T14:38:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29736#issuecomment-2022940457",
      "id" : 2022940457,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29736",
      "node_id" : "IC_kwDOABII5854k58p",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2022940457/reactions"
      },
      "updated_at" : "2024-03-27T14:38:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2022940457",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6665628?v=4",
         "events_url" : "https://api.github.com/users/sr-gi/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sr-gi/followers",
         "following_url" : "https://api.github.com/users/sr-gi/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sr-gi/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sr-gi",
         "id" : 6665628,
         "login" : "sr-gi",
         "node_id" : "MDQ6VXNlcjY2NjU2Mjg=",
         "organizations_url" : "https://api.github.com/users/sr-gi/orgs",
         "received_events_url" : "https://api.github.com/users/sr-gi/received_events",
         "repos_url" : "https://api.github.com/users/sr-gi/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sr-gi/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sr-gi/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sr-gi"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29736#discussion_r1545111761"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29736"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1545111761"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "if we remove this, how can we ensure that we really received a new getheaders message and that it isn't the same getheaders message from a previous iteration?",
      "commit_id" : "fb9eb7a19d87e1a896ebfb16a09c36cdf3816228",
      "created_at" : "2024-03-30T04:58:04Z",
      "diff_hunk" : "@@ -533,15 +535,14 @@ def test_nonnull_locators(self, test_node, inv_node):\n                 block_time += 1\n                 height += 1\n             # Send the header of the second block -> this won't connect.\n-            with p2p_lock:",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29736#discussion_r1545111761",
      "id" : 1545111761,
      "line" : 536,
      "node_id" : "PRRC_kwDOABII585cGIjR",
      "original_commit_id" : "fb9eb7a19d87e1a896ebfb16a09c36cdf3816228",
      "original_line" : 536,
      "original_position" : 29,
      "original_start_line" : null,
      "path" : "test/functional/p2p_sendheaders.py",
      "position" : 29,
      "pull_request_review_id" : 1969807492,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29736",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1545111761/reactions"
      },
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-03-30T05:09:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1545111761",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/44024636?v=4",
         "events_url" : "https://api.github.com/users/stratospher/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stratospher/followers",
         "following_url" : "https://api.github.com/users/stratospher/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stratospher/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stratospher",
         "id" : 44024636,
         "login" : "stratospher",
         "node_id" : "MDQ6VXNlcjQ0MDI0NjM2",
         "organizations_url" : "https://api.github.com/users/stratospher/orgs",
         "received_events_url" : "https://api.github.com/users/stratospher/received_events",
         "repos_url" : "https://api.github.com/users/stratospher/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stratospher/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stratospher/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stratospher"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29736#discussion_r1545161647"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29736"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1545161647"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "oh this is no longer true after 05f7f31. we will only receive a getheaders the first time because of `m_inv_triggered_getheaders_before_sync`. found this issue when i ran the tests by clearing old getheaders as mentioned in https://github.com/bitcoin/bitcoin/pull/29736#discussion_r1545111761.",
      "commit_id" : "fb9eb7a19d87e1a896ebfb16a09c36cdf3816228",
      "created_at" : "2024-03-30T06:26:01Z",
      "diff_hunk" : "@@ -334,7 +335,7 @@ def test_nonnull_locators(self, test_node, inv_node):\n                 if j == 0:\n                     # Announce via inv\n                     test_node.send_block_inv(tip)\n-                    test_node.wait_for_getheaders()\n+                    test_node.wait_for_getheaders(block_hash=expected_hash)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29736#discussion_r1545161647",
      "id" : 1545161647,
      "line" : 338,
      "node_id" : "PRRC_kwDOABII585cGUuv",
      "original_commit_id" : "fb9eb7a19d87e1a896ebfb16a09c36cdf3816228",
      "original_line" : 338,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "test/functional/p2p_sendheaders.py",
      "position" : 13,
      "pull_request_review_id" : 1969840607,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29736",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1545161647/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-03-30T06:26:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1545161647",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/44024636?v=4",
         "events_url" : "https://api.github.com/users/stratospher/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stratospher/followers",
         "following_url" : "https://api.github.com/users/stratospher/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stratospher/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stratospher",
         "id" : 44024636,
         "login" : "stratospher",
         "node_id" : "MDQ6VXNlcjQ0MDI0NjM2",
         "organizations_url" : "https://api.github.com/users/stratospher/orgs",
         "received_events_url" : "https://api.github.com/users/stratospher/received_events",
         "repos_url" : "https://api.github.com/users/stratospher/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stratospher/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stratospher/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stratospher"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29736#discussion_r1545187315"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29736"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1545187315"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "maybe this for https://github.com/bitcoin/bitcoin/pull/29736#discussion_r1545111761?\r\n```suggestion\r\n            last_getheaders = self.last_message.pop(\"getheaders\", None)\r\n```",
      "commit_id" : "fb9eb7a19d87e1a896ebfb16a09c36cdf3816228",
      "created_at" : "2024-03-30T07:19:33Z",
      "diff_hunk" : "@@ -644,15 +644,17 @@ def test_function():\n \n         self.wait_until(test_function, timeout=timeout)\n \n-    def wait_for_getheaders(self, timeout=60):\n-        \"\"\"Waits for a getheaders message.\n+    def wait_for_getheaders(self, block_hash=None, timeout=60):\n+        \"\"\"Waits for a getheaders message containing a specific block hash.\n \n-        Receiving any getheaders message will satisfy the predicate. the last_message[\"getheaders\"]\n-        value must be explicitly cleared before calling this method, or this will return\n-        immediately with success. TODO: change this method to take a hash value and only\n-        return true if the correct block header has been requested.\"\"\"\n+        If no block hash is provided, checks whether any getheaders message has been received by the node.\"\"\"\n         def test_function():\n-            return self.last_message.get(\"getheaders\")\n+            last_getheaders = self.last_message.get(\"getheaders\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29736#discussion_r1545187315",
      "id" : 1545187315,
      "line" : 652,
      "node_id" : "PRRC_kwDOABII585cGa_z",
      "original_commit_id" : "fb9eb7a19d87e1a896ebfb16a09c36cdf3816228",
      "original_line" : 652,
      "original_position" : 16,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/p2p.py",
      "position" : 16,
      "pull_request_review_id" : 1969849316,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29736",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1545187315/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-03-30T07:25:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1545187315",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/44024636?v=4",
         "events_url" : "https://api.github.com/users/stratospher/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stratospher/followers",
         "following_url" : "https://api.github.com/users/stratospher/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stratospher/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stratospher",
         "id" : 44024636,
         "login" : "stratospher",
         "node_id" : "MDQ6VXNlcjQ0MDI0NjM2",
         "organizations_url" : "https://api.github.com/users/stratospher/orgs",
         "received_events_url" : "https://api.github.com/users/stratospher/received_events",
         "repos_url" : "https://api.github.com/users/stratospher/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stratospher/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stratospher/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stratospher"
      }
   }
]
