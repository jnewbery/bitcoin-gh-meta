[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/30230#discussion_r1627954290"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/30230"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1627954290"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Why is it calling `Connect` without specifying `to`? ",
      "commit_id" : "b9a754f24c8f7bc19e4d2df1c0ba8e70b826af34",
      "created_at" : "2024-06-05T15:00:25Z",
      "diff_hunk" : "@@ -0,0 +1,64 @@\n+// Copyright (c) 2020-2022 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// // file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <common/args.h>\n+#include <i2p.h>\n+#include <netaddress.h>\n+#include <netbase.h>\n+#include <test/fuzz/FuzzedDataProvider.h>\n+#include <test/fuzz/fuzz.h>\n+#include <test/fuzz/util.h>\n+#include <test/fuzz/util/net.h>\n+#include <test/util/setup_common.h>\n+#include <util/fs_helpers.h>\n+#include <util/threadinterrupt.h>\n+\n+void initialize_i2p()\n+{\n+    static const auto testing_setup = MakeNoLogFileContext<>();\n+}\n+\n+FUZZ_TARGET(i2p, .init = initialize_i2p)\n+{\n+    FuzzedDataProvider fuzzed_data_provider{buffer.data(), buffer.size()};\n+\n+    SetMockTime(ConsumeTime(fuzzed_data_provider));\n+\n+    // Mock CreateSock() to create FuzzedSock.\n+    auto CreateSockOrig = CreateSock;\n+    CreateSock = [&fuzzed_data_provider](const sa_family_t&) {\n+        return std::make_unique<FuzzedSock>(fuzzed_data_provider);\n+    };\n+\n+    const fs::path private_key_path = gArgs.GetDataDirNet() / \"fuzzed_i2p_private_key\";\n+    const CService addr{in6_addr(IN6ADDR_LOOPBACK_INIT), 7656};\n+    const Proxy sam_proxy{addr, false};\n+    CThreadInterrupt interrupt;\n+\n+    i2p::sam::Session session{private_key_path, sam_proxy, &interrupt};\n+    i2p::Connection conn;\n+\n+    if (session.Listen(conn)) {\n+        if (session.Accept(conn)) {\n+            try {\n+                (void)conn.sock->RecvUntilTerminator('\\n', 10ms, interrupt, i2p::sam::MAX_MSG_SIZE);\n+            } catch (const std::runtime_error&) {\n+            }\n+        }\n+    }\n+\n+    const CService to;\n+    bool proxy_error;\n+\n+    if (session.Connect(to, conn, proxy_error)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/30230#discussion_r1627954290",
      "id" : 1627954290,
      "line" : 54,
      "node_id" : "PRRC_kwDOABII585hCJxy",
      "original_commit_id" : "b9a754f24c8f7bc19e4d2df1c0ba8e70b826af34",
      "original_line" : 54,
      "original_position" : 54,
      "original_start_line" : null,
      "path" : "src/test/fuzz/i2p.cpp",
      "position" : 54,
      "pull_request_review_id" : 2099482370,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/30230",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1627954290/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-06-05T15:00:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1627954290",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19480819?v=4",
         "events_url" : "https://api.github.com/users/brunoerg/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brunoerg/followers",
         "following_url" : "https://api.github.com/users/brunoerg/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brunoerg/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brunoerg",
         "id" : 19480819,
         "login" : "brunoerg",
         "node_id" : "MDQ6VXNlcjE5NDgwODE5",
         "organizations_url" : "https://api.github.com/users/brunoerg/orgs",
         "received_events_url" : "https://api.github.com/users/brunoerg/received_events",
         "repos_url" : "https://api.github.com/users/brunoerg/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brunoerg/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brunoerg/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brunoerg"
      }
   }
]
