[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage\nFor detailed information about the code coverage, see the [test coverage report](https://corecheck.dev/bitcoin/bitcoin/pulls/30213).\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n",
      "created_at" : "2024-05-31T14:39:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/30213#issuecomment-2142402616",
      "id" : 2142402616,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/30213",
      "node_id" : "IC_kwDOABII585_sng4",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2142402616/reactions"
      },
      "updated_at" : "2024-05-31T14:39:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2142402616",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "v2 is fairly straight-forward, but v1 is not.",
      "created_at" : "2024-05-31T14:43:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/30213#issuecomment-2142415999",
      "id" : 2142415999,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/30213",
      "node_id" : "IC_kwDOABII585_sqx_",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2142415999/reactions"
      },
      "updated_at" : "2024-05-31T14:43:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2142415999",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Would an alternative approach be that `V1Transport` and `V2Transport` always just treat the first 12 bytes of a message as the command type (as in on decode they'd produce a message with \"length\" 12+payload_len, etc). That would mean the `Transport` interface works purely on bytes, and could be usable for protocols that don't deal with things that have a command type.\r\n\r\nAnother option is having two layers: a \"raw transport\" interface that works on bytes, and a layer \"command-based transport\" interface on top?",
      "created_at" : "2024-05-31T14:48:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/30213#issuecomment-2142430707",
      "id" : 2142430707,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/30213",
      "node_id" : "IC_kwDOABII585_suXz",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2142430707/reactions"
      },
      "updated_at" : "2024-05-31T14:48:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2142430707",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "In `Sv2Transport` (see [here](https://github.com/bitcoin/bitcoin/pull/29432/files#diff-a84ee692989f2fa3ed26266d59b1d22b608a4f2cfb0ef1faa910a5b96c8ebeef) ) the encrypted header contains both the message length and size. In `V2Transport` we first get the size and then get the type and its content. And in `V1Transport` we first get the message type and then the size followed by the content.\r\n\r\nAt the very minimum `Transport` needs to know the message size. Currently the `V1Transport` and `V2Transport` implementation figure that out. They also perform all the additional steps to construct a `CNetMessage`.\r\n\r\nIn my initial attempt here I moved some of that work to `CNode`, but it's a mess.\r\n\r\n> and a layer \"command-based transport\" interface on top\r\n\r\nI'm not entirely sure what you mean here, but I guess we'd want some new class that tells `Transport` how many bytes to fetch and hands off a `CNetMessage` to `CNode::ReceiveMsgBytes`?",
      "created_at" : "2024-05-31T15:16:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/30213#issuecomment-2142483329",
      "id" : 2142483329,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/30213",
      "node_id" : "IC_kwDOABII585_s7OB",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2142483329/reactions"
      },
      "updated_at" : "2024-05-31T15:17:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2142483329",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   }
]
