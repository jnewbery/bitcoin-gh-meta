[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage\nFor detailed information about the code coverage, see the [test coverage report](https://corecheck.dev/bitcoin/bitcoin/pulls/28647).\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [theStack](https://github.com/bitcoin/bitcoin/pull/28647#pullrequestreview-1676923158), [pablomartin4btc](https://github.com/bitcoin/bitcoin/pull/28647#pullrequestreview-1680916606), [fjahr](https://github.com/bitcoin/bitcoin/pull/28647#issuecomment-1765939188) |\n\nIf your review is incorrectly listed, please react with ð to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#28652](https://github.com/bitcoin/bitcoin/pull/28652) (assumeutxo: fail early if snapshot block hash doesn't match AssumeUTXO parameters by theStack)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "created_at" : "2023-10-13T10:19:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28647#issuecomment-1761275124",
      "id" : 1761275124,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28647",
      "node_id" : "IC_kwDOABII585o-uz0",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1761275124/reactions"
      },
      "updated_at" : "2023-10-17T08:36:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1761275124",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK\r\n\r\nNice. Tried to work on this as well recently and thought it's not possible without implementing a VARINT-parser (for the `Coin` de/serialization), being not aware that the outpoint comes first ð ",
      "created_at" : "2023-10-13T10:48:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28647#issuecomment-1761310820",
      "id" : 1761310820,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28647",
      "node_id" : "IC_kwDOABII585o-3hk",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1761310820/reactions"
      },
      "updated_at" : "2023-10-13T10:48:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1761310820",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28647#discussion_r1361720125"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28647"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1361720125"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Isn't the bad coin height test also already covered with the test where you made the fix?",
      "commit_id" : "fa91fc737dc88899fa7452941327546ec3f73972",
      "created_at" : "2023-10-17T08:24:35Z",
      "diff_hunk" : "@@ -17,8 +17,7 @@\n \n Interesting test cases could be loading an assumeutxo snapshot file with:\n \n-- TODO: An invalid hash\n-- TODO: Valid hash but invalid snapshot file (bad coin height or truncated file or\n+- TODO: Valid hash but invalid snapshot file (bad coin height or",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28647#discussion_r1361720125",
      "id" : 1361720125,
      "line" : 20,
      "node_id" : "PRRC_kwDOABII585RKjM9",
      "original_commit_id" : "fa91fc737dc88899fa7452941327546ec3f73972",
      "original_line" : 20,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "test/functional/feature_assumeutxo.py",
      "position" : 13,
      "pull_request_review_id" : 1681689770,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28647",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1361720125/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-10-17T08:24:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1361720125",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28647#discussion_r1361727248"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28647"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1361727248"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yeah, I wonder how one could test a \"valid\" hash but invalid snapshot file. I guess one would have to add a hash of the invalid file to the source code.\r\n\r\nThough, this comment presumably refers to https://maflcko.github.io/b-c-cov/total.coverage/src/validation.cpp.gcov.html#5398 which is still uncovered.",
      "commit_id" : "fa91fc737dc88899fa7452941327546ec3f73972",
      "created_at" : "2023-10-17T08:29:20Z",
      "diff_hunk" : "@@ -17,8 +17,7 @@\n \n Interesting test cases could be loading an assumeutxo snapshot file with:\n \n-- TODO: An invalid hash\n-- TODO: Valid hash but invalid snapshot file (bad coin height or truncated file or\n+- TODO: Valid hash but invalid snapshot file (bad coin height or",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28647#discussion_r1361727248",
      "id" : 1361727248,
      "in_reply_to_id" : 1361720125,
      "line" : 20,
      "node_id" : "PRRC_kwDOABII585RKk8Q",
      "original_commit_id" : "fa91fc737dc88899fa7452941327546ec3f73972",
      "original_line" : 20,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "test/functional/feature_assumeutxo.py",
      "position" : 13,
      "pull_request_review_id" : 1681703300,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28647",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1361727248/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-10-17T08:29:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1361727248",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "utACK fa91fc737dc88899fa7452941327546ec3f73972",
      "created_at" : "2023-10-17T08:36:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28647#issuecomment-1765939188",
      "id" : 1765939188,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28647",
      "node_id" : "IC_kwDOABII585pQhf0",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 1,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1765939188/reactions"
      },
      "updated_at" : "2023-10-17T08:36:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1765939188",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28647#discussion_r1361773682"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28647"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1361773682"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "> I wonder how one could test a \"valid\" hash but invalid snapshot file\r\n\r\nI would just generally understand this as taking a valid snapshot file and altering the content so that it still serializes correctly but results in a different hash. The way I understand it \"valid hash\" here means that the hash in the metadata of the file matches the hash in the chainparams.\r\n\r\n> I guess one would have to add a hash of the invalid file to the source code.\r\n\r\nThat implies that the attacker is able to give the user a build that is not a release, no? (or we have made a huge mistake when adding the hash) If the attackers are able to do that they could do anything so it doesn't seem feasible to cover such a scenario in our tests.",
      "commit_id" : "fa91fc737dc88899fa7452941327546ec3f73972",
      "created_at" : "2023-10-17T09:02:51Z",
      "diff_hunk" : "@@ -17,8 +17,7 @@\n \n Interesting test cases could be loading an assumeutxo snapshot file with:\n \n-- TODO: An invalid hash\n-- TODO: Valid hash but invalid snapshot file (bad coin height or truncated file or\n+- TODO: Valid hash but invalid snapshot file (bad coin height or",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28647#discussion_r1361773682",
      "id" : 1361773682,
      "in_reply_to_id" : 1361720125,
      "line" : 20,
      "node_id" : "PRRC_kwDOABII585RKwRy",
      "original_commit_id" : "fa91fc737dc88899fa7452941327546ec3f73972",
      "original_line" : 20,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "test/functional/feature_assumeutxo.py",
      "position" : 13,
      "pull_request_review_id" : 1681776111,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28647",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1361773682/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-10-17T09:02:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1361773682",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28647#discussion_r1361790219"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28647"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1361790219"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Right. Though, in that case, it could make sense to transform the unreachable/untestable  code, if there is any, into an assert fail, or use the `Assume` fail.",
      "commit_id" : "fa91fc737dc88899fa7452941327546ec3f73972",
      "created_at" : "2023-10-17T09:15:18Z",
      "diff_hunk" : "@@ -17,8 +17,7 @@\n \n Interesting test cases could be loading an assumeutxo snapshot file with:\n \n-- TODO: An invalid hash\n-- TODO: Valid hash but invalid snapshot file (bad coin height or truncated file or\n+- TODO: Valid hash but invalid snapshot file (bad coin height or",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28647#discussion_r1361790219",
      "id" : 1361790219,
      "in_reply_to_id" : 1361720125,
      "line" : 20,
      "node_id" : "PRRC_kwDOABII585RK0UL",
      "original_commit_id" : "fa91fc737dc88899fa7452941327546ec3f73972",
      "original_line" : 20,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "test/functional/feature_assumeutxo.py",
      "position" : 13,
      "pull_request_review_id" : 1681803226,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28647",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1361790219/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-10-17T09:15:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1361790219",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   }
]
