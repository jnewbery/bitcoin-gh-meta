[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage\nFor detailed information about the code coverage, see the [test coverage report](https://corecheck.dev/bitcoin/bitcoin/pulls/28602).\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [sipa](https://github.com/bitcoin/bitcoin/pull/28602#issuecomment-1752125343) |\n| Concept ACK | [Sjors](https://github.com/bitcoin/bitcoin/pull/28602#pullrequestreview-1663830181) |\n| Stale ACK | [furszy](https://github.com/bitcoin/bitcoin/pull/28602#pullrequestreview-1660838170) |\n\nIf your review is incorrectly listed, please react with ð to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#28610](https://github.com/bitcoin/bitcoin/pull/28610) (wallet: Migrate entire address book entries to watchonly and solvables too by achow101)\n* [#28609](https://github.com/bitcoin/bitcoin/pull/28609) (wallet: Reload watchonly and solvables wallets after migration by achow101)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "created_at" : "2023-10-05T18:01:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28602#issuecomment-1749399626",
      "id" : 1749399626,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28602",
      "node_id" : "IC_kwDOABII585oRbhK",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1749399626/reactions"
      },
      "updated_at" : "2023-10-09T07:26:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1749399626",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28602#discussion_r1347882185"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28602"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1347882185"
         }
      },
      "author_association" : "MEMBER",
      "body" : "More concisely:\r\n\r\n```c++\r\nif (auto pubkey_provider = InferPubkey(pubkey, ParseScriptContext::P2WSH, *m_in)) {\r\n    m_keys.push_back(std::move(pubkey_provider));\r\n    return key;\r\n}\r\n```\r\n",
      "commit_id" : "25a8a173ad30a133b6ed4bd0f1290008c6678029",
      "created_at" : "2023-10-05T19:34:29Z",
      "diff_hunk" : "@@ -1454,8 +1462,11 @@ struct KeyParser {\n         CPubKey pubkey(begin, end);\n         if (pubkey.IsValidNonHybrid()) {\n             Key key = m_keys.size();\n-            m_keys.push_back(InferPubkey(pubkey, ParseScriptContext::P2WSH, *m_in));\n-            return key;\n+            std::unique_ptr<PubkeyProvider> pubkey_provider = InferPubkey(pubkey, ParseScriptContext::P2WSH, *m_in);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28602#discussion_r1347882185",
      "id" : 1347882185,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585QVwzJ",
      "original_commit_id" : "6c80e82b760057a7740ef71a8dc673de21adbd06",
      "original_line" : 1465,
      "original_position" : 24,
      "original_start_line" : null,
      "path" : "src/script/descriptor.cpp",
      "position" : null,
      "pull_request_review_id" : 1660573864,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28602",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1347882185/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-10-05T19:42:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1347882185",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28602#discussion_r1347902176"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28602"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1347902176"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Indentation?",
      "commit_id" : "25a8a173ad30a133b6ed4bd0f1290008c6678029",
      "created_at" : "2023-10-05T19:52:38Z",
      "diff_hunk" : "@@ -384,6 +384,55 @@ void Check(const std::string& prv, const std::string& pub, const std::string& no\n     }\n }\n \n+void CheckInferDescriptor(const std::string& script_hex, const std::string& expected_desc, const std::vector<std::string>& hex_scripts, const std::vector<std::string>& hex_pubkeys, const std::vector<std::pair<std::string, std::string>>& str_origins)\n+{\n+    std::vector<unsigned char> script_bytes{ParseHex(script_hex)};\n+    const CScript& script{script_bytes.begin(), script_bytes.end()};\n+\n+    FlatSigningProvider provider;\n+    for (const std::string& prov_script_hex : hex_scripts) {\n+    std::vector<unsigned char> prov_script_bytes{ParseHex(prov_script_hex)};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28602#discussion_r1347902176",
      "id" : 1347902176,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585QV1rg",
      "original_commit_id" : "6c80e82b760057a7740ef71a8dc673de21adbd06",
      "original_line" : 394,
      "original_position" : 11,
      "original_start_line" : null,
      "path" : "src/test/descriptor_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 1660604516,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28602",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1347902176/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-10-05T19:52:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1347902176",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28602#discussion_r1347904393"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28602"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1347904393"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Used the first suggestion. The second does not compile, `pubkey_provider` is out of scope.",
      "commit_id" : "25a8a173ad30a133b6ed4bd0f1290008c6678029",
      "created_at" : "2023-10-05T19:55:00Z",
      "diff_hunk" : "@@ -1454,8 +1462,11 @@ struct KeyParser {\n         CPubKey pubkey(begin, end);\n         if (pubkey.IsValidNonHybrid()) {\n             Key key = m_keys.size();\n-            m_keys.push_back(InferPubkey(pubkey, ParseScriptContext::P2WSH, *m_in));\n-            return key;\n+            std::unique_ptr<PubkeyProvider> pubkey_provider = InferPubkey(pubkey, ParseScriptContext::P2WSH, *m_in);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28602#discussion_r1347904393",
      "id" : 1347904393,
      "in_reply_to_id" : 1347882185,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585QV2OJ",
      "original_commit_id" : "6c80e82b760057a7740ef71a8dc673de21adbd06",
      "original_line" : 1465,
      "original_position" : 24,
      "original_start_line" : null,
      "path" : "src/script/descriptor.cpp",
      "position" : null,
      "pull_request_review_id" : 1660607865,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28602",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1347904393/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-10-05T19:55:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1347904393",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28602#discussion_r1347904559"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28602"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1347904559"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Fixed",
      "commit_id" : "25a8a173ad30a133b6ed4bd0f1290008c6678029",
      "created_at" : "2023-10-05T19:55:08Z",
      "diff_hunk" : "@@ -384,6 +384,55 @@ void Check(const std::string& prv, const std::string& pub, const std::string& no\n     }\n }\n \n+void CheckInferDescriptor(const std::string& script_hex, const std::string& expected_desc, const std::vector<std::string>& hex_scripts, const std::vector<std::string>& hex_pubkeys, const std::vector<std::pair<std::string, std::string>>& str_origins)\n+{\n+    std::vector<unsigned char> script_bytes{ParseHex(script_hex)};\n+    const CScript& script{script_bytes.begin(), script_bytes.end()};\n+\n+    FlatSigningProvider provider;\n+    for (const std::string& prov_script_hex : hex_scripts) {\n+    std::vector<unsigned char> prov_script_bytes{ParseHex(prov_script_hex)};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28602#discussion_r1347904559",
      "id" : 1347904559,
      "in_reply_to_id" : 1347902176,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585QV2Qv",
      "original_commit_id" : "6c80e82b760057a7740ef71a8dc673de21adbd06",
      "original_line" : 394,
      "original_position" : 11,
      "original_start_line" : null,
      "path" : "src/test/descriptor_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 1660608005,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28602",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1347904559/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-10-05T19:55:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1347904559",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28602#discussion_r1347909296"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28602"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1347909296"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Nit: space after `if`",
      "commit_id" : "6f00af4bcb2f703f8a5f9b63fe3346a660be52da",
      "created_at" : "2023-10-05T19:59:55Z",
      "diff_hunk" : "@@ -1799,33 +1809,43 @@ std::unique_ptr<DescriptorImpl> InferScript(const CScript& script, ParseScriptCo\n \n     if (txntype == TxoutType::PUBKEY && (ctx == ParseScriptContext::TOP || ctx == ParseScriptContext::P2SH || ctx == ParseScriptContext::P2WSH)) {\n         CPubKey pubkey(data[0]);\n-        if (pubkey.IsValidNonHybrid()) {\n-            return std::make_unique<PKDescriptor>(InferPubkey(pubkey, ctx, provider));\n+        if (auto pubkey_provider = InferPubkey(pubkey, ctx, provider)) {\n+            return std::make_unique<PKDescriptor>(std::move(pubkey_provider));\n         }\n     }\n     if (txntype == TxoutType::PUBKEYHASH && (ctx == ParseScriptContext::TOP || ctx == ParseScriptContext::P2SH || ctx == ParseScriptContext::P2WSH)) {\n         uint160 hash(data[0]);\n         CKeyID keyid(hash);\n         CPubKey pubkey;\n         if (provider.GetPubKey(keyid, pubkey)) {\n-            return std::make_unique<PKHDescriptor>(InferPubkey(pubkey, ctx, provider));\n+            if (auto pubkey_provider = InferPubkey(pubkey, ctx, provider)) {\n+                return std::make_unique<PKHDescriptor>(std::move(pubkey_provider));\n+            }\n         }\n     }\n     if (txntype == TxoutType::WITNESS_V0_KEYHASH && (ctx == ParseScriptContext::TOP || ctx == ParseScriptContext::P2SH)) {\n         uint160 hash(data[0]);\n         CKeyID keyid(hash);\n         CPubKey pubkey;\n         if (provider.GetPubKey(keyid, pubkey)) {\n-            return std::make_unique<WPKHDescriptor>(InferPubkey(pubkey, ctx, provider));\n+            if (auto pubkey_provider = InferPubkey(pubkey, ParseScriptContext::P2WPKH, provider)) {\n+                return std::make_unique<WPKHDescriptor>(std::move(pubkey_provider));\n+            }\n         }\n     }\n     if (txntype == TxoutType::MULTISIG && (ctx == ParseScriptContext::TOP || ctx == ParseScriptContext::P2SH || ctx == ParseScriptContext::P2WSH)) {\n+        bool ok = true;\n         std::vector<std::unique_ptr<PubkeyProvider>> providers;\n         for (size_t i = 1; i + 1 < data.size(); ++i) {\n             CPubKey pubkey(data[i]);\n-            providers.push_back(InferPubkey(pubkey, ctx, provider));\n+            if(auto pubkey_provider = InferPubkey(pubkey, ctx, provider)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28602#discussion_r1347909296",
      "id" : 1347909296,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585QV3aw",
      "original_commit_id" : "25a8a173ad30a133b6ed4bd0f1290008c6678029",
      "original_line" : 1841,
      "original_position" : 82,
      "original_start_line" : null,
      "path" : "src/script/descriptor.cpp",
      "position" : null,
      "pull_request_review_id" : 1660615602,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28602",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1347909296/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-10-05T20:10:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1347909296",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28602#discussion_r1347917943"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28602"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1347917943"
         }
      },
      "author_association" : "MEMBER",
      "body" : "The body of this loop looks like it's duplicating code from existing key parsing code.\r\n\r\nWould it be possible to e.g. construct a `[origin]pubkey` string, pass that to `ParsePubkey`, and use the resulting `FlatSigningProvider& out`?",
      "commit_id" : "6f00af4bcb2f703f8a5f9b63fe3346a660be52da",
      "created_at" : "2023-10-05T20:10:23Z",
      "diff_hunk" : "@@ -384,6 +384,55 @@ void Check(const std::string& prv, const std::string& pub, const std::string& no\n     }\n }\n \n+void CheckInferDescriptor(const std::string& script_hex, const std::string& expected_desc, const std::vector<std::string>& hex_scripts, const std::vector<std::string>& hex_pubkeys, const std::vector<std::pair<std::string, std::string>>& str_origins)\n+{\n+    std::vector<unsigned char> script_bytes{ParseHex(script_hex)};\n+    const CScript& script{script_bytes.begin(), script_bytes.end()};\n+\n+    FlatSigningProvider provider;\n+    for (const std::string& prov_script_hex : hex_scripts) {\n+        std::vector<unsigned char> prov_script_bytes{ParseHex(prov_script_hex)};\n+        const CScript& prov_script{prov_script_bytes.begin(), prov_script_bytes.end()};\n+        provider.scripts.emplace(CScriptID(prov_script), prov_script);\n+    }\n+    for (const std::string& pubkey_hex : hex_pubkeys) {\n+        CPubKey prov_pubkey{ParseHex(pubkey_hex)};\n+        provider.pubkeys.emplace(prov_pubkey.GetID(), prov_pubkey);\n+    }\n+    for (const auto& [pubkey_hex, origin_str] : str_origins) {\n+        CPubKey origin_pubkey{ParseHex(pubkey_hex)};\n+\n+        using namespace spanparsing;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28602#discussion_r1347917943",
      "id" : 1347917943,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585QV5h3",
      "original_commit_id" : "25a8a173ad30a133b6ed4bd0f1290008c6678029",
      "original_line" : 405,
      "original_position" : 22,
      "original_start_line" : null,
      "path" : "src/test/descriptor_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 1660615602,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28602",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1347917943/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-10-05T20:10:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1347917943",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28602#discussion_r1348051172"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28602"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1348051172"
         }
      },
      "author_association" : "MEMBER",
      "body" : "tiny nit:\r\n`Key key = m_keys.size();` can be inside the `InferPubkey` block.\r\n\r\nSame for `FromPKHBytes()`.",
      "commit_id" : "6f00af4bcb2f703f8a5f9b63fe3346a660be52da",
      "created_at" : "2023-10-05T22:16:37Z",
      "diff_hunk" : "@@ -1454,8 +1454,10 @@ struct KeyParser {\n         CPubKey pubkey(begin, end);\n         if (pubkey.IsValidNonHybrid()) {\n             Key key = m_keys.size();\n-            m_keys.push_back(InferPubkey(pubkey, ParseScriptContext::P2WSH, *m_in));\n-            return key;\n+            if (auto pubkey_provider = InferPubkey(pubkey, ParseScriptContext::P2WSH, *m_in)) {\n+                m_keys.push_back(std::move(pubkey_provider));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28602#discussion_r1348051172",
      "id" : 1348051172,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585QWaDk",
      "original_commit_id" : "3e718b49e2459ada6c70af2de4e0f4a58f2f2cfe",
      "original_line" : 1458,
      "original_position" : 7,
      "original_start_line" : 1456,
      "path" : "src/script/descriptor.cpp",
      "position" : null,
      "pull_request_review_id" : 1660838170,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28602",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1348051172/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-10-06T19:57:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1348051172",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28602#discussion_r1348070679"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28602"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1348070679"
         }
      },
      "author_association" : "MEMBER",
      "body" : "s/p2pkh/p2wpkh",
      "commit_id" : "6f00af4bcb2f703f8a5f9b63fe3346a660be52da",
      "created_at" : "2023-10-05T22:35:21Z",
      "diff_hunk" : "@@ -770,6 +775,58 @@ def test_conflict_txs(self):\n \n         wallet.unloadwallet()\n \n+    def test_hybrid_pubkey(self):\n+        self.log.info(\"Test migration when wallet contains a hybrid pubkey\")\n+\n+        wallet = self.create_legacy_wallet(\"hybrid_keys\")\n+\n+        # Get the hybrid pubkey for one of the keys in the wallet\n+        normal_pubkey = wallet.getaddressinfo(wallet.getnewaddress())[\"pubkey\"]\n+        first_byte = bytes.fromhex(normal_pubkey)[0] + 4 # Get the hybrid pubkey first byte\n+        parsed_pubkey = ECPubKey()\n+        parsed_pubkey.set(bytes.fromhex(normal_pubkey))\n+        parsed_pubkey.compressed = False\n+        hybrid_pubkey_bytes = bytearray(parsed_pubkey.get_bytes())\n+        hybrid_pubkey_bytes[0] = first_byte # Make it hybrid\n+        hybrid_pubkey = hybrid_pubkey_bytes.hex()\n+\n+        # Import the hybrid pubkey\n+        wallet.importpubkey(hybrid_pubkey)\n+        p2pkh_addr = key_to_p2pkh(hybrid_pubkey)\n+        p2pkh_addr_info = wallet.getaddressinfo(p2pkh_addr)\n+        assert_equal(p2pkh_addr_info[\"iswatchonly\"], True)\n+        assert_equal(p2pkh_addr_info[\"ismine\"], False) # Things involving hybrid pubkeys are not spendable\n+\n+        # Also import the p2pkh for the pubkey to make sure we don't migrate it",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28602#discussion_r1348070679",
      "id" : 1348070679,
      "line" : 800,
      "node_id" : "PRRC_kwDOABII585QWe0X",
      "original_commit_id" : "12f0d05775453e06740b2ffb2b30fa1aebd3c20e",
      "original_line" : 800,
      "original_position" : 41,
      "original_start_line" : null,
      "path" : "test/functional/wallet_migration.py",
      "position" : 41,
      "pull_request_review_id" : 1660838170,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28602",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1348070679/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-10-06T19:57:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1348070679",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28602#discussion_r1348071534"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28602"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1348071534"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "6f00af4bcb2f703f8a5f9b63fe3346a660be52da",
      "created_at" : "2023-10-05T22:36:55Z",
      "diff_hunk" : "@@ -1799,33 +1809,43 @@ std::unique_ptr<DescriptorImpl> InferScript(const CScript& script, ParseScriptCo\n \n     if (txntype == TxoutType::PUBKEY && (ctx == ParseScriptContext::TOP || ctx == ParseScriptContext::P2SH || ctx == ParseScriptContext::P2WSH)) {\n         CPubKey pubkey(data[0]);\n-        if (pubkey.IsValidNonHybrid()) {\n-            return std::make_unique<PKDescriptor>(InferPubkey(pubkey, ctx, provider));\n+        if (auto pubkey_provider = InferPubkey(pubkey, ctx, provider)) {\n+            return std::make_unique<PKDescriptor>(std::move(pubkey_provider));\n         }\n     }\n     if (txntype == TxoutType::PUBKEYHASH && (ctx == ParseScriptContext::TOP || ctx == ParseScriptContext::P2SH || ctx == ParseScriptContext::P2WSH)) {\n         uint160 hash(data[0]);\n         CKeyID keyid(hash);\n         CPubKey pubkey;\n         if (provider.GetPubKey(keyid, pubkey)) {\n-            return std::make_unique<PKHDescriptor>(InferPubkey(pubkey, ctx, provider));\n+            if (auto pubkey_provider = InferPubkey(pubkey, ctx, provider)) {\n+                return std::make_unique<PKHDescriptor>(std::move(pubkey_provider));\n+            }\n         }\n     }\n     if (txntype == TxoutType::WITNESS_V0_KEYHASH && (ctx == ParseScriptContext::TOP || ctx == ParseScriptContext::P2SH)) {\n         uint160 hash(data[0]);\n         CKeyID keyid(hash);\n         CPubKey pubkey;\n         if (provider.GetPubKey(keyid, pubkey)) {\n-            return std::make_unique<WPKHDescriptor>(InferPubkey(pubkey, ctx, provider));\n+            if (auto pubkey_provider = InferPubkey(pubkey, ParseScriptContext::P2WPKH, provider)) {\n+                return std::make_unique<WPKHDescriptor>(std::move(pubkey_provider));\n+            }\n         }\n     }\n     if (txntype == TxoutType::MULTISIG && (ctx == ParseScriptContext::TOP || ctx == ParseScriptContext::P2SH || ctx == ParseScriptContext::P2WSH)) {\n+        bool ok = true;\n         std::vector<std::unique_ptr<PubkeyProvider>> providers;\n         for (size_t i = 1; i + 1 < data.size(); ++i) {\n             CPubKey pubkey(data[i]);\n-            providers.push_back(InferPubkey(pubkey, ctx, provider));\n+            if(auto pubkey_provider = InferPubkey(pubkey, ctx, provider)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28602#discussion_r1348071534",
      "id" : 1348071534,
      "in_reply_to_id" : 1347909296,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585QWfBu",
      "original_commit_id" : "25a8a173ad30a133b6ed4bd0f1290008c6678029",
      "original_line" : 1841,
      "original_position" : 82,
      "original_start_line" : null,
      "path" : "src/script/descriptor.cpp",
      "position" : null,
      "pull_request_review_id" : 1660870513,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28602",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1348071534/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-10-05T22:36:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1348071534",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28602#discussion_r1348071858"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28602"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1348071858"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Not without a lot of refactoring that ends up exposing several descriptor parsing internals.",
      "commit_id" : "6f00af4bcb2f703f8a5f9b63fe3346a660be52da",
      "created_at" : "2023-10-05T22:37:33Z",
      "diff_hunk" : "@@ -384,6 +384,55 @@ void Check(const std::string& prv, const std::string& pub, const std::string& no\n     }\n }\n \n+void CheckInferDescriptor(const std::string& script_hex, const std::string& expected_desc, const std::vector<std::string>& hex_scripts, const std::vector<std::string>& hex_pubkeys, const std::vector<std::pair<std::string, std::string>>& str_origins)\n+{\n+    std::vector<unsigned char> script_bytes{ParseHex(script_hex)};\n+    const CScript& script{script_bytes.begin(), script_bytes.end()};\n+\n+    FlatSigningProvider provider;\n+    for (const std::string& prov_script_hex : hex_scripts) {\n+        std::vector<unsigned char> prov_script_bytes{ParseHex(prov_script_hex)};\n+        const CScript& prov_script{prov_script_bytes.begin(), prov_script_bytes.end()};\n+        provider.scripts.emplace(CScriptID(prov_script), prov_script);\n+    }\n+    for (const std::string& pubkey_hex : hex_pubkeys) {\n+        CPubKey prov_pubkey{ParseHex(pubkey_hex)};\n+        provider.pubkeys.emplace(prov_pubkey.GetID(), prov_pubkey);\n+    }\n+    for (const auto& [pubkey_hex, origin_str] : str_origins) {\n+        CPubKey origin_pubkey{ParseHex(pubkey_hex)};\n+\n+        using namespace spanparsing;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28602#discussion_r1348071858",
      "id" : 1348071858,
      "in_reply_to_id" : 1347917943,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585QWfGy",
      "original_commit_id" : "25a8a173ad30a133b6ed4bd0f1290008c6678029",
      "original_line" : 405,
      "original_position" : 22,
      "original_start_line" : null,
      "path" : "src/test/descriptor_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 1660871033,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28602",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1348071858/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-10-05T22:37:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1348071858",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28602#discussion_r1349230171"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28602"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1349230171"
         }
      },
      "author_association" : "MEMBER",
      "body" : "For better maintainability, comments explaining what we are about to test on each case would be nice.\r\nMaybe:\r\n```c++\r\n// Infer valid sh(pkh(compressed_key))\r\nCheckInferDescriptor(\"a9141a31ad23bf49c247dd531a623c2ef57da3c400c587\", \"sh(pkh([deadbeef/0h/0h/0]03a34b99f22c790c4e36b2b3c2c35a36db06226e41c692fc82b8b56ac1c540c5bd))\", {\"76a9149a1c78a507689f6f54b847ad1cef1e614ee23f1e88ac\"}, {{\"03a34b99f22c790c4e36b2b3c2c35a36db06226e41c692fc82b8b56ac1c540c5bd\", \"deadbeef/0h/0h/0\"}});\r\n// Only can watch an hybrid pk in a P2PK\r\nCheckInferDescriptor(\"41069228de6902abb4f541791f6d7f925b10e2078ccb1298856e5ea5cc5fd667f930eac37a00cc07f9a91ef3c2d17bf7a17db04552ff90ac312a5b8b4caca6c97aa4ac\", \"raw(41069228de6902abb4f541791f6d7f925b10e2078ccb1298856e5ea5cc5fd667f930eac37a00cc07f9a91ef3c2d17bf7a17db04552ff90ac312a5b8b4caca6c97aa4ac)\", {}, {{\"069228de6902abb4f541791f6d7f925b10e2078ccb1298856e5ea5cc5fd667f930eac37a00cc07f9a91ef3c2d17bf7a17db04552ff90ac312a5b8b4caca6c97aa4\", \"\"}});\r\n// Only can watch an hybrid pk in a P2PKH\r\nCheckInferDescriptor(\"76a91445ff7c2327866472639d507334a9a00119dfd32688ac\", \"addr(17P7ge56F2QcdHxxRBa2NyzmejFggPwBJ9)\", {}, {{\"069228de6902abb4f541791f6d7f925b10e2078ccb1298856e5ea5cc5fd667f930eac37a00cc07f9a91ef3c2d17bf7a17db04552ff90ac312a5b8b4caca6c97aa4\", \"\"}});\r\n// Only can watch an uncompressed pk in a P2WPKH\r\nCheckInferDescriptor(\"001422e363a523947a110d9a9eb114820de183aca313\", \"addr(bc1qyt3k8ffrj3apzrv6n6c3fqsduxp6egcnk2r66j)\", {}, {{\"049228de6902abb4f541791f6d7f925b10e2078ccb1298856e5ea5cc5fd667f930eac37a00cc07f9a91ef3c2d17bf7a17db04552ff90ac312a5b8b4caca6c97aa4\", \"\"}});\r\n```",
      "commit_id" : "6f00af4bcb2f703f8a5f9b63fe3346a660be52da",
      "created_at" : "2023-10-06T19:20:53Z",
      "diff_hunk" : "@@ -582,6 +630,11 @@ BOOST_AUTO_TEST_CASE(descriptor_test)\n     // Same for hash256\n     Check(\"wsh(and_v(v:hash256(ae253ca2a54debcac7ecf414f6734f48c56421a08bb59182ff9f39a6fffdb588),pk(xprvA1RpRA33e1JQ7ifknakTFpgNXPmW2YvmhqLQYMmrj4xJXXWYpDPS3xz7iAxn8L39njGVyuoseXzU6rcxFLJ8HFsTjSyQbLYnMpCqE2VbFWc)))\", \"wsh(and_v(v:hash256(ae253ca2a54debcac7ecf414f6734f48c56421a08bb59182ff9f39a6fffdb588),pk(xpub6ERApfZwUNrhLCkDtcHTcxd75RbzS1ed54G1LkBUHQVHQKqhMkhgbmJbZRkrgZw4koxb5JaHWkY4ALHY2grBGRjaDMzQLcgJvLJuZZvRcEL)))\", \"wsh(and_v(v:hash256(ae253ca2a54debcac7ecf414f6734f48c56421a08bb59182ff9f39a6fffdb588),pk(xpub6ERApfZwUNrhLCkDtcHTcxd75RbzS1ed54G1LkBUHQVHQKqhMkhgbmJbZRkrgZw4koxb5JaHWkY4ALHY2grBGRjaDMzQLcgJvLJuZZvRcEL)))\", SIGNABLE_FAILS, {{\"0020cf62bf97baf977aec69cbc290c372899f913337a9093e8f066ab59b8657a365c\"}}, OutputType::BECH32, /*op_desc_id=*/uint256S(\"8412ba3ac20ba3a30f81442d10d32e0468fa52814960d04e959bf84a9b813b88\"), {{}}, /*spender_nlocktime=*/0, /*spender_nsequence=*/CTxIn::SEQUENCE_FINAL, {});\n     Check(\"wsh(and_v(v:hash256(ae253ca2a54debcac7ecf414f6734f48c56421a08bb59182ff9f39a6fffdb588),pk(xprvA1RpRA33e1JQ7ifknakTFpgNXPmW2YvmhqLQYMmrj4xJXXWYpDPS3xz7iAxn8L39njGVyuoseXzU6rcxFLJ8HFsTjSyQbLYnMpCqE2VbFWc)))\", \"wsh(and_v(v:hash256(ae253ca2a54debcac7ecf414f6734f48c56421a08bb59182ff9f39a6fffdb588),pk(xpub6ERApfZwUNrhLCkDtcHTcxd75RbzS1ed54G1LkBUHQVHQKqhMkhgbmJbZRkrgZw4koxb5JaHWkY4ALHY2grBGRjaDMzQLcgJvLJuZZvRcEL)))\", \"wsh(and_v(v:hash256(ae253ca2a54debcac7ecf414f6734f48c56421a08bb59182ff9f39a6fffdb588),pk(xpub6ERApfZwUNrhLCkDtcHTcxd75RbzS1ed54G1LkBUHQVHQKqhMkhgbmJbZRkrgZw4koxb5JaHWkY4ALHY2grBGRjaDMzQLcgJvLJuZZvRcEL)))\", SIGNABLE, {{\"0020cf62bf97baf977aec69cbc290c372899f913337a9093e8f066ab59b8657a365c\"}}, OutputType::BECH32, /*op_desc_id=*/uint256S(\"8412ba3ac20ba3a30f81442d10d32e0468fa52814960d04e959bf84a9b813b88\"), {{}}, /*spender_nlocktime=*/0, /*spender_nsequence=*/CTxIn::SEQUENCE_FINAL, {{ParseHex(\"ae253ca2a54debcac7ecf414f6734f48c56421a08bb59182ff9f39a6fffdb588\"), ParseHex(\"000000000019d6689c085ae165831e934ff763ae46a2a6c172b3f1b60a8ce26f\")}});\n+\n+    CheckInferDescriptor(\"a9141a31ad23bf49c247dd531a623c2ef57da3c400c587\", \"sh(pkh([deadbeef/0h/0h/0]03a34b99f22c790c4e36b2b3c2c35a36db06226e41c692fc82b8b56ac1c540c5bd))\", {\"76a9149a1c78a507689f6f54b847ad1cef1e614ee23f1e88ac\"}, {{\"03a34b99f22c790c4e36b2b3c2c35a36db06226e41c692fc82b8b56ac1c540c5bd\", \"deadbeef/0h/0h/0\"}});\n+    CheckInferDescriptor(\"41069228de6902abb4f541791f6d7f925b10e2078ccb1298856e5ea5cc5fd667f930eac37a00cc07f9a91ef3c2d17bf7a17db04552ff90ac312a5b8b4caca6c97aa4ac\", \"raw(41069228de6902abb4f541791f6d7f925b10e2078ccb1298856e5ea5cc5fd667f930eac37a00cc07f9a91ef3c2d17bf7a17db04552ff90ac312a5b8b4caca6c97aa4ac)\", {}, {{\"069228de6902abb4f541791f6d7f925b10e2078ccb1298856e5ea5cc5fd667f930eac37a00cc07f9a91ef3c2d17bf7a17db04552ff90ac312a5b8b4caca6c97aa4\", \"\"}});\n+    CheckInferDescriptor(\"76a91445ff7c2327866472639d507334a9a00119dfd32688ac\", \"addr(17P7ge56F2QcdHxxRBa2NyzmejFggPwBJ9)\", {}, {{\"069228de6902abb4f541791f6d7f925b10e2078ccb1298856e5ea5cc5fd667f930eac37a00cc07f9a91ef3c2d17bf7a17db04552ff90ac312a5b8b4caca6c97aa4\", \"\"}});\n+    CheckInferDescriptor(\"001422e363a523947a110d9a9eb114820de183aca313\", \"addr(bc1qyt3k8ffrj3apzrv6n6c3fqsduxp6egcnk2r66j)\", {}, {{\"049228de6902abb4f541791f6d7f925b10e2078ccb1298856e5ea5cc5fd667f930eac37a00cc07f9a91ef3c2d17bf7a17db04552ff90ac312a5b8b4caca6c97aa4\", \"\"}});",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28602#discussion_r1349230171",
      "id" : 1349230171,
      "line" : 637,
      "node_id" : "PRRC_kwDOABII585Qa55b",
      "original_commit_id" : "6f00af4bcb2f703f8a5f9b63fe3346a660be52da",
      "original_line" : 637,
      "original_position" : 63,
      "original_start_line" : 634,
      "path" : "src/test/descriptor_tests.cpp",
      "position" : 63,
      "pull_request_review_id" : 1660838170,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28602",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1349230171/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 634,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-10-06T19:57:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1349230171",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28602#discussion_r1349260414"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28602"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1349260414"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Could also verify the inference process for `pkh(uncompressed)` and `pk(uncompressed)`:\r\n\r\n```c++\r\n// Infer valid pkh(uncompressed_key)\r\nCheckInferDescriptor(\"76a914a31725c74421fadc50d35520ab8751ed120af80588ac\", \"pkh(04c56fe4a92d401bcbf1b3dfbe4ac3dac5602ca155a3681497f02c1b9a733b92d704e2da6ec4162e4846af9236ef4171069ac8b7f8234a8405b6cadd96f34f5a31)\", {}, {{\"04c56fe4a92d401bcbf1b3dfbe4ac3dac5602ca155a3681497f02c1b9a733b92d704e2da6ec4162e4846af9236ef4171069ac8b7f8234a8405b6cadd96f34f5a31\", \"\"}});\r\n// Infer valid pk(uncompressed_key)\r\nCheckInferDescriptor(\"4104032540df1d3c7070a8ab3a9cdd304dfc7fd1e6541369c53c4c3310b2537d91059afc8b8e7673eb812a32978dabb78c40f2e423f7757dca61d11838c7aeeb5220ac\", \"pk(04032540df1d3c7070a8ab3a9cdd304dfc7fd1e6541369c53c4c3310b2537d91059afc8b8e7673eb812a32978dabb78c40f2e423f7757dca61d11838c7aeeb5220)#59dvf0e2\", {}, {{\"04032540df1d3c7070a8ab3a9cdd304dfc7fd1e6541369c53c4c3310b2537d91059afc8b8e7673eb812a32978dabb78c40f2e423f7757dca61d11838c7aeeb5220\", \"\"}});\r\n```",
      "commit_id" : "6f00af4bcb2f703f8a5f9b63fe3346a660be52da",
      "created_at" : "2023-10-06T19:56:38Z",
      "diff_hunk" : "@@ -582,6 +630,11 @@ BOOST_AUTO_TEST_CASE(descriptor_test)\n     // Same for hash256\n     Check(\"wsh(and_v(v:hash256(ae253ca2a54debcac7ecf414f6734f48c56421a08bb59182ff9f39a6fffdb588),pk(xprvA1RpRA33e1JQ7ifknakTFpgNXPmW2YvmhqLQYMmrj4xJXXWYpDPS3xz7iAxn8L39njGVyuoseXzU6rcxFLJ8HFsTjSyQbLYnMpCqE2VbFWc)))\", \"wsh(and_v(v:hash256(ae253ca2a54debcac7ecf414f6734f48c56421a08bb59182ff9f39a6fffdb588),pk(xpub6ERApfZwUNrhLCkDtcHTcxd75RbzS1ed54G1LkBUHQVHQKqhMkhgbmJbZRkrgZw4koxb5JaHWkY4ALHY2grBGRjaDMzQLcgJvLJuZZvRcEL)))\", \"wsh(and_v(v:hash256(ae253ca2a54debcac7ecf414f6734f48c56421a08bb59182ff9f39a6fffdb588),pk(xpub6ERApfZwUNrhLCkDtcHTcxd75RbzS1ed54G1LkBUHQVHQKqhMkhgbmJbZRkrgZw4koxb5JaHWkY4ALHY2grBGRjaDMzQLcgJvLJuZZvRcEL)))\", SIGNABLE_FAILS, {{\"0020cf62bf97baf977aec69cbc290c372899f913337a9093e8f066ab59b8657a365c\"}}, OutputType::BECH32, /*op_desc_id=*/uint256S(\"8412ba3ac20ba3a30f81442d10d32e0468fa52814960d04e959bf84a9b813b88\"), {{}}, /*spender_nlocktime=*/0, /*spender_nsequence=*/CTxIn::SEQUENCE_FINAL, {});\n     Check(\"wsh(and_v(v:hash256(ae253ca2a54debcac7ecf414f6734f48c56421a08bb59182ff9f39a6fffdb588),pk(xprvA1RpRA33e1JQ7ifknakTFpgNXPmW2YvmhqLQYMmrj4xJXXWYpDPS3xz7iAxn8L39njGVyuoseXzU6rcxFLJ8HFsTjSyQbLYnMpCqE2VbFWc)))\", \"wsh(and_v(v:hash256(ae253ca2a54debcac7ecf414f6734f48c56421a08bb59182ff9f39a6fffdb588),pk(xpub6ERApfZwUNrhLCkDtcHTcxd75RbzS1ed54G1LkBUHQVHQKqhMkhgbmJbZRkrgZw4koxb5JaHWkY4ALHY2grBGRjaDMzQLcgJvLJuZZvRcEL)))\", \"wsh(and_v(v:hash256(ae253ca2a54debcac7ecf414f6734f48c56421a08bb59182ff9f39a6fffdb588),pk(xpub6ERApfZwUNrhLCkDtcHTcxd75RbzS1ed54G1LkBUHQVHQKqhMkhgbmJbZRkrgZw4koxb5JaHWkY4ALHY2grBGRjaDMzQLcgJvLJuZZvRcEL)))\", SIGNABLE, {{\"0020cf62bf97baf977aec69cbc290c372899f913337a9093e8f066ab59b8657a365c\"}}, OutputType::BECH32, /*op_desc_id=*/uint256S(\"8412ba3ac20ba3a30f81442d10d32e0468fa52814960d04e959bf84a9b813b88\"), {{}}, /*spender_nlocktime=*/0, /*spender_nsequence=*/CTxIn::SEQUENCE_FINAL, {{ParseHex(\"ae253ca2a54debcac7ecf414f6734f48c56421a08bb59182ff9f39a6fffdb588\"), ParseHex(\"000000000019d6689c085ae165831e934ff763ae46a2a6c172b3f1b60a8ce26f\")}});\n+\n+    CheckInferDescriptor(\"a9141a31ad23bf49c247dd531a623c2ef57da3c400c587\", \"sh(pkh([deadbeef/0h/0h/0]03a34b99f22c790c4e36b2b3c2c35a36db06226e41c692fc82b8b56ac1c540c5bd))\", {\"76a9149a1c78a507689f6f54b847ad1cef1e614ee23f1e88ac\"}, {{\"03a34b99f22c790c4e36b2b3c2c35a36db06226e41c692fc82b8b56ac1c540c5bd\", \"deadbeef/0h/0h/0\"}});\n+    CheckInferDescriptor(\"41069228de6902abb4f541791f6d7f925b10e2078ccb1298856e5ea5cc5fd667f930eac37a00cc07f9a91ef3c2d17bf7a17db04552ff90ac312a5b8b4caca6c97aa4ac\", \"raw(41069228de6902abb4f541791f6d7f925b10e2078ccb1298856e5ea5cc5fd667f930eac37a00cc07f9a91ef3c2d17bf7a17db04552ff90ac312a5b8b4caca6c97aa4ac)\", {}, {{\"069228de6902abb4f541791f6d7f925b10e2078ccb1298856e5ea5cc5fd667f930eac37a00cc07f9a91ef3c2d17bf7a17db04552ff90ac312a5b8b4caca6c97aa4\", \"\"}});\n+    CheckInferDescriptor(\"76a91445ff7c2327866472639d507334a9a00119dfd32688ac\", \"addr(17P7ge56F2QcdHxxRBa2NyzmejFggPwBJ9)\", {}, {{\"069228de6902abb4f541791f6d7f925b10e2078ccb1298856e5ea5cc5fd667f930eac37a00cc07f9a91ef3c2d17bf7a17db04552ff90ac312a5b8b4caca6c97aa4\", \"\"}});\n+    CheckInferDescriptor(\"001422e363a523947a110d9a9eb114820de183aca313\", \"addr(bc1qyt3k8ffrj3apzrv6n6c3fqsduxp6egcnk2r66j)\", {}, {{\"049228de6902abb4f541791f6d7f925b10e2078ccb1298856e5ea5cc5fd667f930eac37a00cc07f9a91ef3c2d17bf7a17db04552ff90ac312a5b8b4caca6c97aa4\", \"\"}});",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28602#discussion_r1349260414",
      "id" : 1349260414,
      "line" : 637,
      "node_id" : "PRRC_kwDOABII585QbBR-",
      "original_commit_id" : "6f00af4bcb2f703f8a5f9b63fe3346a660be52da",
      "original_line" : 637,
      "original_position" : 63,
      "original_start_line" : null,
      "path" : "src/test/descriptor_tests.cpp",
      "position" : 63,
      "pull_request_review_id" : 1660838170,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28602",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1349260414/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-10-06T19:57:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1349260414",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28602#discussion_r1349375305"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28602"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1349375305"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "9d639f06441e64c6eca501b051915622ad791d3b",
      "created_at" : "2023-10-06T22:46:24Z",
      "diff_hunk" : "@@ -1454,8 +1454,10 @@ struct KeyParser {\n         CPubKey pubkey(begin, end);\n         if (pubkey.IsValidNonHybrid()) {\n             Key key = m_keys.size();\n-            m_keys.push_back(InferPubkey(pubkey, ParseScriptContext::P2WSH, *m_in));\n-            return key;\n+            if (auto pubkey_provider = InferPubkey(pubkey, ParseScriptContext::P2WSH, *m_in)) {\n+                m_keys.push_back(std::move(pubkey_provider));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28602#discussion_r1349375305",
      "id" : 1349375305,
      "in_reply_to_id" : 1348051172,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585QbdVJ",
      "original_commit_id" : "3e718b49e2459ada6c70af2de4e0f4a58f2f2cfe",
      "original_line" : 1458,
      "original_position" : 7,
      "original_start_line" : 1456,
      "path" : "src/script/descriptor.cpp",
      "position" : null,
      "pull_request_review_id" : 1662884855,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28602",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1349375305/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-10-06T22:46:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1349375305",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28602#discussion_r1349375342"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28602"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1349375342"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "9d639f06441e64c6eca501b051915622ad791d3b",
      "created_at" : "2023-10-06T22:46:29Z",
      "diff_hunk" : "@@ -770,6 +775,58 @@ def test_conflict_txs(self):\n \n         wallet.unloadwallet()\n \n+    def test_hybrid_pubkey(self):\n+        self.log.info(\"Test migration when wallet contains a hybrid pubkey\")\n+\n+        wallet = self.create_legacy_wallet(\"hybrid_keys\")\n+\n+        # Get the hybrid pubkey for one of the keys in the wallet\n+        normal_pubkey = wallet.getaddressinfo(wallet.getnewaddress())[\"pubkey\"]\n+        first_byte = bytes.fromhex(normal_pubkey)[0] + 4 # Get the hybrid pubkey first byte\n+        parsed_pubkey = ECPubKey()\n+        parsed_pubkey.set(bytes.fromhex(normal_pubkey))\n+        parsed_pubkey.compressed = False\n+        hybrid_pubkey_bytes = bytearray(parsed_pubkey.get_bytes())\n+        hybrid_pubkey_bytes[0] = first_byte # Make it hybrid\n+        hybrid_pubkey = hybrid_pubkey_bytes.hex()\n+\n+        # Import the hybrid pubkey\n+        wallet.importpubkey(hybrid_pubkey)\n+        p2pkh_addr = key_to_p2pkh(hybrid_pubkey)\n+        p2pkh_addr_info = wallet.getaddressinfo(p2pkh_addr)\n+        assert_equal(p2pkh_addr_info[\"iswatchonly\"], True)\n+        assert_equal(p2pkh_addr_info[\"ismine\"], False) # Things involving hybrid pubkeys are not spendable\n+\n+        # Also import the p2pkh for the pubkey to make sure we don't migrate it",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28602#discussion_r1349375342",
      "id" : 1349375342,
      "in_reply_to_id" : 1348070679,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585QbdVu",
      "original_commit_id" : "12f0d05775453e06740b2ffb2b30fa1aebd3c20e",
      "original_line" : 800,
      "original_position" : 41,
      "original_start_line" : null,
      "path" : "test/functional/wallet_migration.py",
      "position" : null,
      "pull_request_review_id" : 1662884903,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28602",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1349375342/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-10-06T22:46:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1349375342",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28602#discussion_r1349375393"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28602"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1349375393"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Added some comments.",
      "commit_id" : "9d639f06441e64c6eca501b051915622ad791d3b",
      "created_at" : "2023-10-06T22:46:34Z",
      "diff_hunk" : "@@ -582,6 +630,11 @@ BOOST_AUTO_TEST_CASE(descriptor_test)\n     // Same for hash256\n     Check(\"wsh(and_v(v:hash256(ae253ca2a54debcac7ecf414f6734f48c56421a08bb59182ff9f39a6fffdb588),pk(xprvA1RpRA33e1JQ7ifknakTFpgNXPmW2YvmhqLQYMmrj4xJXXWYpDPS3xz7iAxn8L39njGVyuoseXzU6rcxFLJ8HFsTjSyQbLYnMpCqE2VbFWc)))\", \"wsh(and_v(v:hash256(ae253ca2a54debcac7ecf414f6734f48c56421a08bb59182ff9f39a6fffdb588),pk(xpub6ERApfZwUNrhLCkDtcHTcxd75RbzS1ed54G1LkBUHQVHQKqhMkhgbmJbZRkrgZw4koxb5JaHWkY4ALHY2grBGRjaDMzQLcgJvLJuZZvRcEL)))\", \"wsh(and_v(v:hash256(ae253ca2a54debcac7ecf414f6734f48c56421a08bb59182ff9f39a6fffdb588),pk(xpub6ERApfZwUNrhLCkDtcHTcxd75RbzS1ed54G1LkBUHQVHQKqhMkhgbmJbZRkrgZw4koxb5JaHWkY4ALHY2grBGRjaDMzQLcgJvLJuZZvRcEL)))\", SIGNABLE_FAILS, {{\"0020cf62bf97baf977aec69cbc290c372899f913337a9093e8f066ab59b8657a365c\"}}, OutputType::BECH32, /*op_desc_id=*/uint256S(\"8412ba3ac20ba3a30f81442d10d32e0468fa52814960d04e959bf84a9b813b88\"), {{}}, /*spender_nlocktime=*/0, /*spender_nsequence=*/CTxIn::SEQUENCE_FINAL, {});\n     Check(\"wsh(and_v(v:hash256(ae253ca2a54debcac7ecf414f6734f48c56421a08bb59182ff9f39a6fffdb588),pk(xprvA1RpRA33e1JQ7ifknakTFpgNXPmW2YvmhqLQYMmrj4xJXXWYpDPS3xz7iAxn8L39njGVyuoseXzU6rcxFLJ8HFsTjSyQbLYnMpCqE2VbFWc)))\", \"wsh(and_v(v:hash256(ae253ca2a54debcac7ecf414f6734f48c56421a08bb59182ff9f39a6fffdb588),pk(xpub6ERApfZwUNrhLCkDtcHTcxd75RbzS1ed54G1LkBUHQVHQKqhMkhgbmJbZRkrgZw4koxb5JaHWkY4ALHY2grBGRjaDMzQLcgJvLJuZZvRcEL)))\", \"wsh(and_v(v:hash256(ae253ca2a54debcac7ecf414f6734f48c56421a08bb59182ff9f39a6fffdb588),pk(xpub6ERApfZwUNrhLCkDtcHTcxd75RbzS1ed54G1LkBUHQVHQKqhMkhgbmJbZRkrgZw4koxb5JaHWkY4ALHY2grBGRjaDMzQLcgJvLJuZZvRcEL)))\", SIGNABLE, {{\"0020cf62bf97baf977aec69cbc290c372899f913337a9093e8f066ab59b8657a365c\"}}, OutputType::BECH32, /*op_desc_id=*/uint256S(\"8412ba3ac20ba3a30f81442d10d32e0468fa52814960d04e959bf84a9b813b88\"), {{}}, /*spender_nlocktime=*/0, /*spender_nsequence=*/CTxIn::SEQUENCE_FINAL, {{ParseHex(\"ae253ca2a54debcac7ecf414f6734f48c56421a08bb59182ff9f39a6fffdb588\"), ParseHex(\"000000000019d6689c085ae165831e934ff763ae46a2a6c172b3f1b60a8ce26f\")}});\n+\n+    CheckInferDescriptor(\"a9141a31ad23bf49c247dd531a623c2ef57da3c400c587\", \"sh(pkh([deadbeef/0h/0h/0]03a34b99f22c790c4e36b2b3c2c35a36db06226e41c692fc82b8b56ac1c540c5bd))\", {\"76a9149a1c78a507689f6f54b847ad1cef1e614ee23f1e88ac\"}, {{\"03a34b99f22c790c4e36b2b3c2c35a36db06226e41c692fc82b8b56ac1c540c5bd\", \"deadbeef/0h/0h/0\"}});\n+    CheckInferDescriptor(\"41069228de6902abb4f541791f6d7f925b10e2078ccb1298856e5ea5cc5fd667f930eac37a00cc07f9a91ef3c2d17bf7a17db04552ff90ac312a5b8b4caca6c97aa4ac\", \"raw(41069228de6902abb4f541791f6d7f925b10e2078ccb1298856e5ea5cc5fd667f930eac37a00cc07f9a91ef3c2d17bf7a17db04552ff90ac312a5b8b4caca6c97aa4ac)\", {}, {{\"069228de6902abb4f541791f6d7f925b10e2078ccb1298856e5ea5cc5fd667f930eac37a00cc07f9a91ef3c2d17bf7a17db04552ff90ac312a5b8b4caca6c97aa4\", \"\"}});\n+    CheckInferDescriptor(\"76a91445ff7c2327866472639d507334a9a00119dfd32688ac\", \"addr(17P7ge56F2QcdHxxRBa2NyzmejFggPwBJ9)\", {}, {{\"069228de6902abb4f541791f6d7f925b10e2078ccb1298856e5ea5cc5fd667f930eac37a00cc07f9a91ef3c2d17bf7a17db04552ff90ac312a5b8b4caca6c97aa4\", \"\"}});\n+    CheckInferDescriptor(\"001422e363a523947a110d9a9eb114820de183aca313\", \"addr(bc1qyt3k8ffrj3apzrv6n6c3fqsduxp6egcnk2r66j)\", {}, {{\"049228de6902abb4f541791f6d7f925b10e2078ccb1298856e5ea5cc5fd667f930eac37a00cc07f9a91ef3c2d17bf7a17db04552ff90ac312a5b8b4caca6c97aa4\", \"\"}});",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28602#discussion_r1349375393",
      "id" : 1349375393,
      "in_reply_to_id" : 1349230171,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585QbdWh",
      "original_commit_id" : "6f00af4bcb2f703f8a5f9b63fe3346a660be52da",
      "original_line" : 641,
      "original_position" : 63,
      "original_start_line" : 634,
      "path" : "src/test/descriptor_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 1662884967,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28602",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1349375393/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-10-06T22:46:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1349375393",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28602#discussion_r1349375419"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28602"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1349375419"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "9d639f06441e64c6eca501b051915622ad791d3b",
      "created_at" : "2023-10-06T22:46:39Z",
      "diff_hunk" : "@@ -582,6 +630,11 @@ BOOST_AUTO_TEST_CASE(descriptor_test)\n     // Same for hash256\n     Check(\"wsh(and_v(v:hash256(ae253ca2a54debcac7ecf414f6734f48c56421a08bb59182ff9f39a6fffdb588),pk(xprvA1RpRA33e1JQ7ifknakTFpgNXPmW2YvmhqLQYMmrj4xJXXWYpDPS3xz7iAxn8L39njGVyuoseXzU6rcxFLJ8HFsTjSyQbLYnMpCqE2VbFWc)))\", \"wsh(and_v(v:hash256(ae253ca2a54debcac7ecf414f6734f48c56421a08bb59182ff9f39a6fffdb588),pk(xpub6ERApfZwUNrhLCkDtcHTcxd75RbzS1ed54G1LkBUHQVHQKqhMkhgbmJbZRkrgZw4koxb5JaHWkY4ALHY2grBGRjaDMzQLcgJvLJuZZvRcEL)))\", \"wsh(and_v(v:hash256(ae253ca2a54debcac7ecf414f6734f48c56421a08bb59182ff9f39a6fffdb588),pk(xpub6ERApfZwUNrhLCkDtcHTcxd75RbzS1ed54G1LkBUHQVHQKqhMkhgbmJbZRkrgZw4koxb5JaHWkY4ALHY2grBGRjaDMzQLcgJvLJuZZvRcEL)))\", SIGNABLE_FAILS, {{\"0020cf62bf97baf977aec69cbc290c372899f913337a9093e8f066ab59b8657a365c\"}}, OutputType::BECH32, /*op_desc_id=*/uint256S(\"8412ba3ac20ba3a30f81442d10d32e0468fa52814960d04e959bf84a9b813b88\"), {{}}, /*spender_nlocktime=*/0, /*spender_nsequence=*/CTxIn::SEQUENCE_FINAL, {});\n     Check(\"wsh(and_v(v:hash256(ae253ca2a54debcac7ecf414f6734f48c56421a08bb59182ff9f39a6fffdb588),pk(xprvA1RpRA33e1JQ7ifknakTFpgNXPmW2YvmhqLQYMmrj4xJXXWYpDPS3xz7iAxn8L39njGVyuoseXzU6rcxFLJ8HFsTjSyQbLYnMpCqE2VbFWc)))\", \"wsh(and_v(v:hash256(ae253ca2a54debcac7ecf414f6734f48c56421a08bb59182ff9f39a6fffdb588),pk(xpub6ERApfZwUNrhLCkDtcHTcxd75RbzS1ed54G1LkBUHQVHQKqhMkhgbmJbZRkrgZw4koxb5JaHWkY4ALHY2grBGRjaDMzQLcgJvLJuZZvRcEL)))\", \"wsh(and_v(v:hash256(ae253ca2a54debcac7ecf414f6734f48c56421a08bb59182ff9f39a6fffdb588),pk(xpub6ERApfZwUNrhLCkDtcHTcxd75RbzS1ed54G1LkBUHQVHQKqhMkhgbmJbZRkrgZw4koxb5JaHWkY4ALHY2grBGRjaDMzQLcgJvLJuZZvRcEL)))\", SIGNABLE, {{\"0020cf62bf97baf977aec69cbc290c372899f913337a9093e8f066ab59b8657a365c\"}}, OutputType::BECH32, /*op_desc_id=*/uint256S(\"8412ba3ac20ba3a30f81442d10d32e0468fa52814960d04e959bf84a9b813b88\"), {{}}, /*spender_nlocktime=*/0, /*spender_nsequence=*/CTxIn::SEQUENCE_FINAL, {{ParseHex(\"ae253ca2a54debcac7ecf414f6734f48c56421a08bb59182ff9f39a6fffdb588\"), ParseHex(\"000000000019d6689c085ae165831e934ff763ae46a2a6c172b3f1b60a8ce26f\")}});\n+\n+    CheckInferDescriptor(\"a9141a31ad23bf49c247dd531a623c2ef57da3c400c587\", \"sh(pkh([deadbeef/0h/0h/0]03a34b99f22c790c4e36b2b3c2c35a36db06226e41c692fc82b8b56ac1c540c5bd))\", {\"76a9149a1c78a507689f6f54b847ad1cef1e614ee23f1e88ac\"}, {{\"03a34b99f22c790c4e36b2b3c2c35a36db06226e41c692fc82b8b56ac1c540c5bd\", \"deadbeef/0h/0h/0\"}});\n+    CheckInferDescriptor(\"41069228de6902abb4f541791f6d7f925b10e2078ccb1298856e5ea5cc5fd667f930eac37a00cc07f9a91ef3c2d17bf7a17db04552ff90ac312a5b8b4caca6c97aa4ac\", \"raw(41069228de6902abb4f541791f6d7f925b10e2078ccb1298856e5ea5cc5fd667f930eac37a00cc07f9a91ef3c2d17bf7a17db04552ff90ac312a5b8b4caca6c97aa4ac)\", {}, {{\"069228de6902abb4f541791f6d7f925b10e2078ccb1298856e5ea5cc5fd667f930eac37a00cc07f9a91ef3c2d17bf7a17db04552ff90ac312a5b8b4caca6c97aa4\", \"\"}});\n+    CheckInferDescriptor(\"76a91445ff7c2327866472639d507334a9a00119dfd32688ac\", \"addr(17P7ge56F2QcdHxxRBa2NyzmejFggPwBJ9)\", {}, {{\"069228de6902abb4f541791f6d7f925b10e2078ccb1298856e5ea5cc5fd667f930eac37a00cc07f9a91ef3c2d17bf7a17db04552ff90ac312a5b8b4caca6c97aa4\", \"\"}});\n+    CheckInferDescriptor(\"001422e363a523947a110d9a9eb114820de183aca313\", \"addr(bc1qyt3k8ffrj3apzrv6n6c3fqsduxp6egcnk2r66j)\", {}, {{\"049228de6902abb4f541791f6d7f925b10e2078ccb1298856e5ea5cc5fd667f930eac37a00cc07f9a91ef3c2d17bf7a17db04552ff90ac312a5b8b4caca6c97aa4\", \"\"}});",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28602#discussion_r1349375419",
      "id" : 1349375419,
      "in_reply_to_id" : 1349260414,
      "line" : 641,
      "node_id" : "PRRC_kwDOABII585QbdW7",
      "original_commit_id" : "6f00af4bcb2f703f8a5f9b63fe3346a660be52da",
      "original_line" : 641,
      "original_position" : 63,
      "original_start_line" : null,
      "path" : "src/test/descriptor_tests.cpp",
      "position" : 67,
      "pull_request_review_id" : 1662885015,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28602",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1349375419/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-10-06T22:46:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1349375419",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n",
      "created_at" : "2023-10-08T17:25:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28602#issuecomment-1752111171",
      "id" : 1752111171,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28602",
      "node_id" : "IC_kwDOABII585obxhD",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1752111171/reactions"
      },
      "updated_at" : "2023-10-08T17:25:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1752111171",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "utACK a49081f6cea603d354beef1edff480d4b034dafd",
      "created_at" : "2023-10-08T18:34:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28602#issuecomment-1752125343",
      "id" : 1752125343,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28602",
      "node_id" : "IC_kwDOABII585ob0-f",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1752125343/reactions"
      },
      "updated_at" : "2023-10-08T18:34:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1752125343",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28602#discussion_r1349925787"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28602"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1349925787"
         }
      },
      "author_association" : "MEMBER",
      "body" : "fb3c5f3e9fb17e2313a6f2aec6db49f3e0da8614 why is `return key` outside the `if` context here, but in the below check it's inside?\r\n\r\nWouldn't that cause it to return `0` instead of `{}`?",
      "commit_id" : "a49081f6cea603d354beef1edff480d4b034dafd",
      "created_at" : "2023-10-09T07:09:00Z",
      "diff_hunk" : "@@ -1491,13 +1491,17 @@ struct KeyParser {\n         if (miniscript::IsTapscript(m_script_ctx) && end - begin == 32) {\n             XOnlyPubKey pubkey;\n             std::copy(begin, end, pubkey.begin());\n-            m_keys.push_back(InferPubkey(pubkey.GetEvenCorrespondingCPubKey(), ParseContext(), *m_in));\n+            if (auto pubkey_provider = InferPubkey(pubkey.GetEvenCorrespondingCPubKey(), ParseContext(), *m_in)) {\n+                m_keys.push_back(std::move(pubkey_provider));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28602#discussion_r1349925787",
      "id" : 1349925787,
      "line" : 1503,
      "node_id" : "PRRC_kwDOABII585Qdjub",
      "original_commit_id" : "fb3c5f3e9fb17e2313a6f2aec6db49f3e0da8614",
      "original_line" : 1495,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/script/descriptor.cpp",
      "position" : 24,
      "pull_request_review_id" : 1663830181,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28602",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1349925787/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-10-09T07:26:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1349925787",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28602#discussion_r1349934946"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28602"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1349934946"
         }
      },
      "author_association" : "MEMBER",
      "body" : "62ca75bd99b42f686ed1879481b856c882b40025: what's wrong with passing `ctx` here?",
      "commit_id" : "a49081f6cea603d354beef1edff480d4b034dafd",
      "created_at" : "2023-10-09T07:20:54Z",
      "diff_hunk" : "@@ -1876,7 +1880,7 @@ std::unique_ptr<DescriptorImpl> InferScript(const CScript& script, ParseScriptCo\n         CKeyID keyid(hash);\n         CPubKey pubkey;\n         if (provider.GetPubKey(keyid, pubkey)) {\n-            if (auto pubkey_provider = InferPubkey(pubkey, ctx, provider)) {\n+            if (auto pubkey_provider = InferPubkey(pubkey, ParseScriptContext::P2WPKH, provider)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28602#discussion_r1349934946",
      "id" : 1349934946,
      "line" : 1883,
      "node_id" : "PRRC_kwDOABII585Qdl9i",
      "original_commit_id" : "62ca75bd99b42f686ed1879481b856c882b40025",
      "original_line" : 1883,
      "original_position" : 51,
      "original_start_line" : null,
      "path" : "src/script/descriptor.cpp",
      "position" : 79,
      "pull_request_review_id" : 1663830181,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28602",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1349934946/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-10-09T07:26:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1349934946",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@DrahtBot you're drunk, I just reviewed it.",
      "created_at" : "2023-10-09T07:27:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28602#issuecomment-1752472795",
      "id" : 1752472795,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28602",
      "node_id" : "IC_kwDOABII585odJzb",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1752472795/reactions"
      },
      "updated_at" : "2023-10-09T07:27:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1752472795",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   }
]
