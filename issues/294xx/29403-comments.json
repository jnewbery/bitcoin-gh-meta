[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage\nFor detailed information about the code coverage, see the [test coverage report](https://corecheck.dev/bitcoin/bitcoin/pulls/29403).\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n",
      "created_at" : "2024-02-07T13:42:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29403#issuecomment-1932079274",
      "id" : 1932079274,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29403",
      "node_id" : "IC_kwDOABII585zKTCq",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1932079274/reactions"
      },
      "updated_at" : "2024-02-07T13:43:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1932079274",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29403#discussion_r1481506563"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29403"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1481506563"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit, feel free to ignore: Any reason to add `__func__` to this log, when none of the other logs have it here? If someone is interested in the exact source location, they can enable the corresponding log option. If this is needed for context, it could make more sense to clarify the log message itself, so that it is unique and clear without requiring the source code as context.\r\n",
      "commit_id" : "69c5bb5c3ad3da508541a3ef6c29a0bad21f2fc0",
      "created_at" : "2024-02-07T13:50:54Z",
      "diff_hunk" : "@@ -2395,15 +2395,37 @@ bool CWallet::DelAddressBook(const CTxDestination& address)\n             WalletLogPrintf(\"%s called with IsMine address, NOT SUPPORTED. Please report this bug! %s\\n\", __func__, PACKAGE_BUGREPORT);\n             return false;\n         }\n+\n+        WalletBatch batch(GetDatabase());\n+        if (!batch.TxnBegin()) {\n+            WalletLogPrintf(\"Error: cannot create db txn for address book entry removal\\n\");\n+            return false;\n+        }\n+\n         // Delete data rows associated with this address\n-        batch.EraseAddressData(address);\n+        if (!batch.EraseAddressData(address)) {\n+            WalletLogPrintf(\"Error: cannot erase address book entry data\\n\");\n+            return false;\n+        }\n+\n+        // Delete purpose and name\n+        if (!batch.ErasePurpose(dest) || !batch.EraseName(dest)) {\n+            WalletLogPrintf(\"%s error erasing purpose/name\\n\", __func__);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29403#discussion_r1481506563",
      "id" : 1481506563,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585YTf8D",
      "original_commit_id" : "da103ecf4a7a341e7376c6ef31af11aed05aed5c",
      "original_line" : 2413,
      "original_position" : 29,
      "original_start_line" : null,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 1867863458,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29403",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1481506563/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-02-07T13:50:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1481506563",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29403#discussion_r1481525685"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29403"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1481525685"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> Any reason to add `__func__` to this log, when none of the other logs have it here?\r\n\r\nNot really. It is just a bad habit. I pulled 9a4e1f5 from #26836 because it is required for this changes. Will change it there.",
      "commit_id" : "69c5bb5c3ad3da508541a3ef6c29a0bad21f2fc0",
      "created_at" : "2024-02-07T14:04:31Z",
      "diff_hunk" : "@@ -2395,15 +2395,37 @@ bool CWallet::DelAddressBook(const CTxDestination& address)\n             WalletLogPrintf(\"%s called with IsMine address, NOT SUPPORTED. Please report this bug! %s\\n\", __func__, PACKAGE_BUGREPORT);\n             return false;\n         }\n+\n+        WalletBatch batch(GetDatabase());\n+        if (!batch.TxnBegin()) {\n+            WalletLogPrintf(\"Error: cannot create db txn for address book entry removal\\n\");\n+            return false;\n+        }\n+\n         // Delete data rows associated with this address\n-        batch.EraseAddressData(address);\n+        if (!batch.EraseAddressData(address)) {\n+            WalletLogPrintf(\"Error: cannot erase address book entry data\\n\");\n+            return false;\n+        }\n+\n+        // Delete purpose and name\n+        if (!batch.ErasePurpose(dest) || !batch.EraseName(dest)) {\n+            WalletLogPrintf(\"%s error erasing purpose/name\\n\", __func__);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29403#discussion_r1481525685",
      "id" : 1481525685,
      "in_reply_to_id" : 1481506563,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585YTkm1",
      "original_commit_id" : "da103ecf4a7a341e7376c6ef31af11aed05aed5c",
      "original_line" : 2413,
      "original_position" : 29,
      "original_start_line" : null,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 1867895148,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29403",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1481525685/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-02-07T14:04:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1481525685",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Updated per feedback. Thanks Marko.",
      "created_at" : "2024-02-07T14:16:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29403#issuecomment-1932141334",
      "id" : 1932141334,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29403",
      "node_id" : "IC_kwDOABII585zKiMW",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1932141334/reactions"
      },
      "updated_at" : "2024-02-07T14:16:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1932141334",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--85328a0da195eb286784d51f73fa0af9-->\n\nð§ At least one of the CI tasks failed. Make sure to run all tests locally, according to the\ndocumentation.\n\nPossibly this is due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n<sub>Debug: https://github.com/bitcoin/bitcoin/runs/21321086502</sub>",
      "created_at" : "2024-02-07T14:18:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29403#issuecomment-1932145648",
      "id" : 1932145648,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29403",
      "node_id" : "IC_kwDOABII585zKjPw",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1932145648/reactions"
      },
      "updated_at" : "2024-02-07T14:18:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1932145648",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29403#discussion_r1481997602"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29403"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1481997602"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In 2d770f6ae88d9ee6f1775e011f241274059fe275 \"wallet: clean redundancies in DelAddressBook\"\r\n\r\nI'd prefer to have these occur separately so that a distinct error can be logged for each, that way we can discover which operation failed.",
      "commit_id" : "69c5bb5c3ad3da508541a3ef6c29a0bad21f2fc0",
      "created_at" : "2024-02-07T19:43:17Z",
      "diff_hunk" : "@@ -2396,14 +2397,24 @@ bool CWallet::DelAddressBook(const CTxDestination& address)\n             return false;\n         }\n         // Delete data rows associated with this address\n-        batch.EraseAddressData(address);\n+        if (!batch.EraseAddressData(address)) {\n+            WalletLogPrintf(\"Error: cannot erase address book entry data\\n\");\n+            return false;\n+        }\n+\n+        // Delete purpose and name\n+        if (!batch.ErasePurpose(dest) || !batch.EraseName(dest)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29403#discussion_r1481997602",
      "id" : 1481997602,
      "line" : 2412,
      "node_id" : "PRRC_kwDOABII585YVX0i",
      "original_commit_id" : "2d770f6ae88d9ee6f1775e011f241274059fe275",
      "original_line" : 2406,
      "original_position" : 19,
      "original_start_line" : null,
      "path" : "src/wallet/wallet.cpp",
      "position" : 28,
      "pull_request_review_id" : 1868639990,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29403",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1481997602/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-02-07T19:46:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1481997602",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29403#discussion_r1482000338"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29403"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1482000338"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In 0dba0b6de03c0c79bb09296b913729ec8eb75aca \"wallet: bdb batch 'ErasePrefix', do not create txn internally\"\r\n\r\nInstead of `assert`ing, I would prefer if this did `if (!Assume(activeTxn)) return false` so we didn't cause nodes to crash if a transaction were missing for whatever reason. `Assume` should still catch this for developers.",
      "commit_id" : "69c5bb5c3ad3da508541a3ef6c29a0bad21f2fc0",
      "created_at" : "2024-02-07T19:46:01Z",
      "diff_hunk" : "@@ -887,7 +887,7 @@ bool BerkeleyBatch::HasKey(DataStream&& key)\n \n bool BerkeleyBatch::ErasePrefix(Span<const std::byte> prefix)\n {\n-    if (!TxnBegin()) return false;\n+    assert(activeTxn); // because this is a read-write operation, the current db config requires a txn context.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29403#discussion_r1482000338",
      "id" : 1482000338,
      "line" : 890,
      "node_id" : "PRRC_kwDOABII585YVYfS",
      "original_commit_id" : "0dba0b6de03c0c79bb09296b913729ec8eb75aca",
      "original_line" : 890,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/wallet/bdb.cpp",
      "position" : 5,
      "pull_request_review_id" : 1868639990,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29403",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1482000338/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-02-07T19:46:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1482000338",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   }
]
