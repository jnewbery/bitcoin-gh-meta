[
   {
      "author_association" : "MEMBER",
      "body" : "@markblundeberg could you look into #15864?",
      "created_at" : "2019-06-16T22:54:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/16220#issuecomment-502492677",
      "id" : 502492677,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16220",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUwMjQ5MjY3Nw==",
      "updated_at" : "2019-06-16T22:54:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/502492677",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "@hebasto Hmm interesting, thanks for pointing that out. I think you're onto something good there. To be honest I don't fully grok the init code so I can't provide a good review there.\r\n\r\nRelating to this wallets/ directory issue though, I wonder if in the case of #15240, it would have been desired for bitcoind to create a wallets/ directory on first run, even if `/var/local/lib/bitcoind` already exists (it would have been created by a sysadmin).\r\n\r\nThere must be some elegant solution to all this, but I don't have any great ideas to offer.",
      "created_at" : "2019-06-17T04:06:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/16220#issuecomment-502527419",
      "id" : 502527419,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16220",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUwMjUyNzQxOQ==",
      "updated_at" : "2019-06-17T04:06:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/502527419",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/36528214?v=4",
         "events_url" : "https://api.github.com/users/markblundeberg/events{/privacy}",
         "followers_url" : "https://api.github.com/users/markblundeberg/followers",
         "following_url" : "https://api.github.com/users/markblundeberg/following{/other_user}",
         "gists_url" : "https://api.github.com/users/markblundeberg/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/markblundeberg",
         "id" : 36528214,
         "login" : "markblundeberg",
         "node_id" : "MDQ6VXNlcjM2NTI4MjE0",
         "organizations_url" : "https://api.github.com/users/markblundeberg/orgs",
         "received_events_url" : "https://api.github.com/users/markblundeberg/received_events",
         "repos_url" : "https://api.github.com/users/markblundeberg/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/markblundeberg/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/markblundeberg/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/markblundeberg"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> I think a more elegant solution would be to have wallets/ directory created in the wallet initialization, however I'm not an expert on the wallet part of the code and how this ought to behave.\r\n\r\nIt would be, however the reason that `wallets/` is not created when the `.bitcoin` directory already exists is backwards compatibility. If there is an existing datadir but no wallets directory it's assumed to be an old data directory, and creating `wallets` would effectively hide the existing wallets in the top level dir, possibly leading to people to suspect loss of funds. \r\n\r\nThere would be other possibilities such as checking for any existing wallets first, but that was deemed more dangerous: no naming convention was enforced for wallets before, so it's non-trivial and brittle to do this detection.\r\n\r\nThere was a lot of discussion around this at the time.\r\n\r\nI guess there could be another heuristic: if the datadir is *completely empty*, do create the wallets directory. Then again, it's kind of piling on hacks (do you want to exclude `bitcoin.conf` in this count?) I wish there was a better way.",
      "created_at" : "2019-06-18T07:58:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/16220#issuecomment-502992650",
      "id" : 502992650,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16220",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUwMjk5MjY1MA==",
      "updated_at" : "2019-06-18T08:02:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/502992650",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I found this in my TODO notes from a previous discussion about this (https://github.com/bitcoin/bitcoin/pull/24266#discussion_r800865220), and think it could be a good solution\r\n\r\n- `util/system` datadir code should not care about wallets or look for or create any wallet paths\r\n- If `-walletdir` is specified, wallet code should use that directory to locate and list wallets.\r\n- If `-walletdir` is specified and path is not a directory, wallet init should return a fatal error and refuse to start\r\n- If `-walletdir` is not specified, wallet code should use `<datadir>/wallets` as the directory to locate and list wallets.\r\n- If `-walletdir` is not specified and `<datadir>/wallets` does not exist, wallet init code should create it\r\n  - Before creating `<datadir>/wallets` wallet should call ~`ListWalletDir`~ `ListDatabases` on `<datadir>`\r\n  - If list is empty wallet should create `<datadir>/wallets` as a directory, otherwise it should create it as a symlink pointing to `.`",
      "created_at" : "2023-02-14T15:46:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/16220#issuecomment-1429962692",
      "id" : 1429962692,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16220",
      "node_id" : "IC_kwDOABII585VO3_E",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1429962692/reactions"
      },
      "updated_at" : "2023-02-14T15:46:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1429962692",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "would like to work on this, with the solution proposed by @ryanofsky ",
      "created_at" : "2023-09-13T09:44:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/16220#issuecomment-1717299925",
      "id" : 1717299925,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16220",
      "node_id" : "IC_kwDOABII585mW-rV",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1717299925/reactions"
      },
      "updated_at" : "2023-09-13T09:44:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1717299925",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/15610188?v=4",
         "events_url" : "https://api.github.com/users/BrandonOdiwuor/events{/privacy}",
         "followers_url" : "https://api.github.com/users/BrandonOdiwuor/followers",
         "following_url" : "https://api.github.com/users/BrandonOdiwuor/following{/other_user}",
         "gists_url" : "https://api.github.com/users/BrandonOdiwuor/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/BrandonOdiwuor",
         "id" : 15610188,
         "login" : "BrandonOdiwuor",
         "node_id" : "MDQ6VXNlcjE1NjEwMTg4",
         "organizations_url" : "https://api.github.com/users/BrandonOdiwuor/orgs",
         "received_events_url" : "https://api.github.com/users/BrandonOdiwuor/received_events",
         "repos_url" : "https://api.github.com/users/BrandonOdiwuor/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/BrandonOdiwuor/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/BrandonOdiwuor/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/BrandonOdiwuor"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "@ryanofsky @hebasto @laanwj could you please look at #28514, I created a PR regarding this issue",
      "created_at" : "2023-10-11T06:10:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/16220#issuecomment-1756867216",
      "id" : 1756867216,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16220",
      "node_id" : "IC_kwDOABII585ot6qQ",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1756867216/reactions"
      },
      "updated_at" : "2023-10-11T06:10:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1756867216",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/15610188?v=4",
         "events_url" : "https://api.github.com/users/BrandonOdiwuor/events{/privacy}",
         "followers_url" : "https://api.github.com/users/BrandonOdiwuor/followers",
         "following_url" : "https://api.github.com/users/BrandonOdiwuor/following{/other_user}",
         "gists_url" : "https://api.github.com/users/BrandonOdiwuor/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/BrandonOdiwuor",
         "id" : 15610188,
         "login" : "BrandonOdiwuor",
         "node_id" : "MDQ6VXNlcjE1NjEwMTg4",
         "organizations_url" : "https://api.github.com/users/BrandonOdiwuor/orgs",
         "received_events_url" : "https://api.github.com/users/BrandonOdiwuor/received_events",
         "repos_url" : "https://api.github.com/users/BrandonOdiwuor/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/BrandonOdiwuor/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/BrandonOdiwuor/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/BrandonOdiwuor"
      }
   }
]
