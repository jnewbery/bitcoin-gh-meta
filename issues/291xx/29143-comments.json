[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage\nFor detailed information about the code coverage, see the [test coverage report](https://corecheck.dev/bitcoin/bitcoin/pulls/29143).\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#25390](https://github.com/bitcoin/bitcoin/pull/25390) (sync: introduce a thread-safe generic container and use it to remove a bunch of \"GlobalMutex\"es by vasild)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "created_at" : "2023-12-26T18:29:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29143#issuecomment-1869707015",
      "id" : 1869707015,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29143",
      "node_id" : "IC_kwDOABII585vcXcH",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1869707015/reactions"
      },
      "updated_at" : "2023-12-26T19:30:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1869707015",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "cc @maflcko @fanquake ",
      "created_at" : "2023-12-26T18:30:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29143#issuecomment-1869707247",
      "id" : 1869707247,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29143",
      "node_id" : "IC_kwDOABII585vcXfv",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1869707247/reactions"
      },
      "updated_at" : "2023-12-26T18:30:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1869707247",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/33068296?v=4",
         "events_url" : "https://api.github.com/users/dimitaracev/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dimitaracev/followers",
         "following_url" : "https://api.github.com/users/dimitaracev/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dimitaracev/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dimitaracev",
         "id" : 33068296,
         "login" : "dimitaracev",
         "node_id" : "MDQ6VXNlcjMzMDY4Mjk2",
         "organizations_url" : "https://api.github.com/users/dimitaracev/orgs",
         "received_events_url" : "https://api.github.com/users/dimitaracev/received_events",
         "repos_url" : "https://api.github.com/users/dimitaracev/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dimitaracev/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dimitaracev/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dimitaracev"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "```sh\r\ntest/functional/wallet_multiwallet.py:38:9: F841 local variable 'e' is assigned to but never used\r\ntest/functional/wallet_multiwallet.py:39:50: F821 undefined name 'e'\r\ntest/functional/wallet_multiwallet.py:39:104: F821 undefined name 'e'\r\ntest/functional/wallet_multiwallet.py:40:63: F821 undefined name 'e'\r\ntest/functional/wallet_multiwallet.py:40:130: F821 undefined name 'e'\r\n```",
      "created_at" : "2023-12-26T18:36:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29143#issuecomment-1869709929",
      "id" : 1869709929,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29143",
      "node_id" : "IC_kwDOABII585vcYJp",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1869709929/reactions"
      },
      "updated_at" : "2023-12-26T18:36:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1869709929",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19480819?v=4",
         "events_url" : "https://api.github.com/users/brunoerg/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brunoerg/followers",
         "following_url" : "https://api.github.com/users/brunoerg/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brunoerg/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brunoerg",
         "id" : 19480819,
         "login" : "brunoerg",
         "node_id" : "MDQ6VXNlcjE5NDgwODE5",
         "organizations_url" : "https://api.github.com/users/brunoerg/orgs",
         "received_events_url" : "https://api.github.com/users/brunoerg/received_events",
         "repos_url" : "https://api.github.com/users/brunoerg/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brunoerg/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brunoerg/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brunoerg"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> How is this possible if `RemoveWallet()` locks the context wallets' mutex, checks if the wallet is there (failing if not) and then removes it.\r\n\r\nFrom my understanding, the statements\r\n```c++\r\nauto it = g_unloading_wallet_set.insert(name);\r\nassert(it.second);\r\n```\r\nassume that the wallet will always be correctly inserted into `g_unloading_wallet_set` where `g_unloading_wallet_set.insert(name)` returns a pair (`it.second` is 1 if the wallet is successfully inserted into the set to be used by `ReleaseWallet()`, or 0 if it is already present in the set). At least to me it appears that it can in some rare cases come into a collision where the wallet name is not yet removed from the `g_unloading_wallet_set` and `g_unloading_wallet_set.insert(name)` returns `it.second` as 0. Correct me if I'm wrong but I'm not very familiar with the codebase and trying to slowly learn.",
      "created_at" : "2023-12-26T23:01:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29143#issuecomment-1869811694",
      "id" : 1869811694,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29143",
      "node_id" : "IC_kwDOABII585vcw_u",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1869811694/reactions"
      },
      "updated_at" : "2023-12-26T23:01:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1869811694",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/33068296?v=4",
         "events_url" : "https://api.github.com/users/dimitaracev/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dimitaracev/followers",
         "following_url" : "https://api.github.com/users/dimitaracev/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dimitaracev/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dimitaracev",
         "id" : 33068296,
         "login" : "dimitaracev",
         "node_id" : "MDQ6VXNlcjMzMDY4Mjk2",
         "organizations_url" : "https://api.github.com/users/dimitaracev/orgs",
         "received_events_url" : "https://api.github.com/users/dimitaracev/received_events",
         "repos_url" : "https://api.github.com/users/dimitaracev/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dimitaracev/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dimitaracev/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dimitaracev"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> > How is this possible if `RemoveWallet()` locks the context wallets' mutex, checks if the wallet is there (failing if not) and then removes it.\r\n> \r\n> From my understanding, the statements\r\n> \r\n> ```c++\r\n> auto it = g_unloading_wallet_set.insert(name);\r\n> assert(it.second);\r\n> ```\r\n> \r\n> assume that the wallet will always be correctly inserted into `g_unloading_wallet_set` where `g_unloading_wallet_set.insert(name)` returns a pair (`it.second` is 1 if the wallet is successfully inserted into the set to be used by `ReleaseWallet()`, or 0 if it is already present in the set). At least to me it appears that it can in some rare cases come into a collision where the wallet name is not yet removed from the `g_unloading_wallet_set` and `g_unloading_wallet_set.insert(name)` returns `it.second` as 0. Correct me if I'm wrong but I'm not very familiar with the codebase and trying to slowly learn.\r\n\r\nBefore calling `UnloadWallet()`, `unloadwallet` calls `RemoveWallet()` which locks the context wallets' mutex and tries to remove the wallet. Failing if the wallet is being unloaded (aka not able to remove it from the context wallets' vector).\r\n\r\nIn other words, the code shouldn't reach the `UnloadWallet()` call. Should verify that we are not pushing two pointers of the same wallet into the context vector.",
      "created_at" : "2023-12-26T23:19:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29143#issuecomment-1869817009",
      "id" : 1869817009,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29143",
      "node_id" : "IC_kwDOABII585vcySx",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1869817009/reactions"
      },
      "updated_at" : "2023-12-26T23:19:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1869817009",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@furszy Oh I see, will continue to look into this further. Thanks.",
      "created_at" : "2023-12-26T23:38:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29143#issuecomment-1869823524",
      "id" : 1869823524,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29143",
      "node_id" : "IC_kwDOABII585vcz4k",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1869823524/reactions"
      },
      "updated_at" : "2023-12-26T23:38:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1869823524",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/33068296?v=4",
         "events_url" : "https://api.github.com/users/dimitaracev/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dimitaracev/followers",
         "following_url" : "https://api.github.com/users/dimitaracev/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dimitaracev/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dimitaracev",
         "id" : 33068296,
         "login" : "dimitaracev",
         "node_id" : "MDQ6VXNlcjMzMDY4Mjk2",
         "organizations_url" : "https://api.github.com/users/dimitaracev/orgs",
         "received_events_url" : "https://api.github.com/users/dimitaracev/received_events",
         "repos_url" : "https://api.github.com/users/dimitaracev/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dimitaracev/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dimitaracev/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dimitaracev"
      }
   }
]
