[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK",
      "created_at" : "2022-06-06T13:44:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#issuecomment-1147463839",
      "id" : 1147463839,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25284",
      "node_id" : "IC_kwDOABII585EZOif",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1147463839/reactions"
      },
      "updated_at" : "2022-06-06T13:44:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1147463839",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [theuni](https://github.com/bitcoin/bitcoin/pull/25284#pullrequestreview-1596363843) |\n| Concept ACK | [vasild](https://github.com/bitcoin/bitcoin/pull/25284#issuecomment-1147463839) |\n| Stale ACK | [jonatack](https://github.com/bitcoin/bitcoin/pull/25284#pullrequestreview-1563400593) |\n\nIf your review is incorrectly listed, please react with ð to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#26859](https://github.com/bitcoin/bitcoin/pull/26859) (fuzz: extend ConsumeNetAddr() to return I2P and CJDNS addresses by vasild)\n* [#26621](https://github.com/bitcoin/bitcoin/pull/26621) (refactor: Continue moving application data from CNode to Peer by dergoegge)\n* [#24034](https://github.com/bitcoin/bitcoin/pull/24034) (p2p: delete anchors.dat after trying to connect to that peers by brunoerg)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "created_at" : "2022-06-07T09:06:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#issuecomment-1148401322",
      "id" : 1148401322,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25284",
      "node_id" : "IC_kwDOABII585Eczaq",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1148401322/reactions"
      },
      "updated_at" : "2023-08-25T19:13:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1148401322",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : ">It seems confusing to have consensus (weakly) depend on low level BIP 155 addrv2 serialization.\r\n\r\nYou mean the \"consensus\" module, right, not actual consensus?",
      "created_at" : "2022-06-18T16:12:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#issuecomment-1159490585",
      "id" : 1159490585,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25284",
      "node_id" : "IC_kwDOABII585FHGwZ",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1159490585/reactions"
      },
      "updated_at" : "2022-06-18T16:12:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1159490585",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Yes, just the module",
      "created_at" : "2022-06-18T16:15:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#issuecomment-1159491107",
      "id" : 1159491107,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25284",
      "node_id" : "IC_kwDOABII585FHG4j",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1159491107/reactions"
      },
      "updated_at" : "2022-06-18T16:15:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1159491107",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2022-07-12T15:15:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#issuecomment-1181889586",
      "id" : 1181889586,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25284",
      "node_id" : "IC_kwDOABII585GcjQy",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1181889586/reactions"
      },
      "updated_at" : "2022-07-12T15:15:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1181889586",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2022-07-27T11:22:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#issuecomment-1196601684",
      "id" : 1196601684,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25284",
      "node_id" : "IC_kwDOABII585HUrFU",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1196601684/reactions"
      },
      "updated_at" : "2022-07-27T11:22:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1196601684",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2022-09-16T10:16:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#issuecomment-1249188452",
      "id" : 1249188452,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25284",
      "node_id" : "IC_kwDOABII585KdRpk",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1249188452/reactions"
      },
      "updated_at" : "2022-09-16T10:16:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1249188452",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--13523179cfe9479db18ec6c5d236f789-->\nThere hasn't been much activity lately and the patch still needs rebase. What is the status here?\n\n* Is it still relevant? â¡ï¸ Please solve the conflicts to make it ready for review and to ensure the CI passes.\n* Is it no longer relevant? â¡ï¸ Please close.\n* Did the author lose interest or time to work on this? â¡ï¸ Please close it and mark it 'Up for grabs' with the label, so that it can be picked up in the future.\n",
      "created_at" : "2022-12-15T00:45:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#issuecomment-1352410596",
      "id" : 1352410596,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25284",
      "node_id" : "IC_kwDOABII585QnCXk",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1352410596/reactions"
      },
      "updated_at" : "2022-12-15T00:45:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1352410596",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n",
      "created_at" : "2023-01-19T16:18:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#issuecomment-1397236897",
      "id" : 1397236897,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25284",
      "node_id" : "IC_kwDOABII585TSCSh",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1397236897/reactions"
      },
      "updated_at" : "2023-01-19T16:18:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1397236897",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rebased and changed title\r\n\r\n<!--\r\n\r\n\r\ntemplate <typename MParams, typename MSubStream>\r\nauto MakeParamsStream(const MParams& params, MSubStream& substream) {\r\n    std::cout << __LINE__ << std::endl;\r\n    return ParamsStream{params, substream};\r\n}\r\ntemplate <typename MParams, typename MSParams, typename MSSubStream>\r\nauto MakeParamsStream(const MParams& params,\r\n                      ParamsStream<MSParams, MSSubStream>& substream) {\r\n    std::cout << __LINE__ << std::endl;\r\n    return ParamsStream{params, substream.m_substream};\r\n}",
      "created_at" : "2023-01-31T18:40:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#issuecomment-1410886593",
      "id" : 1410886593,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25284",
      "node_id" : "IC_kwDOABII585UGGvB",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1410886593/reactions"
      },
      "updated_at" : "2023-01-31T18:40:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1410886593",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n",
      "created_at" : "2023-01-31T22:58:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#issuecomment-1411184315",
      "id" : 1411184315,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25284",
      "node_id" : "IC_kwDOABII585UHPa7",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1411184315/reactions"
      },
      "updated_at" : "2023-01-31T22:58:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1411184315",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n",
      "created_at" : "2023-05-30T16:01:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#issuecomment-1568693241",
      "id" : 1568693241,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25284",
      "node_id" : "IC_kwDOABII585dgFv5",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1568693241/reactions"
      },
      "updated_at" : "2023-05-30T16:01:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1568693241",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "rebased",
      "created_at" : "2023-07-06T11:12:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#issuecomment-1623488101",
      "id" : 1623488101,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25284",
      "node_id" : "IC_kwDOABII585gxHZl",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1623488101/reactions"
      },
      "updated_at" : "2023-07-06T11:12:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1623488101",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n",
      "created_at" : "2023-07-13T23:57:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#issuecomment-1635069230",
      "id" : 1635069230,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25284",
      "node_id" : "IC_kwDOABII585hdS0u",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1635069230/reactions"
      },
      "updated_at" : "2023-07-13T23:57:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1635069230",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK, will have a look.",
      "created_at" : "2023-07-28T02:20:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#issuecomment-1654879568",
      "id" : 1654879568,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25284",
      "node_id" : "IC_kwDOABII585io3VQ",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1654879568/reactions"
      },
      "updated_at" : "2023-07-28T02:20:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1654879568",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n",
      "created_at" : "2023-08-03T17:26:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#issuecomment-1664361540",
      "id" : 1664361540,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25284",
      "node_id" : "IC_kwDOABII585jNCRE",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1664361540/reactions"
      },
      "updated_at" : "2023-08-03T17:26:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1664361540",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1284741805"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1284741805"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "ef03a51\r\n```suggestion\r\n/** Convert any argument to a reference to X, maintaining constness.\r\n```\r\n\r\n-----\r\n\r\nalso here\r\n\r\n```diff\r\n-/* ::GetSerializeSize implementations\r\n+/** ::GetSerializeSize implementations\r\n```\r\n",
      "commit_id" : "9dfc1f373e5a896ae63f535c4c3b7d6e6e6d08d0",
      "created_at" : "2023-08-04T18:49:45Z",
      "diff_hunk" : "@@ -133,12 +134,29 @@ enum\n     SER_GETHASH         = (1 << 2),\n };\n \n-//! Convert the reference base type to X, without changing constness or reference type.\n-template<typename X> X& ReadWriteAsHelper(X& x) { return x; }\n-template<typename X> const X& ReadWriteAsHelper(const X& x) { return x; }\n+/* Convert any argument to a reference to X, maintaining constness.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1284741805",
      "id" : 1284741805,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585Mk5qt",
      "original_commit_id" : "6a99da9fa4a66e343df0910918da0ba9686d0fde",
      "original_line" : 137,
      "original_position" : 15,
      "original_start_line" : null,
      "path" : "src/serialize.h",
      "position" : null,
      "pull_request_review_id" : 1563400593,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1284741805/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-08-04T19:26:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1284741805",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1284769402"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1284769402"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "6a99da9 If the `#if` directive is inversed\r\n\r\n```\r\ntest/serialize_tests.cpp:281:22: error: use of undeclared identifier 'ParseUint32'; did you mean 'ParseUInt32'?\r\n                ok = ParseUint32(str, &data);\r\n                     ^~~~~~~~~~~\r\n                     ParseUInt32\r\n./util/strencodings.h:225:20: note: 'ParseUInt32' declared here\r\n[[nodiscard]] bool ParseUInt32(std::string_view str, uint32_t *out);\r\n```\r\n\r\n",
      "commit_id" : "9dfc1f373e5a896ae63f535c4c3b7d6e6e6d08d0",
      "created_at" : "2023-08-04T19:21:02Z",
      "diff_hunk" : "@@ -254,4 +255,175 @@ BOOST_AUTO_TEST_CASE(class_methods)\n     }\n }\n \n+enum class BaseFormat {\n+    DEC,\n+    HEX,\n+};\n+\n+/// (Un)serialize a number as a string either from/to decimal or hexadecimal.\n+class Base\n+{\n+public:\n+    uint8_t m_base_data;\n+\n+    Base() : m_base_data(17) {}\n+    explicit Base(uint8_t data) : m_base_data(data) {}\n+\n+#if 0 // the following two are equivalent\n+    SERIALIZE_METHODS_PARAMS(Base, obj, BaseFormat, fmt)\n+    {\n+        if (ser_action.ForRead()) {\n+            std::string str;\n+            s >> str;\n+            assert(str.size() == 2 || (fmt == BaseFormat::DEC && str.size() == 3));\n+            uint32_t data;\n+            bool ok;\n+            if (fmt == BaseFormat::DEC) {\n+                ok = ParseUint32(str, &data);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1284769402",
      "id" : 1284769402,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585MlAZ6",
      "original_commit_id" : "6a99da9fa4a66e343df0910918da0ba9686d0fde",
      "original_line" : 282,
      "original_position" : 36,
      "original_start_line" : null,
      "path" : "src/test/serialize_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 1563400593,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1284769402/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-08-04T19:26:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1284769402",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1288277494"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1288277494"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Good catch. The test was written by @vasild. I've removed the code, since there is already another unit test checking `SERIALIZE_METHODS_PARAMS`.\r\n\r\nAlso, I've replaced `DEC` by `RAW` to remove the dependency on tinyformat for the unit test and instead only use Bitcoin Core's own util functions.",
      "commit_id" : "9dfc1f373e5a896ae63f535c4c3b7d6e6e6d08d0",
      "created_at" : "2023-08-09T10:26:24Z",
      "diff_hunk" : "@@ -254,4 +255,175 @@ BOOST_AUTO_TEST_CASE(class_methods)\n     }\n }\n \n+enum class BaseFormat {\n+    DEC,\n+    HEX,\n+};\n+\n+/// (Un)serialize a number as a string either from/to decimal or hexadecimal.\n+class Base\n+{\n+public:\n+    uint8_t m_base_data;\n+\n+    Base() : m_base_data(17) {}\n+    explicit Base(uint8_t data) : m_base_data(data) {}\n+\n+#if 0 // the following two are equivalent\n+    SERIALIZE_METHODS_PARAMS(Base, obj, BaseFormat, fmt)\n+    {\n+        if (ser_action.ForRead()) {\n+            std::string str;\n+            s >> str;\n+            assert(str.size() == 2 || (fmt == BaseFormat::DEC && str.size() == 3));\n+            uint32_t data;\n+            bool ok;\n+            if (fmt == BaseFormat::DEC) {\n+                ok = ParseUint32(str, &data);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1288277494",
      "id" : 1288277494,
      "in_reply_to_id" : 1284769402,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585MyY32",
      "original_commit_id" : "6a99da9fa4a66e343df0910918da0ba9686d0fde",
      "original_line" : 282,
      "original_position" : 36,
      "original_start_line" : null,
      "path" : "src/test/serialize_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 1569235054,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1288277494/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-08-09T10:26:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1288277494",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1288277658"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1288277658"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Thanks, fixed doxygen",
      "commit_id" : "9dfc1f373e5a896ae63f535c4c3b7d6e6e6d08d0",
      "created_at" : "2023-08-09T10:26:34Z",
      "diff_hunk" : "@@ -133,12 +134,29 @@ enum\n     SER_GETHASH         = (1 << 2),\n };\n \n-//! Convert the reference base type to X, without changing constness or reference type.\n-template<typename X> X& ReadWriteAsHelper(X& x) { return x; }\n-template<typename X> const X& ReadWriteAsHelper(const X& x) { return x; }\n+/* Convert any argument to a reference to X, maintaining constness.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1288277658",
      "id" : 1288277658,
      "in_reply_to_id" : 1284741805,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585MyY6a",
      "original_commit_id" : "6a99da9fa4a66e343df0910918da0ba9686d0fde",
      "original_line" : 137,
      "original_position" : 15,
      "original_start_line" : null,
      "path" : "src/serialize.h",
      "position" : null,
      "pull_request_review_id" : 1569235302,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1288277658/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-08-09T10:26:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1288277658",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1302182555"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1302182555"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Maybe constrain this with `std::is_base_of` and SFINAE until we get concepts?",
      "commit_id" : "9dfc1f373e5a896ae63f535c4c3b7d6e6e6d08d0",
      "created_at" : "2023-08-22T20:50:23Z",
      "diff_hunk" : "@@ -133,12 +133,30 @@ enum\n     SER_GETHASH         = (1 << 2),\n };\n \n-//! Convert the reference base type to X, without changing constness or reference type.\n-template<typename X> X& ReadWriteAsHelper(X& x) { return x; }\n-template<typename X> const X& ReadWriteAsHelper(const X& x) { return x; }\n+/**\n+ * Convert any argument to a reference to X, maintaining constness.\n+ *\n+ * This can be used in serialization code to invoke a base class's\n+ * serialization routines.\n+ *\n+ * Example use:\n+ *   class Base { ... };\n+ *   class Child : public Base {\n+ *     int m_data;\n+ *   public:\n+ *     SERIALIZE_METHODS(Child, obj) {\n+ *       READWRITE(AsBase<Base>(obj), obj.m_data);\n+ *     }\n+ *   };\n+ *\n+ * static_cast cannot easily be used here, as the type of Obj will be const Child&\n+ * during serialization and Child& during deserialization. AsBase will convert to\n+ * const Base& and Base& appropriately.\n+ */\n+template <typename X> X& AsBase(X& x) { return x; }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1302182555",
      "id" : 1302182555,
      "line" : 157,
      "node_id" : "PRRC_kwDOABII585Nnbqb",
      "original_commit_id" : "667cf7e210747de24b28612049fb58fe85c041fe",
      "original_line" : 156,
      "original_position" : 27,
      "original_start_line" : null,
      "path" : "src/serialize.h",
      "position" : 35,
      "pull_request_review_id" : 1590318929,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1302182555/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-08-22T20:52:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1302182555",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "node_id" : "MDQ6VXNlcjQxNzA0Mw==",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1302696191"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1302696191"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Would there be a reason to check `std::is_base_of`? IIUC the compiler already checks this internally on the argument when the function is called. And if the function call argument is a violating `reinterpret_cast` we can't protect against this anyway inside this function or the function signature.",
      "commit_id" : "9dfc1f373e5a896ae63f535c4c3b7d6e6e6d08d0",
      "created_at" : "2023-08-23T08:48:52Z",
      "diff_hunk" : "@@ -133,12 +133,30 @@ enum\n     SER_GETHASH         = (1 << 2),\n };\n \n-//! Convert the reference base type to X, without changing constness or reference type.\n-template<typename X> X& ReadWriteAsHelper(X& x) { return x; }\n-template<typename X> const X& ReadWriteAsHelper(const X& x) { return x; }\n+/**\n+ * Convert any argument to a reference to X, maintaining constness.\n+ *\n+ * This can be used in serialization code to invoke a base class's\n+ * serialization routines.\n+ *\n+ * Example use:\n+ *   class Base { ... };\n+ *   class Child : public Base {\n+ *     int m_data;\n+ *   public:\n+ *     SERIALIZE_METHODS(Child, obj) {\n+ *       READWRITE(AsBase<Base>(obj), obj.m_data);\n+ *     }\n+ *   };\n+ *\n+ * static_cast cannot easily be used here, as the type of Obj will be const Child&\n+ * during serialization and Child& during deserialization. AsBase will convert to\n+ * const Base& and Base& appropriately.\n+ */\n+template <typename X> X& AsBase(X& x) { return x; }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1302696191",
      "id" : 1302696191,
      "in_reply_to_id" : 1302182555,
      "line" : 157,
      "node_id" : "PRRC_kwDOABII585NpZD_",
      "original_commit_id" : "667cf7e210747de24b28612049fb58fe85c041fe",
      "original_line" : 156,
      "original_position" : 27,
      "original_start_line" : null,
      "path" : "src/serialize.h",
      "position" : 35,
      "pull_request_review_id" : 1591084332,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1302696191/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-08-23T08:48:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1302696191",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1302996454"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1302996454"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "It will try conversion functions, eg:\r\n\r\n```c++\r\ntemplate<typename T> T& AsBase(T& x) { return x; }\r\n\r\ntemplate<typename T, typename A, \r\n    typename = typename std::enable_if<\r\n        std::is_base_of<T, A>::value, void\r\n    >::type>\r\nT& AsBaseSafe(A& x) { return x; }\r\n\r\nstruct Foo { };\r\nstruct Bar : public Foo { };\r\n\r\nBar b;\r\nFoo& fb = AsBase<Foo>(b); // fine\r\nFoo& fbsafe = AsBaseSafe<Foo>(b); // fine\r\n\r\nBar g_foobar;\r\nstruct Nope { operator Foo&() { return g_foobar; }; };\r\nNope n;\r\nFoo& f = AsBase<Foo>(n); // fine\r\nFoo& fsafe = AsBaseSafe<Foo>(n); // error: no matching function for call to 'AsBaseSafe'\r\n\r\nstruct Nope2 { operator Bar() { return g_foobar; }; };\r\nNope2 n2;\r\nBar& n2b = AsBase<Bar>(n2); // error: no matching function for call to 'AsBase'\r\nconst Bar& n2bc = AsBase<const Bar>(n2); // fine\r\nconst Foo& n2fc = AsBase<const Foo>(n2); // fine\r\nconst Bar& n2bcsafe = AsBaseSafe<const Bar>(n2); // error: no matching...\r\nconst Foo& n2fcsafe = AsBaseSafe<const Foo>(n2); // error: no matching...\r\n```",
      "commit_id" : "9dfc1f373e5a896ae63f535c4c3b7d6e6e6d08d0",
      "created_at" : "2023-08-23T13:10:31Z",
      "diff_hunk" : "@@ -133,12 +133,30 @@ enum\n     SER_GETHASH         = (1 << 2),\n };\n \n-//! Convert the reference base type to X, without changing constness or reference type.\n-template<typename X> X& ReadWriteAsHelper(X& x) { return x; }\n-template<typename X> const X& ReadWriteAsHelper(const X& x) { return x; }\n+/**\n+ * Convert any argument to a reference to X, maintaining constness.\n+ *\n+ * This can be used in serialization code to invoke a base class's\n+ * serialization routines.\n+ *\n+ * Example use:\n+ *   class Base { ... };\n+ *   class Child : public Base {\n+ *     int m_data;\n+ *   public:\n+ *     SERIALIZE_METHODS(Child, obj) {\n+ *       READWRITE(AsBase<Base>(obj), obj.m_data);\n+ *     }\n+ *   };\n+ *\n+ * static_cast cannot easily be used here, as the type of Obj will be const Child&\n+ * during serialization and Child& during deserialization. AsBase will convert to\n+ * const Base& and Base& appropriately.\n+ */\n+template <typename X> X& AsBase(X& x) { return x; }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1302996454",
      "id" : 1302996454,
      "in_reply_to_id" : 1302182555,
      "line" : 157,
      "node_id" : "PRRC_kwDOABII585NqiXm",
      "original_commit_id" : "667cf7e210747de24b28612049fb58fe85c041fe",
      "original_line" : 156,
      "original_position" : 27,
      "original_start_line" : null,
      "path" : "src/serialize.h",
      "position" : 35,
      "pull_request_review_id" : 1591560782,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1302996454/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-08-23T13:10:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1302996454",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1303132334"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1303132334"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I don't think we use conversion functions in this codebase, but I've added the `static_assert` to turn it into a compile failure.",
      "commit_id" : "fa80d8e26a50f33528d837e9f90f0561d0c21794",
      "created_at" : "2023-08-23T14:43:58Z",
      "diff_hunk" : "@@ -133,12 +133,30 @@ enum\n     SER_GETHASH         = (1 << 2),\n };\n \n-//! Convert the reference base type to X, without changing constness or reference type.\n-template<typename X> X& ReadWriteAsHelper(X& x) { return x; }\n-template<typename X> const X& ReadWriteAsHelper(const X& x) { return x; }\n+/**\n+ * Convert any argument to a reference to X, maintaining constness.\n+ *\n+ * This can be used in serialization code to invoke a base class's\n+ * serialization routines.\n+ *\n+ * Example use:\n+ *   class Base { ... };\n+ *   class Child : public Base {\n+ *     int m_data;\n+ *   public:\n+ *     SERIALIZE_METHODS(Child, obj) {\n+ *       READWRITE(AsBase<Base>(obj), obj.m_data);\n+ *     }\n+ *   };\n+ *\n+ * static_cast cannot easily be used here, as the type of Obj will be const Child&\n+ * during serialization and Child& during deserialization. AsBase will convert to\n+ * const Base& and Base& appropriately.\n+ */\n+template <typename X> X& AsBase(X& x) { return x; }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1303132334",
      "id" : 1303132334,
      "in_reply_to_id" : 1302182555,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585NrDiu",
      "original_commit_id" : "667cf7e210747de24b28612049fb58fe85c041fe",
      "original_line" : 156,
      "original_position" : 27,
      "original_start_line" : null,
      "path" : "src/serialize.h",
      "position" : null,
      "pull_request_review_id" : 1591778823,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284",
      "reactions" : {
         "+1" : 2,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 2,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1303132334/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-08-23T14:43:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1303132334",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Edit: Most of the below was written with a misunderstanding of how these params actually work. I was trying (unsuccessfully) to shoe-horn params into the existing stream behavior. I'll leave my clueless comments in case they help anyone else with the same misunderstanding. See [this follow-up comment](https://github.com/bitcoin/bitcoin/pull/25284#issuecomment-1693406525) for a more reasonable take.\r\n\r\n---\r\n\r\nWhat is the future of `s.GetType() & SER_GETHASH` and `s.GetVersion() & SERIALIZE_TRANSACTION_NO_WITNESS` ?\r\n\r\nI'm working on trying to switch #28327 to this approach, but I'm running into some issues.\r\n\r\n`CBlockLocator` and  `CDiskBlockIndex` both check for `SER_GETHASH` and conditionally skip some serializing if we're hashing. So i've introduced a `bool hashing` in `SerParams` for those classes.\r\n\r\nBut now we have a problem in `net_processing`:\r\nhttps://github.com/bitcoin/bitcoin/blob/33da5d0eb155993ab0d07c95704a0dd9e981c100/src/net_processing.cpp#L2630\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/33da5d0eb155993ab0d07c95704a0dd9e981c100/src/netmessagemaker.h#L18-L24\r\n\r\nIt's not clear how to set `!hashing` for `locator` there.\r\n\r\nOne solution is to have global params which could apply to any class:\r\n```c++\r\nstruct GlobalParams {\r\n    enum class hashing{\r\n        on,\r\n        off\r\n    };\r\n    bool is_hashing() const\r\n    {\r\n        return do_hashing == hashing::on;\r\n    }\r\n    hashing do_hashing;\r\n};\r\n```\r\n\r\nThen places like netmessagemaker can override for all structures:\r\n```c++\r\n CSerializedNetMsg Make(int nFlags, std::string msg_type, Args&&... args) const \r\n { \r\n    CSerializedNetMsg msg;\r\n    msg.m_type = std::move(msg_type);\r\n    CVectorWriter vecwriter{ SER_NETWORK, nFlags | nVersion, msg.data, 0};\r\n    GlobalParams ser_params{GlobalParams::hashing::off};\r\n    ParamsStream s{ser_params, vecwriter};\r\n    ::SerializeMany(s, std::forward<Args>(args)...);\r\n    return msg;\r\n}\r\n```\r\n\r\nThat works but:\r\n- `SER_NETWORK` and `GlobalParams::hashing::off` are redundant\r\n- Now `CTransaction` fails to serialize because `ParamsStream` deletes `GetVersion()`.\r\n\r\nFinally.. that could be fixed by turning `SERIALIZE_TRANSACTION_NO_WITNESS` into a global param as well. But that seems like it puts us back where we started, with everything jumbled up in the same place.\r\n\r\n~So while I appreciate the approach here for CAddress, it's not clear to me how it interacts with the last few serialization quirks.~",
      "created_at" : "2023-08-23T19:36:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#issuecomment-1690530501",
      "id" : 1690530501,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25284",
      "node_id" : "IC_kwDOABII585kw3LF",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1690530501/reactions"
      },
      "updated_at" : "2023-08-25T14:03:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1690530501",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "node_id" : "MDQ6VXNlcjQxNzA0Mw==",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "It's also unclear to me how this should work when the thing-to-be-serialized is a template param:\r\nhttps://github.com/bitcoin/bitcoin/blob/33da5d0eb155993ab0d07c95704a0dd9e981c100/src/dbwrapper.h#L168-L177\r\n\r\nIn that case we'll need to set some params for some types of `V` but not others. How to do that generically?",
      "created_at" : "2023-08-23T20:05:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#issuecomment-1690563812",
      "id" : 1690563812,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25284",
      "node_id" : "IC_kwDOABII585kw_Tk",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1690563812/reactions"
      },
      "updated_at" : "2023-08-23T20:05:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1690563812",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "node_id" : "MDQ6VXNlcjQxNzA0Mw==",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@theuni This is very generic, and I haven't tried any of this, but roughly my thinking is the following.\r\n\r\nFor transactions (CTransaction, CMutableTransaction), I'd expect a TransactionParams with a boolean that indicates whether the witness is to be serialized or not (and whether it's accepted on deserialization). I'd think we'd want that passed through when serializing blocks, so `CBlock` would also want a `TransactionParams`. But \"higher\" than that (e.g. in CNetMsgMaker or database logic) it would feel wrong to try to support having TransactionParams, because that code shouldn't know or care about what blocks or transactions are. Instead, whenever there is code that tries to give (say) a transaction to a database writing, *that* code should instead serialize a `WithParams(TransactionParams{.segwit=...}, tx)` rather than a `tx`, because presumably *that* code knows whether witness serialization is supposed to be used. In a sense, my view is that the real problem is trying to even have a way to \"globally\" set witness or not - it should be confined to logic that knows what that means.\r\n\r\nFor the distinct serializations of CBlockLocator and CDiskBlockIndex, I suspect there are similar things possible. Yes, introduce a parameter, locally for them, and we'll find a place not much higher in the stack where the parameter value can be set, without needing to go all the way to very generic code.",
      "created_at" : "2023-08-23T20:28:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#issuecomment-1690592983",
      "id" : 1690592983,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25284",
      "node_id" : "IC_kwDOABII585kxGbX",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1690592983/reactions"
      },
      "updated_at" : "2023-08-24T15:01:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1690592983",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1303512869"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1303512869"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think this function could be replaced with a deduction guide for `ParamsWrapper`.",
      "commit_id" : "fa80d8e26a50f33528d837e9f90f0561d0c21794",
      "created_at" : "2023-08-23T20:33:01Z",
      "diff_hunk" : "@@ -1061,4 +1134,61 @@ size_t GetSerializeSizeMany(int nVersion, const T&... t)\n     return sc.size();\n }\n \n+/** Wrapper that overrides the GetParams() function of a stream (and hides GetVersion/GetType). */\n+template <typename Params, typename SubStream>\n+class ParamsStream\n+{\n+    const Params& m_params;\n+    SubStream& m_substream; // private to avoid leaking version/type into serialization code that shouldn't see it\n+\n+public:\n+    ParamsStream(const Params& params LIFETIMEBOUND, SubStream& substream LIFETIMEBOUND) : m_params{params}, m_substream{substream} {}\n+    template <typename U> ParamsStream& operator<<(const U& obj) { ::Serialize(*this, obj); return *this; }\n+    template <typename U> ParamsStream& operator>>(U&& obj) { ::Unserialize(*this, obj); return *this; }\n+    void write(Span<const std::byte> src) { m_substream.write(src); }\n+    void read(Span<std::byte> dst) { m_substream.read(dst); }\n+    void ignore(size_t num) { m_substream.ignore(num); }\n+    bool eof() const { return m_substream.eof(); }\n+    size_t size() const { return m_substream.size(); }\n+    const Params& GetParams() const { return m_params; }\n+    int GetVersion() = delete; // Deprecated with Params usage\n+    int GetType() = delete;    // Deprecated with Params usage\n+};\n+\n+/** Wrapper that serializes objects with the specified parameters. */\n+template <typename Params, typename T>\n+class ParamsWrapper\n+{\n+    static_assert(std::is_lvalue_reference<T>::value, \"ParamsWrapper needs an lvalue reference type T\");\n+    const Params& m_params;\n+    T m_object;\n+\n+public:\n+    explicit ParamsWrapper(const Params& params, T obj) : m_params{params}, m_object{obj} {}\n+\n+    template <typename Stream>\n+    void Serialize(Stream& s) const\n+    {\n+        ParamsStream ss{m_params, s};\n+        ::Serialize(ss, m_object);\n+    }\n+    template <typename Stream>\n+    void Unserialize(Stream& s)\n+    {\n+        ParamsStream ss{m_params, s};\n+        ::Unserialize(ss, m_object);\n+    }\n+};\n+\n+/**\n+ * Return a wrapper around t that (de)serializes it with specified parameter params.\n+ *\n+ * See FORMATTER_METHODS_PARAMS for more information on serialization parameters.\n+ */\n+template <typename Params, typename T>\n+static auto WithParams(const Params& params, T&& t)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1303512869",
      "id" : 1303512869,
      "line" : 1189,
      "node_id" : "PRRC_kwDOABII585Nsgcl",
      "original_commit_id" : "fa7d40795b909306c1a20132ac5fd3222157dcb4",
      "original_line" : 1189,
      "original_position" : 285,
      "original_start_line" : null,
      "path" : "src/serialize.h",
      "position" : 285,
      "pull_request_review_id" : 1592366755,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1303512869/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-08-23T20:33:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1303512869",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> should instead give a `WithParams(TransactionParams{.segwit=...}, tx)` rather than `tx` to be serialized,\r\n\r\nMaybe something like:\r\n\r\n * replace `CTransaction::Serialize(stream)` with `CTransaction::Serialize(stream, txseropts)` -- so bare `CTransaction` isn't serializable anymore\r\n * add an automatic wrapper, so instead of `stream << tx` you write `stream << seropt(tx, {.with_witness=true})`\r\n\r\nIn that case, I think the idea could just be to have that wrapper be something like:\r\n\r\n```c++\r\ntemplate<typename T, typename O>\r\nclass serializable_with_options\r\n{\r\nprivate:\r\n    T& obj;\r\n    O opts;\r\npublic:\r\n    serializable_with_options(T& obj, O&& opts) : obj{obj}, opts{std::move(opts)} { }\r\n\r\n    template<typename Stream>\r\n    inline void Serialize(Stream& s) const { obj.Serialize(s, opts); }\r\n\r\n    template<typename Stream> \r\n    inline void Unserialize(Stream& s) { obj.Unserialize(s, opts); }\r\n};\r\n\r\ntemplate<typename T>\r\nauto seropt(T& obj, typename T::SerOptions&& opts)\r\n{\r\n    return serializable_with_options<T, typename T::SerOptions>(obj, std::move(opts));\r\n}\r\n```\r\n\r\nProbably needs some further tweaking to handle constyness?\r\n\r\nHere's a patch that may be fun to play with: https://github.com/ajtowns/bitcoin/commit/19cdc6b66cdf3c27d1fe895c39ab4075372bf99b . Seems workable?\r\n\r\nEDIT: On second thoughts, it doesn't seem very workable -- inheriting CNetAddr options through its child classes and across vectors of CNetAddrs and such kinda sucks.",
      "created_at" : "2023-08-24T07:28:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#issuecomment-1691151071",
      "id" : 1691151071,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25284",
      "node_id" : "IC_kwDOABII585kzOrf",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1691151071/reactions"
      },
      "updated_at" : "2023-08-24T15:33:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1691151071",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> For the distinct serializations of CBlockLocator and CDiskBlockIndex, I suspect there are similar things possible. Yes, introduce a parameter, locally for them, and we'll find a place not much higher in the stack where the parameter value can be set, without needing to go all the way to very generic code.\r\n\r\n@sipa Thanks for the explanation. After playing with this some more I realized that I had a pretty significant misunderstanding, having a hard time not still thinking in terms of setting options for the entire stream. I see what you mean now about setting the param at the appropriate level in the stack.\r\n\r\nI took another stab at a [POC for using params for CBlockLocator](https://github.com/theuni/bitcoin/commit/99d23d6559503f112ac62ef082536c6b641bbf6f) as you described, which I think turned out looking quite reasonable (ironically I'm not sure if anything ever actually uses hashing mode, I'll trace that out).\r\n\r\n> So while I appreciate the approach here for CAddress, it's not clear to me how it interacts with the last few serialization quirks.\r\n\r\nI take that back. Having now implemented some of those quirks in the commit above, it interacts just fine. ",
      "created_at" : "2023-08-25T14:00:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#issuecomment-1693406525",
      "id" : 1693406525,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25284",
      "node_id" : "IC_kwDOABII585k71U9",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1693406525/reactions"
      },
      "updated_at" : "2023-08-25T14:00:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1693406525",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "node_id" : "MDQ6VXNlcjQxNzA0Mw==",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> (ironically I'm not sure if anything ever actually uses hashing mode, I'll trace that out).\r\n\r\nI don't think anything does, but I am not aware of a simple way to find out at compile time. Maybe use this pull request and remove the `GetType` definition and confirm it only fails in CTransaction/CBlock? Slightly related, most uses of the legacy interface `CHashWriter` are not needed at all, see https://github.com/bitcoin/bitcoin/pull/28341",
      "created_at" : "2023-08-25T15:14:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#issuecomment-1693525192",
      "id" : 1693525192,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25284",
      "node_id" : "IC_kwDOABII585k8STI",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1693525192/reactions"
      },
      "updated_at" : "2023-08-25T15:17:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1693525192",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Added a commit to remove code",
      "created_at" : "2023-08-25T16:02:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#issuecomment-1693585364",
      "id" : 1693585364,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25284",
      "node_id" : "IC_kwDOABII585k8g_U",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1693585364/reactions"
      },
      "updated_at" : "2023-08-25T16:02:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1693585364",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> > (ironically I'm not sure if anything ever actually uses hashing mode, I'll trace that out).\r\n> \r\n> I don't think anything does, but I am not aware of a simple way to find out at compile time. Maybe use this pull request and remove the `GetType` definition and confirm it only fails in CTransaction/CBlock? Slightly related, most uses of the legacy interface `CHashWriter` are not needed at all, see #28341\r\n\r\nIt's worth pointing out that, as you mentioned, it's hard to trace this path in the current code. But a nice feature of the approach in the PR is that the params are now enforced at compile time and closer to the callsite, so it's trivial to see what's being used.\r\n\r\nSo after converting `CBLockLocator`, compile fails for every serialization because params are missing. That's fixed by switching `CDataStream` -> `DataStream` and handling the params. If none of the deleted `CDataStream` usages were `SER_GETHASH`, I think it's safe to say we don't need the `hashing` param at all?\r\n\r\nAnd yes, from a quick check, that's the case everywhere but `CTransaction`. So specifically, I propose that we nuke the hashing checks in `CDiskBlockIndex`/`CBLockLocator`/`CKeyPool`. Presumably the lack of usage means that a hash has never had meaning for those. There's still the question about whether or not to use dummy `nVersion`s  though.",
      "created_at" : "2023-08-25T16:45:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#issuecomment-1693650533",
      "id" : 1693650533,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25284",
      "node_id" : "IC_kwDOABII585k8w5l",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1693650533/reactions"
      },
      "updated_at" : "2023-08-25T16:45:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1693650533",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "node_id" : "MDQ6VXNlcjQxNzA0Mw==",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1306353261"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1306353261"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Thanks, I'll look into this style nit on the next force-push or in a follow-up.",
      "commit_id" : "fa80d8e26a50f33528d837e9f90f0561d0c21794",
      "created_at" : "2023-08-26T06:44:30Z",
      "diff_hunk" : "@@ -1061,4 +1134,61 @@ size_t GetSerializeSizeMany(int nVersion, const T&... t)\n     return sc.size();\n }\n \n+/** Wrapper that overrides the GetParams() function of a stream (and hides GetVersion/GetType). */\n+template <typename Params, typename SubStream>\n+class ParamsStream\n+{\n+    const Params& m_params;\n+    SubStream& m_substream; // private to avoid leaking version/type into serialization code that shouldn't see it\n+\n+public:\n+    ParamsStream(const Params& params LIFETIMEBOUND, SubStream& substream LIFETIMEBOUND) : m_params{params}, m_substream{substream} {}\n+    template <typename U> ParamsStream& operator<<(const U& obj) { ::Serialize(*this, obj); return *this; }\n+    template <typename U> ParamsStream& operator>>(U&& obj) { ::Unserialize(*this, obj); return *this; }\n+    void write(Span<const std::byte> src) { m_substream.write(src); }\n+    void read(Span<std::byte> dst) { m_substream.read(dst); }\n+    void ignore(size_t num) { m_substream.ignore(num); }\n+    bool eof() const { return m_substream.eof(); }\n+    size_t size() const { return m_substream.size(); }\n+    const Params& GetParams() const { return m_params; }\n+    int GetVersion() = delete; // Deprecated with Params usage\n+    int GetType() = delete;    // Deprecated with Params usage\n+};\n+\n+/** Wrapper that serializes objects with the specified parameters. */\n+template <typename Params, typename T>\n+class ParamsWrapper\n+{\n+    static_assert(std::is_lvalue_reference<T>::value, \"ParamsWrapper needs an lvalue reference type T\");\n+    const Params& m_params;\n+    T m_object;\n+\n+public:\n+    explicit ParamsWrapper(const Params& params, T obj) : m_params{params}, m_object{obj} {}\n+\n+    template <typename Stream>\n+    void Serialize(Stream& s) const\n+    {\n+        ParamsStream ss{m_params, s};\n+        ::Serialize(ss, m_object);\n+    }\n+    template <typename Stream>\n+    void Unserialize(Stream& s)\n+    {\n+        ParamsStream ss{m_params, s};\n+        ::Unserialize(ss, m_object);\n+    }\n+};\n+\n+/**\n+ * Return a wrapper around t that (de)serializes it with specified parameter params.\n+ *\n+ * See FORMATTER_METHODS_PARAMS for more information on serialization parameters.\n+ */\n+template <typename Params, typename T>\n+static auto WithParams(const Params& params, T&& t)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1306353261",
      "id" : 1306353261,
      "in_reply_to_id" : 1303512869,
      "line" : 1189,
      "node_id" : "PRRC_kwDOABII585N3V5t",
      "original_commit_id" : "fa7d40795b909306c1a20132ac5fd3222157dcb4",
      "original_line" : 1189,
      "original_position" : 285,
      "original_start_line" : null,
      "path" : "src/serialize.h",
      "position" : 285,
      "pull_request_review_id" : 1596775605,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1306353261/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-08-26T06:44:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1306353261",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "From https://github.com/bitcoin/bitcoin/pull/19503 :\r\n> In this PR, the feature is only used for CAddress serialization, but I plan to also convert SERIALIZE_TRANSACTION_NO_WITNESS in a follow-up.\r\n\r\n@sipa follow-up reminder in case this gets merged :p\r\n\r\nCombined with https://github.com/bitcoin/bitcoin/pull/28341 and https://github.com/bitcoin/bitcoin/pull/25284#issuecomment-1693650533, that would go a long way towards (,if not completely) eliminating the legacy flags.",
      "created_at" : "2023-08-26T21:42:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#issuecomment-1694507114",
      "id" : 1694507114,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25284",
      "node_id" : "IC_kwDOABII585lACBq",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1694507114/reactions"
      },
      "updated_at" : "2023-08-26T21:42:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1694507114",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "node_id" : "MDQ6VXNlcjQxNzA0Mw==",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1306603854"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1306603854"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Is this intended to default to `V1`? If so, be explicit with `enc{V1}`; if not, maybe `const NoDefaultInitializer<Encoding> enc`:\r\n\r\n```\r\ntemplate<typename T>\r\nstruct NoDefaultInitializer\r\n{\r\n    T value;\r\n    NoDefaultInitializer(const T& v) : value{v} { }\r\n    NoDefaultInitializer(T&& v) : value{std::move(v)} { }\r\n    NoDefaultInitializer() = delete;\r\n    NoDefaultInitializer(NoDefaultInitializer&&) = default;\r\n    NoDefaultInitializer(const NoDefaultInitializer&) = default;\r\n    operator T&() { return value; }\r\n    operator const T&() const { return value; }\r\n    T& operator=(const T& v) { value = v; return value; }\r\n};\r\n```",
      "commit_id" : "fa80d8e26a50f33528d837e9f90f0561d0c21794",
      "created_at" : "2023-08-27T05:48:15Z",
      "diff_hunk" : "@@ -220,13 +212,21 @@ class CNetAddr\n         return IsIPv4() || IsIPv6() || IsTor() || IsI2P() || IsCJDNS();\n     }\n \n+    enum class Encoding {\n+        V1,\n+        V2, //!< BIP155 encoding\n+    };\n+    struct SerParams {\n+        const Encoding enc;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1306603854",
      "id" : 1306603854,
      "line" : 220,
      "node_id" : "PRRC_kwDOABII585N4TFO",
      "original_commit_id" : "fab1d5bcf28d49ee0de51546f297b0c4faeaadaa",
      "original_line" : 220,
      "original_position" : 24,
      "original_start_line" : null,
      "path" : "src/netaddress.h",
      "position" : 24,
      "pull_request_review_id" : 1597075767,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1306603854/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-08-27T07:21:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1306603854",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1306604259"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1306604259"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Perhaps:\r\n\r\n```c++\r\nclass CAddress {\r\n    ...\r\n    static constexpr SerParams network_v1{{Encoding::V1}, Format::Network};\r\n};\r\n```\r\n\r\nwould be a bit friendlier?",
      "commit_id" : "fa80d8e26a50f33528d837e9f90f0561d0c21794",
      "created_at" : "2023-08-27T05:53:53Z",
      "diff_hunk" : "@@ -697,16 +697,17 @@ BOOST_AUTO_TEST_CASE(addrman_serialization)\n     auto addrman_asmap1_dup = std::make_unique<AddrMan>(netgroupman, DETERMINISTIC, ratio);\n     auto addrman_noasmap = std::make_unique<AddrMan>(EMPTY_NETGROUPMAN, DETERMINISTIC, ratio);\n \n-    CDataStream stream(SER_NETWORK, PROTOCOL_VERSION);\n+    DataStream stream{};\n+    const CAddress::SerParams ser_params{{CNetAddr::Encoding::V1}, CAddress::Format::Network};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1306604259",
      "id" : 1306604259,
      "line" : 701,
      "node_id" : "PRRC_kwDOABII585N4TLj",
      "original_commit_id" : "fab1d5bcf28d49ee0de51546f297b0c4faeaadaa",
      "original_line" : 701,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/test/addrman_tests.cpp",
      "position" : 6,
      "pull_request_review_id" : 1597075767,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1306604259/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-08-27T07:21:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1306604259",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1306608585"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1306608585"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "This is an encoding, not a `ser_params`",
      "commit_id" : "fa80d8e26a50f33528d837e9f90f0561d0c21794",
      "created_at" : "2023-08-27T06:34:25Z",
      "diff_hunk" : "@@ -5272,15 +5275,15 @@ void PeerManagerImpl::MaybeSendAddr(CNode& node, Peer& peer, std::chrono::micros\n     if (peer.m_addrs_to_send.empty()) return;\n \n     const char* msg_type;\n-    int make_flags;\n+    CNetAddr::Encoding ser_params;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1306608585",
      "id" : 1306608585,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585N4UPJ",
      "original_commit_id" : "fab1d5bcf28d49ee0de51546f297b0c4faeaadaa",
      "original_line" : 5278,
      "original_position" : 54,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 1597075767,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1306608585/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-08-27T07:21:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1306608585",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1306612626"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1306612626"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "If the stream has parameters but not the right parameters this gives a mildly confusing error. Writing it as:\r\n\r\n```c++\r\n    template <typename Stream>\r\n    void Serialize(Stream& s, const SerParams& params) const\r\n\r\n    template <typename Stream> void Serialize(Stream& s) const { return Serialize(s, s.GetParams()); }\r\n```\r\n\r\nseems a bit nicer. It seems like there should be some way to have `::Serialize()` call this with the parameters directly via some template magic, but I can't see what it would be.",
      "commit_id" : "fa80d8e26a50f33528d837e9f90f0561d0c21794",
      "created_at" : "2023-08-27T07:09:02Z",
      "diff_hunk" : "@@ -220,13 +212,21 @@ class CNetAddr\n         return IsIPv4() || IsIPv6() || IsTor() || IsI2P() || IsCJDNS();\n     }\n \n+    enum class Encoding {\n+        V1,\n+        V2, //!< BIP155 encoding\n+    };\n+    struct SerParams {\n+        const Encoding enc;\n+    };\n+\n     /**\n      * Serialize to a stream.\n      */\n     template <typename Stream>\n     void Serialize(Stream& s) const\n     {\n-        if (s.GetVersion() & ADDRV2_FORMAT) {\n+        if (s.GetParams().enc == Encoding::V2) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1306612626",
      "id" : 1306612626,
      "line" : 229,
      "node_id" : "PRRC_kwDOABII585N4VOS",
      "original_commit_id" : "fab1d5bcf28d49ee0de51546f297b0c4faeaadaa",
      "original_line" : 229,
      "original_position" : 34,
      "original_start_line" : null,
      "path" : "src/netaddress.h",
      "position" : 34,
      "pull_request_review_id" : 1597075767,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1306612626/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-08-27T07:21:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1306612626",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1306613010"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1306613010"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "FWIW, I would have written:\r\n\r\n```c++\r\nWithParams(CAddress::SerParams{{CNetAddr::Encoding::V1}, CAddress::Format::Disk}, addrman2)\r\n```\r\n\r\nmore like:\r\n\r\n```c++\r\nWithParams<CAddress>({.addrv2=false, .disk=true}, addrman2)\r\n```",
      "commit_id" : "fa80d8e26a50f33528d837e9f90f0561d0c21794",
      "created_at" : "2023-08-27T07:12:07Z",
      "diff_hunk" : "@@ -972,35 +974,35 @@ BOOST_AUTO_TEST_CASE(load_addrman)\n     BOOST_CHECK(addrman.Size() == 3);\n \n     // Test that the de-serialization does not throw an exception.\n-    CDataStream ssPeers1 = AddrmanToStream(addrman);\n+    auto ssPeers1{AddrmanToStream(addrman)};\n     bool exceptionThrown = false;\n     AddrMan addrman1{EMPTY_NETGROUPMAN, !DETERMINISTIC, GetCheckRatio(m_node)};\n \n     BOOST_CHECK(addrman1.Size() == 0);\n     try {\n         unsigned char pchMsgTmp[4];\n         ssPeers1 >> pchMsgTmp;\n-        ssPeers1 >> addrman1;\n+        ssPeers1 >> WithParams(CAddress::SerParams{{CNetAddr::Encoding::V1}, CAddress::Format::Disk}, addrman1);\n     } catch (const std::exception&) {\n         exceptionThrown = true;\n     }\n \n     BOOST_CHECK(addrman1.Size() == 3);\n     BOOST_CHECK(exceptionThrown == false);\n \n-    // Test that ReadFromStream creates an addrman with the correct number of addrs.\n-    CDataStream ssPeers2 = AddrmanToStream(addrman);\n+    // Test that ReadFromStreamUnitTests creates an addrman with the correct number of addrs.\n+    auto ssPeers2{AddrmanToStream(addrman)};\n \n     AddrMan addrman2{EMPTY_NETGROUPMAN, !DETERMINISTIC, GetCheckRatio(m_node)};\n     BOOST_CHECK(addrman2.Size() == 0);\n-    ReadFromStream(addrman2, ssPeers2);\n+    ReadFromStreamUnitTests(WithParams(CAddress::SerParams{{CNetAddr::Encoding::V1}, CAddress::Format::Disk}, addrman2), ssPeers2);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1306613010",
      "id" : 1306613010,
      "line" : 998,
      "node_id" : "PRRC_kwDOABII585N4VUS",
      "original_commit_id" : "fab1d5bcf28d49ee0de51546f297b0c4faeaadaa",
      "original_line" : 998,
      "original_position" : 127,
      "original_start_line" : null,
      "path" : "src/test/addrman_tests.cpp",
      "position" : 127,
      "pull_request_review_id" : 1597075767,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1306613010/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-08-27T07:21:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1306613010",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1306613399"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1306613399"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "If you want to use designated initializers, a la `{.addrv2=false, .disk=false}`, then you can't use inheritance here, but could instead add an `operator CNetAddr::SerParams() const` function for pretty much the same result.",
      "commit_id" : "fa80d8e26a50f33528d837e9f90f0561d0c21794",
      "created_at" : "2023-08-27T07:15:25Z",
      "diff_hunk" : "@@ -390,35 +390,39 @@ class CAddress : public CService\n     CAddress(CService ipIn, ServiceFlags nServicesIn) : CService{ipIn}, nServices{nServicesIn} {};\n     CAddress(CService ipIn, ServiceFlags nServicesIn, NodeSeconds time) : CService{ipIn}, nTime{time}, nServices{nServicesIn} {};\n \n-    SERIALIZE_METHODS(CAddress, obj)\n+    enum class Format {\n+        Disk,\n+        Network,\n+    };\n+    struct SerParams : CNetAddr::SerParams {\n+        const Format fmt;\n+    };",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1306613399",
      "id" : 1306613399,
      "line" : 399,
      "node_id" : "PRRC_kwDOABII585N4VaX",
      "original_commit_id" : "fab1d5bcf28d49ee0de51546f297b0c4faeaadaa",
      "original_line" : 399,
      "original_position" : 11,
      "original_start_line" : null,
      "path" : "src/protocol.h",
      "position" : 11,
      "pull_request_review_id" : 1597075767,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1306613399/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-08-27T07:21:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1306613399",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1307588767"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307588767"
         }
      },
      "author_association" : "MEMBER",
      "body" : "`SerParams a;` is illegal due to `const`, so I guess you mean `SerParams b{};`. But that type of bug seems impossible to fix, because one can just write `NoDefaultInitializer<Encoding> d{{}};`, or `SerParams b{{}};`.\r\n\r\nSo I'll leave as is for now.",
      "commit_id" : "fa80d8e26a50f33528d837e9f90f0561d0c21794",
      "created_at" : "2023-08-28T15:37:29Z",
      "diff_hunk" : "@@ -220,13 +212,21 @@ class CNetAddr\n         return IsIPv4() || IsIPv6() || IsTor() || IsI2P() || IsCJDNS();\n     }\n \n+    enum class Encoding {\n+        V1,\n+        V2, //!< BIP155 encoding\n+    };\n+    struct SerParams {\n+        const Encoding enc;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1307588767",
      "id" : 1307588767,
      "in_reply_to_id" : 1306603854,
      "line" : 220,
      "node_id" : "PRRC_kwDOABII585N8Dif",
      "original_commit_id" : "fab1d5bcf28d49ee0de51546f297b0c4faeaadaa",
      "original_line" : 220,
      "original_position" : 24,
      "original_start_line" : null,
      "path" : "src/netaddress.h",
      "position" : 24,
      "pull_request_review_id" : 1598554155,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307588767/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-08-28T15:37:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307588767",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1307590671"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307590671"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> But that type of bug seems impossible to fix\r\n\r\nOr rather, this may be a clang-tidy-plugin candidate, no?",
      "commit_id" : "fa80d8e26a50f33528d837e9f90f0561d0c21794",
      "created_at" : "2023-08-28T15:39:10Z",
      "diff_hunk" : "@@ -220,13 +212,21 @@ class CNetAddr\n         return IsIPv4() || IsIPv6() || IsTor() || IsI2P() || IsCJDNS();\n     }\n \n+    enum class Encoding {\n+        V1,\n+        V2, //!< BIP155 encoding\n+    };\n+    struct SerParams {\n+        const Encoding enc;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1307590671",
      "id" : 1307590671,
      "in_reply_to_id" : 1306603854,
      "line" : 220,
      "node_id" : "PRRC_kwDOABII585N8EAP",
      "original_commit_id" : "fab1d5bcf28d49ee0de51546f297b0c4faeaadaa",
      "original_line" : 220,
      "original_position" : 24,
      "original_start_line" : null,
      "path" : "src/netaddress.h",
      "position" : 24,
      "pull_request_review_id" : 1598557007,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307590671/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-08-28T15:39:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307590671",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1307599983"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307599983"
         }
      },
      "author_association" : "MEMBER",
      "body" : "It is just a test, so I think it is fine, no?",
      "commit_id" : "fa80d8e26a50f33528d837e9f90f0561d0c21794",
      "created_at" : "2023-08-28T15:47:34Z",
      "diff_hunk" : "@@ -697,16 +697,17 @@ BOOST_AUTO_TEST_CASE(addrman_serialization)\n     auto addrman_asmap1_dup = std::make_unique<AddrMan>(netgroupman, DETERMINISTIC, ratio);\n     auto addrman_noasmap = std::make_unique<AddrMan>(EMPTY_NETGROUPMAN, DETERMINISTIC, ratio);\n \n-    CDataStream stream(SER_NETWORK, PROTOCOL_VERSION);\n+    DataStream stream{};\n+    const CAddress::SerParams ser_params{{CNetAddr::Encoding::V1}, CAddress::Format::Network};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1307599983",
      "id" : 1307599983,
      "in_reply_to_id" : 1306604259,
      "line" : 701,
      "node_id" : "PRRC_kwDOABII585N8GRv",
      "original_commit_id" : "fab1d5bcf28d49ee0de51546f297b0c4faeaadaa",
      "original_line" : 701,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/test/addrman_tests.cpp",
      "position" : 6,
      "pull_request_review_id" : 1598571658,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307599983/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-08-28T15:47:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307599983",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1307600262"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307600262"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Thanks, changed name.",
      "commit_id" : "fa80d8e26a50f33528d837e9f90f0561d0c21794",
      "created_at" : "2023-08-28T15:47:51Z",
      "diff_hunk" : "@@ -5272,15 +5275,15 @@ void PeerManagerImpl::MaybeSendAddr(CNode& node, Peer& peer, std::chrono::micros\n     if (peer.m_addrs_to_send.empty()) return;\n \n     const char* msg_type;\n-    int make_flags;\n+    CNetAddr::Encoding ser_params;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1307600262",
      "id" : 1307600262,
      "in_reply_to_id" : 1306608585,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585N8GWG",
      "original_commit_id" : "fab1d5bcf28d49ee0de51546f297b0c4faeaadaa",
      "original_line" : 5278,
      "original_position" : 54,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 1598572114,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307600262/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-08-28T15:47:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307600262",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1307602238"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307602238"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I could also add an `const SerParams& params{s.GetParams()};` in the first line of the function.",
      "commit_id" : "fa80d8e26a50f33528d837e9f90f0561d0c21794",
      "created_at" : "2023-08-28T15:49:47Z",
      "diff_hunk" : "@@ -220,13 +212,21 @@ class CNetAddr\n         return IsIPv4() || IsIPv6() || IsTor() || IsI2P() || IsCJDNS();\n     }\n \n+    enum class Encoding {\n+        V1,\n+        V2, //!< BIP155 encoding\n+    };\n+    struct SerParams {\n+        const Encoding enc;\n+    };\n+\n     /**\n      * Serialize to a stream.\n      */\n     template <typename Stream>\n     void Serialize(Stream& s) const\n     {\n-        if (s.GetVersion() & ADDRV2_FORMAT) {\n+        if (s.GetParams().enc == Encoding::V2) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1307602238",
      "id" : 1307602238,
      "in_reply_to_id" : 1306612626,
      "line" : 229,
      "node_id" : "PRRC_kwDOABII585N8G0-",
      "original_commit_id" : "fab1d5bcf28d49ee0de51546f297b0c4faeaadaa",
      "original_line" : 229,
      "original_position" : 34,
      "original_start_line" : null,
      "path" : "src/netaddress.h",
      "position" : 34,
      "pull_request_review_id" : 1598575003,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307602238/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-08-28T15:49:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307602238",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1307603154"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307603154"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yeah, inheritance is a bit verbose, but I like that it assigns each parameter the exact class name it is used for. Maybe if you post your full diff, I can consider it?",
      "commit_id" : "fa80d8e26a50f33528d837e9f90f0561d0c21794",
      "created_at" : "2023-08-28T15:50:41Z",
      "diff_hunk" : "@@ -390,35 +390,39 @@ class CAddress : public CService\n     CAddress(CService ipIn, ServiceFlags nServicesIn) : CService{ipIn}, nServices{nServicesIn} {};\n     CAddress(CService ipIn, ServiceFlags nServicesIn, NodeSeconds time) : CService{ipIn}, nTime{time}, nServices{nServicesIn} {};\n \n-    SERIALIZE_METHODS(CAddress, obj)\n+    enum class Format {\n+        Disk,\n+        Network,\n+    };\n+    struct SerParams : CNetAddr::SerParams {\n+        const Format fmt;\n+    };",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1307603154",
      "id" : 1307603154,
      "in_reply_to_id" : 1306613399,
      "line" : 399,
      "node_id" : "PRRC_kwDOABII585N8HDS",
      "original_commit_id" : "fab1d5bcf28d49ee0de51546f297b0c4faeaadaa",
      "original_line" : 399,
      "original_position" : 11,
      "original_start_line" : null,
      "path" : "src/protocol.h",
      "position" : 11,
      "pull_request_review_id" : 1598577152,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307603154/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-08-28T15:50:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307603154",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1307634959"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307634959"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I was more thinking just as a way to avoid missing entries by accident, so writing `{.addrv2=true}` and forgetting that you should be specifying `.disk=false` as well. If you're writing `.disk=NoDefaultInitializaer<bool>{{}}` then you're still at least explicitly aware of the parameter...",
      "commit_id" : "fa80d8e26a50f33528d837e9f90f0561d0c21794",
      "created_at" : "2023-08-28T16:14:45Z",
      "diff_hunk" : "@@ -220,13 +212,21 @@ class CNetAddr\n         return IsIPv4() || IsIPv6() || IsTor() || IsI2P() || IsCJDNS();\n     }\n \n+    enum class Encoding {\n+        V1,\n+        V2, //!< BIP155 encoding\n+    };\n+    struct SerParams {\n+        const Encoding enc;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1307634959",
      "id" : 1307634959,
      "in_reply_to_id" : 1306603854,
      "line" : 220,
      "node_id" : "PRRC_kwDOABII585N8O0P",
      "original_commit_id" : "fab1d5bcf28d49ee0de51546f297b0c4faeaadaa",
      "original_line" : 220,
      "original_position" : 24,
      "original_start_line" : null,
      "path" : "src/netaddress.h",
      "position" : 24,
      "pull_request_review_id" : 1598629972,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307634959/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-08-28T16:14:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307634959",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1307670763"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307670763"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Yeah; with C++20 concepts I could get `::Serialize` to call `obj.Serialize(s, s.GetParams())` directly which seemed nicer, but with just C++17 I got myself too confused.",
      "commit_id" : "fa80d8e26a50f33528d837e9f90f0561d0c21794",
      "created_at" : "2023-08-28T16:45:23Z",
      "diff_hunk" : "@@ -220,13 +212,21 @@ class CNetAddr\n         return IsIPv4() || IsIPv6() || IsTor() || IsI2P() || IsCJDNS();\n     }\n \n+    enum class Encoding {\n+        V1,\n+        V2, //!< BIP155 encoding\n+    };\n+    struct SerParams {\n+        const Encoding enc;\n+    };\n+\n     /**\n      * Serialize to a stream.\n      */\n     template <typename Stream>\n     void Serialize(Stream& s) const\n     {\n-        if (s.GetVersion() & ADDRV2_FORMAT) {\n+        if (s.GetParams().enc == Encoding::V2) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1307670763",
      "id" : 1307670763,
      "in_reply_to_id" : 1306612626,
      "line" : 229,
      "node_id" : "PRRC_kwDOABII585N8Xjr",
      "original_commit_id" : "fab1d5bcf28d49ee0de51546f297b0c4faeaadaa",
      "original_line" : 229,
      "original_position" : 34,
      "original_start_line" : null,
      "path" : "src/netaddress.h",
      "position" : 34,
      "pull_request_review_id" : 1598675701,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307670763/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-08-28T16:45:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307670763",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1307678939"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307678939"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Instead of `WithParams(Foo::SerParams{Foo::Bar::VALUE}, obj)` I had `seropt<Foo>(obj, {.var=value})`; implemented something like:\r\n\r\n```c++\r\ntemplate<typename O, typename T>\r\ninline auto seropt(T& obj, const SerializationOptions<O>& opts) {\r\n   return ParamsWrapper<SerializationOptions<O>,T>(opts, obj);\r\n}\r\n\r\ntemplate<typename T>\r\ninline auto seropt(T& obj, const SerializationOptions<T>& opts) { return seropt<T,T>(obj, opts); }\r\n\r\ntemplate<>\r\nstruct SerializationOptions<class CAddress> {\r\n    bool addrv2{false};\r\n    bool to_disk{false};\r\n    operator SerializationOptions<class CNetAddr>() const { return {.addrv2=addrv2}; }\r\n};\r\n```\r\n\r\nSaves a bit of boiler plate, not sure it's entirely enough to be worthwhile.",
      "commit_id" : "fa80d8e26a50f33528d837e9f90f0561d0c21794",
      "created_at" : "2023-08-28T16:53:25Z",
      "diff_hunk" : "@@ -390,35 +390,39 @@ class CAddress : public CService\n     CAddress(CService ipIn, ServiceFlags nServicesIn) : CService{ipIn}, nServices{nServicesIn} {};\n     CAddress(CService ipIn, ServiceFlags nServicesIn, NodeSeconds time) : CService{ipIn}, nTime{time}, nServices{nServicesIn} {};\n \n-    SERIALIZE_METHODS(CAddress, obj)\n+    enum class Format {\n+        Disk,\n+        Network,\n+    };\n+    struct SerParams : CNetAddr::SerParams {\n+        const Format fmt;\n+    };",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1307678939",
      "id" : 1307678939,
      "in_reply_to_id" : 1306613399,
      "line" : 399,
      "node_id" : "PRRC_kwDOABII585N8Zjb",
      "original_commit_id" : "fab1d5bcf28d49ee0de51546f297b0c4faeaadaa",
      "original_line" : 399,
      "original_position" : 11,
      "original_start_line" : null,
      "path" : "src/protocol.h",
      "position" : 11,
      "pull_request_review_id" : 1598687690,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307678939/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-08-28T16:53:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307678939",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1307684865"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307684865"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "You construct `V1` params a couple of times in net_processing as well, just thought having them already done might be easier? You'd be saying `WithParams(CAddress::V1_DISK, info)` rather than `WithParams(ser_params, info)` or whatever, so it'd be slightly clearer inline as well as maybe saving a redeclaration?",
      "commit_id" : "fa80d8e26a50f33528d837e9f90f0561d0c21794",
      "created_at" : "2023-08-28T16:59:31Z",
      "diff_hunk" : "@@ -697,16 +697,17 @@ BOOST_AUTO_TEST_CASE(addrman_serialization)\n     auto addrman_asmap1_dup = std::make_unique<AddrMan>(netgroupman, DETERMINISTIC, ratio);\n     auto addrman_noasmap = std::make_unique<AddrMan>(EMPTY_NETGROUPMAN, DETERMINISTIC, ratio);\n \n-    CDataStream stream(SER_NETWORK, PROTOCOL_VERSION);\n+    DataStream stream{};\n+    const CAddress::SerParams ser_params{{CNetAddr::Encoding::V1}, CAddress::Format::Network};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1307684865",
      "id" : 1307684865,
      "in_reply_to_id" : 1306604259,
      "line" : 701,
      "node_id" : "PRRC_kwDOABII585N8bAB",
      "original_commit_id" : "fab1d5bcf28d49ee0de51546f297b0c4faeaadaa",
      "original_line" : 701,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/test/addrman_tests.cpp",
      "position" : 6,
      "pull_request_review_id" : 1598696551,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307684865/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-08-28T16:59:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307684865",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1307689145"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307689145"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Ah, at least for my code, I already get a warning with `clang-16`:\r\n\r\n```diff\r\ndiff --git a/src/net_processing.cpp b/src/net_processing.cpp\r\nindex 0582da423f..98699fd505 100644\r\n--- a/src/net_processing.cpp\r\n+++ b/src/net_processing.cpp\r\n@@ -5283,7 +5283,7 @@ void PeerManagerImpl::MaybeSendAddr(CNode& node, Peer& peer, std::chrono::micros\r\n         msg_type = NetMsgType::ADDR;\r\n         ser_enc = CNetAddr::Encoding::V1;\r\n     }\r\n-    m_connman.PushMessage(&node, CNetMsgMaker(node.GetCommonVersion()).Make(msg_type, WithParams(CAddress::SerParams{{ser_enc}, CAddress::Format::Network}, peer.m_addrs_to_send)));\r\n+    m_connman.PushMessage(&node, CNetMsgMaker(node.GetCommonVersion()).Make(msg_type, WithParams(CAddress::SerParams{{ser_enc}}, peer.m_addrs_to_send)));\r\n     peer.m_addrs_to_send.clear();\r\n \r\n     // we only send the big addr message once\r\n```\r\n\r\n```\r\nnet_processing.cpp:5286:127: warning: missing field 'fmt' initializer [-Wmissing-field-initializers]\r\n    m_connman.PushMessage(&node, CNetMsgMaker(node.GetCommonVersion()).Make(msg_type, WithParams(CAddress::SerParams{{ser_enc}}, peer.m_addrs_to_send)));\r\n                                                                                                                              ^\r\n1 warning generated.\r\n",
      "commit_id" : "fa80d8e26a50f33528d837e9f90f0561d0c21794",
      "created_at" : "2023-08-28T17:04:16Z",
      "diff_hunk" : "@@ -220,13 +212,21 @@ class CNetAddr\n         return IsIPv4() || IsIPv6() || IsTor() || IsI2P() || IsCJDNS();\n     }\n \n+    enum class Encoding {\n+        V1,\n+        V2, //!< BIP155 encoding\n+    };\n+    struct SerParams {\n+        const Encoding enc;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1307689145",
      "id" : 1307689145,
      "in_reply_to_id" : 1306603854,
      "line" : 220,
      "node_id" : "PRRC_kwDOABII585N8cC5",
      "original_commit_id" : "fab1d5bcf28d49ee0de51546f297b0c4faeaadaa",
      "original_line" : 220,
      "original_position" : 24,
      "original_start_line" : null,
      "path" : "src/netaddress.h",
      "position" : 24,
      "pull_request_review_id" : 1598703473,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307689145/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-08-28T17:04:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307689145",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1307717337"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307717337"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> Or rather, this may be a clang-tidy-plugin candidate, no?\r\n\r\nHere's a _very_ quick POC in case this is desired: https://github.com/theuni/bitcoin/commit/caad1926ab4c4ee7a7f5bc6979228afd8500350d\r\n\r\nIt's not tested against all forms of init/inheritance, so we'd likely need to fix it up a bit.\r\n\r\nAlso the max params are hard-coded because of an AST traversal quirk. That limit could be removed with a less strict match and fancier code in `SerParamsCheck::check`.",
      "commit_id" : "fa80d8e26a50f33528d837e9f90f0561d0c21794",
      "created_at" : "2023-08-28T17:34:24Z",
      "diff_hunk" : "@@ -220,13 +212,21 @@ class CNetAddr\n         return IsIPv4() || IsIPv6() || IsTor() || IsI2P() || IsCJDNS();\n     }\n \n+    enum class Encoding {\n+        V1,\n+        V2, //!< BIP155 encoding\n+    };\n+    struct SerParams {\n+        const Encoding enc;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1307717337",
      "id" : 1307717337,
      "in_reply_to_id" : 1306603854,
      "line" : 220,
      "node_id" : "PRRC_kwDOABII585N8i7Z",
      "original_commit_id" : "fab1d5bcf28d49ee0de51546f297b0c4faeaadaa",
      "original_line" : 220,
      "original_position" : 24,
      "original_start_line" : null,
      "path" : "src/netaddress.h",
      "position" : 24,
      "pull_request_review_id" : 1598746969,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307717337/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-08-28T17:34:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307717337",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "node_id" : "MDQ6VXNlcjQxNzA0Mw==",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1307798024"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307798024"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Makes sense, pushed a change to reduce verbosity.\r\n\r\nThe diff should be scripted-diff, roughly:\r\n\r\n\r\n```\r\nsed -i 's|CAddress::SerParams{{CNetAddr::Encoding::V1}, CAddress::Format::Disk}|CAddress::V1_DISK|g'                                   $(git grep -l SerParams)\r\nsed -i 's|CAddress::SerParams{{CNetAddr::Encoding::V2}, CAddress::Format::Disk}|CAddress::V2_DISK|g'                                   $(git grep -l SerParams)\r\nsed -i 's|CAddress::SerParams{{CNetAddr::Encoding::V2}, CAddress::Format::Network}|CAddress::V2_NETWORK|g'                             $(git grep -l SerParams)\r\nsed -i 's|CAddress::SerParams{{CNetAddr::Encoding::V1}, CAddress::Format::Network}|CAddress::V1_NETWORK|g'                             $(git grep -l SerParams)\r\nsed -i 's|CAddress::SerParams ser_params{{CNetAddr::Encoding::V1}, CAddress::Format::Network}|auto ser_params{CAddress::V1_NETWORK}|g' $(git grep -l SerParams)\r\nsed -i 's|CAddress::SerParams ser_params{{CNetAddr::Encoding::V2}, CAddress::Format::Network}|auto ser_params{CAddress::V2_NETWORK}|g' $(git grep -l SerParams)\r\nsed -i 's|CNetAddr::SerParams ser_params{CNetAddr::Encoding::V1}|auto ser_params{CNetAddr:V1}|g'                                       $(git grep -l SerParams)\r\nsed -i 's|CNetAddr::SerParams{CNetAddr::Encoding::V1}|CNetAddr::V1|g'                                                                  $(git grep -l SerParams)\r\nsed -i 's|CNetAddr::SerParams{CNetAddr::Encoding::V2}|CNetAddr::V2|g'                                                                  $(git grep -l SerParams)\r\n",
      "commit_id" : "fafca6b73310a4449918b95e3895ac434a2e096a",
      "created_at" : "2023-08-28T19:03:17Z",
      "diff_hunk" : "@@ -697,16 +697,17 @@ BOOST_AUTO_TEST_CASE(addrman_serialization)\n     auto addrman_asmap1_dup = std::make_unique<AddrMan>(netgroupman, DETERMINISTIC, ratio);\n     auto addrman_noasmap = std::make_unique<AddrMan>(EMPTY_NETGROUPMAN, DETERMINISTIC, ratio);\n \n-    CDataStream stream(SER_NETWORK, PROTOCOL_VERSION);\n+    DataStream stream{};\n+    const CAddress::SerParams ser_params{{CNetAddr::Encoding::V1}, CAddress::Format::Network};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1307798024",
      "id" : 1307798024,
      "in_reply_to_id" : 1306604259,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585N82oI",
      "original_commit_id" : "fab1d5bcf28d49ee0de51546f297b0c4faeaadaa",
      "original_line" : 701,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/test/addrman_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 1598883764,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307798024/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-08-28T19:03:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307798024",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1307801824"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307801824"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think the last push removed most of the boilerplate, no?",
      "commit_id" : "fafca6b73310a4449918b95e3895ac434a2e096a",
      "created_at" : "2023-08-28T19:07:50Z",
      "diff_hunk" : "@@ -390,35 +390,39 @@ class CAddress : public CService\n     CAddress(CService ipIn, ServiceFlags nServicesIn) : CService{ipIn}, nServices{nServicesIn} {};\n     CAddress(CService ipIn, ServiceFlags nServicesIn, NodeSeconds time) : CService{ipIn}, nTime{time}, nServices{nServicesIn} {};\n \n-    SERIALIZE_METHODS(CAddress, obj)\n+    enum class Format {\n+        Disk,\n+        Network,\n+    };\n+    struct SerParams : CNetAddr::SerParams {\n+        const Format fmt;\n+    };",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1307801824",
      "id" : 1307801824,
      "in_reply_to_id" : 1306613399,
      "line" : 399,
      "node_id" : "PRRC_kwDOABII585N83jg",
      "original_commit_id" : "fab1d5bcf28d49ee0de51546f297b0c4faeaadaa",
      "original_line" : 399,
      "original_position" : 11,
      "original_start_line" : null,
      "path" : "src/protocol.h",
      "position" : 11,
      "pull_request_review_id" : 1598889964,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307801824/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-08-28T19:07:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307801824",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1307803115"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307803115"
         }
      },
      "author_association" : "MEMBER",
      "body" : "It is now:\r\n\r\n```cpp\r\nWithParams(CAddress::V1_DISK, addrman2)",
      "commit_id" : "fafca6b73310a4449918b95e3895ac434a2e096a",
      "created_at" : "2023-08-28T19:09:16Z",
      "diff_hunk" : "@@ -972,35 +974,35 @@ BOOST_AUTO_TEST_CASE(load_addrman)\n     BOOST_CHECK(addrman.Size() == 3);\n \n     // Test that the de-serialization does not throw an exception.\n-    CDataStream ssPeers1 = AddrmanToStream(addrman);\n+    auto ssPeers1{AddrmanToStream(addrman)};\n     bool exceptionThrown = false;\n     AddrMan addrman1{EMPTY_NETGROUPMAN, !DETERMINISTIC, GetCheckRatio(m_node)};\n \n     BOOST_CHECK(addrman1.Size() == 0);\n     try {\n         unsigned char pchMsgTmp[4];\n         ssPeers1 >> pchMsgTmp;\n-        ssPeers1 >> addrman1;\n+        ssPeers1 >> WithParams(CAddress::SerParams{{CNetAddr::Encoding::V1}, CAddress::Format::Disk}, addrman1);\n     } catch (const std::exception&) {\n         exceptionThrown = true;\n     }\n \n     BOOST_CHECK(addrman1.Size() == 3);\n     BOOST_CHECK(exceptionThrown == false);\n \n-    // Test that ReadFromStream creates an addrman with the correct number of addrs.\n-    CDataStream ssPeers2 = AddrmanToStream(addrman);\n+    // Test that ReadFromStreamUnitTests creates an addrman with the correct number of addrs.\n+    auto ssPeers2{AddrmanToStream(addrman)};\n \n     AddrMan addrman2{EMPTY_NETGROUPMAN, !DETERMINISTIC, GetCheckRatio(m_node)};\n     BOOST_CHECK(addrman2.Size() == 0);\n-    ReadFromStream(addrman2, ssPeers2);\n+    ReadFromStreamUnitTests(WithParams(CAddress::SerParams{{CNetAddr::Encoding::V1}, CAddress::Format::Disk}, addrman2), ssPeers2);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1307803115",
      "id" : 1307803115,
      "in_reply_to_id" : 1306613010,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585N833r",
      "original_commit_id" : "fab1d5bcf28d49ee0de51546f297b0c4faeaadaa",
      "original_line" : 998,
      "original_position" : 127,
      "original_start_line" : null,
      "path" : "src/test/addrman_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 1598891861,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307803115/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-08-28T19:09:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307803115",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1307803451"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307803451"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Ok, let's improve the warning once and if there is C++20",
      "commit_id" : "fafca6b73310a4449918b95e3895ac434a2e096a",
      "created_at" : "2023-08-28T19:09:42Z",
      "diff_hunk" : "@@ -220,13 +212,21 @@ class CNetAddr\n         return IsIPv4() || IsIPv6() || IsTor() || IsI2P() || IsCJDNS();\n     }\n \n+    enum class Encoding {\n+        V1,\n+        V2, //!< BIP155 encoding\n+    };\n+    struct SerParams {\n+        const Encoding enc;\n+    };\n+\n     /**\n      * Serialize to a stream.\n      */\n     template <typename Stream>\n     void Serialize(Stream& s) const\n     {\n-        if (s.GetVersion() & ADDRV2_FORMAT) {\n+        if (s.GetParams().enc == Encoding::V2) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1307803451",
      "id" : 1307803451,
      "in_reply_to_id" : 1306612626,
      "line" : 231,
      "node_id" : "PRRC_kwDOABII585N8387",
      "original_commit_id" : "fab1d5bcf28d49ee0de51546f297b0c4faeaadaa",
      "original_line" : 231,
      "original_position" : 34,
      "original_start_line" : null,
      "path" : "src/netaddress.h",
      "position" : 36,
      "pull_request_review_id" : 1598892477,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307803451/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-08-28T19:09:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307803451",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1307804070"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307804070"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Nice, can be submitted in a follow-up  pull?",
      "commit_id" : "fafca6b73310a4449918b95e3895ac434a2e096a",
      "created_at" : "2023-08-28T19:10:22Z",
      "diff_hunk" : "@@ -220,13 +212,21 @@ class CNetAddr\n         return IsIPv4() || IsIPv6() || IsTor() || IsI2P() || IsCJDNS();\n     }\n \n+    enum class Encoding {\n+        V1,\n+        V2, //!< BIP155 encoding\n+    };\n+    struct SerParams {\n+        const Encoding enc;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1307804070",
      "id" : 1307804070,
      "in_reply_to_id" : 1306603854,
      "line" : 220,
      "node_id" : "PRRC_kwDOABII585N84Gm",
      "original_commit_id" : "fab1d5bcf28d49ee0de51546f297b0c4faeaadaa",
      "original_line" : 220,
      "original_position" : 24,
      "original_start_line" : null,
      "path" : "src/netaddress.h",
      "position" : 24,
      "pull_request_review_id" : 1598893407,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307804070/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-08-28T19:10:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307804070",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1307928342"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307928342"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Nit: using `ser_params` here (and in `ProcessMessage`) seems less clear than just using `CNetAddr::V1` directly.",
      "commit_id" : "fafca6b73310a4449918b95e3895ac434a2e096a",
      "created_at" : "2023-08-28T20:38:49Z",
      "diff_hunk" : "@@ -1414,9 +1414,10 @@ void PeerManagerImpl::PushNodeVersion(CNode& pnode, const Peer& peer)\n     uint64_t your_services{addr.nServices};\n \n     const bool tx_relay{!RejectIncomingTxs(pnode)};\n+    const auto ser_params{CNetAddr::V1};\n     m_connman.PushMessage(&pnode, CNetMsgMaker(INIT_PROTO_VERSION).Make(NetMsgType::VERSION, PROTOCOL_VERSION, my_services, nTime,\n-            your_services, addr_you, // Together the pre-version-31402 serialization of CAddress \"addrYou\" (without nTime)\n-            my_services, CService(), // Together the pre-version-31402 serialization of CAddress \"addrMe\" (without nTime)\n+            your_services, WithParams(ser_params, addr_you), // Together the pre-version-31402 serialization of CAddress \"addrYou\" (without nTime)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1307928342",
      "id" : 1307928342,
      "line" : 1419,
      "node_id" : "PRRC_kwDOABII585N9WcW",
      "original_commit_id" : "fa0b988a15bf1caf13e76a92649afab9fd089591",
      "original_line" : 1419,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : 8,
      "pull_request_review_id" : 1599076164,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307928342/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-08-28T20:41:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1307928342",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "node_id" : "MDQ6VXNlcjQxNzA0Mw==",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1308290216"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1308290216"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yes, good point. It makes little sense to assign an existing short alias to a `const auto` alias when it is only used once or twice.\r\n\r\nFixed in all files in this commit.",
      "commit_id" : "faba341ed5da9a396eb64f0b1d369ba58701ebf7",
      "created_at" : "2023-08-29T06:50:23Z",
      "diff_hunk" : "@@ -1414,9 +1414,10 @@ void PeerManagerImpl::PushNodeVersion(CNode& pnode, const Peer& peer)\n     uint64_t your_services{addr.nServices};\n \n     const bool tx_relay{!RejectIncomingTxs(pnode)};\n+    const auto ser_params{CNetAddr::V1};\n     m_connman.PushMessage(&pnode, CNetMsgMaker(INIT_PROTO_VERSION).Make(NetMsgType::VERSION, PROTOCOL_VERSION, my_services, nTime,\n-            your_services, addr_you, // Together the pre-version-31402 serialization of CAddress \"addrYou\" (without nTime)\n-            my_services, CService(), // Together the pre-version-31402 serialization of CAddress \"addrMe\" (without nTime)\n+            your_services, WithParams(ser_params, addr_you), // Together the pre-version-31402 serialization of CAddress \"addrYou\" (without nTime)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1308290216",
      "id" : 1308290216,
      "in_reply_to_id" : 1307928342,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585N-uyo",
      "original_commit_id" : "fa0b988a15bf1caf13e76a92649afab9fd089591",
      "original_line" : 1419,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 1599619717,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1308290216/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-08-29T06:50:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1308290216",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1312914650"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1312914650"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Where is this `GetParams` defined that the method here overrides? Does this refer to the underlying type instead?",
      "commit_id" : "fa626af3edbe8d98b2de91dd71729ceef90389fb",
      "created_at" : "2023-09-01T11:32:08Z",
      "diff_hunk" : "@@ -1080,4 +1134,61 @@ size_t GetSerializeSizeMany(int nVersion, const T&... t)\n     return sc.size();\n }\n \n+/** Wrapper that overrides the GetParams() function of a stream (and hides GetVersion/GetType). */",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1312914650",
      "id" : 1312914650,
      "line" : 1137,
      "node_id" : "PRRC_kwDOABII585OQXza",
      "original_commit_id" : "faec591d64e40ba7ec7656cbfdda1a05953bde13",
      "original_line" : 1137,
      "original_position" : 107,
      "original_start_line" : null,
      "path" : "src/serialize.h",
      "position" : 233,
      "pull_request_review_id" : 1606775232,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1312914650/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-09-05T08:04:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1312914650",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8421793?v=4",
         "events_url" : "https://api.github.com/users/TheCharlatan/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheCharlatan/followers",
         "following_url" : "https://api.github.com/users/TheCharlatan/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheCharlatan/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheCharlatan",
         "id" : 8421793,
         "login" : "TheCharlatan",
         "node_id" : "MDQ6VXNlcjg0MjE3OTM=",
         "organizations_url" : "https://api.github.com/users/TheCharlatan/orgs",
         "received_events_url" : "https://api.github.com/users/TheCharlatan/received_events",
         "repos_url" : "https://api.github.com/users/TheCharlatan/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheCharlatan/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheCharlatan/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheCharlatan"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1313191801"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1313191801"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This feels unnecessary. Addrman's serialization controls how the addresses in it are serialized (only `V1_DISK` or `V2_DISK` should be used), so it shouldn't be necessary to provide it with a `CAddress` parameter (and doing so is misleading, as it'd be overridden anyway).",
      "commit_id" : "faba341ed5da9a396eb64f0b1d369ba58701ebf7",
      "created_at" : "2023-09-01T15:36:54Z",
      "diff_hunk" : "@@ -175,13 +174,15 @@ bool CBanDB::Read(banmap_t& banSet)\n bool DumpPeerAddresses(const ArgsManager& args, const AddrMan& addr)\n {\n     const auto pathAddr = args.GetDataDirNet() / \"peers.dat\";\n-    return SerializeFileDB(\"peers\", pathAddr, addr, CLIENT_VERSION);\n+    return SerializeFileDB(\"peers\", pathAddr, WithParams(CAddress::V1_DISK, addr));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1313191801",
      "id" : 1313191801,
      "line" : 177,
      "node_id" : "PRRC_kwDOABII585ORbd5",
      "original_commit_id" : "fad3f7a5249a4ad59fc040a1b2e46d8d5aedf80c",
      "original_line" : 177,
      "original_position" : 51,
      "original_start_line" : null,
      "path" : "src/addrdb.cpp",
      "position" : 51,
      "pull_request_review_id" : 1607194023,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1313191801/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-09-01T15:49:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1313191801",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1313194337"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1313194337"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Same here, I think it should be possible to unserialize addrman without parameter.",
      "commit_id" : "faba341ed5da9a396eb64f0b1d369ba58701ebf7",
      "created_at" : "2023-09-01T15:39:29Z",
      "diff_hunk" : "@@ -191,7 +192,7 @@ util::Result<std::unique_ptr<AddrMan>> LoadAddrman(const NetGroupManager& netgro\n     const auto start{SteadyClock::now()};\n     const auto path_addr{args.GetDataDirNet() / \"peers.dat\"};\n     try {\n-        DeserializeFileDB(path_addr, *addrman, CLIENT_VERSION);\n+        DeserializeFileDB(path_addr, WithParams(CAddress::V1_DISK, *addrman));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1313194337",
      "id" : 1313194337,
      "line" : 195,
      "node_id" : "PRRC_kwDOABII585ORcFh",
      "original_commit_id" : "fad3f7a5249a4ad59fc040a1b2e46d8d5aedf80c",
      "original_line" : 195,
      "original_position" : 69,
      "original_start_line" : null,
      "path" : "src/addrdb.cpp",
      "position" : 69,
      "pull_request_review_id" : 1607194023,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1313194337/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-09-01T15:43:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1313194337",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1313195976"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1313195976"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Addrman is only ever serialized to disk, so the fmt here should always be disk (and thus, ser_params will only ever be `V2_DISK` here).",
      "commit_id" : "faba341ed5da9a396eb64f0b1d369ba58701ebf7",
      "created_at" : "2023-09-01T15:41:06Z",
      "diff_hunk" : "@@ -171,8 +171,8 @@ void AddrManImpl::Serialize(Stream& s_) const\n      */\n \n     // Always serialize in the latest version (FILE_FORMAT).\n-\n-    OverrideStream<Stream> s(&s_, s_.GetType(), s_.GetVersion() | ADDRV2_FORMAT);\n+    const CAddress::SerParams ser_params{{CNetAddr::Encoding::V2}, s_.GetParams().fmt};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1313195976",
      "id" : 1313195976,
      "line" : 174,
      "node_id" : "PRRC_kwDOABII585ORcfI",
      "original_commit_id" : "fad3f7a5249a4ad59fc040a1b2e46d8d5aedf80c",
      "original_line" : 174,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/addrman.cpp",
      "position" : 6,
      "pull_request_review_id" : 1607194023,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1313195976/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-09-01T15:45:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1313195976",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1313197007"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1313197007"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This line and the lines above could be simplified, as it's only choosing between options `V1_DISK` and `V2_DISK`.",
      "commit_id" : "faba341ed5da9a396eb64f0b1d369ba58701ebf7",
      "created_at" : "2023-09-01T15:42:10Z",
      "diff_hunk" : "@@ -236,14 +236,15 @@ void AddrManImpl::Unserialize(Stream& s_)\n     Format format;\n     s_ >> Using<CustomUintFormatter<1>>(format);\n \n-    int stream_version = s_.GetVersion();\n+    auto stream_enc{CNetAddr::Encoding::V1};\n     if (format >= Format::V3_BIP155) {\n-        // Add ADDRV2_FORMAT to the version so that the CNetAddr and CAddress\n+        // Set V2 so that the CNetAddr and CAddress\n         // unserialize methods know that an address in addrv2 format is coming.\n-        stream_version |= ADDRV2_FORMAT;\n+        stream_enc = CNetAddr::Encoding::V2;\n     }\n \n-    OverrideStream<Stream> s(&s_, s_.GetType(), stream_version);\n+    const CAddress::SerParams ser_params{{stream_enc}, s_.GetParams().fmt};\n+    ParamsStream s{ser_params, s_};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1313197007",
      "id" : 1313197007,
      "line" : 247,
      "node_id" : "PRRC_kwDOABII585ORcvP",
      "original_commit_id" : "fad3f7a5249a4ad59fc040a1b2e46d8d5aedf80c",
      "original_line" : 247,
      "original_position" : 27,
      "original_start_line" : null,
      "path" : "src/addrman.cpp",
      "position" : 27,
      "pull_request_review_id" : 1607194023,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1313197007/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-09-01T15:43:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1313197007",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1314855799"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1314855799"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "+1 Patch with these changes is at https://github.com/ajtowns/bitcoin/commits/202309-serializeaddrmansimp if you want to squash it in",
      "commit_id" : "faba341ed5da9a396eb64f0b1d369ba58701ebf7",
      "created_at" : "2023-09-04T11:59:38Z",
      "diff_hunk" : "@@ -175,13 +174,15 @@ bool CBanDB::Read(banmap_t& banSet)\n bool DumpPeerAddresses(const ArgsManager& args, const AddrMan& addr)\n {\n     const auto pathAddr = args.GetDataDirNet() / \"peers.dat\";\n-    return SerializeFileDB(\"peers\", pathAddr, addr, CLIENT_VERSION);\n+    return SerializeFileDB(\"peers\", pathAddr, WithParams(CAddress::V1_DISK, addr));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1314855799",
      "id" : 1314855799,
      "in_reply_to_id" : 1313191801,
      "line" : 177,
      "node_id" : "PRRC_kwDOABII585OXxt3",
      "original_commit_id" : "fad3f7a5249a4ad59fc040a1b2e46d8d5aedf80c",
      "original_line" : 177,
      "original_position" : 51,
      "original_start_line" : null,
      "path" : "src/addrdb.cpp",
      "position" : 51,
      "pull_request_review_id" : 1609404320,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1314855799/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-09-04T11:59:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1314855799",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1314858653"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1314858653"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Yeah, looks fine",
      "commit_id" : "faba341ed5da9a396eb64f0b1d369ba58701ebf7",
      "created_at" : "2023-09-04T12:02:32Z",
      "diff_hunk" : "@@ -390,35 +390,39 @@ class CAddress : public CService\n     CAddress(CService ipIn, ServiceFlags nServicesIn) : CService{ipIn}, nServices{nServicesIn} {};\n     CAddress(CService ipIn, ServiceFlags nServicesIn, NodeSeconds time) : CService{ipIn}, nTime{time}, nServices{nServicesIn} {};\n \n-    SERIALIZE_METHODS(CAddress, obj)\n+    enum class Format {\n+        Disk,\n+        Network,\n+    };\n+    struct SerParams : CNetAddr::SerParams {\n+        const Format fmt;\n+    };",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1314858653",
      "id" : 1314858653,
      "in_reply_to_id" : 1306613399,
      "line" : 399,
      "node_id" : "PRRC_kwDOABII585OXyad",
      "original_commit_id" : "fab1d5bcf28d49ee0de51546f297b0c4faeaadaa",
      "original_line" : 399,
      "original_position" : 11,
      "original_start_line" : null,
      "path" : "src/protocol.h",
      "position" : 11,
      "pull_request_review_id" : 1609408832,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1314858653/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-09-04T12:02:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1314858653",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1315516573"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1315516573"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I agree this is misleading, but the unit and fuzz tests would still set `Network`, as opposed to `Disk` sometimes. I agree with the cleanup, but I think this is a slight change (improvement) in what the unit and fuzz tests are testing.\r\n\r\nThough, as it only affects tests, I think the `refactoring` label can be kept on this pull request.",
      "commit_id" : "fa626af3edbe8d98b2de91dd71729ceef90389fb",
      "created_at" : "2023-09-05T07:54:29Z",
      "diff_hunk" : "@@ -175,13 +174,15 @@ bool CBanDB::Read(banmap_t& banSet)\n bool DumpPeerAddresses(const ArgsManager& args, const AddrMan& addr)\n {\n     const auto pathAddr = args.GetDataDirNet() / \"peers.dat\";\n-    return SerializeFileDB(\"peers\", pathAddr, addr, CLIENT_VERSION);\n+    return SerializeFileDB(\"peers\", pathAddr, WithParams(CAddress::V1_DISK, addr));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1315516573",
      "id" : 1315516573,
      "in_reply_to_id" : 1313191801,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585OaTCd",
      "original_commit_id" : "fad3f7a5249a4ad59fc040a1b2e46d8d5aedf80c",
      "original_line" : 177,
      "original_position" : 51,
      "original_start_line" : null,
      "path" : "src/addrdb.cpp",
      "position" : null,
      "pull_request_review_id" : 1610447655,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1315516573/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-09-05T07:54:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1315516573",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1315525468"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1315525468"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Not in the unit tests, see https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1315516573 and:\r\n\r\n```\r\ntest/addrman_tests.cpp(690): Entering test case \"addrman_serialization\"\r\ntest_bitcoin: addrman.cpp:175: void AddrManImpl::Serialize(Stream &) const [Stream = ParamsStream<CAddress::SerParams, DataStream>]: Assertion `s_.GetParams().fmt==CAddress::Format::Disk' failed.\r\nmake[3]: *** [Makefile:22464: test/addrman_tests.cpp.test] Error 1\r\n",
      "commit_id" : "fa626af3edbe8d98b2de91dd71729ceef90389fb",
      "created_at" : "2023-09-05T08:01:04Z",
      "diff_hunk" : "@@ -171,8 +171,8 @@ void AddrManImpl::Serialize(Stream& s_) const\n      */\n \n     // Always serialize in the latest version (FILE_FORMAT).\n-\n-    OverrideStream<Stream> s(&s_, s_.GetType(), s_.GetVersion() | ADDRV2_FORMAT);\n+    const CAddress::SerParams ser_params{{CNetAddr::Encoding::V2}, s_.GetParams().fmt};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1315525468",
      "id" : 1315525468,
      "in_reply_to_id" : 1313195976,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585OaVNc",
      "original_commit_id" : "fad3f7a5249a4ad59fc040a1b2e46d8d5aedf80c",
      "original_line" : 174,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/addrman.cpp",
      "position" : null,
      "pull_request_review_id" : 1610459669,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1315525468/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-09-05T08:01:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1315525468",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1315546606"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1315546606"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Good question. I wonder if it makes sense to override the `GetParams()` function at all. Generally, no underlying stream type has a `GetParams()` method, so \"overriding\" really means \"defines\".\r\n\r\nAnd if the `GetParams()` method is truly overridden, it should be rare, and it could make more sense to first require the stream to reveal its underlying unwrapped stream, without the `GetParams()` method?",
      "commit_id" : "fa626af3edbe8d98b2de91dd71729ceef90389fb",
      "created_at" : "2023-09-05T08:19:05Z",
      "diff_hunk" : "@@ -1080,4 +1134,61 @@ size_t GetSerializeSizeMany(int nVersion, const T&... t)\n     return sc.size();\n }\n \n+/** Wrapper that overrides the GetParams() function of a stream (and hides GetVersion/GetType). */",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1315546606",
      "id" : 1315546606,
      "in_reply_to_id" : 1312914650,
      "line" : 1137,
      "node_id" : "PRRC_kwDOABII585OaaXu",
      "original_commit_id" : "faec591d64e40ba7ec7656cbfdda1a05953bde13",
      "original_line" : 1137,
      "original_position" : 107,
      "original_start_line" : null,
      "path" : "src/serialize.h",
      "position" : 233,
      "pull_request_review_id" : 1610494431,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1315546606/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-09-05T08:19:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1315546606",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1315548320"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1315548320"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> +1 Patch with these changes is at https://github.com/ajtowns/bitcoin/commits/202309-serializeaddrmansimp if you want to squash it in\r\n\r\nThanks for the patch! I've squashed it and adjusted the commit message to explain the test changes.",
      "commit_id" : "fa626af3edbe8d98b2de91dd71729ceef90389fb",
      "created_at" : "2023-09-05T08:20:35Z",
      "diff_hunk" : "@@ -175,13 +174,15 @@ bool CBanDB::Read(banmap_t& banSet)\n bool DumpPeerAddresses(const ArgsManager& args, const AddrMan& addr)\n {\n     const auto pathAddr = args.GetDataDirNet() / \"peers.dat\";\n-    return SerializeFileDB(\"peers\", pathAddr, addr, CLIENT_VERSION);\n+    return SerializeFileDB(\"peers\", pathAddr, WithParams(CAddress::V1_DISK, addr));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1315548320",
      "id" : 1315548320,
      "in_reply_to_id" : 1313191801,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585Oaayg",
      "original_commit_id" : "fad3f7a5249a4ad59fc040a1b2e46d8d5aedf80c",
      "original_line" : 177,
      "original_position" : 51,
      "original_start_line" : null,
      "path" : "src/addrdb.cpp",
      "position" : null,
      "pull_request_review_id" : 1610497244,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1315548320/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-09-05T08:20:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1315548320",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1315550841"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1315550841"
         }
      },
      "author_association" : "MEMBER",
      "body" : "(My plan was to look into this after C++20, to avoid the risk of writing clunky C++17 code.)",
      "commit_id" : "fa626af3edbe8d98b2de91dd71729ceef90389fb",
      "created_at" : "2023-09-05T08:22:39Z",
      "diff_hunk" : "@@ -1080,4 +1134,61 @@ size_t GetSerializeSizeMany(int nVersion, const T&... t)\n     return sc.size();\n }\n \n+/** Wrapper that overrides the GetParams() function of a stream (and hides GetVersion/GetType). */",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1315550841",
      "id" : 1315550841,
      "in_reply_to_id" : 1312914650,
      "line" : 1137,
      "node_id" : "PRRC_kwDOABII585OabZ5",
      "original_commit_id" : "faec591d64e40ba7ec7656cbfdda1a05953bde13",
      "original_line" : 1137,
      "original_position" : 107,
      "original_start_line" : null,
      "path" : "src/serialize.h",
      "position" : 233,
      "pull_request_review_id" : 1610501171,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1315550841/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-09-05T08:22:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1315550841",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1315927911"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1315927911"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I think you could do:\r\n\r\n```c++\r\n#ifdef HAVE_CXX20\r\ntemplate<typename Stream>\r\nconcept ParamsStreamConcept = requires(Stream& s) { s.GetParams(); };\r\ntemplate<typename Stream>\r\nconcept PlainStreamConcept = !ParamsStreamConcept<Stream>;\r\n#else\r\ntemplate<typename Stream>\r\nbool ParamsStreamConcept = true;\r\ntemplate<typename Stream>\r\nbool PlainStreamConcept = true;\r\n#endif\r\n\r\n /** Wrapper that overrides the GetParams() function of a stream (and hides GetVersion/GetType). */\r\n template <typename Params, typename SubStream>\r\n class ParamsStream\r\n {\r\n    static_assert(PlainStreamConcept<SubStream>, \"avoid wrapping a ParamsStream in a ParamsStream\");\r\n    SubStream& GetSubStream() { return m_substream; }\r\n```\r\n\r\nor similar if you wanted, which would catch this sort of case via the C++20 CI builds. At present the only lines that violate this rule are `READWRITE(WithParams(ser_params, AsBase<CService>(obj)));` in protocol.h and `Derived::SERIALIZE_METHOD_PARAMS` in serialize_tests.cpp; you need a `GetSubStream` getter to fix those up.",
      "commit_id" : "fa626af3edbe8d98b2de91dd71729ceef90389fb",
      "created_at" : "2023-09-05T13:48:27Z",
      "diff_hunk" : "@@ -1080,4 +1134,61 @@ size_t GetSerializeSizeMany(int nVersion, const T&... t)\n     return sc.size();\n }\n \n+/** Wrapper that overrides the GetParams() function of a stream (and hides GetVersion/GetType). */",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25284#discussion_r1315927911",
      "id" : 1315927911,
      "in_reply_to_id" : 1312914650,
      "line" : 1137,
      "node_id" : "PRRC_kwDOABII585Ob3dn",
      "original_commit_id" : "faec591d64e40ba7ec7656cbfdda1a05953bde13",
      "original_line" : 1137,
      "original_position" : 107,
      "original_start_line" : null,
      "path" : "src/serialize.h",
      "position" : 233,
      "pull_request_review_id" : 1611106328,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25284",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1315927911/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-09-05T13:48:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1315927911",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   }
]
