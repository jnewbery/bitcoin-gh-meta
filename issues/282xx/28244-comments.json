[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [murchandamus](https://github.com/bitcoin/bitcoin/pull/28244#pullrequestreview-1571963217) |\n| Concept ACK | [ariard](https://github.com/bitcoin/bitcoin/pull/28244#pullrequestreview-1570874742), [Sjors](https://github.com/bitcoin/bitcoin/pull/28244#pullrequestreview-1571575185) |\n\nIf your review is incorrectly listed, please react with ð to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#bitcoin-core/gui/650](https://github.com/bitcoin-core/gui/pull/650) (Add Import to Wallet GUI by KolbyML)\n* [#28230](https://github.com/bitcoin/bitcoin/pull/28230) (rpc: Add Arg() default helper by MarcoFalke)\n* [#28200](https://github.com/bitcoin/bitcoin/pull/28200) (refactor: Remove unused includes from wallet.cpp by MarcoFalke)\n* [#28193](https://github.com/bitcoin/bitcoin/pull/28193) (test: add script compression coverage for not-on-curve P2PK outputs by theStack)\n* [#27850](https://github.com/bitcoin/bitcoin/pull/27850) (test: Add unit & functional test coverage for blockstore by pinheadmz)\n* [#27260](https://github.com/bitcoin/bitcoin/pull/27260) (Enhanced error messages for invalid network prefix during address parsing. by russeree)\n* [#26573](https://github.com/bitcoin/bitcoin/pull/26573) (Wallet: don't underestimate the fees when spending a Taproot output by darosior)\n* [#26567](https://github.com/bitcoin/bitcoin/pull/26567) (Wallet: estimate the size of signed inputs using descriptors by darosior)\n* [#26403](https://github.com/bitcoin/bitcoin/pull/26403) (policy: Ephemeral anchors by instagibbs)\n* [#26291](https://github.com/bitcoin/bitcoin/pull/26291) (Update MANDATORY_SCRIPT_VERIFY_FLAGS by ajtowns)\n* [#24128](https://github.com/bitcoin/bitcoin/pull/24128) (wallet: BIP 326 sequence based anti-fee-snipe for taproot inputs by MarcoFalke)\n* [#21283](https://github.com/bitcoin/bitcoin/pull/21283) (Implement BIP 370 PSBTv2 by achow101)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "created_at" : "2023-08-09T11:44:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28244#issuecomment-1671172203",
      "id" : 1671172203,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28244",
      "node_id" : "IC_kwDOABII585jnBBr",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1671172203/reactions"
      },
      "updated_at" : "2023-08-10T14:23:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1671172203",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28244#discussion_r1288431124"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28244"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1288431124"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```bash\r\nsrc/script/solver.h seems to be missing the expected include guard:\r\n  #ifndef BITCOIN_SCRIPT_SOLVER_H\r\n  #define BITCOIN_SCRIPT_SOLVER_H\r\n  ...\r\n  #endif // BITCOIN_SCRIPT_SOLVER_H\r\n```",
      "commit_id" : "3a6e49e80fb6c1a7b0ed792cd0611545df63d3da",
      "created_at" : "2023-08-09T12:48:58Z",
      "diff_hunk" : "@@ -0,0 +1,64 @@\n+// Copyright (c) 2009-2010 Satoshi Nakamoto\n+// Copyright (c) 2009-2022 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_SCRIPT_STANDARD_H",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28244#discussion_r1288431124",
      "id" : 1288431124,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585My-YU",
      "original_commit_id" : "cc898bfb5e937d6a620eafca07b55427461a42c7",
      "original_line" : 6,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/script/solver.h",
      "position" : null,
      "pull_request_review_id" : 1569477051,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28244",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1288431124/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-08-09T12:48:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1288431124",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28244#discussion_r1288456318"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28244"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1288456318"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "3a6e49e80fb6c1a7b0ed792cd0611545df63d3da",
      "created_at" : "2023-08-09T13:08:44Z",
      "diff_hunk" : "@@ -0,0 +1,64 @@\n+// Copyright (c) 2009-2010 Satoshi Nakamoto\n+// Copyright (c) 2009-2022 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_SCRIPT_STANDARD_H",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28244#discussion_r1288456318",
      "id" : 1288456318,
      "in_reply_to_id" : 1288431124,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585MzEh-",
      "original_commit_id" : "cc898bfb5e937d6a620eafca07b55427461a42c7",
      "original_line" : 6,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/script/solver.h",
      "position" : null,
      "pull_request_review_id" : 1569516422,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28244",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1288456318/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-08-09T13:08:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1288456318",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28244#discussion_r1289439494"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28244"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1289439494"
         }
      },
      "author_association" : "MEMBER",
      "body" : "It could be noted what represents a âfailed solveâ is up to the caller. Actually `TxoutType::WITNESS_UNKNOWN` is considered as a failure in `AreInputsStandard`, as witness unknown is a special case of non-standardness for undefined segwit output.",
      "commit_id" : "3a6e49e80fb6c1a7b0ed792cd0611545df63d3da",
      "created_at" : "2023-08-10T01:52:09Z",
      "diff_hunk" : "@@ -0,0 +1,64 @@\n+// Copyright (c) 2009-2010 Satoshi Nakamoto\n+// Copyright (c) 2009-2022 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_SCRIPT_SOLVER_H\n+#define BITCOIN_SCRIPT_SOLVER_H\n+\n+#include <attributes.h>\n+#include <script/script.h>\n+\n+#include <string>\n+#include <optional>\n+#include <utility>\n+#include <vector>\n+\n+class CPubKey;\n+template <typename C> class Span;\n+\n+enum class TxoutType {\n+    NONSTANDARD,\n+    // 'standard' transaction types:\n+    PUBKEY,\n+    PUBKEYHASH,\n+    SCRIPTHASH,\n+    MULTISIG,\n+    NULL_DATA, //!< unspendable OP_RETURN script that carries data\n+    WITNESS_V0_SCRIPTHASH,\n+    WITNESS_V0_KEYHASH,\n+    WITNESS_V1_TAPROOT,\n+    WITNESS_UNKNOWN, //!< Only for Witness versions not already defined above\n+};\n+\n+/** Get the name of a TxoutType as a string */\n+std::string GetTxnOutputType(TxoutType t);\n+\n+constexpr bool IsPushdataOp(opcodetype opcode)\n+{\n+    return opcode > OP_FALSE && opcode <= OP_PUSHDATA4;\n+}\n+\n+/**\n+ * Parse a scriptPubKey and identify script type for standard scripts. If\n+ * successful, returns script type and parsed pubkeys or hashes, depending on\n+ * the type. For example, for a P2SH script, vSolutionsRet will contain the\n+ * script hash, for P2PKH it will contain the key hash, etc.\n+ *\n+ * @param[in]   scriptPubKey   Script to parse\n+ * @param[out]  vSolutionsRet  Vector of parsed pubkeys and hashes\n+ * @return                     The script type. TxoutType::NONSTANDARD represents a failed solve.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28244#discussion_r1289439494",
      "id" : 1289439494,
      "line" : 50,
      "node_id" : "PRRC_kwDOABII585M20kG",
      "original_commit_id" : "3a6e49e80fb6c1a7b0ed792cd0611545df63d3da",
      "original_line" : 50,
      "original_position" : 50,
      "original_start_line" : null,
      "path" : "src/script/solver.h",
      "position" : 50,
      "pull_request_review_id" : 1570874742,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28244",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1289439494/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-08-10T01:52:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1289439494",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Maybe cherry-pick 461259c4ecc1e48d028eaea56061e72a6667ce4f instead of 34aca2d5f26f0441a366942dc56bd220e806d63c. Seems to compile and pass all tests.",
      "created_at" : "2023-08-10T14:40:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28244#issuecomment-1673353862",
      "id" : 1673353862,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28244",
      "node_id" : "IC_kwDOABII585jvVqG",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1673353862/reactions"
      },
      "updated_at" : "2023-08-10T14:40:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1673353862",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   }
]
