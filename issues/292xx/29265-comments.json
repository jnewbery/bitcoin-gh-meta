[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage\nFor detailed information about the code coverage, see the [test coverage report](https://corecheck.dev/bitcoin/bitcoin/pulls/29265).\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#29221](https://github.com/bitcoin/bitcoin/pull/29221) (Implement 64 bit arithmetic op codes in the Script interpreter by Christewart)\n* [#29198](https://github.com/bitcoin/bitcoin/pull/29198) (OP_CHECKTEMPLATEVERIFY, OP_CHECKSIGFROMSTACK(VERIFY), OP_INTERNALKEY validation (LNHANCE) by reardencode)\n* [#29050](https://github.com/bitcoin/bitcoin/pull/29050) (Add OP_TXHASH and OP_CHECKTXHASHVERIFY opcodes by stevenroose)\n* [#28550](https://github.com/bitcoin/bitcoin/pull/28550) (Covenant tools softfork by jamesob)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "created_at" : "2024-01-17T20:44:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29265#issuecomment-1896658574",
      "id" : 1896658574,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29265",
      "node_id" : "IC_kwDOABII585xDLaO",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1896658574/reactions"
      },
      "updated_at" : "2024-01-17T22:39:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1896658574",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29265#discussion_r1456471781"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29265"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1456471781"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "For unknown leaf_versions, do we want to return true by default?",
      "commit_id" : "1498198042ee1b6fe88fcda7b66525a15f358c44",
      "created_at" : "2024-01-17T20:52:36Z",
      "diff_hunk" : "@@ -338,12 +339,15 @@ bool GetScriptOp(CScriptBase::const_iterator& pc, CScriptBase::const_iterator en\n     return true;\n }\n \n-bool IsOpSuccess(const opcodetype& opcode)\n+bool IsOpSuccess(const opcodetype& opcode, uint8_t leaf_version)\n {\n-    return opcode == 80 || opcode == 98 || (opcode >= 126 && opcode <= 129) ||\n+    if (leaf_version == TAPROOT_LEAF_TAPSCRIPT) {\n+        return opcode == 80 || opcode == 98 || (opcode >= 126 && opcode <= 129) ||\n            (opcode >= 131 && opcode <= 134) || (opcode >= 137 && opcode <= 138) ||\n            (opcode >= 141 && opcode <= 142) || (opcode >= 149 && opcode <= 153) ||\n            (opcode >= 187 && opcode <= 254);\n+    }\n+    return true;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29265#discussion_r1456471781",
      "id" : 1456471781,
      "line" : 350,
      "node_id" : "PRRC_kwDOABII585Wz_7l",
      "original_commit_id" : "1498198042ee1b6fe88fcda7b66525a15f358c44",
      "original_line" : 350,
      "original_position" : 22,
      "original_start_line" : null,
      "path" : "src/script/script.cpp",
      "position" : 22,
      "pull_request_review_id" : 1828166850,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29265",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1456471781/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-01-17T20:52:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1456471781",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3514957?v=4",
         "events_url" : "https://api.github.com/users/Christewart/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Christewart/followers",
         "following_url" : "https://api.github.com/users/Christewart/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Christewart/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Christewart",
         "id" : 3514957,
         "login" : "Christewart",
         "node_id" : "MDQ6VXNlcjM1MTQ5NTc=",
         "organizations_url" : "https://api.github.com/users/Christewart/orgs",
         "received_events_url" : "https://api.github.com/users/Christewart/received_events",
         "repos_url" : "https://api.github.com/users/Christewart/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Christewart/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Christewart/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Christewart"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I think you'd want to pass SigVersion rather than leaf_version. The SigVersion defines what script/signature rules are active, while the leaf_version is one of several ways of encoding that information in scripts. It also answers your comment: we don't care about unknown leaf_versions because they will never occur (under an unknown leaf version, no script execution happens at all).\n\nThat said, I think a change like this belongs in the PR that implements a consensus change that needs it. It's generally better not to touch consensus code unless necessary.",
      "created_at" : "2024-01-17T21:43:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29265#issuecomment-1896903940",
      "id" : 1896903940,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29265",
      "node_id" : "IC_kwDOABII585xEHUE",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1896903940/reactions"
      },
      "updated_at" : "2024-01-17T21:43:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1896903940",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> That said, I think a change like this belongs in the PR that implements a consensus change that needs it. It's generally better not \r\nto touch consensus code unless necessary.\r\n\r\nSmall quibble here, there are other consensus PRs out there that probably would need this change ( #29247 , #29050 , #28550 ).\r\n\r\nIts unclear to me right now if I was just \"lucky\" with my opcode byte selection such that I ran into a test case that failed with witness redeemScript (`4edc`). Perhaps the test vectors are exhaustive though, I have not looked closely.\r\n\r\nThat said, if you don't find that argument compelling i will close this in the next few days and add it to #29221 \r\n",
      "created_at" : "2024-01-17T21:51:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29265#issuecomment-1896953936",
      "id" : 1896953936,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29265",
      "node_id" : "IC_kwDOABII585xEThQ",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1896953936/reactions"
      },
      "updated_at" : "2024-01-17T21:51:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1896953936",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3514957?v=4",
         "events_url" : "https://api.github.com/users/Christewart/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Christewart/followers",
         "following_url" : "https://api.github.com/users/Christewart/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Christewart/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Christewart",
         "id" : 3514957,
         "login" : "Christewart",
         "node_id" : "MDQ6VXNlcjM1MTQ5NTc=",
         "organizations_url" : "https://api.github.com/users/Christewart/orgs",
         "received_events_url" : "https://api.github.com/users/Christewart/received_events",
         "repos_url" : "https://api.github.com/users/Christewart/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Christewart/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Christewart/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Christewart"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--85328a0da195eb286784d51f73fa0af9-->\n\nð§ At least one of the CI tasks failed. Make sure to run all tests locally, according to the\ndocumentation.\n\nPossibly this is due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n<sub>Debug: https://github.com/bitcoin/bitcoin/runs/20590106339</sub>",
      "created_at" : "2024-01-17T22:12:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29265#issuecomment-1897075746",
      "id" : 1897075746,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29265",
      "node_id" : "IC_kwDOABII585xExQi",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1897075746/reactions"
      },
      "updated_at" : "2024-01-17T22:12:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1897075746",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   }
]
