[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage\nFor detailed information about the code coverage, see the [test coverage report](https://corecheck.dev/bitcoin/bitcoin/pulls/29939).\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept ACK | [glozow](https://github.com/bitcoin/bitcoin/pull/29939#issuecomment-2072442023), [ismaelsadeeq](https://github.com/bitcoin/bitcoin/pull/29939#pullrequestreview-2017794758), [brunoerg](https://github.com/bitcoin/bitcoin/pull/29939#issuecomment-2079566994) |\n\nIf your review is incorrectly listed, please react with ð to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#29371](https://github.com/bitcoin/bitcoin/pull/29371) (test: Add `leaf_version` parameter to `taproot_tree_helper()` by Christewart)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "created_at" : "2024-04-23T11:13:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29939#issuecomment-2072029327",
      "id" : 2072029327,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29939",
      "node_id" : "IC_kwDOABII5857gKiP",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2072029327/reactions"
      },
      "updated_at" : "2024-04-26T15:01:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2072029327",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Nice, concept ACK",
      "created_at" : "2024-04-23T14:19:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29939#issuecomment-2072442023",
      "id" : 2072442023,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29939",
      "node_id" : "IC_kwDOABII5857hvSn",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2072442023/reactions"
      },
      "updated_at" : "2024-04-23T14:19:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2072442023",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK",
      "created_at" : "2024-04-26T15:01:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29939#issuecomment-2079566994",
      "id" : 2079566994,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29939",
      "node_id" : "IC_kwDOABII585786yS",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2079566994/reactions"
      },
      "updated_at" : "2024-04-26T15:01:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2079566994",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19480819?v=4",
         "events_url" : "https://api.github.com/users/brunoerg/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brunoerg/followers",
         "following_url" : "https://api.github.com/users/brunoerg/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brunoerg/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brunoerg",
         "id" : 19480819,
         "login" : "brunoerg",
         "node_id" : "MDQ6VXNlcjE5NDgwODE5",
         "organizations_url" : "https://api.github.com/users/brunoerg/orgs",
         "received_events_url" : "https://api.github.com/users/brunoerg/received_events",
         "repos_url" : "https://api.github.com/users/brunoerg/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brunoerg/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brunoerg/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brunoerg"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29939#discussion_r1584437933"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29939"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1584437933"
         }
      },
      "author_association" : "MEMBER",
      "body" : "901ffa9e6e57f7c0e0db967fba9c715139bbcf0b nit: did you mean ephemeral? (also in commit message)",
      "commit_id" : "5bb2cb9a92c92c1da715fb6471ae20d28512f5e9",
      "created_at" : "2024-04-30T09:23:57Z",
      "diff_hunk" : "@@ -25,8 +28,8 @@ def fill_mempool(test_framework, node, miniwallet):\n     It will not ensure mempools become synced as it\n     is based on a single node and assumes -minrelaytxfee\n     is 1 sat/vbyte.\n-    To avoid unintentional tx dependencies, it is recommended to use separate miniwallets for\n-    mempool filling vs transactions in tests.\n+    To avoid unintentional tx dependencies, the mempool filling txs are created with a\n+    separate tagged ephermal miniwallet instance.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29939#discussion_r1584437933",
      "id" : 1584437933,
      "line" : 32,
      "node_id" : "PRRC_kwDOABII585ecJqt",
      "original_commit_id" : "901ffa9e6e57f7c0e0db967fba9c715139bbcf0b",
      "original_line" : 32,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/mempool_util.py",
      "position" : 32,
      "pull_request_review_id" : 2030752389,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29939",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1584437933/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-30T09:28:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1584437933",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29939#discussion_r1584441713"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29939"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1584441713"
         }
      },
      "author_association" : "MEMBER",
      "body" : "901ffa9e6e57f7c0e0db967fba9c715139bbcf0b shouldn't this be sent from the ephemeral miniwallet?",
      "commit_id" : "5bb2cb9a92c92c1da715fb6471ae20d28512f5e9",
      "created_at" : "2024-04-30T09:26:12Z",
      "diff_hunk" : "@@ -39,19 +42,16 @@ def fill_mempool(test_framework, node, miniwallet):\n     # Generate UTXOs to flood the mempool\n     # 1 to create a tx initially that will be evicted from the mempool later\n     # 75 transactions each with a fee rate higher than the previous one\n-    test_framework.generate(miniwallet, 1 + (num_of_batches * tx_batch_size))\n+    ephermal_miniwallet = MiniWallet(node, tag_name=\"fill_mempool_ephermal_wallet\")\n+    assert ephermal_miniwallet.get_scriptPubKey() != miniwallet.get_scriptPubKey()\n+    test_framework.generate(miniwallet, 1)\n+    test_framework.generate(ephermal_miniwallet, num_of_batches * tx_batch_size)\n \n     # Mine enough blocks so that the UTXOs are allowed to be spent\n     test_framework.generate(node, COINBASE_MATURITY - 1)\n \n-    # Get all UTXOs up front to ensure none of the transactions spend from each other, as that may\n-    # change their effective feerate and thus the order in which they are selected for eviction.\n-    confirmed_utxos = [miniwallet.get_utxo(confirmed_only=True) for _ in range(num_of_batches * tx_batch_size + 1)]\n-    assert_equal(len(confirmed_utxos), num_of_batches * tx_batch_size + 1)\n-\n     test_framework.log.debug(\"Create a mempool tx that will be evicted\")\n-    tx_to_be_evicted_id = miniwallet.send_self_transfer(from_node=node, utxo_to_spend=confirmed_utxos[0], fee_rate=relayfee)[\"txid\"]\n-    del confirmed_utxos[0]\n+    tx_to_be_evicted_id = miniwallet.send_self_transfer(from_node=node, fee_rate=relayfee)[\"txid\"]",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29939#discussion_r1584441713",
      "id" : 1584441713,
      "line" : 54,
      "node_id" : "PRRC_kwDOABII585ecKlx",
      "original_commit_id" : "901ffa9e6e57f7c0e0db967fba9c715139bbcf0b",
      "original_line" : 54,
      "original_position" : 42,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/mempool_util.py",
      "position" : 54,
      "pull_request_review_id" : 2030752389,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29939",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1584441713/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-30T09:28:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1584441713",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29939#discussion_r1584443662"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29939"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1584443662"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Also I was imagining that, with the ephemeral miniwallet, we can just delete the `miniwallet` param",
      "commit_id" : "5bb2cb9a92c92c1da715fb6471ae20d28512f5e9",
      "created_at" : "2024-04-30T09:27:29Z",
      "diff_hunk" : "@@ -39,19 +42,16 @@ def fill_mempool(test_framework, node, miniwallet):\n     # Generate UTXOs to flood the mempool\n     # 1 to create a tx initially that will be evicted from the mempool later\n     # 75 transactions each with a fee rate higher than the previous one\n-    test_framework.generate(miniwallet, 1 + (num_of_batches * tx_batch_size))\n+    ephermal_miniwallet = MiniWallet(node, tag_name=\"fill_mempool_ephermal_wallet\")\n+    assert ephermal_miniwallet.get_scriptPubKey() != miniwallet.get_scriptPubKey()\n+    test_framework.generate(miniwallet, 1)\n+    test_framework.generate(ephermal_miniwallet, num_of_batches * tx_batch_size)\n \n     # Mine enough blocks so that the UTXOs are allowed to be spent\n     test_framework.generate(node, COINBASE_MATURITY - 1)\n \n-    # Get all UTXOs up front to ensure none of the transactions spend from each other, as that may\n-    # change their effective feerate and thus the order in which they are selected for eviction.\n-    confirmed_utxos = [miniwallet.get_utxo(confirmed_only=True) for _ in range(num_of_batches * tx_batch_size + 1)]\n-    assert_equal(len(confirmed_utxos), num_of_batches * tx_batch_size + 1)\n-\n     test_framework.log.debug(\"Create a mempool tx that will be evicted\")\n-    tx_to_be_evicted_id = miniwallet.send_self_transfer(from_node=node, utxo_to_spend=confirmed_utxos[0], fee_rate=relayfee)[\"txid\"]\n-    del confirmed_utxos[0]\n+    tx_to_be_evicted_id = miniwallet.send_self_transfer(from_node=node, fee_rate=relayfee)[\"txid\"]",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29939#discussion_r1584443662",
      "id" : 1584443662,
      "in_reply_to_id" : 1584441713,
      "line" : 54,
      "node_id" : "PRRC_kwDOABII585ecLEO",
      "original_commit_id" : "901ffa9e6e57f7c0e0db967fba9c715139bbcf0b",
      "original_line" : 54,
      "original_position" : 42,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/mempool_util.py",
      "position" : 54,
      "pull_request_review_id" : 2030752389,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29939",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1584443662/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-30T09:28:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1584443662",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29939#discussion_r1585154706"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29939"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1585154706"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Ugh indeed, apparently I've used a word for several years without noticing that it doesn't exist (mostly in \"ephermal port\") :D fixed.",
      "commit_id" : "45bf7dba025b27916f5c4c4a385340006b62cd38",
      "created_at" : "2024-04-30T16:19:09Z",
      "diff_hunk" : "@@ -25,8 +28,8 @@ def fill_mempool(test_framework, node, miniwallet):\n     It will not ensure mempools become synced as it\n     is based on a single node and assumes -minrelaytxfee\n     is 1 sat/vbyte.\n-    To avoid unintentional tx dependencies, it is recommended to use separate miniwallets for\n-    mempool filling vs transactions in tests.\n+    To avoid unintentional tx dependencies, the mempool filling txs are created with a\n+    separate tagged ephermal miniwallet instance.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29939#discussion_r1585154706",
      "id" : 1585154706,
      "in_reply_to_id" : 1584437933,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585ee4qS",
      "original_commit_id" : "901ffa9e6e57f7c0e0db967fba9c715139bbcf0b",
      "original_line" : 32,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/mempool_util.py",
      "position" : null,
      "pull_request_review_id" : 2031935909,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29939",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1585154706/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-30T16:19:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1585154706",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29939#discussion_r1585154931"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29939"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1585154931"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "> [901ffa9](https://github.com/bitcoin/bitcoin/commit/901ffa9e6e57f7c0e0db967fba9c715139bbcf0b) shouldn't this be sent from the ephemeral miniwallet?\r\n\r\nIf the to-be-evicted tx and the filling txs originate from the same miniwallet instance, the problem fixed by e9dc511a7e9a562f953ff93f358102f555f583e6 is unfortunately re-introduced, as it could happen again that a filler tx spends from the to-be-evicted tx, increasing its' effective fee-rate and thus avoiding the expected eviction (making the assertion `assert tx_to_be_evicted_id not in node.getrawmempool()` fail; this happens at least for the `mempool_limit.py` functional test) :/ \r\n\r\n> Also I was imagining that, with the ephemeral miniwallet, we can just delete the miniwallet param\r\n\r\nAgree that it would be nice to get completely rid of the `miniwallet` param. We could use _two_ ephemeral MiniWallet instances though (one for the to-be-evicted test tx, one for the filling txs), happy to change if that is preferred.",
      "commit_id" : "45bf7dba025b27916f5c4c4a385340006b62cd38",
      "created_at" : "2024-04-30T16:19:20Z",
      "diff_hunk" : "@@ -39,19 +42,16 @@ def fill_mempool(test_framework, node, miniwallet):\n     # Generate UTXOs to flood the mempool\n     # 1 to create a tx initially that will be evicted from the mempool later\n     # 75 transactions each with a fee rate higher than the previous one\n-    test_framework.generate(miniwallet, 1 + (num_of_batches * tx_batch_size))\n+    ephermal_miniwallet = MiniWallet(node, tag_name=\"fill_mempool_ephermal_wallet\")\n+    assert ephermal_miniwallet.get_scriptPubKey() != miniwallet.get_scriptPubKey()\n+    test_framework.generate(miniwallet, 1)\n+    test_framework.generate(ephermal_miniwallet, num_of_batches * tx_batch_size)\n \n     # Mine enough blocks so that the UTXOs are allowed to be spent\n     test_framework.generate(node, COINBASE_MATURITY - 1)\n \n-    # Get all UTXOs up front to ensure none of the transactions spend from each other, as that may\n-    # change their effective feerate and thus the order in which they are selected for eviction.\n-    confirmed_utxos = [miniwallet.get_utxo(confirmed_only=True) for _ in range(num_of_batches * tx_batch_size + 1)]\n-    assert_equal(len(confirmed_utxos), num_of_batches * tx_batch_size + 1)\n-\n     test_framework.log.debug(\"Create a mempool tx that will be evicted\")\n-    tx_to_be_evicted_id = miniwallet.send_self_transfer(from_node=node, utxo_to_spend=confirmed_utxos[0], fee_rate=relayfee)[\"txid\"]\n-    del confirmed_utxos[0]\n+    tx_to_be_evicted_id = miniwallet.send_self_transfer(from_node=node, fee_rate=relayfee)[\"txid\"]",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29939#discussion_r1585154931",
      "id" : 1585154931,
      "in_reply_to_id" : 1584441713,
      "line" : 54,
      "node_id" : "PRRC_kwDOABII585ee4tz",
      "original_commit_id" : "901ffa9e6e57f7c0e0db967fba9c715139bbcf0b",
      "original_line" : 54,
      "original_position" : 42,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/mempool_util.py",
      "position" : 54,
      "pull_request_review_id" : 2031936273,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29939",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1585154931/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-30T16:19:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1585154931",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29939#discussion_r1585186363"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29939"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1585186363"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Not 100% related to these change, but`fill_mempool` requires -datacarriersize=100000 and -maxmempool=5 and in `rpc_packages` test, this is mentioned:\r\n```py\r\n# Make chain of two transactions where parent doesn't make minfee threshold\r\n# but child is too high fee\r\n# Lower mempool limit to make it easier to fill_mempool\r\nself.restart_node(0, extra_args=[\r\n    \"-datacarriersize=100000\",\r\n    \"-maxmempool=5\",\r\n    \"-persistmempool=0\",\r\n])\r\n```\r\n\r\nPerhaps, it would worth to also mention it in `mempool_limit`?",
      "commit_id" : "45bf7dba025b27916f5c4c4a385340006b62cd38",
      "created_at" : "2024-04-30T16:41:38Z",
      "diff_hunk" : "@@ -6,14 +6,16 @@\n \n from decimal import Decimal\n \n+from test_framework.mempool_util import (\n+    fill_mempool,",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29939#discussion_r1585186363",
      "id" : 1585186363,
      "line" : 10,
      "node_id" : "PRRC_kwDOABII585efAY7",
      "original_commit_id" : "45bf7dba025b27916f5c4c4a385340006b62cd38",
      "original_line" : 10,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "test/functional/mempool_limit.py",
      "position" : 5,
      "pull_request_review_id" : 2031989252,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29939",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1585186363/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-30T16:41:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1585186363",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19480819?v=4",
         "events_url" : "https://api.github.com/users/brunoerg/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brunoerg/followers",
         "following_url" : "https://api.github.com/users/brunoerg/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brunoerg/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brunoerg",
         "id" : 19480819,
         "login" : "brunoerg",
         "node_id" : "MDQ6VXNlcjE5NDgwODE5",
         "organizations_url" : "https://api.github.com/users/brunoerg/orgs",
         "received_events_url" : "https://api.github.com/users/brunoerg/received_events",
         "repos_url" : "https://api.github.com/users/brunoerg/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brunoerg/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brunoerg/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brunoerg"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29939#discussion_r1587963767"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29939"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1587963767"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Could also continue to get all the UTXOs up front?",
      "commit_id" : "45bf7dba025b27916f5c4c4a385340006b62cd38",
      "created_at" : "2024-05-02T16:47:29Z",
      "diff_hunk" : "@@ -39,19 +42,16 @@ def fill_mempool(test_framework, node, miniwallet):\n     # Generate UTXOs to flood the mempool\n     # 1 to create a tx initially that will be evicted from the mempool later\n     # 75 transactions each with a fee rate higher than the previous one\n-    test_framework.generate(miniwallet, 1 + (num_of_batches * tx_batch_size))\n+    ephermal_miniwallet = MiniWallet(node, tag_name=\"fill_mempool_ephermal_wallet\")\n+    assert ephermal_miniwallet.get_scriptPubKey() != miniwallet.get_scriptPubKey()\n+    test_framework.generate(miniwallet, 1)\n+    test_framework.generate(ephermal_miniwallet, num_of_batches * tx_batch_size)\n \n     # Mine enough blocks so that the UTXOs are allowed to be spent\n     test_framework.generate(node, COINBASE_MATURITY - 1)\n \n-    # Get all UTXOs up front to ensure none of the transactions spend from each other, as that may\n-    # change their effective feerate and thus the order in which they are selected for eviction.\n-    confirmed_utxos = [miniwallet.get_utxo(confirmed_only=True) for _ in range(num_of_batches * tx_batch_size + 1)]\n-    assert_equal(len(confirmed_utxos), num_of_batches * tx_batch_size + 1)\n-\n     test_framework.log.debug(\"Create a mempool tx that will be evicted\")\n-    tx_to_be_evicted_id = miniwallet.send_self_transfer(from_node=node, utxo_to_spend=confirmed_utxos[0], fee_rate=relayfee)[\"txid\"]\n-    del confirmed_utxos[0]\n+    tx_to_be_evicted_id = miniwallet.send_self_transfer(from_node=node, fee_rate=relayfee)[\"txid\"]",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29939#discussion_r1587963767",
      "id" : 1587963767,
      "in_reply_to_id" : 1584441713,
      "line" : 54,
      "node_id" : "PRRC_kwDOABII585epmd3",
      "original_commit_id" : "901ffa9e6e57f7c0e0db967fba9c715139bbcf0b",
      "original_line" : 54,
      "original_position" : 42,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/mempool_util.py",
      "position" : 54,
      "pull_request_review_id" : 2036297749,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29939",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1587963767/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-05-02T16:47:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1587963767",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--85328a0da195eb286784d51f73fa0af9-->\n\nð§ At least one of the CI tasks failed. Make sure to run all tests locally, according to the\ndocumentation.\n\nPossibly this is due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n<sub>Debug: https://github.com/bitcoin/bitcoin/runs/24434826323</sub>",
      "created_at" : "2024-05-04T02:37:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29939#issuecomment-2093968628",
      "id" : 2093968628,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29939",
      "node_id" : "IC_kwDOABII5858z2z0",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2093968628/reactions"
      },
      "updated_at" : "2024-05-04T02:37:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2093968628",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   }
]
