[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage\nFor detailed information about the code coverage, see the [test coverage report](https://corecheck.dev/bitcoin/bitcoin/pulls/29904).\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept NACK | [luke-jr](https://github.com/bitcoin/bitcoin/pull/29904#issuecomment-2067871490) |\n| Concept ACK | [TheCharlatan](https://github.com/bitcoin/bitcoin/pull/29904#issuecomment-2063858822), [theStack](https://github.com/bitcoin/bitcoin/pull/29904#issuecomment-2073028810) |\n| Approach ACK | [hebasto](https://github.com/bitcoin/bitcoin/pull/29904#pullrequestreview-2016884640) |\n| Stale ACK | [Sjors](https://github.com/bitcoin/bitcoin/pull/29904#pullrequestreview-2010862632), [stickies-v](https://github.com/bitcoin/bitcoin/pull/29904#pullrequestreview-2017977113), [laanwj](https://github.com/bitcoin/bitcoin/pull/29904#pullrequestreview-2018558155) |\n\nIf your review is incorrectly listed, please react with ð to this comment and the bot will ignore it on the next update.\n",
      "created_at" : "2024-04-18T13:06:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#issuecomment-2063825450",
      "id" : 2063825450,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29904",
      "node_id" : "IC_kwDOABII5857A3oq",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2063825450/reactions"
      },
      "updated_at" : "2024-04-24T14:36:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2063825450",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK\r\nyes please... the hooking we do for `URL_DECODE` and `UrlDecodeFn` made me kind of scared, to be honest (in that context), i think can we get rid of that at the same time?\r\n\r\nThis will also fix @luke-jr's #29654.",
      "created_at" : "2024-04-18T13:11:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#issuecomment-2063835209",
      "id" : 2063835209,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29904",
      "node_id" : "IC_kwDOABII5857A6BJ",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 2,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 2,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2063835209/reactions"
      },
      "updated_at" : "2024-04-18T13:11:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2063835209",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK",
      "created_at" : "2024-04-18T13:22:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#issuecomment-2063858822",
      "id" : 2063858822,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29904",
      "node_id" : "IC_kwDOABII5857A_yG",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2063858822/reactions"
      },
      "updated_at" : "2024-04-18T13:22:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2063858822",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8421793?v=4",
         "events_url" : "https://api.github.com/users/TheCharlatan/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheCharlatan/followers",
         "following_url" : "https://api.github.com/users/TheCharlatan/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheCharlatan/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheCharlatan",
         "id" : 8421793,
         "login" : "TheCharlatan",
         "node_id" : "MDQ6VXNlcjg0MjE3OTM=",
         "organizations_url" : "https://api.github.com/users/TheCharlatan/orgs",
         "received_events_url" : "https://api.github.com/users/TheCharlatan/received_events",
         "repos_url" : "https://api.github.com/users/TheCharlatan/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheCharlatan/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheCharlatan/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheCharlatan"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK",
      "created_at" : "2024-04-18T13:54:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#issuecomment-2063926648",
      "id" : 2063926648,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29904",
      "node_id" : "IC_kwDOABII5857BQV4",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2063926648/reactions"
      },
      "updated_at" : "2024-04-18T13:54:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2063926648",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK.",
      "created_at" : "2024-04-18T15:18:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#issuecomment-2064197562",
      "id" : 2064197562,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29904",
      "node_id" : "IC_kwDOABII5857CSe6",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2064197562/reactions"
      },
      "updated_at" : "2024-04-18T15:18:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2064197562",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1571038503"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1571038503"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit\r\n```suggestion\r\n    BOOST_CHECK_EQUAL(urlDecode(encoded), result);\r\n```",
      "commit_id" : "2447bc7774edcc3f0ac92a41d4a7a30dde663da0",
      "created_at" : "2024-04-18T16:12:09Z",
      "diff_hunk" : "@@ -0,0 +1,46 @@\n+// Copyright (c) 2024 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <test/util/setup_common.h>\n+#include <common/url.h>\n+\n+#include <string>\n+\n+#include <boost/test/unit_test.hpp>\n+\n+BOOST_AUTO_TEST_SUITE(common_url_tests)\n+\n+// These test vectors were ported from test/regress.c in the libevent library\n+// which used to be a dependency of the urlDecode function.\n+\n+BOOST_AUTO_TEST_CASE(encode_decode_test) {\n+    BOOST_CHECK_EQUAL(urlDecode(\"Hello\"), \"Hello\");\n+    BOOST_CHECK_EQUAL(urlDecode(\"99\"), \"99\");\n+    BOOST_CHECK_EQUAL(urlDecode(\"\"), \"\");\n+    BOOST_CHECK_EQUAL(urlDecode(\"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ123456789-.~_\"),\n+                      \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ123456789-.~_\");\n+    BOOST_CHECK_EQUAL(urlDecode(\"%20\"), \" \");\n+    BOOST_CHECK_EQUAL(urlDecode(\"%FF%F0%E0\"), \"\\xff\\xf0\\xe0\");\n+    BOOST_CHECK_EQUAL(urlDecode(\"%01%19\"), \"\\x01\\x19\");\n+    BOOST_CHECK_EQUAL(urlDecode(\"http%3A%2F%2Fwww.ietf.org%2Frfc%2Frfc3986.txt\"),\n+                      \"http://www.ietf.org/rfc/rfc3986.txt\");\n+    BOOST_CHECK_EQUAL(urlDecode(\"1%2B2%3D3\"), \"1+2=3\");\n+}\n+\n+BOOST_AUTO_TEST_CASE(decode_malformed_test) {\n+    BOOST_CHECK_EQUAL(urlDecode(\"%%xhello th+ere \\xff\"), \"%%xhello th+ere \\xff\");\n+}\n+\n+BOOST_AUTO_TEST_CASE(decode_lowercase_hex_test) {\n+    BOOST_CHECK_EQUAL(urlDecode(\"%f0%a0%b0\"), \"\\xf0\\xa0\\xb0\");\n+}\n+\n+BOOST_AUTO_TEST_CASE(decode_internal_nuls_test) {\n+    std::string result{\"\\0\\0x\\0\\0\", 5};\n+    std::string encoded{\"%00%00x%00%00\"};\n+    BOOST_CHECK_EQUAL(urlDecode(encoded).size(), 5);\n+    BOOST_CHECK(urlDecode(encoded) == result);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1571038503",
      "id" : 1571038503,
      "line" : 43,
      "node_id" : "PRRC_kwDOABII585dpCUn",
      "original_commit_id" : "2447bc7774edcc3f0ac92a41d4a7a30dde663da0",
      "original_line" : 43,
      "original_position" : 43,
      "original_start_line" : null,
      "path" : "src/test/common_url_tests.cpp",
      "position" : 43,
      "pull_request_review_id" : 2009339803,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1571038503/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-18T16:46:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1571038503",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1571059431"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1571059431"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "We didn't use [plus decoding](https://github.com/libevent/libevent/blob/e0a4574ba2cbcdb64bb2b593e72be7f7f4010746/http.c#L3505) with `evhttp_uridecode`, so this implementation keeps functionality the same. Since `urlDecode` is a generic utility function, I think there should be a docstring that highlights that this implementation doesn't decode `+` to ` ` in case it's used for other purposes in the future.",
      "commit_id" : "2447bc7774edcc3f0ac92a41d4a7a30dde663da0",
      "created_at" : "2024-04-18T16:29:13Z",
      "diff_hunk" : "@@ -4,19 +4,33 @@\n \n #include <common/url.h>\n \n-#include <event2/http.h>\n-\n-#include <cstdlib>\n #include <string>\n+#include <stdexcept>\n+#include <charconv>\n \n-std::string urlDecode(const std::string &urlEncoded) {\n+std::string urlDecode(const std::string& urlEncoded) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1571059431",
      "id" : 1571059431,
      "line" : 11,
      "node_id" : "PRRC_kwDOABII585dpHbn",
      "original_commit_id" : "2447bc7774edcc3f0ac92a41d4a7a30dde663da0",
      "original_line" : 11,
      "original_position" : 12,
      "original_start_line" : null,
      "path" : "src/common/url.cpp",
      "position" : 12,
      "pull_request_review_id" : 2009339803,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1571059431/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-18T16:46:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1571059431",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1571063727"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1571063727"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "What's the rationale for continuing here? Should we accept invalid URLs? At first sight, I think I'd prefer having this return a `util::Result` and have the function fail in case of missing hex digits or invalid hex?",
      "commit_id" : "2447bc7774edcc3f0ac92a41d4a7a30dde663da0",
      "created_at" : "2024-04-18T16:33:02Z",
      "diff_hunk" : "@@ -4,19 +4,33 @@\n \n #include <common/url.h>\n \n-#include <event2/http.h>\n-\n-#include <cstdlib>\n #include <string>\n+#include <stdexcept>\n+#include <charconv>\n \n-std::string urlDecode(const std::string &urlEncoded) {\n+std::string urlDecode(const std::string& urlEncoded) {\n     std::string res;\n-    if (!urlEncoded.empty()) {\n-        char *decoded = evhttp_uridecode(urlEncoded.c_str(), false, nullptr);\n-        if (decoded) {\n-            res = std::string(decoded);\n-            free(decoded);\n+    res.reserve(urlEncoded.size());\n+\n+    for (size_t i = 0; i < urlEncoded.size(); ++i) {\n+        char c = urlEncoded[i];\n+        // Special handling for percent which should be followed by two hex digits\n+        // representing an octet values, see RFC 3986, Section 2.1 Percent-Encoding\n+        if (c == '%' && i + 2 < urlEncoded.size()) {\n+            int decoded_value = 0;\n+            auto [ptr, ec] = std::from_chars(&urlEncoded[i + 1], &urlEncoded[i + 3], decoded_value, 16);\n+            if (ec == std::errc()) {\n+                res += static_cast<char>(decoded_value);\n+                // Next two characters are part of the percent encoding\n+                i += 2;\n+            } else {\n+                // In case of invalid percent encoding, add the '%' and continue",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1571063727",
      "id" : 1571063727,
      "line" : 27,
      "node_id" : "PRRC_kwDOABII585dpIev",
      "original_commit_id" : "2447bc7774edcc3f0ac92a41d4a7a30dde663da0",
      "original_line" : 27,
      "original_position" : 33,
      "original_start_line" : null,
      "path" : "src/common/url.cpp",
      "position" : 33,
      "pull_request_review_id" : 2009339803,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1571063727/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-18T16:46:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1571063727",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Addressed @laanwj 's comment and removed the hooking.\r\n\r\nFWIW, I wondered for a moment why this is in common and not util but that was a conscious decision, see #26294.\r\n\r\n> yes please... the hooking we do for `URL_DECODE` and `UrlDecodeFn` made me kind of scared, to be honest (in that context), i think can we get rid of that at the same time?\r\n\r\nAbsolutely, I hadn't even seen that yet. For reviewers that wonder as well, the point of this was to not have the wallet depend on `libevent`, see #18504.\r\n\r\n> This will also fix @luke-jr's #29654.\r\n\r\nNice, I also missed that one!\r\n\r\n",
      "created_at" : "2024-04-18T18:37:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#issuecomment-2064887943",
      "id" : 2064887943,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29904",
      "node_id" : "IC_kwDOABII5857E7CH",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2064887943/reactions"
      },
      "updated_at" : "2024-04-18T18:37:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2064887943",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1571211295"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1571211295"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I also found this a bit strange but it's the behavior of libevent and they even have an explicit test case for this (which failed when I wrote my initial implementation). I didn't investigate this further yet but I think the safest option is to keep this a pure refactor for now.",
      "commit_id" : "68bf6c82fee917756b367db4e99a8f6bcb6476bf",
      "created_at" : "2024-04-18T18:44:37Z",
      "diff_hunk" : "@@ -4,19 +4,33 @@\n \n #include <common/url.h>\n \n-#include <event2/http.h>\n-\n-#include <cstdlib>\n #include <string>\n+#include <stdexcept>\n+#include <charconv>\n \n-std::string urlDecode(const std::string &urlEncoded) {\n+std::string urlDecode(const std::string& urlEncoded) {\n     std::string res;\n-    if (!urlEncoded.empty()) {\n-        char *decoded = evhttp_uridecode(urlEncoded.c_str(), false, nullptr);\n-        if (decoded) {\n-            res = std::string(decoded);\n-            free(decoded);\n+    res.reserve(urlEncoded.size());\n+\n+    for (size_t i = 0; i < urlEncoded.size(); ++i) {\n+        char c = urlEncoded[i];\n+        // Special handling for percent which should be followed by two hex digits\n+        // representing an octet values, see RFC 3986, Section 2.1 Percent-Encoding\n+        if (c == '%' && i + 2 < urlEncoded.size()) {\n+            int decoded_value = 0;\n+            auto [ptr, ec] = std::from_chars(&urlEncoded[i + 1], &urlEncoded[i + 3], decoded_value, 16);\n+            if (ec == std::errc()) {\n+                res += static_cast<char>(decoded_value);\n+                // Next two characters are part of the percent encoding\n+                i += 2;\n+            } else {\n+                // In case of invalid percent encoding, add the '%' and continue",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1571211295",
      "id" : 1571211295,
      "in_reply_to_id" : 1571063727,
      "line" : 27,
      "node_id" : "PRRC_kwDOABII585dpsgf",
      "original_commit_id" : "2447bc7774edcc3f0ac92a41d4a7a30dde663da0",
      "original_line" : 27,
      "original_position" : 33,
      "original_start_line" : null,
      "path" : "src/common/url.cpp",
      "position" : 33,
      "pull_request_review_id" : 2009628589,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1571211295/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-18T19:30:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1571211295",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1571252576"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1571252576"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "done",
      "commit_id" : "68bf6c82fee917756b367db4e99a8f6bcb6476bf",
      "created_at" : "2024-04-18T19:19:11Z",
      "diff_hunk" : "@@ -0,0 +1,46 @@\n+// Copyright (c) 2024 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <test/util/setup_common.h>\n+#include <common/url.h>\n+\n+#include <string>\n+\n+#include <boost/test/unit_test.hpp>\n+\n+BOOST_AUTO_TEST_SUITE(common_url_tests)\n+\n+// These test vectors were ported from test/regress.c in the libevent library\n+// which used to be a dependency of the urlDecode function.\n+\n+BOOST_AUTO_TEST_CASE(encode_decode_test) {\n+    BOOST_CHECK_EQUAL(urlDecode(\"Hello\"), \"Hello\");\n+    BOOST_CHECK_EQUAL(urlDecode(\"99\"), \"99\");\n+    BOOST_CHECK_EQUAL(urlDecode(\"\"), \"\");\n+    BOOST_CHECK_EQUAL(urlDecode(\"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ123456789-.~_\"),\n+                      \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ123456789-.~_\");\n+    BOOST_CHECK_EQUAL(urlDecode(\"%20\"), \" \");\n+    BOOST_CHECK_EQUAL(urlDecode(\"%FF%F0%E0\"), \"\\xff\\xf0\\xe0\");\n+    BOOST_CHECK_EQUAL(urlDecode(\"%01%19\"), \"\\x01\\x19\");\n+    BOOST_CHECK_EQUAL(urlDecode(\"http%3A%2F%2Fwww.ietf.org%2Frfc%2Frfc3986.txt\"),\n+                      \"http://www.ietf.org/rfc/rfc3986.txt\");\n+    BOOST_CHECK_EQUAL(urlDecode(\"1%2B2%3D3\"), \"1+2=3\");\n+}\n+\n+BOOST_AUTO_TEST_CASE(decode_malformed_test) {\n+    BOOST_CHECK_EQUAL(urlDecode(\"%%xhello th+ere \\xff\"), \"%%xhello th+ere \\xff\");\n+}\n+\n+BOOST_AUTO_TEST_CASE(decode_lowercase_hex_test) {\n+    BOOST_CHECK_EQUAL(urlDecode(\"%f0%a0%b0\"), \"\\xf0\\xa0\\xb0\");\n+}\n+\n+BOOST_AUTO_TEST_CASE(decode_internal_nuls_test) {\n+    std::string result{\"\\0\\0x\\0\\0\", 5};\n+    std::string encoded{\"%00%00x%00%00\"};\n+    BOOST_CHECK_EQUAL(urlDecode(encoded).size(), 5);\n+    BOOST_CHECK(urlDecode(encoded) == result);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1571252576",
      "id" : 1571252576,
      "in_reply_to_id" : 1571038503,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585dp2lg",
      "original_commit_id" : "2447bc7774edcc3f0ac92a41d4a7a30dde663da0",
      "original_line" : 43,
      "original_position" : 43,
      "original_start_line" : null,
      "path" : "src/test/common_url_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 2009695056,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1571252576/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-18T19:19:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1571252576",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1571252651"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1571252651"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Added a short docstring.",
      "commit_id" : "68bf6c82fee917756b367db4e99a8f6bcb6476bf",
      "created_at" : "2024-04-18T19:19:16Z",
      "diff_hunk" : "@@ -4,19 +4,33 @@\n \n #include <common/url.h>\n \n-#include <event2/http.h>\n-\n-#include <cstdlib>\n #include <string>\n+#include <stdexcept>\n+#include <charconv>\n \n-std::string urlDecode(const std::string &urlEncoded) {\n+std::string urlDecode(const std::string& urlEncoded) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1571252651",
      "id" : 1571252651,
      "in_reply_to_id" : 1571059431,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585dp2mr",
      "original_commit_id" : "2447bc7774edcc3f0ac92a41d4a7a30dde663da0",
      "original_line" : 11,
      "original_position" : 12,
      "original_start_line" : null,
      "path" : "src/common/url.cpp",
      "position" : null,
      "pull_request_review_id" : 2009695164,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1571252651/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-18T19:19:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1571252651",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Addressed @stickies-v 's feedback as well, thanks a lot!",
      "created_at" : "2024-04-18T19:20:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#issuecomment-2065027349",
      "id" : 2065027349,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29904",
      "node_id" : "IC_kwDOABII5857FdEV",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2065027349/reactions"
      },
      "updated_at" : "2024-04-18T19:20:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2065027349",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1571288106"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1571288106"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Indentation isn't right here",
      "commit_id" : "68bf6c82fee917756b367db4e99a8f6bcb6476bf",
      "created_at" : "2024-04-18T19:42:08Z",
      "diff_hunk" : "@@ -85,6 +85,7 @@ BITCOIN_TESTS =\\\n   test/checkqueue_tests.cpp \\\n   test/coins_tests.cpp \\\n   test/coinstatsindex_tests.cpp \\\n+\ttest/common_url_tests.cpp \\",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1571288106",
      "id" : 1571288106,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585dp_Qq",
      "original_commit_id" : "f037e67fb76a29573a0a28059279885911ef11e2",
      "original_line" : 88,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/Makefile.test.include",
      "position" : null,
      "pull_request_review_id" : 2009744473,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1571288106/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-18T19:42:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1571288106",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1571291302"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1571291302"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "fixed",
      "commit_id" : "68bf6c82fee917756b367db4e99a8f6bcb6476bf",
      "created_at" : "2024-04-18T19:45:43Z",
      "diff_hunk" : "@@ -85,6 +85,7 @@ BITCOIN_TESTS =\\\n   test/checkqueue_tests.cpp \\\n   test/coins_tests.cpp \\\n   test/coinstatsindex_tests.cpp \\\n+\ttest/common_url_tests.cpp \\",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1571291302",
      "id" : 1571291302,
      "in_reply_to_id" : 1571288106,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585dqACm",
      "original_commit_id" : "f037e67fb76a29573a0a28059279885911ef11e2",
      "original_line" : 88,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/Makefile.test.include",
      "position" : null,
      "pull_request_review_id" : 2009749789,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1571291302/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-18T19:45:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1571291302",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1572032575"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1572032575"
         }
      },
      "author_association" : "MEMBER",
      "body" : "caa2040edc46291b3f032c64018eda2f4b31df39 nit: `auto [_, ec]`",
      "commit_id" : "68bf6c82fee917756b367db4e99a8f6bcb6476bf",
      "created_at" : "2024-04-19T08:36:36Z",
      "diff_hunk" : "@@ -4,19 +4,33 @@\n \n #include <common/url.h>\n \n-#include <event2/http.h>\n-\n-#include <cstdlib>\n #include <string>\n+#include <stdexcept>\n+#include <charconv>\n \n-std::string urlDecode(const std::string &urlEncoded) {\n+std::string urlDecode(const std::string& urlEncoded) {\n     std::string res;\n-    if (!urlEncoded.empty()) {\n-        char *decoded = evhttp_uridecode(urlEncoded.c_str(), false, nullptr);\n-        if (decoded) {\n-            res = std::string(decoded);\n-            free(decoded);\n+    res.reserve(urlEncoded.size());\n+\n+    for (size_t i = 0; i < urlEncoded.size(); ++i) {\n+        char c = urlEncoded[i];\n+        // Special handling for percent which should be followed by two hex digits\n+        // representing an octet values, see RFC 3986, Section 2.1 Percent-Encoding\n+        if (c == '%' && i + 2 < urlEncoded.size()) {\n+            int decoded_value = 0;\n+            auto [ptr, ec] = std::from_chars(&urlEncoded[i + 1], &urlEncoded[i + 3], decoded_value, 16);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1572032575",
      "id" : 1572032575,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585ds1A_",
      "original_commit_id" : "caa2040edc46291b3f032c64018eda2f4b31df39",
      "original_line" : 21,
      "original_position" : 27,
      "original_start_line" : null,
      "path" : "src/common/url.cpp",
      "position" : null,
      "pull_request_review_id" : 2010862632,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1572032575/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-19T08:46:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1572032575",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1572043682"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1572043682"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Was this doing anything, or did we forget to remove it earlier?",
      "commit_id" : "68bf6c82fee917756b367db4e99a8f6bcb6476bf",
      "created_at" : "2024-04-19T08:45:41Z",
      "diff_hunk" : "@@ -51,7 +50,6 @@\n using CliClock = std::chrono::system_clock;\n \n const std::function<std::string(const char*)> G_TRANSLATION_FUN = nullptr;\n-UrlDecodeFn* const URL_DECODE = urlDecode;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1572043682",
      "id" : 1572043682,
      "line" : 54,
      "node_id" : "PRRC_kwDOABII585ds3ui",
      "original_commit_id" : "68bf6c82fee917756b367db4e99a8f6bcb6476bf",
      "original_line" : 54,
      "original_position" : 12,
      "original_start_line" : null,
      "path" : "src/bitcoin-cli.cpp",
      "position" : 12,
      "pull_request_review_id" : 2010862632,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1572043682/reactions"
      },
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-19T08:46:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1572043682",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1572049607"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1572049607"
         }
      },
      "author_association" : "NONE",
      "body" : "it seems to me that `&& i + 2 < url_encoded.size()` part isn't checked by the tests, consider adding a few more corner cases, e.g. this is what I tested it with:\r\n```C++\r\nBOOST_AUTO_TEST_CASE(decode_malformed_test) {\r\n    BOOST_CHECK_EQUAL(urlDecode(\"%%xhello th+ere \\xff\"), \"%%xhello th+ere \\xff\");\r\n\r\n    BOOST_CHECK_EQUAL(urlDecode(\"%\"), \"%\");\r\n    BOOST_CHECK_EQUAL(urlDecode(\"%%\"), \"%%\");\r\n    BOOST_CHECK_EQUAL(urlDecode(\"%%%\"), \"%%%\");\r\n    BOOST_CHECK_EQUAL(urlDecode(\"%%%%\"), \"%%%%\");\r\n\r\n    BOOST_CHECK_EQUAL(urlDecode(\"+\"), \"+\");\r\n    BOOST_CHECK_EQUAL(urlDecode(\"++\"), \"++\");\r\n\r\n    BOOST_CHECK_EQUAL(urlDecode(\"?\"), \"?\");\r\n    BOOST_CHECK_EQUAL(urlDecode(\"??\"), \"??\");\r\n\r\n    BOOST_CHECK_EQUAL(urlDecode(\"%G1\"), \"%G1\");\r\n    BOOST_CHECK_EQUAL(urlDecode(\"%2\"), \"%2\");\r\n    BOOST_CHECK_EQUAL(urlDecode(\"%ZX\"), \"%ZX\");\r\n\r\n    BOOST_CHECK_EQUAL(urlDecode(\"valid%20string%G1\"), \"valid string%G1\");\r\n    BOOST_CHECK_EQUAL(urlDecode(\"%20invalid%ZX\"), \" invalid%ZX\");\r\n    BOOST_CHECK_EQUAL(urlDecode(\"%20%G1%ZX\"), \" %G1%ZX\");\r\n}\r\n```\r\n\r\nSince the original implementation seems to include a case for handling `?` and `+` as well, I've added tests to make sure they're kept.",
      "commit_id" : "68bf6c82fee917756b367db4e99a8f6bcb6476bf",
      "created_at" : "2024-04-19T08:50:34Z",
      "diff_hunk" : "@@ -4,19 +4,33 @@\n \n #include <common/url.h>\n \n-#include <event2/http.h>\n-\n-#include <cstdlib>\n #include <string>\n+#include <stdexcept>\n+#include <charconv>\n \n-std::string urlDecode(const std::string &urlEncoded) {\n+std::string UrlDecode(const std::string& url_encoded) {\n     std::string res;\n-    if (!urlEncoded.empty()) {\n-        char *decoded = evhttp_uridecode(urlEncoded.c_str(), false, nullptr);\n-        if (decoded) {\n-            res = std::string(decoded);\n-            free(decoded);\n+    res.reserve(url_encoded.size());\n+\n+    for (size_t i = 0; i < url_encoded.size(); ++i) {\n+        char c = url_encoded[i];\n+        // Special handling for percent which should be followed by two hex digits\n+        // representing an octet values, see RFC 3986, Section 2.1 Percent-Encoding\n+        if (c == '%' && i + 2 < url_encoded.size()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1572049607",
      "id" : 1572049607,
      "line" : 19,
      "node_id" : "PRRC_kwDOABII585ds5LH",
      "original_commit_id" : "68bf6c82fee917756b367db4e99a8f6bcb6476bf",
      "original_line" : 19,
      "original_position" : 25,
      "original_start_line" : null,
      "path" : "src/common/url.cpp",
      "position" : 25,
      "pull_request_review_id" : 2010889399,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1572049607/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-19T09:32:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1572049607",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1841944?v=4",
         "events_url" : "https://api.github.com/users/paplorinc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/paplorinc/followers",
         "following_url" : "https://api.github.com/users/paplorinc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/paplorinc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/paplorinc",
         "id" : 1841944,
         "login" : "paplorinc",
         "node_id" : "MDQ6VXNlcjE4NDE5NDQ=",
         "organizations_url" : "https://api.github.com/users/paplorinc/orgs",
         "received_events_url" : "https://api.github.com/users/paplorinc/received_events",
         "repos_url" : "https://api.github.com/users/paplorinc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/paplorinc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/paplorinc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/paplorinc"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1572069107"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1572069107"
         }
      },
      "author_association" : "NONE",
      "body" : "`ptr` seems unused, we might as well inline it to:\r\n```C++\r\nstd::from_chars(&url_encoded[i + 1], &url_encoded[i + 3], decoded_value, 16).ec == std::errc{})\r\n```\r\n(note, I've used `std::errc{}` instead, seems we're using that more often in the codebase)",
      "commit_id" : "68bf6c82fee917756b367db4e99a8f6bcb6476bf",
      "created_at" : "2024-04-19T09:06:07Z",
      "diff_hunk" : "@@ -4,19 +4,33 @@\n \n #include <common/url.h>\n \n-#include <event2/http.h>\n-\n-#include <cstdlib>\n #include <string>\n+#include <stdexcept>\n+#include <charconv>\n \n-std::string urlDecode(const std::string &urlEncoded) {\n+std::string UrlDecode(const std::string& url_encoded) {\n     std::string res;\n-    if (!urlEncoded.empty()) {\n-        char *decoded = evhttp_uridecode(urlEncoded.c_str(), false, nullptr);\n-        if (decoded) {\n-            res = std::string(decoded);\n-            free(decoded);\n+    res.reserve(url_encoded.size());\n+\n+    for (size_t i = 0; i < url_encoded.size(); ++i) {\n+        char c = url_encoded[i];\n+        // Special handling for percent which should be followed by two hex digits\n+        // representing an octet values, see RFC 3986, Section 2.1 Percent-Encoding\n+        if (c == '%' && i + 2 < url_encoded.size()) {\n+            int decoded_value = 0;\n+            auto [ptr, ec] = std::from_chars(&url_encoded[i + 1], &url_encoded[i + 3], decoded_value, 16);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1572069107",
      "id" : 1572069107,
      "line" : 21,
      "node_id" : "PRRC_kwDOABII585ds97z",
      "original_commit_id" : "68bf6c82fee917756b367db4e99a8f6bcb6476bf",
      "original_line" : 21,
      "original_position" : 27,
      "original_start_line" : null,
      "path" : "src/common/url.cpp",
      "position" : 27,
      "pull_request_review_id" : 2010889399,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1572069107/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-19T09:32:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1572069107",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1841944?v=4",
         "events_url" : "https://api.github.com/users/paplorinc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/paplorinc/followers",
         "following_url" : "https://api.github.com/users/paplorinc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/paplorinc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/paplorinc",
         "id" : 1841944,
         "login" : "paplorinc",
         "node_id" : "MDQ6VXNlcjE4NDE5NDQ=",
         "organizations_url" : "https://api.github.com/users/paplorinc/orgs",
         "received_events_url" : "https://api.github.com/users/paplorinc/received_events",
         "repos_url" : "https://api.github.com/users/paplorinc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/paplorinc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/paplorinc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/paplorinc"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1572070476"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1572070476"
         }
      },
      "author_association" : "NONE",
      "body" : "we could unify these two `res += c` cases by merging the two conditions:\r\n```C++\r\nstd::string UrlDecode(const std::string& url_encoded) {\r\n    std::string res;\r\n    res.reserve(url_encoded.size());\r\n\r\n    for (size_t i = 0; i < url_encoded.size(); ++i) {\r\n        int decoded_value = 0;\r\n        if (url_encoded[i] == '%' &&\r\n            i + 2 < url_encoded.size() &&\r\n            std::from_chars(&url_encoded[i + 1], &url_encoded[i + 3], decoded_value, 16).ec == std::errc{}) {\r\n            res += static_cast<char>(decoded_value);\r\n            i += 2;\r\n        } else {\r\n            res += url_encoded[i];\r\n        }\r\n    }\r\n\r\n    return res;\r\n}\r\n```",
      "commit_id" : "68bf6c82fee917756b367db4e99a8f6bcb6476bf",
      "created_at" : "2024-04-19T09:07:14Z",
      "diff_hunk" : "@@ -4,19 +4,33 @@\n \n #include <common/url.h>\n \n-#include <event2/http.h>\n-\n-#include <cstdlib>\n #include <string>\n+#include <stdexcept>\n+#include <charconv>\n \n-std::string urlDecode(const std::string &urlEncoded) {\n+std::string UrlDecode(const std::string& url_encoded) {\n     std::string res;\n-    if (!urlEncoded.empty()) {\n-        char *decoded = evhttp_uridecode(urlEncoded.c_str(), false, nullptr);\n-        if (decoded) {\n-            res = std::string(decoded);\n-            free(decoded);\n+    res.reserve(url_encoded.size());\n+\n+    for (size_t i = 0; i < url_encoded.size(); ++i) {\n+        char c = url_encoded[i];\n+        // Special handling for percent which should be followed by two hex digits\n+        // representing an octet values, see RFC 3986, Section 2.1 Percent-Encoding\n+        if (c == '%' && i + 2 < url_encoded.size()) {\n+            int decoded_value = 0;\n+            auto [ptr, ec] = std::from_chars(&url_encoded[i + 1], &url_encoded[i + 3], decoded_value, 16);\n+            if (ec == std::errc()) {\n+                res += static_cast<char>(decoded_value);\n+                // Next two characters are part of the percent encoding\n+                i += 2;\n+            } else {\n+                // In case of invalid percent encoding, add the '%' and continue\n+                res += c;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1572070476",
      "id" : 1572070476,
      "line" : 28,
      "node_id" : "PRRC_kwDOABII585ds-RM",
      "original_commit_id" : "68bf6c82fee917756b367db4e99a8f6bcb6476bf",
      "original_line" : 28,
      "original_position" : 34,
      "original_start_line" : null,
      "path" : "src/common/url.cpp",
      "position" : 34,
      "pull_request_review_id" : 2010889399,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1572070476/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-19T09:32:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1572070476",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1841944?v=4",
         "events_url" : "https://api.github.com/users/paplorinc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/paplorinc/followers",
         "following_url" : "https://api.github.com/users/paplorinc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/paplorinc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/paplorinc",
         "id" : 1841944,
         "login" : "paplorinc",
         "node_id" : "MDQ6VXNlcjE4NDE5NDQ=",
         "organizations_url" : "https://api.github.com/users/paplorinc/orgs",
         "received_events_url" : "https://api.github.com/users/paplorinc/received_events",
         "repos_url" : "https://api.github.com/users/paplorinc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/paplorinc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/paplorinc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/paplorinc"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1572090699"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1572090699"
         }
      },
      "author_association" : "NONE",
      "body" : "is this passing for the old implementation?\r\nIsn't this a change in behavior?",
      "commit_id" : "68bf6c82fee917756b367db4e99a8f6bcb6476bf",
      "created_at" : "2024-04-19T09:23:44Z",
      "diff_hunk" : "@@ -0,0 +1,46 @@\n+// Copyright (c) 2024 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <test/util/setup_common.h>\n+#include <common/url.h>\n+\n+#include <string>\n+\n+#include <boost/test/unit_test.hpp>\n+\n+BOOST_AUTO_TEST_SUITE(common_url_tests)\n+\n+// These test vectors were ported from test/regress.c in the libevent library\n+// which used to be a dependency of the UrlDecode function.\n+\n+BOOST_AUTO_TEST_CASE(encode_decode_test) {\n+    BOOST_CHECK_EQUAL(UrlDecode(\"Hello\"), \"Hello\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"99\"), \"99\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"\"), \"\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ123456789-.~_\"),\n+                      \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ123456789-.~_\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"%20\"), \" \");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"%FF%F0%E0\"), \"\\xff\\xf0\\xe0\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"%01%19\"), \"\\x01\\x19\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"http%3A%2F%2Fwww.ietf.org%2Frfc%2Frfc3986.txt\"),\n+                      \"http://www.ietf.org/rfc/rfc3986.txt\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"1%2B2%3D3\"), \"1+2=3\");\n+}\n+\n+BOOST_AUTO_TEST_CASE(decode_malformed_test) {\n+    BOOST_CHECK_EQUAL(UrlDecode(\"%%xhello th+ere \\xff\"), \"%%xhello th+ere \\xff\");\n+}\n+\n+BOOST_AUTO_TEST_CASE(decode_lowercase_hex_test) {\n+    BOOST_CHECK_EQUAL(UrlDecode(\"%f0%a0%b0\"), \"\\xf0\\xa0\\xb0\");\n+}\n+\n+BOOST_AUTO_TEST_CASE(decode_internal_nuls_test) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1572090699",
      "id" : 1572090699,
      "line" : 39,
      "node_id" : "PRRC_kwDOABII585dtDNL",
      "original_commit_id" : "68bf6c82fee917756b367db4e99a8f6bcb6476bf",
      "original_line" : 39,
      "original_position" : 39,
      "original_start_line" : null,
      "path" : "src/test/common_url_tests.cpp",
      "position" : 39,
      "pull_request_review_id" : 2010889399,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1572090699/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-19T09:32:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1572090699",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1841944?v=4",
         "events_url" : "https://api.github.com/users/paplorinc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/paplorinc/followers",
         "following_url" : "https://api.github.com/users/paplorinc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/paplorinc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/paplorinc",
         "id" : 1841944,
         "login" : "paplorinc",
         "node_id" : "MDQ6VXNlcjE4NDE5NDQ=",
         "organizations_url" : "https://api.github.com/users/paplorinc/orgs",
         "received_events_url" : "https://api.github.com/users/paplorinc/received_events",
         "repos_url" : "https://api.github.com/users/paplorinc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/paplorinc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/paplorinc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/paplorinc"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1572096517"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1572096517"
         }
      },
      "author_association" : "NONE",
      "body" : "nit: it used to be a dependency of `urlDecode`, not `UrlDecode`, but I guess it's fine",
      "commit_id" : "68bf6c82fee917756b367db4e99a8f6bcb6476bf",
      "created_at" : "2024-04-19T09:28:33Z",
      "diff_hunk" : "@@ -0,0 +1,46 @@\n+// Copyright (c) 2024 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <test/util/setup_common.h>\n+#include <common/url.h>\n+\n+#include <string>\n+\n+#include <boost/test/unit_test.hpp>\n+\n+BOOST_AUTO_TEST_SUITE(common_url_tests)\n+\n+// These test vectors were ported from test/regress.c in the libevent library\n+// which used to be a dependency of the UrlDecode function.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1572096517",
      "id" : 1572096517,
      "line" : 15,
      "node_id" : "PRRC_kwDOABII585dtEoF",
      "original_commit_id" : "68bf6c82fee917756b367db4e99a8f6bcb6476bf",
      "original_line" : 15,
      "original_position" : 15,
      "original_start_line" : null,
      "path" : "src/test/common_url_tests.cpp",
      "position" : 15,
      "pull_request_review_id" : 2010889399,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1572096517/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-19T09:32:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1572096517",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1841944?v=4",
         "events_url" : "https://api.github.com/users/paplorinc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/paplorinc/followers",
         "following_url" : "https://api.github.com/users/paplorinc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/paplorinc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/paplorinc",
         "id" : 1841944,
         "login" : "paplorinc",
         "node_id" : "MDQ6VXNlcjE4NDE5NDQ=",
         "organizations_url" : "https://api.github.com/users/paplorinc/orgs",
         "received_events_url" : "https://api.github.com/users/paplorinc/received_events",
         "repos_url" : "https://api.github.com/users/paplorinc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/paplorinc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/paplorinc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/paplorinc"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1573345116"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1573345116"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "done",
      "commit_id" : "f98631505f28fbd5dfe86be1f83e1b04eea443d6",
      "created_at" : "2024-04-20T17:13:01Z",
      "diff_hunk" : "@@ -4,19 +4,33 @@\n \n #include <common/url.h>\n \n-#include <event2/http.h>\n-\n-#include <cstdlib>\n #include <string>\n+#include <stdexcept>\n+#include <charconv>\n \n-std::string urlDecode(const std::string &urlEncoded) {\n+std::string urlDecode(const std::string& urlEncoded) {\n     std::string res;\n-    if (!urlEncoded.empty()) {\n-        char *decoded = evhttp_uridecode(urlEncoded.c_str(), false, nullptr);\n-        if (decoded) {\n-            res = std::string(decoded);\n-            free(decoded);\n+    res.reserve(urlEncoded.size());\n+\n+    for (size_t i = 0; i < urlEncoded.size(); ++i) {\n+        char c = urlEncoded[i];\n+        // Special handling for percent which should be followed by two hex digits\n+        // representing an octet values, see RFC 3986, Section 2.1 Percent-Encoding\n+        if (c == '%' && i + 2 < urlEncoded.size()) {\n+            int decoded_value = 0;\n+            auto [ptr, ec] = std::from_chars(&urlEncoded[i + 1], &urlEncoded[i + 3], decoded_value, 16);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1573345116",
      "id" : 1573345116,
      "in_reply_to_id" : 1572032575,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585dx1dc",
      "original_commit_id" : "caa2040edc46291b3f032c64018eda2f4b31df39",
      "original_line" : 21,
      "original_position" : 27,
      "original_start_line" : null,
      "path" : "src/common/url.cpp",
      "position" : null,
      "pull_request_review_id" : 2013119910,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1573345116/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-20T17:13:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1573345116",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1573345292"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1573345292"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Not sure if I understand your question, do you mean this line in particular or the whole hooking thing? This line was added the with the rest of hooking code in #18504 and I don't think anything was changed about that until now, so I don't know where we might have forgotten to remove it.",
      "commit_id" : "632eb484280d13bda7b0976c7dab3606efdb509d",
      "created_at" : "2024-04-20T17:13:46Z",
      "diff_hunk" : "@@ -51,7 +50,6 @@\n using CliClock = std::chrono::system_clock;\n \n const std::function<std::string(const char*)> G_TRANSLATION_FUN = nullptr;\n-UrlDecodeFn* const URL_DECODE = urlDecode;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1573345292",
      "id" : 1573345292,
      "in_reply_to_id" : 1572043682,
      "line" : 54,
      "node_id" : "PRRC_kwDOABII585dx1gM",
      "original_commit_id" : "68bf6c82fee917756b367db4e99a8f6bcb6476bf",
      "original_line" : 54,
      "original_position" : 12,
      "original_start_line" : null,
      "path" : "src/bitcoin-cli.cpp",
      "position" : 12,
      "pull_request_review_id" : 2013119983,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1573345292/reactions"
      },
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-20T18:03:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1573345292",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1573345315"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1573345315"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks, added.",
      "commit_id" : "f98631505f28fbd5dfe86be1f83e1b04eea443d6",
      "created_at" : "2024-04-20T17:13:56Z",
      "diff_hunk" : "@@ -4,19 +4,33 @@\n \n #include <common/url.h>\n \n-#include <event2/http.h>\n-\n-#include <cstdlib>\n #include <string>\n+#include <stdexcept>\n+#include <charconv>\n \n-std::string urlDecode(const std::string &urlEncoded) {\n+std::string UrlDecode(const std::string& url_encoded) {\n     std::string res;\n-    if (!urlEncoded.empty()) {\n-        char *decoded = evhttp_uridecode(urlEncoded.c_str(), false, nullptr);\n-        if (decoded) {\n-            res = std::string(decoded);\n-            free(decoded);\n+    res.reserve(url_encoded.size());\n+\n+    for (size_t i = 0; i < url_encoded.size(); ++i) {\n+        char c = url_encoded[i];\n+        // Special handling for percent which should be followed by two hex digits\n+        // representing an octet values, see RFC 3986, Section 2.1 Percent-Encoding\n+        if (c == '%' && i + 2 < url_encoded.size()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1573345315",
      "id" : 1573345315,
      "in_reply_to_id" : 1572049607,
      "line" : 19,
      "node_id" : "PRRC_kwDOABII585dx1gj",
      "original_commit_id" : "68bf6c82fee917756b367db4e99a8f6bcb6476bf",
      "original_line" : 19,
      "original_position" : 25,
      "original_start_line" : null,
      "path" : "src/common/url.cpp",
      "position" : 25,
      "pull_request_review_id" : 2013120007,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1573345315/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-20T17:13:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1573345315",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1573345552"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1573345552"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I think this is less readable so I will keep it as is but I did take @Sjors 's suggestion to change it to change `ptr` to `_`.",
      "commit_id" : "f98631505f28fbd5dfe86be1f83e1b04eea443d6",
      "created_at" : "2024-04-20T17:15:22Z",
      "diff_hunk" : "@@ -4,19 +4,33 @@\n \n #include <common/url.h>\n \n-#include <event2/http.h>\n-\n-#include <cstdlib>\n #include <string>\n+#include <stdexcept>\n+#include <charconv>\n \n-std::string urlDecode(const std::string &urlEncoded) {\n+std::string UrlDecode(const std::string& url_encoded) {\n     std::string res;\n-    if (!urlEncoded.empty()) {\n-        char *decoded = evhttp_uridecode(urlEncoded.c_str(), false, nullptr);\n-        if (decoded) {\n-            res = std::string(decoded);\n-            free(decoded);\n+    res.reserve(url_encoded.size());\n+\n+    for (size_t i = 0; i < url_encoded.size(); ++i) {\n+        char c = url_encoded[i];\n+        // Special handling for percent which should be followed by two hex digits\n+        // representing an octet values, see RFC 3986, Section 2.1 Percent-Encoding\n+        if (c == '%' && i + 2 < url_encoded.size()) {\n+            int decoded_value = 0;\n+            auto [ptr, ec] = std::from_chars(&url_encoded[i + 1], &url_encoded[i + 3], decoded_value, 16);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1573345552",
      "id" : 1573345552,
      "in_reply_to_id" : 1572069107,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585dx1kQ",
      "original_commit_id" : "68bf6c82fee917756b367db4e99a8f6bcb6476bf",
      "original_line" : 21,
      "original_position" : 27,
      "original_start_line" : null,
      "path" : "src/common/url.cpp",
      "position" : null,
      "pull_request_review_id" : 2013120185,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1573345552/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-20T17:15:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1573345552",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1573345672"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1573345672"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Like above, I think this is a bit less readable so I will keep it as is.",
      "commit_id" : "f98631505f28fbd5dfe86be1f83e1b04eea443d6",
      "created_at" : "2024-04-20T17:15:58Z",
      "diff_hunk" : "@@ -4,19 +4,33 @@\n \n #include <common/url.h>\n \n-#include <event2/http.h>\n-\n-#include <cstdlib>\n #include <string>\n+#include <stdexcept>\n+#include <charconv>\n \n-std::string urlDecode(const std::string &urlEncoded) {\n+std::string UrlDecode(const std::string& url_encoded) {\n     std::string res;\n-    if (!urlEncoded.empty()) {\n-        char *decoded = evhttp_uridecode(urlEncoded.c_str(), false, nullptr);\n-        if (decoded) {\n-            res = std::string(decoded);\n-            free(decoded);\n+    res.reserve(url_encoded.size());\n+\n+    for (size_t i = 0; i < url_encoded.size(); ++i) {\n+        char c = url_encoded[i];\n+        // Special handling for percent which should be followed by two hex digits\n+        // representing an octet values, see RFC 3986, Section 2.1 Percent-Encoding\n+        if (c == '%' && i + 2 < url_encoded.size()) {\n+            int decoded_value = 0;\n+            auto [ptr, ec] = std::from_chars(&url_encoded[i + 1], &url_encoded[i + 3], decoded_value, 16);\n+            if (ec == std::errc()) {\n+                res += static_cast<char>(decoded_value);\n+                // Next two characters are part of the percent encoding\n+                i += 2;\n+            } else {\n+                // In case of invalid percent encoding, add the '%' and continue\n+                res += c;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1573345672",
      "id" : 1573345672,
      "in_reply_to_id" : 1572070476,
      "line" : 33,
      "node_id" : "PRRC_kwDOABII585dx1mI",
      "original_commit_id" : "68bf6c82fee917756b367db4e99a8f6bcb6476bf",
      "original_line" : 33,
      "original_position" : 34,
      "original_start_line" : null,
      "path" : "src/common/url.cpp",
      "position" : 39,
      "pull_request_review_id" : 2013120358,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1573345672/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-20T17:15:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1573345672",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1573345724"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1573345724"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Either way, someone might get confused, but I think it's better to keep it as is.",
      "commit_id" : "f98631505f28fbd5dfe86be1f83e1b04eea443d6",
      "created_at" : "2024-04-20T17:16:08Z",
      "diff_hunk" : "@@ -0,0 +1,46 @@\n+// Copyright (c) 2024 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <test/util/setup_common.h>\n+#include <common/url.h>\n+\n+#include <string>\n+\n+#include <boost/test/unit_test.hpp>\n+\n+BOOST_AUTO_TEST_SUITE(common_url_tests)\n+\n+// These test vectors were ported from test/regress.c in the libevent library\n+// which used to be a dependency of the UrlDecode function.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1573345724",
      "id" : 1573345724,
      "in_reply_to_id" : 1572096517,
      "line" : 15,
      "node_id" : "PRRC_kwDOABII585dx1m8",
      "original_commit_id" : "68bf6c82fee917756b367db4e99a8f6bcb6476bf",
      "original_line" : 15,
      "original_position" : 15,
      "original_start_line" : null,
      "path" : "src/test/common_url_tests.cpp",
      "position" : 15,
      "pull_request_review_id" : 2013120375,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1573345724/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-20T17:16:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1573345724",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1573347809"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1573347809"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "You're right, good catch! I was focussing too much on the behavior inside of libevent and didn't take into account that the result was cast to `std::string` afterwards, which lead to the behavior that a null character terminated the string. I have changed this to keep behavior consistent with the libevent version.",
      "commit_id" : "f98631505f28fbd5dfe86be1f83e1b04eea443d6",
      "created_at" : "2024-04-20T17:24:05Z",
      "diff_hunk" : "@@ -0,0 +1,46 @@\n+// Copyright (c) 2024 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <test/util/setup_common.h>\n+#include <common/url.h>\n+\n+#include <string>\n+\n+#include <boost/test/unit_test.hpp>\n+\n+BOOST_AUTO_TEST_SUITE(common_url_tests)\n+\n+// These test vectors were ported from test/regress.c in the libevent library\n+// which used to be a dependency of the UrlDecode function.\n+\n+BOOST_AUTO_TEST_CASE(encode_decode_test) {\n+    BOOST_CHECK_EQUAL(UrlDecode(\"Hello\"), \"Hello\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"99\"), \"99\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"\"), \"\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ123456789-.~_\"),\n+                      \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ123456789-.~_\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"%20\"), \" \");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"%FF%F0%E0\"), \"\\xff\\xf0\\xe0\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"%01%19\"), \"\\x01\\x19\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"http%3A%2F%2Fwww.ietf.org%2Frfc%2Frfc3986.txt\"),\n+                      \"http://www.ietf.org/rfc/rfc3986.txt\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"1%2B2%3D3\"), \"1+2=3\");\n+}\n+\n+BOOST_AUTO_TEST_CASE(decode_malformed_test) {\n+    BOOST_CHECK_EQUAL(UrlDecode(\"%%xhello th+ere \\xff\"), \"%%xhello th+ere \\xff\");\n+}\n+\n+BOOST_AUTO_TEST_CASE(decode_lowercase_hex_test) {\n+    BOOST_CHECK_EQUAL(UrlDecode(\"%f0%a0%b0\"), \"\\xf0\\xa0\\xb0\");\n+}\n+\n+BOOST_AUTO_TEST_CASE(decode_internal_nuls_test) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1573347809",
      "id" : 1573347809,
      "in_reply_to_id" : 1572090699,
      "line" : 58,
      "node_id" : "PRRC_kwDOABII585dx2Hh",
      "original_commit_id" : "68bf6c82fee917756b367db4e99a8f6bcb6476bf",
      "original_line" : 58,
      "original_position" : 39,
      "original_start_line" : null,
      "path" : "src/test/common_url_tests.cpp",
      "position" : 58,
      "pull_request_review_id" : 2013122865,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1573347809/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-20T17:24:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1573347809",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Addressed feedback by @paplorinc and @Sjors , thanks a lot!\r\n\r\nI also reorganized the commits a bit because they were doing more than one thing and it was hard to address feedback cleanly. The tests are now split from the implementation, which makes it easier to cherry-pick the unit test commit and run it against master. And I split off the renaming into a scripted diff.",
      "created_at" : "2024-04-20T17:28:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#issuecomment-2067736339",
      "id" : 2067736339,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29904",
      "node_id" : "IC_kwDOABII5857PycT",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2067736339/reactions"
      },
      "updated_at" : "2024-04-20T17:28:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2067736339",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "CI failure can be ignored, it was introduced by #29827 and should hopefully be fixed by #29926",
      "created_at" : "2024-04-20T23:33:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#issuecomment-2067814020",
      "id" : 2067814020,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29904",
      "node_id" : "IC_kwDOABII5857QFaE",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2067814020/reactions"
      },
      "updated_at" : "2024-04-20T23:33:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2067814020",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept NACK. Embedding copies of shared code just makes things more fragile, not safer. It's far more likely there's a bugfix that we miss picking up on, than that there's malicious code inserted later.",
      "created_at" : "2024-04-21T02:59:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#issuecomment-2067871490",
      "id" : 2067871490,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29904",
      "node_id" : "IC_kwDOABII5857QTcC",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2067871490/reactions"
      },
      "updated_at" : "2024-04-21T02:59:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2067871490",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : ">  It's far more likely there's a bugfix that we miss picking up on, than that there's malicious code inserted later.\r\n\r\nSometimes i'd agree with that reasoning. But let's face it, `urlDecode` is not more complex than say, `leftpad`, it's unlikely to need maintainance or bug fixes, and thus seems unnecessary to carry a dependency for. \r\n\r\n(Also this isn't a direct copy of the C code! It's a C++ reimplementation that does `std::string` to `std::string`, so should handle embedded NULL bytes without truncation)",
      "created_at" : "2024-04-21T08:17:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#issuecomment-2067954555",
      "id" : 2067954555,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29904",
      "node_id" : "IC_kwDOABII5857Qnt7",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2067954555/reactions"
      },
      "updated_at" : "2024-04-21T08:17:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2067954555",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Embedding copies of shared code just makes things more fragile, not safer. It's far more likely there's a bugfix that we miss picking up on, than that there's malicious code inserted later.\r\n\r\nIn addition to what @laanwj  said, it's also a much simpler re-implementation. The libevent function provided further options that we didn't care about and hardcoded, that's how we could simplify. And as was discussed in the last IRC meeting, there is also interest in removing libevent in general, at which point this would be a necessary change anyway. We are also removing that hooking code which is a big improvement in itself. If you subtract the test code, we are almost removing as much code as we are adding.\r\n\r\n> It's a C++ reimplementation that does std::string to std::string, so should handle embedded NULL bytes without truncation\r\n\r\nSo, to be clear, your opinion is for this part I should [remove the patch](https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1573347809) and introduce a change of behavior, right?",
      "created_at" : "2024-04-21T14:59:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#issuecomment-2068074835",
      "id" : 2068074835,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29904",
      "node_id" : "IC_kwDOABII5857RFFT",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2068074835/reactions"
      },
      "updated_at" : "2024-04-21T14:59:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2068074835",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> So, to be clear, your opinion is for this part I should https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1573347809 and introduce a change of behavior, right?\r\n\r\nYes. There's no use in emulating broken C string behavior.\r\nEdit: maybe for one commit when you want to prove both implementations are the same. But it can be removed quickly after that, imo.",
      "created_at" : "2024-04-21T18:16:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#issuecomment-2068154367",
      "id" : 2068154367,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29904",
      "node_id" : "IC_kwDOABII5857RYf_",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2068154367/reactions"
      },
      "updated_at" : "2024-04-21T18:22:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2068154367",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1573899433"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1573899433"
         }
      },
      "author_association" : "NONE",
      "body" : "Thanks for adding me as a co-author, if you force push again, please change the email to `LÅrinc <pap.lorinc@gmail.com>`",
      "commit_id" : "632eb484280d13bda7b0976c7dab3606efdb509d",
      "created_at" : "2024-04-21T19:54:31Z",
      "diff_hunk" : "@@ -0,0 +1,46 @@\n+// Copyright (c) 2024 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <test/util/setup_common.h>\n+#include <common/url.h>\n+\n+#include <string>\n+\n+#include <boost/test/unit_test.hpp>\n+\n+BOOST_AUTO_TEST_SUITE(common_url_tests)\n+\n+// These test vectors were ported from test/regress.c in the libevent library\n+// which used to be a dependency of the UrlDecode function.\n+\n+BOOST_AUTO_TEST_CASE(encode_decode_test) {\n+    BOOST_CHECK_EQUAL(UrlDecode(\"Hello\"), \"Hello\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"99\"), \"99\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"\"), \"\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ123456789-.~_\"),\n+                      \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ123456789-.~_\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"%20\"), \" \");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"%FF%F0%E0\"), \"\\xff\\xf0\\xe0\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"%01%19\"), \"\\x01\\x19\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"http%3A%2F%2Fwww.ietf.org%2Frfc%2Frfc3986.txt\"),\n+                      \"http://www.ietf.org/rfc/rfc3986.txt\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"1%2B2%3D3\"), \"1+2=3\");\n+}\n+\n+BOOST_AUTO_TEST_CASE(decode_malformed_test) {\n+    BOOST_CHECK_EQUAL(UrlDecode(\"%%xhello th+ere \\xff\"), \"%%xhello th+ere \\xff\");\n+}\n+\n+BOOST_AUTO_TEST_CASE(decode_lowercase_hex_test) {\n+    BOOST_CHECK_EQUAL(UrlDecode(\"%f0%a0%b0\"), \"\\xf0\\xa0\\xb0\");\n+}\n+\n+BOOST_AUTO_TEST_CASE(decode_internal_nuls_test) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1573899433",
      "id" : 1573899433,
      "in_reply_to_id" : 1572090699,
      "line" : 58,
      "node_id" : "PRRC_kwDOABII585dz8yp",
      "original_commit_id" : "68bf6c82fee917756b367db4e99a8f6bcb6476bf",
      "original_line" : 58,
      "original_position" : 39,
      "original_start_line" : null,
      "path" : "src/test/common_url_tests.cpp",
      "position" : 58,
      "pull_request_review_id" : 2013507911,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1573899433/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-21T19:54:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1573899433",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1841944?v=4",
         "events_url" : "https://api.github.com/users/paplorinc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/paplorinc/followers",
         "following_url" : "https://api.github.com/users/paplorinc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/paplorinc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/paplorinc",
         "id" : 1841944,
         "login" : "paplorinc",
         "node_id" : "MDQ6VXNlcjE4NDE5NDQ=",
         "organizations_url" : "https://api.github.com/users/paplorinc/orgs",
         "received_events_url" : "https://api.github.com/users/paplorinc/received_events",
         "repos_url" : "https://api.github.com/users/paplorinc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/paplorinc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/paplorinc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/paplorinc"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I have added the behavior change in a separate commit.",
      "created_at" : "2024-04-21T19:55:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#issuecomment-2068180640",
      "id" : 2068180640,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29904",
      "node_id" : "IC_kwDOABII5857Re6g",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2068180640/reactions"
      },
      "updated_at" : "2024-04-21T19:55:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2068180640",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1573899901"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1573899901"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "The behavior change is now re-introduced but explicitly documented as such in a separate commit.",
      "commit_id" : "632eb484280d13bda7b0976c7dab3606efdb509d",
      "created_at" : "2024-04-21T19:56:07Z",
      "diff_hunk" : "@@ -0,0 +1,46 @@\n+// Copyright (c) 2024 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <test/util/setup_common.h>\n+#include <common/url.h>\n+\n+#include <string>\n+\n+#include <boost/test/unit_test.hpp>\n+\n+BOOST_AUTO_TEST_SUITE(common_url_tests)\n+\n+// These test vectors were ported from test/regress.c in the libevent library\n+// which used to be a dependency of the UrlDecode function.\n+\n+BOOST_AUTO_TEST_CASE(encode_decode_test) {\n+    BOOST_CHECK_EQUAL(UrlDecode(\"Hello\"), \"Hello\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"99\"), \"99\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"\"), \"\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ123456789-.~_\"),\n+                      \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ123456789-.~_\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"%20\"), \" \");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"%FF%F0%E0\"), \"\\xff\\xf0\\xe0\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"%01%19\"), \"\\x01\\x19\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"http%3A%2F%2Fwww.ietf.org%2Frfc%2Frfc3986.txt\"),\n+                      \"http://www.ietf.org/rfc/rfc3986.txt\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"1%2B2%3D3\"), \"1+2=3\");\n+}\n+\n+BOOST_AUTO_TEST_CASE(decode_malformed_test) {\n+    BOOST_CHECK_EQUAL(UrlDecode(\"%%xhello th+ere \\xff\"), \"%%xhello th+ere \\xff\");\n+}\n+\n+BOOST_AUTO_TEST_CASE(decode_lowercase_hex_test) {\n+    BOOST_CHECK_EQUAL(UrlDecode(\"%f0%a0%b0\"), \"\\xf0\\xa0\\xb0\");\n+}\n+\n+BOOST_AUTO_TEST_CASE(decode_internal_nuls_test) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1573899901",
      "id" : 1573899901,
      "in_reply_to_id" : 1572090699,
      "line" : 58,
      "node_id" : "PRRC_kwDOABII585dz859",
      "original_commit_id" : "68bf6c82fee917756b367db4e99a8f6bcb6476bf",
      "original_line" : 58,
      "original_position" : 39,
      "original_start_line" : null,
      "path" : "src/test/common_url_tests.cpp",
      "position" : 58,
      "pull_request_review_id" : 2013508122,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1573899901/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-21T19:56:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1573899901",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1573900516"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1573900516"
         }
      },
      "author_association" : "NONE",
      "body" : "would it make sense to mention the `&` as well?",
      "commit_id" : "477c03b42825084ac344050d97ea206a82ba0eb6",
      "created_at" : "2024-04-21T19:58:30Z",
      "diff_hunk" : "@@ -7,8 +7,10 @@\n \n #include <string>\n \n-using UrlDecodeFn = std::string(const std::string& url_encoded);\n-UrlDecodeFn urlDecode;\n-extern UrlDecodeFn* const URL_DECODE;\n+/* Decode a URL.\n+ *\n+ * Notably this implementation does not decode a '+' to a ' '.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1573900516",
      "id" : 1573900516,
      "line" : 13,
      "node_id" : "PRRC_kwDOABII585dz9Dk",
      "original_commit_id" : "21ad0064439e5ecca93e42379e71391bb735e450",
      "original_line" : 13,
      "original_position" : 9,
      "original_start_line" : null,
      "path" : "src/common/url.h",
      "position" : 11,
      "pull_request_review_id" : 2013508448,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1573900516/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-23T19:52:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1573900516",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1841944?v=4",
         "events_url" : "https://api.github.com/users/paplorinc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/paplorinc/followers",
         "following_url" : "https://api.github.com/users/paplorinc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/paplorinc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/paplorinc",
         "id" : 1841944,
         "login" : "paplorinc",
         "node_id" : "MDQ6VXNlcjE4NDE5NDQ=",
         "organizations_url" : "https://api.github.com/users/paplorinc/orgs",
         "received_events_url" : "https://api.github.com/users/paplorinc/received_events",
         "repos_url" : "https://api.github.com/users/paplorinc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/paplorinc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/paplorinc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/paplorinc"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1573902309"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1573902309"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Are these commonly decoded as a space as well? I couldn't find evidence for this but I didn't spend much time on it.",
      "commit_id" : "175d57ba953cdc1da3a54ae0208dad813f7ea4cf",
      "created_at" : "2024-04-21T20:06:44Z",
      "diff_hunk" : "@@ -7,8 +7,10 @@\n \n #include <string>\n \n-using UrlDecodeFn = std::string(const std::string& url_encoded);\n-UrlDecodeFn urlDecode;\n-extern UrlDecodeFn* const URL_DECODE;\n+/* Decode a URL.\n+ *\n+ * Notably this implementation does not decode a '+' to a ' '.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1573902309",
      "id" : 1573902309,
      "in_reply_to_id" : 1573900516,
      "line" : 12,
      "node_id" : "PRRC_kwDOABII585dz9fl",
      "original_commit_id" : "21ad0064439e5ecca93e42379e71391bb735e450",
      "original_line" : 12,
      "original_position" : 9,
      "original_start_line" : null,
      "path" : "src/common/url.h",
      "position" : 9,
      "pull_request_review_id" : 2013509536,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1573902309/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-21T20:06:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1573902309",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1573902893"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1573902893"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "> Thanks for adding me as a co-author, if you force push again, please change the email to `LÅrinc <pap.lorinc@gmail.com>`\r\n\r\nfixed the email",
      "commit_id" : "175d57ba953cdc1da3a54ae0208dad813f7ea4cf",
      "created_at" : "2024-04-21T20:09:06Z",
      "diff_hunk" : "@@ -0,0 +1,46 @@\n+// Copyright (c) 2024 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <test/util/setup_common.h>\n+#include <common/url.h>\n+\n+#include <string>\n+\n+#include <boost/test/unit_test.hpp>\n+\n+BOOST_AUTO_TEST_SUITE(common_url_tests)\n+\n+// These test vectors were ported from test/regress.c in the libevent library\n+// which used to be a dependency of the UrlDecode function.\n+\n+BOOST_AUTO_TEST_CASE(encode_decode_test) {\n+    BOOST_CHECK_EQUAL(UrlDecode(\"Hello\"), \"Hello\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"99\"), \"99\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"\"), \"\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ123456789-.~_\"),\n+                      \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ123456789-.~_\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"%20\"), \" \");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"%FF%F0%E0\"), \"\\xff\\xf0\\xe0\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"%01%19\"), \"\\x01\\x19\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"http%3A%2F%2Fwww.ietf.org%2Frfc%2Frfc3986.txt\"),\n+                      \"http://www.ietf.org/rfc/rfc3986.txt\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"1%2B2%3D3\"), \"1+2=3\");\n+}\n+\n+BOOST_AUTO_TEST_CASE(decode_malformed_test) {\n+    BOOST_CHECK_EQUAL(UrlDecode(\"%%xhello th+ere \\xff\"), \"%%xhello th+ere \\xff\");\n+}\n+\n+BOOST_AUTO_TEST_CASE(decode_lowercase_hex_test) {\n+    BOOST_CHECK_EQUAL(UrlDecode(\"%f0%a0%b0\"), \"\\xf0\\xa0\\xb0\");\n+}\n+\n+BOOST_AUTO_TEST_CASE(decode_internal_nuls_test) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1573902893",
      "id" : 1573902893,
      "in_reply_to_id" : 1572090699,
      "line" : 58,
      "node_id" : "PRRC_kwDOABII585dz9ot",
      "original_commit_id" : "68bf6c82fee917756b367db4e99a8f6bcb6476bf",
      "original_line" : 58,
      "original_position" : 39,
      "original_start_line" : null,
      "path" : "src/test/common_url_tests.cpp",
      "position" : 58,
      "pull_request_review_id" : 2013510121,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1573902893/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-21T20:14:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1573902893",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1573902969"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1573902969"
         }
      },
      "author_association" : "NONE",
      "body" : "Not exactly: https://github.com/libevent/libevent/blob/release-2.1.12-stable/http.c#L3186-L3188",
      "commit_id" : "175d57ba953cdc1da3a54ae0208dad813f7ea4cf",
      "created_at" : "2024-04-21T20:09:33Z",
      "diff_hunk" : "@@ -7,8 +7,10 @@\n \n #include <string>\n \n-using UrlDecodeFn = std::string(const std::string& url_encoded);\n-UrlDecodeFn urlDecode;\n-extern UrlDecodeFn* const URL_DECODE;\n+/* Decode a URL.\n+ *\n+ * Notably this implementation does not decode a '+' to a ' '.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1573902969",
      "id" : 1573902969,
      "in_reply_to_id" : 1573900516,
      "line" : 12,
      "node_id" : "PRRC_kwDOABII585dz9p5",
      "original_commit_id" : "21ad0064439e5ecca93e42379e71391bb735e450",
      "original_line" : 12,
      "original_position" : 9,
      "original_start_line" : null,
      "path" : "src/common/url.h",
      "position" : 9,
      "pull_request_review_id" : 2013510175,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1573902969/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-21T20:09:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1573902969",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1841944?v=4",
         "events_url" : "https://api.github.com/users/paplorinc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/paplorinc/followers",
         "following_url" : "https://api.github.com/users/paplorinc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/paplorinc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/paplorinc",
         "id" : 1841944,
         "login" : "paplorinc",
         "node_id" : "MDQ6VXNlcjE4NDE5NDQ=",
         "organizations_url" : "https://api.github.com/users/paplorinc/orgs",
         "received_events_url" : "https://api.github.com/users/paplorinc/received_events",
         "repos_url" : "https://api.github.com/users/paplorinc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/paplorinc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/paplorinc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/paplorinc"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1573904156"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1573904156"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Hm, the code you are linking to is part of how libevent handles the `+`. Or did you want to refer to `?`? I think if it's not very common for `&` to be decoded as space then we don't need to mention it.",
      "commit_id" : "175d57ba953cdc1da3a54ae0208dad813f7ea4cf",
      "created_at" : "2024-04-21T20:14:07Z",
      "diff_hunk" : "@@ -7,8 +7,10 @@\n \n #include <string>\n \n-using UrlDecodeFn = std::string(const std::string& url_encoded);\n-UrlDecodeFn urlDecode;\n-extern UrlDecodeFn* const URL_DECODE;\n+/* Decode a URL.\n+ *\n+ * Notably this implementation does not decode a '+' to a ' '.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1573904156",
      "id" : 1573904156,
      "in_reply_to_id" : 1573900516,
      "line" : 12,
      "node_id" : "PRRC_kwDOABII585dz98c",
      "original_commit_id" : "21ad0064439e5ecca93e42379e71391bb735e450",
      "original_line" : 12,
      "original_position" : 9,
      "original_start_line" : null,
      "path" : "src/common/url.h",
      "position" : 9,
      "pull_request_review_id" : 2013510816,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1573904156/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-21T20:14:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1573904156",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1573905184"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1573905184"
         }
      },
      "author_association" : "NONE",
      "body" : "? seems to be a control char, `If -1, when true we transform plus to space only after we've seen a ?.  -1 is deprecated.`, no need to mention it, thanks for checking.",
      "commit_id" : "175d57ba953cdc1da3a54ae0208dad813f7ea4cf",
      "created_at" : "2024-04-21T20:18:58Z",
      "diff_hunk" : "@@ -7,8 +7,10 @@\n \n #include <string>\n \n-using UrlDecodeFn = std::string(const std::string& url_encoded);\n-UrlDecodeFn urlDecode;\n-extern UrlDecodeFn* const URL_DECODE;\n+/* Decode a URL.\n+ *\n+ * Notably this implementation does not decode a '+' to a ' '.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1573905184",
      "id" : 1573905184,
      "in_reply_to_id" : 1573900516,
      "line" : 12,
      "node_id" : "PRRC_kwDOABII585dz-Mg",
      "original_commit_id" : "21ad0064439e5ecca93e42379e71391bb735e450",
      "original_line" : 12,
      "original_position" : 9,
      "original_start_line" : null,
      "path" : "src/common/url.h",
      "position" : 9,
      "pull_request_review_id" : 2013511440,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1573905184/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-21T20:18:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1573905184",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1841944?v=4",
         "events_url" : "https://api.github.com/users/paplorinc/events{/privacy}",
         "followers_url" : "https://api.github.com/users/paplorinc/followers",
         "following_url" : "https://api.github.com/users/paplorinc/following{/other_user}",
         "gists_url" : "https://api.github.com/users/paplorinc/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/paplorinc",
         "id" : 1841944,
         "login" : "paplorinc",
         "node_id" : "MDQ6VXNlcjE4NDE5NDQ=",
         "organizations_url" : "https://api.github.com/users/paplorinc/orgs",
         "received_events_url" : "https://api.github.com/users/paplorinc/received_events",
         "repos_url" : "https://api.github.com/users/paplorinc/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/paplorinc/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/paplorinc/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/paplorinc"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1574339319"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1574339319"
         }
      },
      "author_association" : "MEMBER",
      "body" : "For better or worse, this silent accepting behavior for invalid hex values in URL decoding is really common. See for example Python:\r\n\r\n```python3\r\n>>> import urllib.parse\r\n>>> urllib.parse.unquote('%12%%xx%0a')\r\n'\\x12%%xx\\n'\r\n```\r\nIt's the web philopsophy of \"in case of doubt, just do something!\" ð . Anyhow, in this refactor it doesn't make sense imo to add error handling here.",
      "commit_id" : "175d57ba953cdc1da3a54ae0208dad813f7ea4cf",
      "created_at" : "2024-04-22T08:25:36Z",
      "diff_hunk" : "@@ -4,19 +4,33 @@\n \n #include <common/url.h>\n \n-#include <event2/http.h>\n-\n-#include <cstdlib>\n #include <string>\n+#include <stdexcept>\n+#include <charconv>\n \n-std::string urlDecode(const std::string &urlEncoded) {\n+std::string urlDecode(const std::string& urlEncoded) {\n     std::string res;\n-    if (!urlEncoded.empty()) {\n-        char *decoded = evhttp_uridecode(urlEncoded.c_str(), false, nullptr);\n-        if (decoded) {\n-            res = std::string(decoded);\n-            free(decoded);\n+    res.reserve(urlEncoded.size());\n+\n+    for (size_t i = 0; i < urlEncoded.size(); ++i) {\n+        char c = urlEncoded[i];\n+        // Special handling for percent which should be followed by two hex digits\n+        // representing an octet values, see RFC 3986, Section 2.1 Percent-Encoding\n+        if (c == '%' && i + 2 < urlEncoded.size()) {\n+            int decoded_value = 0;\n+            auto [ptr, ec] = std::from_chars(&urlEncoded[i + 1], &urlEncoded[i + 3], decoded_value, 16);\n+            if (ec == std::errc()) {\n+                res += static_cast<char>(decoded_value);\n+                // Next two characters are part of the percent encoding\n+                i += 2;\n+            } else {\n+                // In case of invalid percent encoding, add the '%' and continue",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1574339319",
      "id" : 1574339319,
      "in_reply_to_id" : 1571063727,
      "line" : 27,
      "node_id" : "PRRC_kwDOABII585d1oL3",
      "original_commit_id" : "2447bc7774edcc3f0ac92a41d4a7a30dde663da0",
      "original_line" : 27,
      "original_position" : 33,
      "original_start_line" : null,
      "path" : "src/common/url.cpp",
      "position" : 33,
      "pull_request_review_id" : 2014106251,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1574339319/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-22T08:25:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1574339319",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "No, it isn't. Nor is piling on the `EVENT_CFLAGS`. Good catch @hebasto.",
      "created_at" : "2024-04-22T08:42:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#issuecomment-2068827925",
      "id" : 2068827925,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29904",
      "node_id" : "IC_kwDOABII5857T88V",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2068827925/reactions"
      },
      "updated_at" : "2024-04-22T08:42:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2068827925",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> No, it isn't. Nor is piling on the `EVENT_CFLAGS`.\r\n\r\nRemoved both, thanks @hebasto and @laanwj !\r\n\r\n",
      "created_at" : "2024-04-22T23:27:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#issuecomment-2071116761",
      "id" : 2071116761,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29904",
      "node_id" : "IC_kwDOABII5857crvZ",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2071116761/reactions"
      },
      "updated_at" : "2024-04-22T23:27:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2071116761",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1576033526"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1576033526"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: this should move up a bit:\r\n\r\n<details>\r\n<summary>git diff on b7a3f8e375</summary>\r\n\r\n```diff\r\ndiff --git a/src/Makefile.am b/src/Makefile.am\r\nindex 239113a056..7387eb1eaa 100644\r\n--- a/src/Makefile.am\r\n+++ b/src/Makefile.am\r\n@@ -679,6 +679,7 @@ libbitcoin_common_a_SOURCES = \\\r\n   common/run_command.cpp \\\r\n   common/settings.cpp \\\r\n   common/system.cpp \\\r\n+  common/url.cpp \\\r\n   compressor.cpp \\\r\n   core_read.cpp \\\r\n   core_write.cpp \\\r\n@@ -711,8 +712,6 @@ libbitcoin_common_a_SOURCES = \\\r\n   script/solver.cpp \\\r\n   warnings.cpp \\\r\n   $(BITCOIN_CORE_H)\r\n-\r\n-libbitcoin_common_a_SOURCES += common/url.cpp\r\n #\r\n \r\n # util #\r\n\r\n```\r\n</details>\r\n",
      "commit_id" : "b7a3f8e375b87e4f3ccfa7994905dfbf46a23bf2",
      "created_at" : "2024-04-23T10:36:44Z",
      "diff_hunk" : "@@ -712,10 +712,7 @@ libbitcoin_common_a_SOURCES = \\\n   warnings.cpp \\\n   $(BITCOIN_CORE_H)\n \n-if USE_LIBEVENT\n-libbitcoin_common_a_CPPFLAGS += $(EVENT_CFLAGS)\n libbitcoin_common_a_SOURCES += common/url.cpp",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1576033526",
      "id" : 1576033526,
      "line" : 715,
      "node_id" : "PRRC_kwDOABII585d8Fz2",
      "original_commit_id" : "b7a3f8e375b87e4f3ccfa7994905dfbf46a23bf2",
      "original_line" : 715,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/Makefile.am",
      "position" : 6,
      "pull_request_review_id" : 2016873417,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1576033526/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-23T11:15:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1576033526",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1576038708"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1576038708"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: `std::errc` [is part of `system_error`](https://en.cppreference.com/w/cpp/error/errc)",
      "commit_id" : "b7a3f8e375b87e4f3ccfa7994905dfbf46a23bf2",
      "created_at" : "2024-04-23T10:41:11Z",
      "diff_hunk" : "@@ -4,19 +4,33 @@\n \n #include <common/url.h>\n \n-#include <event2/http.h>\n-\n-#include <cstdlib>\n #include <string>\n+#include <stdexcept>",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1576038708",
      "id" : 1576038708,
      "line" : 8,
      "node_id" : "PRRC_kwDOABII585d8HE0",
      "original_commit_id" : "b7a3f8e375b87e4f3ccfa7994905dfbf46a23bf2",
      "original_line" : 8,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/common/url.cpp",
      "position" : 8,
      "pull_request_review_id" : 2016873417,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1576038708/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-23T11:15:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1576038708",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1576040769"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1576040769"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: For new source files we can use a copyright header with HTTPS link and future-proof dating:\r\n```suggestion\r\n// Copyright (c) 2024-present The Bitcoin Core developers\r\n// Distributed under the MIT software license, see the accompanying\r\n// file COPYING or https://opensource.org/license/mit/.\r\n```",
      "commit_id" : "b7a3f8e375b87e4f3ccfa7994905dfbf46a23bf2",
      "created_at" : "2024-04-23T10:43:01Z",
      "diff_hunk" : "@@ -0,0 +1,65 @@\n+// Copyright (c) 2024 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1576040769",
      "id" : 1576040769,
      "line" : 3,
      "node_id" : "PRRC_kwDOABII585d8HlB",
      "original_commit_id" : "b7a3f8e375b87e4f3ccfa7994905dfbf46a23bf2",
      "original_line" : 3,
      "original_position" : 3,
      "original_start_line" : 1,
      "path" : "src/test/common_url_tests.cpp",
      "position" : 3,
      "pull_request_review_id" : 2016884640,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1576040769/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 1,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2024-04-23T10:44:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1576040769",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1576041988"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1576041988"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: It seems no symbols from that header are used in the source file.",
      "commit_id" : "b7a3f8e375b87e4f3ccfa7994905dfbf46a23bf2",
      "created_at" : "2024-04-23T10:44:08Z",
      "diff_hunk" : "@@ -0,0 +1,65 @@\n+// Copyright (c) 2024 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <test/util/setup_common.h>",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1576041988",
      "id" : 1576041988,
      "line" : 5,
      "node_id" : "PRRC_kwDOABII585d8H4E",
      "original_commit_id" : "b7a3f8e375b87e4f3ccfa7994905dfbf46a23bf2",
      "original_line" : 5,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/test/common_url_tests.cpp",
      "position" : 5,
      "pull_request_review_id" : 2016884640,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1576041988/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-23T10:44:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1576041988",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1576047415"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1576047415"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "typo nit\r\n```suggestion\r\nBOOST_AUTO_TEST_CASE(decode_internal_nulls_test) {\r\n```",
      "commit_id" : "b7a3f8e375b87e4f3ccfa7994905dfbf46a23bf2",
      "created_at" : "2024-04-23T10:49:04Z",
      "diff_hunk" : "@@ -0,0 +1,65 @@\n+// Copyright (c) 2024 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <test/util/setup_common.h>\n+#include <common/url.h>\n+\n+#include <string>\n+\n+#include <boost/test/unit_test.hpp>\n+\n+BOOST_AUTO_TEST_SUITE(common_url_tests)\n+\n+// These test vectors were ported from test/regress.c in the libevent library\n+// which used to be a dependency of the UrlDecode function.\n+\n+BOOST_AUTO_TEST_CASE(encode_decode_test) {\n+    BOOST_CHECK_EQUAL(UrlDecode(\"Hello\"), \"Hello\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"99\"), \"99\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"\"), \"\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ123456789-.~_\"),\n+                      \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ123456789-.~_\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"%20\"), \" \");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"%FF%F0%E0\"), \"\\xff\\xf0\\xe0\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"%01%19\"), \"\\x01\\x19\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"http%3A%2F%2Fwww.ietf.org%2Frfc%2Frfc3986.txt\"),\n+                      \"http://www.ietf.org/rfc/rfc3986.txt\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"1%2B2%3D3\"), \"1+2=3\");\n+}\n+\n+BOOST_AUTO_TEST_CASE(decode_malformed_test) {\n+    BOOST_CHECK_EQUAL(UrlDecode(\"%%xhello th+ere \\xff\"), \"%%xhello th+ere \\xff\");\n+\n+    BOOST_CHECK_EQUAL(UrlDecode(\"%\"), \"%\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"%%\"), \"%%\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"%%%\"), \"%%%\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"%%%%\"), \"%%%%\");\n+\n+    BOOST_CHECK_EQUAL(UrlDecode(\"+\"), \"+\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"++\"), \"++\");\n+\n+    BOOST_CHECK_EQUAL(UrlDecode(\"?\"), \"?\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"??\"), \"??\");\n+\n+    BOOST_CHECK_EQUAL(UrlDecode(\"%G1\"), \"%G1\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"%2\"), \"%2\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"%ZX\"), \"%ZX\");\n+\n+    BOOST_CHECK_EQUAL(UrlDecode(\"valid%20string%G1\"), \"valid string%G1\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"%20invalid%ZX\"), \" invalid%ZX\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"%20%G1%ZX\"), \" %G1%ZX\");\n+}\n+\n+BOOST_AUTO_TEST_CASE(decode_lowercase_hex_test) {\n+    BOOST_CHECK_EQUAL(UrlDecode(\"%f0%a0%b0\"), \"\\xf0\\xa0\\xb0\");\n+}\n+\n+BOOST_AUTO_TEST_CASE(decode_internal_nuls_test) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1576047415",
      "id" : 1576047415,
      "line" : 58,
      "node_id" : "PRRC_kwDOABII585d8JM3",
      "original_commit_id" : "b7a3f8e375b87e4f3ccfa7994905dfbf46a23bf2",
      "original_line" : 58,
      "original_position" : 58,
      "original_start_line" : null,
      "path" : "src/test/common_url_tests.cpp",
      "position" : 58,
      "pull_request_review_id" : 2016873417,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1576047415/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-23T11:15:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1576047415",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1576053878"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1576053878"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: includes not sorted",
      "commit_id" : "b7a3f8e375b87e4f3ccfa7994905dfbf46a23bf2",
      "created_at" : "2024-04-23T10:55:00Z",
      "diff_hunk" : "@@ -4,19 +4,33 @@\n \n #include <common/url.h>\n \n-#include <event2/http.h>\n-\n-#include <cstdlib>\n #include <string>\n+#include <stdexcept>",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1576053878",
      "id" : 1576053878,
      "in_reply_to_id" : 1576038708,
      "line" : 8,
      "node_id" : "PRRC_kwDOABII585d8Kx2",
      "original_commit_id" : "b7a3f8e375b87e4f3ccfa7994905dfbf46a23bf2",
      "original_line" : 8,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/common/url.cpp",
      "position" : 8,
      "pull_request_review_id" : 2016873417,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1576053878/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-23T11:15:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1576053878",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1576316804"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1576316804"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "done",
      "commit_id" : "47c472df6ac223b03ad4c533722b2525a58a58c5",
      "created_at" : "2024-04-23T13:59:22Z",
      "diff_hunk" : "@@ -0,0 +1,65 @@\n+// Copyright (c) 2024 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1576316804",
      "id" : 1576316804,
      "in_reply_to_id" : 1576040769,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585d9K-E",
      "original_commit_id" : "b7a3f8e375b87e4f3ccfa7994905dfbf46a23bf2",
      "original_line" : 3,
      "original_position" : 3,
      "original_start_line" : 1,
      "path" : "src/test/common_url_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 2017360884,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1576316804/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2024-04-23T13:59:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1576316804",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1576316974"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1576316974"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "done",
      "commit_id" : "47c472df6ac223b03ad4c533722b2525a58a58c5",
      "created_at" : "2024-04-23T13:59:26Z",
      "diff_hunk" : "@@ -0,0 +1,65 @@\n+// Copyright (c) 2024 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <test/util/setup_common.h>",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1576316974",
      "id" : 1576316974,
      "in_reply_to_id" : 1576041988,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585d9LAu",
      "original_commit_id" : "b7a3f8e375b87e4f3ccfa7994905dfbf46a23bf2",
      "original_line" : 5,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/test/common_url_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 2017361201,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1576316974/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-23T13:59:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1576316974",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1576317113"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1576317113"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "done",
      "commit_id" : "47c472df6ac223b03ad4c533722b2525a58a58c5",
      "created_at" : "2024-04-23T13:59:32Z",
      "diff_hunk" : "@@ -712,10 +712,7 @@ libbitcoin_common_a_SOURCES = \\\n   warnings.cpp \\\n   $(BITCOIN_CORE_H)\n \n-if USE_LIBEVENT\n-libbitcoin_common_a_CPPFLAGS += $(EVENT_CFLAGS)\n libbitcoin_common_a_SOURCES += common/url.cpp",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1576317113",
      "id" : 1576317113,
      "in_reply_to_id" : 1576033526,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585d9LC5",
      "original_commit_id" : "b7a3f8e375b87e4f3ccfa7994905dfbf46a23bf2",
      "original_line" : 715,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/Makefile.am",
      "position" : null,
      "pull_request_review_id" : 2017361447,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1576317113/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-23T13:59:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1576317113",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1576317267"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1576317267"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "both done",
      "commit_id" : "47c472df6ac223b03ad4c533722b2525a58a58c5",
      "created_at" : "2024-04-23T13:59:37Z",
      "diff_hunk" : "@@ -4,19 +4,33 @@\n \n #include <common/url.h>\n \n-#include <event2/http.h>\n-\n-#include <cstdlib>\n #include <string>\n+#include <stdexcept>",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1576317267",
      "id" : 1576317267,
      "in_reply_to_id" : 1576038708,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585d9LFT",
      "original_commit_id" : "b7a3f8e375b87e4f3ccfa7994905dfbf46a23bf2",
      "original_line" : 8,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/common/url.cpp",
      "position" : null,
      "pull_request_review_id" : 2017361695,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1576317267/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-23T13:59:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1576317267",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1576317764"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1576317764"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "done, I took this naming from libevent exactly fwiw but since we change the behavior and tests anyway, it's not that relevant anymore to keep it consistent",
      "commit_id" : "47c472df6ac223b03ad4c533722b2525a58a58c5",
      "created_at" : "2024-04-23T13:59:55Z",
      "diff_hunk" : "@@ -0,0 +1,65 @@\n+// Copyright (c) 2024 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <test/util/setup_common.h>\n+#include <common/url.h>\n+\n+#include <string>\n+\n+#include <boost/test/unit_test.hpp>\n+\n+BOOST_AUTO_TEST_SUITE(common_url_tests)\n+\n+// These test vectors were ported from test/regress.c in the libevent library\n+// which used to be a dependency of the UrlDecode function.\n+\n+BOOST_AUTO_TEST_CASE(encode_decode_test) {\n+    BOOST_CHECK_EQUAL(UrlDecode(\"Hello\"), \"Hello\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"99\"), \"99\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"\"), \"\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ123456789-.~_\"),\n+                      \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ123456789-.~_\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"%20\"), \" \");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"%FF%F0%E0\"), \"\\xff\\xf0\\xe0\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"%01%19\"), \"\\x01\\x19\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"http%3A%2F%2Fwww.ietf.org%2Frfc%2Frfc3986.txt\"),\n+                      \"http://www.ietf.org/rfc/rfc3986.txt\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"1%2B2%3D3\"), \"1+2=3\");\n+}\n+\n+BOOST_AUTO_TEST_CASE(decode_malformed_test) {\n+    BOOST_CHECK_EQUAL(UrlDecode(\"%%xhello th+ere \\xff\"), \"%%xhello th+ere \\xff\");\n+\n+    BOOST_CHECK_EQUAL(UrlDecode(\"%\"), \"%\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"%%\"), \"%%\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"%%%\"), \"%%%\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"%%%%\"), \"%%%%\");\n+\n+    BOOST_CHECK_EQUAL(UrlDecode(\"+\"), \"+\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"++\"), \"++\");\n+\n+    BOOST_CHECK_EQUAL(UrlDecode(\"?\"), \"?\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"??\"), \"??\");\n+\n+    BOOST_CHECK_EQUAL(UrlDecode(\"%G1\"), \"%G1\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"%2\"), \"%2\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"%ZX\"), \"%ZX\");\n+\n+    BOOST_CHECK_EQUAL(UrlDecode(\"valid%20string%G1\"), \"valid string%G1\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"%20invalid%ZX\"), \" invalid%ZX\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"%20%G1%ZX\"), \" %G1%ZX\");\n+}\n+\n+BOOST_AUTO_TEST_CASE(decode_lowercase_hex_test) {\n+    BOOST_CHECK_EQUAL(UrlDecode(\"%f0%a0%b0\"), \"\\xf0\\xa0\\xb0\");\n+}\n+\n+BOOST_AUTO_TEST_CASE(decode_internal_nuls_test) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1576317764",
      "id" : 1576317764,
      "in_reply_to_id" : 1576047415,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585d9LNE",
      "original_commit_id" : "b7a3f8e375b87e4f3ccfa7994905dfbf46a23bf2",
      "original_line" : 58,
      "original_position" : 58,
      "original_start_line" : null,
      "path" : "src/test/common_url_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 2017362477,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1576317764/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-23T13:59:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1576317764",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Addressed latest feedback from @hebasto and @stickies-v , thank you!",
      "created_at" : "2024-04-23T14:00:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#issuecomment-2072397502",
      "id" : 2072397502,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29904",
      "node_id" : "IC_kwDOABII5857hka-",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2072397502/reactions"
      },
      "updated_at" : "2024-04-23T14:00:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2072397502",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1576323273"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1576323273"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Indentation?",
      "commit_id" : "47c472df6ac223b03ad4c533722b2525a58a58c5",
      "created_at" : "2024-04-23T14:03:16Z",
      "diff_hunk" : "@@ -679,6 +679,7 @@ libbitcoin_common_a_SOURCES = \\\n   common/run_command.cpp \\\n   common/settings.cpp \\\n   common/system.cpp \\\n+\tcommon/url.cpp \\",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1576323273",
      "id" : 1576323273,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585d9MjJ",
      "original_commit_id" : "c8779aa751731471b43c8199592d718b650a218c",
      "original_line" : 682,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/Makefile.am",
      "position" : null,
      "pull_request_review_id" : 2017371644,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1576323273/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-23T14:03:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1576323273",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1576348255"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1576348255"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "should be fixed now, weird, I must have some plugin that inserts these tabs :/",
      "commit_id" : "47c472df6ac223b03ad4c533722b2525a58a58c5",
      "created_at" : "2024-04-23T14:18:51Z",
      "diff_hunk" : "@@ -679,6 +679,7 @@ libbitcoin_common_a_SOURCES = \\\n   common/run_command.cpp \\\n   common/settings.cpp \\\n   common/system.cpp \\\n+\tcommon/url.cpp \\",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1576348255",
      "id" : 1576348255,
      "in_reply_to_id" : 1576323273,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585d9Spf",
      "original_commit_id" : "c8779aa751731471b43c8199592d718b650a218c",
      "original_line" : 682,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/Makefile.am",
      "position" : null,
      "pull_request_review_id" : 2017413440,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1576348255/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-23T14:18:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1576348255",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--85328a0da195eb286784d51f73fa0af9-->\n\nð§ At least one of the CI tasks failed. Make sure to run all tests locally, according to the\ndocumentation.\n\nPossibly this is due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n<sub>Debug: https://github.com/bitcoin/bitcoin/runs/24156835469</sub>",
      "created_at" : "2024-04-23T15:37:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#issuecomment-2072743790",
      "id" : 2072743790,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29904",
      "node_id" : "IC_kwDOABII5857i49u",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2072743790/reactions"
      },
      "updated_at" : "2024-04-23T15:37:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2072743790",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1576523097"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1576523097"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I guess `i+3` fails, because you access the memory past the end of the string(view) as a reference and then take a pointer to that.\r\n\r\nA possible fix could be to use iterators instead of memory-access. Something like this, but not sure if it compiles, or is the best solution.\r\n\r\n```suggestion\r\n            auto [_, ec] = std::from_chars(url_encoded.begin() + (i + 1), url_encoded.begin() + (i + 3), decoded_value, 16);\r\n```",
      "commit_id" : "477c03b42825084ac344050d97ea206a82ba0eb6",
      "created_at" : "2024-04-23T16:08:13Z",
      "diff_hunk" : "@@ -4,19 +4,34 @@\n \n #include <common/url.h>\n \n-#include <event2/http.h>\n-\n-#include <cstdlib>\n+#include <charconv>\n #include <string>\n+#include <string_view>\n+#include <system_error>\n \n-std::string urlDecode(const std::string &urlEncoded) {\n+std::string UrlDecode(std::string_view url_encoded) {\n     std::string res;\n-    if (!urlEncoded.empty()) {\n-        char *decoded = evhttp_uridecode(urlEncoded.c_str(), false, nullptr);\n-        if (decoded) {\n-            res = std::string(decoded);\n-            free(decoded);\n+    res.reserve(url_encoded.size());\n+\n+    for (size_t i = 0; i < url_encoded.size(); ++i) {\n+        char c = url_encoded[i];\n+        // Special handling for percent which should be followed by two hex digits\n+        // representing an octet values, see RFC 3986, Section 2.1 Percent-Encoding\n+        if (c == '%' && i + 2 < url_encoded.size()) {\n+            int decoded_value{0};\n+            auto [_, ec] = std::from_chars(&url_encoded[i + 1], &url_encoded[i + 3], decoded_value, 16);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1576523097",
      "id" : 1576523097,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585d99VZ",
      "original_commit_id" : "47c472df6ac223b03ad4c533722b2525a58a58c5",
      "original_line" : 22,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "src/common/url.cpp",
      "position" : null,
      "pull_request_review_id" : 2017697795,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1576523097/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-23T16:08:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1576523097",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1576524917"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1576524917"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Yeah, I just pushed this.",
      "commit_id" : "477c03b42825084ac344050d97ea206a82ba0eb6",
      "created_at" : "2024-04-23T16:09:34Z",
      "diff_hunk" : "@@ -4,19 +4,34 @@\n \n #include <common/url.h>\n \n-#include <event2/http.h>\n-\n-#include <cstdlib>\n+#include <charconv>\n #include <string>\n+#include <string_view>\n+#include <system_error>\n \n-std::string urlDecode(const std::string &urlEncoded) {\n+std::string UrlDecode(std::string_view url_encoded) {\n     std::string res;\n-    if (!urlEncoded.empty()) {\n-        char *decoded = evhttp_uridecode(urlEncoded.c_str(), false, nullptr);\n-        if (decoded) {\n-            res = std::string(decoded);\n-            free(decoded);\n+    res.reserve(url_encoded.size());\n+\n+    for (size_t i = 0; i < url_encoded.size(); ++i) {\n+        char c = url_encoded[i];\n+        // Special handling for percent which should be followed by two hex digits\n+        // representing an octet values, see RFC 3986, Section 2.1 Percent-Encoding\n+        if (c == '%' && i + 2 < url_encoded.size()) {\n+            int decoded_value{0};\n+            auto [_, ec] = std::from_chars(&url_encoded[i + 1], &url_encoded[i + 3], decoded_value, 16);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1576524917",
      "id" : 1576524917,
      "in_reply_to_id" : 1576523097,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585d99x1",
      "original_commit_id" : "47c472df6ac223b03ad4c533722b2525a58a58c5",
      "original_line" : 22,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "src/common/url.cpp",
      "position" : null,
      "pull_request_review_id" : 2017700655,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1576524917/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-23T16:09:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1576524917",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1576531967"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1576531967"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```suggestion\r\n            auto [_, ec] = std::from_chars(url_encoded.data() + i + 1, url_encoded.data() + i + 3, decoded_value, 16);\r\n```\r\n\r\nProbably a wrong push?",
      "commit_id" : "477c03b42825084ac344050d97ea206a82ba0eb6",
      "created_at" : "2024-04-23T16:14:50Z",
      "diff_hunk" : "@@ -4,19 +4,34 @@\n \n #include <common/url.h>\n \n-#include <event2/http.h>\n-\n-#include <cstdlib>\n+#include <charconv>\n #include <string>\n+#include <string_view>\n+#include <system_error>\n \n-std::string urlDecode(const std::string &urlEncoded) {\n+std::string UrlDecode(std::string_view url_encoded) {\n     std::string res;\n-    if (!urlEncoded.empty()) {\n-        char *decoded = evhttp_uridecode(urlEncoded.c_str(), false, nullptr);\n-        if (decoded) {\n-            res = std::string(decoded);\n-            free(decoded);\n+    res.reserve(url_encoded.size());\n+\n+    for (size_t i = 0; i < url_encoded.size(); ++i) {\n+        char c = url_encoded[i];\n+        // Special handling for percent which should be followed by two hex digits\n+        // representing an octet values, see RFC 3986, Section 2.1 Percent-Encoding\n+        if (c == '%' && i + 2 < url_encoded.size()) {\n+            int decoded_value{0};\n+            auto [_, ec] = std::from_chars(url_encoded.data() + i + 1, url_encoded.data() + i + 1, decoded_value, 16);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1576531967",
      "id" : 1576531967,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585d9_f_",
      "original_commit_id" : "89ffa56b637e389454afbed3102d0257e2df5d77",
      "original_line" : 22,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "src/common/url.cpp",
      "position" : null,
      "pull_request_review_id" : 2017711710,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1576531967/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-23T16:14:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1576531967",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1576534925"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1576534925"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "fixed, thanks",
      "commit_id" : "477c03b42825084ac344050d97ea206a82ba0eb6",
      "created_at" : "2024-04-23T16:17:17Z",
      "diff_hunk" : "@@ -4,19 +4,34 @@\n \n #include <common/url.h>\n \n-#include <event2/http.h>\n-\n-#include <cstdlib>\n+#include <charconv>\n #include <string>\n+#include <string_view>\n+#include <system_error>\n \n-std::string urlDecode(const std::string &urlEncoded) {\n+std::string UrlDecode(std::string_view url_encoded) {\n     std::string res;\n-    if (!urlEncoded.empty()) {\n-        char *decoded = evhttp_uridecode(urlEncoded.c_str(), false, nullptr);\n-        if (decoded) {\n-            res = std::string(decoded);\n-            free(decoded);\n+    res.reserve(url_encoded.size());\n+\n+    for (size_t i = 0; i < url_encoded.size(); ++i) {\n+        char c = url_encoded[i];\n+        // Special handling for percent which should be followed by two hex digits\n+        // representing an octet values, see RFC 3986, Section 2.1 Percent-Encoding\n+        if (c == '%' && i + 2 < url_encoded.size()) {\n+            int decoded_value{0};\n+            auto [_, ec] = std::from_chars(url_encoded.data() + i + 1, url_encoded.data() + i + 1, decoded_value, 16);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1576534925",
      "id" : 1576534925,
      "in_reply_to_id" : 1576531967,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585d-AON",
      "original_commit_id" : "89ffa56b637e389454afbed3102d0257e2df5d77",
      "original_line" : 22,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "src/common/url.cpp",
      "position" : null,
      "pull_request_review_id" : 2017716472,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1576534925/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-23T16:17:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1576534925",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK",
      "created_at" : "2024-04-23T17:48:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#issuecomment-2073028810",
      "id" : 2073028810,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29904",
      "node_id" : "IC_kwDOABII5857j-jK",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2073028810/reactions"
      },
      "updated_at" : "2024-04-23T17:48:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2073028810",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1577057922"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1577057922"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Even this can go? It's fascinating to see how this little function was such a wedge issue and now we can drop half the build system ð ",
      "commit_id" : "477c03b42825084ac344050d97ea206a82ba0eb6",
      "created_at" : "2024-04-24T00:36:47Z",
      "diff_hunk" : "@@ -1706,7 +1706,6 @@ AM_CONDITIONAL([ENABLE_QT_TESTS], [test \"$BUILD_TEST_QT\" = \"yes\"])\n AM_CONDITIONAL([ENABLE_BENCH], [test \"$use_bench\" = \"yes\"])\n AM_CONDITIONAL([USE_QRCODE], [test \"$use_qr\" = \"yes\"])\n AM_CONDITIONAL([USE_LCOV], [test \"$use_lcov\" = \"yes\"])\n-AM_CONDITIONAL([USE_LIBEVENT], [test \"$use_libevent\" = \"yes\"])",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1577057922",
      "id" : 1577057922,
      "line" : 1709,
      "node_id" : "PRRC_kwDOABII585d__6C",
      "original_commit_id" : "477c03b42825084ac344050d97ea206a82ba0eb6",
      "original_line" : 1709,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "configure.ac",
      "position" : 4,
      "pull_request_review_id" : 2018556340,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1577057922/reactions"
      },
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-24T00:36:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1577057922",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1577622427"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1577622427"
         }
      },
      "author_association" : "MEMBER",
      "body" : "How important is it to preserve invalid encodings? For example the decode of `%1 ` (percent, 1, space) differs between this implementation and the one of libevent.",
      "commit_id" : "cb8f83df1916308013a6ae4b8e4914eb805c5343",
      "created_at" : "2024-04-24T09:56:11Z",
      "diff_hunk" : "@@ -0,0 +1,64 @@\n+// Copyright (c) 2024-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or https://opensource.org/license/mit/.\n+\n+#include <common/url.h>\n+\n+#include <string>\n+\n+#include <boost/test/unit_test.hpp>\n+\n+BOOST_AUTO_TEST_SUITE(common_url_tests)\n+\n+// These test vectors were ported from test/regress.c in the libevent library\n+// which used to be a dependency of the UrlDecode function.\n+\n+BOOST_AUTO_TEST_CASE(encode_decode_test) {\n+    BOOST_CHECK_EQUAL(UrlDecode(\"Hello\"), \"Hello\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"99\"), \"99\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"\"), \"\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ123456789-.~_\"),\n+                      \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ123456789-.~_\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"%20\"), \" \");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"%FF%F0%E0\"), \"\\xff\\xf0\\xe0\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"%01%19\"), \"\\x01\\x19\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"http%3A%2F%2Fwww.ietf.org%2Frfc%2Frfc3986.txt\"),\n+                      \"http://www.ietf.org/rfc/rfc3986.txt\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"1%2B2%3D3\"), \"1+2=3\");\n+}\n+\n+BOOST_AUTO_TEST_CASE(decode_malformed_test) {\n+    BOOST_CHECK_EQUAL(UrlDecode(\"%%xhello th+ere \\xff\"), \"%%xhello th+ere \\xff\");\n+\n+    BOOST_CHECK_EQUAL(UrlDecode(\"%\"), \"%\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1577622427",
      "id" : 1577622427,
      "line" : 33,
      "node_id" : "PRRC_kwDOABII585eCJub",
      "original_commit_id" : "477c03b42825084ac344050d97ea206a82ba0eb6",
      "original_line" : 33,
      "original_position" : 33,
      "original_start_line" : null,
      "path" : "src/test/common_url_tests.cpp",
      "position" : 33,
      "pull_request_review_id" : 2019429420,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1577622427/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-24T09:56:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1577622427",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1578006194"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1578006194"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Hm, ok, that's another behavior change I didn't anticipate. Let me first describe my understanding of happens: In [the libevent version](https://github.com/libevent/libevent/blob/e0a4574ba2cbcdb64bb2b593e72be7f7f4010746/http.c#L3492) each of the two characters following the `%` are [looked at individually if they are valid hex characters](https://github.com/libevent/libevent/blob/e0a4574ba2cbcdb64bb2b593e72be7f7f4010746/http.c#L3508). The space is not so the if fails and the fallback case takes over, which just adds the `%` to res and then the next two chars are processed individually and since they are not special cases by themselves, they are also just added to res, so the result is `%1 `. In the current version here we look at both characters together with `std::from_chars`. The white space seems to be ignored, no error raised, and so the `decoded_value` is integer `1`. Then the `static_cast<char>(decoded_value)` converts the `1` to a non-printable character and so the result visually appears to be an empty string. It seems to me now that it's safer to check both digits individually if they are hex, so I have changed the code in this regard and added a few more tests with spaces. Let me know if you found other cases where the behavior is still changing.",
      "commit_id" : "cb8f83df1916308013a6ae4b8e4914eb805c5343",
      "created_at" : "2024-04-24T14:36:53Z",
      "diff_hunk" : "@@ -0,0 +1,64 @@\n+// Copyright (c) 2024-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or https://opensource.org/license/mit/.\n+\n+#include <common/url.h>\n+\n+#include <string>\n+\n+#include <boost/test/unit_test.hpp>\n+\n+BOOST_AUTO_TEST_SUITE(common_url_tests)\n+\n+// These test vectors were ported from test/regress.c in the libevent library\n+// which used to be a dependency of the UrlDecode function.\n+\n+BOOST_AUTO_TEST_CASE(encode_decode_test) {\n+    BOOST_CHECK_EQUAL(UrlDecode(\"Hello\"), \"Hello\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"99\"), \"99\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"\"), \"\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ123456789-.~_\"),\n+                      \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ123456789-.~_\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"%20\"), \" \");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"%FF%F0%E0\"), \"\\xff\\xf0\\xe0\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"%01%19\"), \"\\x01\\x19\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"http%3A%2F%2Fwww.ietf.org%2Frfc%2Frfc3986.txt\"),\n+                      \"http://www.ietf.org/rfc/rfc3986.txt\");\n+    BOOST_CHECK_EQUAL(UrlDecode(\"1%2B2%3D3\"), \"1+2=3\");\n+}\n+\n+BOOST_AUTO_TEST_CASE(decode_malformed_test) {\n+    BOOST_CHECK_EQUAL(UrlDecode(\"%%xhello th+ere \\xff\"), \"%%xhello th+ere \\xff\");\n+\n+    BOOST_CHECK_EQUAL(UrlDecode(\"%\"), \"%\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1578006194",
      "id" : 1578006194,
      "in_reply_to_id" : 1577622427,
      "line" : 33,
      "node_id" : "PRRC_kwDOABII585eDnay",
      "original_commit_id" : "477c03b42825084ac344050d97ea206a82ba0eb6",
      "original_line" : 33,
      "original_position" : 33,
      "original_start_line" : null,
      "path" : "src/test/common_url_tests.cpp",
      "position" : 33,
      "pull_request_review_id" : 2020069741,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1578006194/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-24T14:36:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1578006194",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1578019052"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1578019052"
         }
      },
      "author_association" : "MEMBER",
      "body" : "The hex checking is done inside of from_chars (locale independent), so you can re-use that. Something like this may work:\r\n\r\n```suggestion\r\n        if (c == '%' && i + 2 < url_encoded.size()  \r\n                 \r\n                ) {\r\n            int decoded_value{0};\r\n            auto [p, ec] = std::from_chars(url_encoded.data() + i + 1, url_encoded.data() + i + 3, decoded_value, 16);\r\n\r\n            if(ec == std::errc{} && p==url_encoded.data() + i + 3) { // hex\r\n\r\n            res += static_cast<char>(decoded_value);\r\n            // Next two characters are part of the percent encoding\r\n            i += 2;\r\n            continue;\r\n            }\r\n        }  \r\n        res += c;\r\n```",
      "commit_id" : "cb8f83df1916308013a6ae4b8e4914eb805c5343",
      "created_at" : "2024-04-24T14:45:05Z",
      "diff_hunk" : "@@ -4,19 +4,40 @@\n \n #include <common/url.h>\n \n-#include <event2/http.h>\n-\n-#include <cstdlib>\n+#include <cassert>\n+#include <cctype>\n+#include <charconv>\n #include <string>\n+#include <string_view>\n+#include <system_error>\n \n-std::string urlDecode(const std::string &urlEncoded) {\n+std::string UrlDecode(std::string_view url_encoded) {\n     std::string res;\n-    if (!urlEncoded.empty()) {\n-        char *decoded = evhttp_uridecode(urlEncoded.c_str(), false, nullptr);\n-        if (decoded) {\n-            res = std::string(decoded);\n-            free(decoded);\n+    res.reserve(url_encoded.size());\n+\n+    for (size_t i = 0; i < url_encoded.size(); ++i) {\n+        char c = url_encoded[i];\n+        // Special handling for percent which should be followed by two hex digits\n+        // representing an octet values, see RFC 3986, Section 2.1 Percent-Encoding\n+        if (c == '%' && i + 2 < url_encoded.size() &&\n+                std::isxdigit(static_cast<unsigned char>(url_encoded[i + 1])) &&\n+                std::isxdigit(static_cast<unsigned char>(url_encoded[i + 2]))) {\n+            int decoded_value{0};\n+            auto [_, ec] = std::from_chars(url_encoded.data() + i + 1, url_encoded.data() + i + 3, decoded_value, 16);\n+\n+            // Since we already checked both digits to be valid hex above,\n+            // from_chars should never encounter an error\n+            assert(ec == std::errc{});\n+\n+            res += static_cast<char>(decoded_value);\n+            // Next two characters are part of the percent encoding\n+            i += 2;\n+        } else {\n+            // In case of an invalid percent encoding, we add the '%' and\n+            // continue just like in the base case\n+            res += c;\n         }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1578019052",
      "id" : 1578019052,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585eDqjs",
      "original_commit_id" : "d4c7863a3f7f4cade71feabc0ba06e6b94f6df6f",
      "original_line" : 35,
      "original_position" : 45,
      "original_start_line" : 22,
      "path" : "src/common/url.cpp",
      "position" : null,
      "pull_request_review_id" : 2020090571,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1578019052/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2024-04-24T14:45:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1578019052",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--85328a0da195eb286784d51f73fa0af9-->\n\nð§ At least one of the CI tasks failed. Make sure to run all tests locally, according to the\ndocumentation.\n\nPossibly this is due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n<sub>Debug: https://github.com/bitcoin/bitcoin/runs/24207110287</sub>",
      "created_at" : "2024-04-24T15:11:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#issuecomment-2075182575",
      "id" : 2075182575,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29904",
      "node_id" : "IC_kwDOABII5857sMXv",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2075182575/reactions"
      },
      "updated_at" : "2024-04-24T15:11:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2075182575",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1578065722"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1578065722"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Yepp, looks good, thanks!",
      "commit_id" : "cb8f83df1916308013a6ae4b8e4914eb805c5343",
      "created_at" : "2024-04-24T15:12:54Z",
      "diff_hunk" : "@@ -4,19 +4,40 @@\n \n #include <common/url.h>\n \n-#include <event2/http.h>\n-\n-#include <cstdlib>\n+#include <cassert>\n+#include <cctype>\n+#include <charconv>\n #include <string>\n+#include <string_view>\n+#include <system_error>\n \n-std::string urlDecode(const std::string &urlEncoded) {\n+std::string UrlDecode(std::string_view url_encoded) {\n     std::string res;\n-    if (!urlEncoded.empty()) {\n-        char *decoded = evhttp_uridecode(urlEncoded.c_str(), false, nullptr);\n-        if (decoded) {\n-            res = std::string(decoded);\n-            free(decoded);\n+    res.reserve(url_encoded.size());\n+\n+    for (size_t i = 0; i < url_encoded.size(); ++i) {\n+        char c = url_encoded[i];\n+        // Special handling for percent which should be followed by two hex digits\n+        // representing an octet values, see RFC 3986, Section 2.1 Percent-Encoding\n+        if (c == '%' && i + 2 < url_encoded.size() &&\n+                std::isxdigit(static_cast<unsigned char>(url_encoded[i + 1])) &&\n+                std::isxdigit(static_cast<unsigned char>(url_encoded[i + 2]))) {\n+            int decoded_value{0};\n+            auto [_, ec] = std::from_chars(url_encoded.data() + i + 1, url_encoded.data() + i + 3, decoded_value, 16);\n+\n+            // Since we already checked both digits to be valid hex above,\n+            // from_chars should never encounter an error\n+            assert(ec == std::errc{});\n+\n+            res += static_cast<char>(decoded_value);\n+            // Next two characters are part of the percent encoding\n+            i += 2;\n+        } else {\n+            // In case of an invalid percent encoding, we add the '%' and\n+            // continue just like in the base case\n+            res += c;\n         }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1578065722",
      "id" : 1578065722,
      "in_reply_to_id" : 1578019052,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585eD186",
      "original_commit_id" : "d4c7863a3f7f4cade71feabc0ba06e6b94f6df6f",
      "original_line" : 35,
      "original_position" : 45,
      "original_start_line" : 22,
      "path" : "src/common/url.cpp",
      "position" : null,
      "pull_request_review_id" : 2020168688,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1578065722/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2024-04-24T15:12:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1578065722",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1578133898"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1578133898"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This must be `unsinged`, otherwise a sign (`-`) is treated as valid hex",
      "commit_id" : "992c714451676cee33d3dff49f36329423270c1c",
      "created_at" : "2024-04-24T15:53:43Z",
      "diff_hunk" : "@@ -4,19 +4,42 @@\n \n #include <common/url.h>\n \n-#include <event2/http.h>\n-\n-#include <cstdlib>\n+#include <cassert>\n+#include <charconv>\n #include <string>\n+#include <string_view>\n+#include <system_error>\n+#include <util/strencodings.h>\n \n-std::string urlDecode(const std::string &urlEncoded) {\n+std::string urlDecode(std::string_view urlEncoded) {\n     std::string res;\n-    if (!urlEncoded.empty()) {\n-        char *decoded = evhttp_uridecode(urlEncoded.c_str(), false, nullptr);\n-        if (decoded) {\n-            res = std::string(decoded);\n-            free(decoded);\n+    res.reserve(urlEncoded.size());\n+\n+    for (size_t i = 0; i < urlEncoded.size(); ++i) {\n+        char c = urlEncoded[i];\n+        // Special handling for percent which should be followed by two hex digits\n+        // representing an octet values, see RFC 3986, Section 2.1 Percent-Encoding\n+        if (c == '%' && i + 2 < urlEncoded.size()) {\n+            int decoded_value{0};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1578133898",
      "id" : 1578133898,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585eEGmK",
      "original_commit_id" : "fcee97601f464e3330d10ff85e19e6ce17452897",
      "original_line" : 23,
      "original_position" : 29,
      "original_start_line" : null,
      "path" : "src/common/url.cpp",
      "position" : null,
      "pull_request_review_id" : 2020255232,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1578133898/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-24T16:02:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1578133898",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1578134591"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1578134591"
         }
      },
      "author_association" : "MEMBER",
      "body" : "`%-1`",
      "commit_id" : "992c714451676cee33d3dff49f36329423270c1c",
      "created_at" : "2024-04-24T15:54:14Z",
      "diff_hunk" : "@@ -4,19 +4,42 @@\n \n #include <common/url.h>\n \n-#include <event2/http.h>\n-\n-#include <cstdlib>\n+#include <cassert>\n+#include <charconv>\n #include <string>\n+#include <string_view>\n+#include <system_error>\n+#include <util/strencodings.h>\n \n-std::string urlDecode(const std::string &urlEncoded) {\n+std::string urlDecode(std::string_view urlEncoded) {\n     std::string res;\n-    if (!urlEncoded.empty()) {\n-        char *decoded = evhttp_uridecode(urlEncoded.c_str(), false, nullptr);\n-        if (decoded) {\n-            res = std::string(decoded);\n-            free(decoded);\n+    res.reserve(urlEncoded.size());\n+\n+    for (size_t i = 0; i < urlEncoded.size(); ++i) {\n+        char c = urlEncoded[i];\n+        // Special handling for percent which should be followed by two hex digits\n+        // representing an octet values, see RFC 3986, Section 2.1 Percent-Encoding\n+        if (c == '%' && i + 2 < urlEncoded.size()) {\n+            int decoded_value{0};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1578134591",
      "id" : 1578134591,
      "in_reply_to_id" : 1578133898,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585eEGw_",
      "original_commit_id" : "fcee97601f464e3330d10ff85e19e6ce17452897",
      "original_line" : 23,
      "original_position" : 29,
      "original_start_line" : null,
      "path" : "src/common/url.cpp",
      "position" : null,
      "pull_request_review_id" : 2020255232,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1578134591/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-24T16:02:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1578134591",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1578145369"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1578145369"
         }
      },
      "author_association" : "MEMBER",
      "body" : "style nit: The verbose member calls can be avoided by turning `i` into an iterator:\r\n\r\n```diff\r\n std::string urlDecode(std::string_view urlEncoded) {\r\n     std::string res;\r\n     res.reserve(urlEncoded.size());\r\n \r\n-    for (size_t i = 0; i < urlEncoded.size(); ++i) {\r\n-        char c = urlEncoded[i];\r\n+    for (auto i = urlEncoded.begin(); i < urlEncoded.end(); ++i) {\r\n+        char c = *i;\r\n         // Special handling for percent which should be followed by two hex digits\r\n         // representing an octet values, see RFC 3986, Section 2.1 Percent-Encoding\r\n-        if (c == '%' && i + 2 < urlEncoded.size()) {\r\n-            int decoded_value{0};\r\n-            auto [p, ec] = std::from_chars(urlEncoded.data() + i + 1, urlEncoded.data() + i + 3, decoded_value, 16);\r\n+        if (c == '%' && i + 2 < urlEncoded.end()) {\r\n+            unsigned int decoded_value{0};\r\n+            auto [p, ec] = std::from_chars( i + 1,  i + 3, decoded_value, 16);\r\n \r\n             // Only if there is no error and the pointer is set to the end of\r\n             // the string, we can be sure both characters were valid hex\r\n-            if(ec == std::errc{} && p == urlEncoded.data() + i + 3) {\r\n+            if(ec == std::errc{} && p ==  i + 3) {\r\n                 // A null character terminates the string\r\n                 if (decoded_value == 0) {\r\n                     return res;\r\n",
      "commit_id" : "992c714451676cee33d3dff49f36329423270c1c",
      "created_at" : "2024-04-24T15:59:53Z",
      "diff_hunk" : "@@ -4,19 +4,42 @@\n \n #include <common/url.h>\n \n-#include <event2/http.h>\n-\n-#include <cstdlib>\n+#include <cassert>\n+#include <charconv>\n #include <string>\n+#include <string_view>\n+#include <system_error>\n+#include <util/strencodings.h>\n \n-std::string urlDecode(const std::string &urlEncoded) {\n+std::string urlDecode(std::string_view urlEncoded) {\n     std::string res;\n-    if (!urlEncoded.empty()) {\n-        char *decoded = evhttp_uridecode(urlEncoded.c_str(), false, nullptr);\n-        if (decoded) {\n-            res = std::string(decoded);\n-            free(decoded);\n+    res.reserve(urlEncoded.size());\n+\n+    for (size_t i = 0; i < urlEncoded.size(); ++i) {\n+        char c = urlEncoded[i];\n+        // Special handling for percent which should be followed by two hex digits\n+        // representing an octet values, see RFC 3986, Section 2.1 Percent-Encoding\n+        if (c == '%' && i + 2 < urlEncoded.size()) {\n+            int decoded_value{0};\n+            auto [p, ec] = std::from_chars(urlEncoded.data() + i + 1, urlEncoded.data() + i + 3, decoded_value, 16);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1578145369",
      "id" : 1578145369,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585eEJZZ",
      "original_commit_id" : "fcee97601f464e3330d10ff85e19e6ce17452897",
      "original_line" : 24,
      "original_position" : 30,
      "original_start_line" : null,
      "path" : "src/common/url.cpp",
      "position" : null,
      "pull_request_review_id" : 2020255232,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1578145369/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-24T16:02:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1578145369",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1578146669"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1578146669"
         }
      },
      "author_association" : "MEMBER",
      "body" : "style nit: snake_case for new code, and newline before `{`, according to clang-format",
      "commit_id" : "992c714451676cee33d3dff49f36329423270c1c",
      "created_at" : "2024-04-24T16:00:34Z",
      "diff_hunk" : "@@ -4,19 +4,42 @@\n \n #include <common/url.h>\n \n-#include <event2/http.h>\n-\n-#include <cstdlib>\n+#include <cassert>\n+#include <charconv>\n #include <string>\n+#include <string_view>\n+#include <system_error>\n+#include <util/strencodings.h>\n \n-std::string urlDecode(const std::string &urlEncoded) {\n+std::string urlDecode(std::string_view urlEncoded) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1578146669",
      "id" : 1578146669,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585eEJtt",
      "original_commit_id" : "fcee97601f464e3330d10ff85e19e6ce17452897",
      "original_line" : 14,
      "original_position" : 15,
      "original_start_line" : null,
      "path" : "src/common/url.cpp",
      "position" : null,
      "pull_request_review_id" : 2020255232,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1578146669/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-24T16:02:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1578146669",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--9cd9c72976c961c55c7acef8f6ba82cd-->\n### Guix builds (on x86_64) [untrusted test-only build, possibly unsafe, not for production use]\n\n| File | commit 19722e3e728933e629eb8e407075fb193b2908e2<br>(master) | commit 3db54d655deb2e57cafe9512f1319971d6bba463<br>(master and this pull) |\n|--|--|--|\n| SHA256SUMS.part | [`dd1712328d25bcaf...`](https://drahtbot.space/guix/bitcoin/bitcoin/19722e3e728933e629eb8e407075fb193b2908e2/SHA256SUMS.part) | [`1243f9e62f4a358e...`](https://drahtbot.space/guix/bitcoin/bitcoin/3db54d655deb2e57cafe9512f1319971d6bba463/SHA256SUMS.part) |\n| *-aarch64-linux-gnu-debug.tar.gz | [`fbc72cad71f5f74b...`](https://drahtbot.space/guix/bitcoin/bitcoin/19722e3e728933e629eb8e407075fb193b2908e2/bitcoin-19722e3e7289-aarch64-linux-gnu-debug.tar.gz) | [`fdc5596c5b2d1535...`](https://drahtbot.space/guix/bitcoin/bitcoin/3db54d655deb2e57cafe9512f1319971d6bba463/bitcoin-3db54d655deb-aarch64-linux-gnu-debug.tar.gz) |\n| *-aarch64-linux-gnu.tar.gz | [`44b0f030a753f1e8...`](https://drahtbot.space/guix/bitcoin/bitcoin/19722e3e728933e629eb8e407075fb193b2908e2/bitcoin-19722e3e7289-aarch64-linux-gnu.tar.gz) | [`b2424b849fec0ec5...`](https://drahtbot.space/guix/bitcoin/bitcoin/3db54d655deb2e57cafe9512f1319971d6bba463/bitcoin-3db54d655deb-aarch64-linux-gnu.tar.gz) |\n| *-arm-linux-gnueabihf-debug.tar.gz | [`f74c72fe6e94b042...`](https://drahtbot.space/guix/bitcoin/bitcoin/19722e3e728933e629eb8e407075fb193b2908e2/bitcoin-19722e3e7289-arm-linux-gnueabihf-debug.tar.gz) | [`16279e80f5ec1d2d...`](https://drahtbot.space/guix/bitcoin/bitcoin/3db54d655deb2e57cafe9512f1319971d6bba463/bitcoin-3db54d655deb-arm-linux-gnueabihf-debug.tar.gz) |\n| *-arm-linux-gnueabihf.tar.gz | [`ec25b11c12af5bd9...`](https://drahtbot.space/guix/bitcoin/bitcoin/19722e3e728933e629eb8e407075fb193b2908e2/bitcoin-19722e3e7289-arm-linux-gnueabihf.tar.gz) | [`2ed1a728ce6df93c...`](https://drahtbot.space/guix/bitcoin/bitcoin/3db54d655deb2e57cafe9512f1319971d6bba463/bitcoin-3db54d655deb-arm-linux-gnueabihf.tar.gz) |\n| *-arm64-apple-darwin-unsigned.tar.gz | [`5737f85f0414f80b...`](https://drahtbot.space/guix/bitcoin/bitcoin/19722e3e728933e629eb8e407075fb193b2908e2/bitcoin-19722e3e7289-arm64-apple-darwin-unsigned.tar.gz) | [`79deb92dd6ee804c...`](https://drahtbot.space/guix/bitcoin/bitcoin/3db54d655deb2e57cafe9512f1319971d6bba463/bitcoin-3db54d655deb-arm64-apple-darwin-unsigned.tar.gz) |\n| *-arm64-apple-darwin-unsigned.zip | [`89397807079e9e09...`](https://drahtbot.space/guix/bitcoin/bitcoin/19722e3e728933e629eb8e407075fb193b2908e2/bitcoin-19722e3e7289-arm64-apple-darwin-unsigned.zip) | [`b624036147bc56d2...`](https://drahtbot.space/guix/bitcoin/bitcoin/3db54d655deb2e57cafe9512f1319971d6bba463/bitcoin-3db54d655deb-arm64-apple-darwin-unsigned.zip) |\n| *-arm64-apple-darwin.tar.gz | [`da23abaa516c746d...`](https://drahtbot.space/guix/bitcoin/bitcoin/19722e3e728933e629eb8e407075fb193b2908e2/bitcoin-19722e3e7289-arm64-apple-darwin.tar.gz) | [`9a9d2bedc06f7185...`](https://drahtbot.space/guix/bitcoin/bitcoin/3db54d655deb2e57cafe9512f1319971d6bba463/bitcoin-3db54d655deb-arm64-apple-darwin.tar.gz) |\n| *-powerpc64-linux-gnu-debug.tar.gz | [`8e020a133752d536...`](https://drahtbot.space/guix/bitcoin/bitcoin/19722e3e728933e629eb8e407075fb193b2908e2/bitcoin-19722e3e7289-powerpc64-linux-gnu-debug.tar.gz) | [`5dc045731387cb03...`](https://drahtbot.space/guix/bitcoin/bitcoin/3db54d655deb2e57cafe9512f1319971d6bba463/bitcoin-3db54d655deb-powerpc64-linux-gnu-debug.tar.gz) |\n| *-powerpc64-linux-gnu.tar.gz | [`51263f27eb622313...`](https://drahtbot.space/guix/bitcoin/bitcoin/19722e3e728933e629eb8e407075fb193b2908e2/bitcoin-19722e3e7289-powerpc64-linux-gnu.tar.gz) | [`9eab562db7f148a3...`](https://drahtbot.space/guix/bitcoin/bitcoin/3db54d655deb2e57cafe9512f1319971d6bba463/bitcoin-3db54d655deb-powerpc64-linux-gnu.tar.gz) |\n| *-riscv64-linux-gnu-debug.tar.gz | [`4ffa90e40623f251...`](https://drahtbot.space/guix/bitcoin/bitcoin/19722e3e728933e629eb8e407075fb193b2908e2/bitcoin-19722e3e7289-riscv64-linux-gnu-debug.tar.gz) | [`2835f73da39e68d8...`](https://drahtbot.space/guix/bitcoin/bitcoin/3db54d655deb2e57cafe9512f1319971d6bba463/bitcoin-3db54d655deb-riscv64-linux-gnu-debug.tar.gz) |\n| *-riscv64-linux-gnu.tar.gz | [`ca585d1223f81eb6...`](https://drahtbot.space/guix/bitcoin/bitcoin/19722e3e728933e629eb8e407075fb193b2908e2/bitcoin-19722e3e7289-riscv64-linux-gnu.tar.gz) | [`7d605eeef3f0ef43...`](https://drahtbot.space/guix/bitcoin/bitcoin/3db54d655deb2e57cafe9512f1319971d6bba463/bitcoin-3db54d655deb-riscv64-linux-gnu.tar.gz) |\n| *-x86_64-apple-darwin-unsigned.tar.gz | [`7c94bed0e764a97a...`](https://drahtbot.space/guix/bitcoin/bitcoin/19722e3e728933e629eb8e407075fb193b2908e2/bitcoin-19722e3e7289-x86_64-apple-darwin-unsigned.tar.gz) | [`c4d8fd1eaf22f970...`](https://drahtbot.space/guix/bitcoin/bitcoin/3db54d655deb2e57cafe9512f1319971d6bba463/bitcoin-3db54d655deb-x86_64-apple-darwin-unsigned.tar.gz) |\n| *-x86_64-apple-darwin-unsigned.zip | [`6dd1358fbb025b8c...`](https://drahtbot.space/guix/bitcoin/bitcoin/19722e3e728933e629eb8e407075fb193b2908e2/bitcoin-19722e3e7289-x86_64-apple-darwin-unsigned.zip) | [`f8a9538b001bf98e...`](https://drahtbot.space/guix/bitcoin/bitcoin/3db54d655deb2e57cafe9512f1319971d6bba463/bitcoin-3db54d655deb-x86_64-apple-darwin-unsigned.zip) |\n| *-x86_64-apple-darwin.tar.gz | [`c8e2062db3a8e478...`](https://drahtbot.space/guix/bitcoin/bitcoin/19722e3e728933e629eb8e407075fb193b2908e2/bitcoin-19722e3e7289-x86_64-apple-darwin.tar.gz) | [`6cf25aa80cdd02c1...`](https://drahtbot.space/guix/bitcoin/bitcoin/3db54d655deb2e57cafe9512f1319971d6bba463/bitcoin-3db54d655deb-x86_64-apple-darwin.tar.gz) |\n| *-x86_64-linux-gnu-debug.tar.gz | [`b9f95fcb53d4a9b6...`](https://drahtbot.space/guix/bitcoin/bitcoin/19722e3e728933e629eb8e407075fb193b2908e2/bitcoin-19722e3e7289-x86_64-linux-gnu-debug.tar.gz) | [`f1b24f30dd8b4f3e...`](https://drahtbot.space/guix/bitcoin/bitcoin/3db54d655deb2e57cafe9512f1319971d6bba463/bitcoin-3db54d655deb-x86_64-linux-gnu-debug.tar.gz) |\n| *-x86_64-linux-gnu.tar.gz | [`993a1a976d07cacf...`](https://drahtbot.space/guix/bitcoin/bitcoin/19722e3e728933e629eb8e407075fb193b2908e2/bitcoin-19722e3e7289-x86_64-linux-gnu.tar.gz) | [`b8ea47e235056555...`](https://drahtbot.space/guix/bitcoin/bitcoin/3db54d655deb2e57cafe9512f1319971d6bba463/bitcoin-3db54d655deb-x86_64-linux-gnu.tar.gz) |\n| *.tar.gz | [`9f7d684e6dda4ef7...`](https://drahtbot.space/guix/bitcoin/bitcoin/19722e3e728933e629eb8e407075fb193b2908e2/bitcoin-19722e3e7289.tar.gz) | [`4bae0d613217622d...`](https://drahtbot.space/guix/bitcoin/bitcoin/3db54d655deb2e57cafe9512f1319971d6bba463/bitcoin-3db54d655deb.tar.gz) |\n| guix_build.log | [`3f47151e14a51431...`](https://drahtbot.space/guix/bitcoin/bitcoin/19722e3e728933e629eb8e407075fb193b2908e2/guix_build.log) | [`2018dd41c187e857...`](https://drahtbot.space/guix/bitcoin/bitcoin/3db54d655deb2e57cafe9512f1319971d6bba463/guix_build.log) |\n| guix_build.log.diff |  | [`f1c9d3754d446530...`](https://drahtbot.space/guix/bitcoin/bitcoin/3db54d655deb2e57cafe9512f1319971d6bba463/guix_build.log.diff) |\n\n",
      "created_at" : "2024-04-24T17:59:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#issuecomment-2075527163",
      "id" : 2075527163,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29904",
      "node_id" : "IC_kwDOABII5857tgf7",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2075527163/reactions"
      },
      "updated_at" : "2024-04-24T17:59:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2075527163",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1578496251"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1578496251"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "The snake case is already applied in the scripted diff but I applied the clang format suggestions",
      "commit_id" : "992c714451676cee33d3dff49f36329423270c1c",
      "created_at" : "2024-04-24T20:39:58Z",
      "diff_hunk" : "@@ -4,19 +4,42 @@\n \n #include <common/url.h>\n \n-#include <event2/http.h>\n-\n-#include <cstdlib>\n+#include <cassert>\n+#include <charconv>\n #include <string>\n+#include <string_view>\n+#include <system_error>\n+#include <util/strencodings.h>\n \n-std::string urlDecode(const std::string &urlEncoded) {\n+std::string urlDecode(std::string_view urlEncoded) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1578496251",
      "id" : 1578496251,
      "in_reply_to_id" : 1578146669,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585eFfD7",
      "original_commit_id" : "fcee97601f464e3330d10ff85e19e6ce17452897",
      "original_line" : 14,
      "original_position" : 15,
      "original_start_line" : null,
      "path" : "src/common/url.cpp",
      "position" : null,
      "pull_request_review_id" : 2020901709,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1578496251/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-24T20:39:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1578496251",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1578496354"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1578496354"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "neat, I applied this change",
      "commit_id" : "992c714451676cee33d3dff49f36329423270c1c",
      "created_at" : "2024-04-24T20:40:04Z",
      "diff_hunk" : "@@ -4,19 +4,42 @@\n \n #include <common/url.h>\n \n-#include <event2/http.h>\n-\n-#include <cstdlib>\n+#include <cassert>\n+#include <charconv>\n #include <string>\n+#include <string_view>\n+#include <system_error>\n+#include <util/strencodings.h>\n \n-std::string urlDecode(const std::string &urlEncoded) {\n+std::string urlDecode(std::string_view urlEncoded) {\n     std::string res;\n-    if (!urlEncoded.empty()) {\n-        char *decoded = evhttp_uridecode(urlEncoded.c_str(), false, nullptr);\n-        if (decoded) {\n-            res = std::string(decoded);\n-            free(decoded);\n+    res.reserve(urlEncoded.size());\n+\n+    for (size_t i = 0; i < urlEncoded.size(); ++i) {\n+        char c = urlEncoded[i];\n+        // Special handling for percent which should be followed by two hex digits\n+        // representing an octet values, see RFC 3986, Section 2.1 Percent-Encoding\n+        if (c == '%' && i + 2 < urlEncoded.size()) {\n+            int decoded_value{0};\n+            auto [p, ec] = std::from_chars(urlEncoded.data() + i + 1, urlEncoded.data() + i + 3, decoded_value, 16);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1578496354",
      "id" : 1578496354,
      "in_reply_to_id" : 1578145369,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585eFfFi",
      "original_commit_id" : "fcee97601f464e3330d10ff85e19e6ce17452897",
      "original_line" : 24,
      "original_position" : 30,
      "original_start_line" : null,
      "path" : "src/common/url.cpp",
      "position" : null,
      "pull_request_review_id" : 2020901864,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1578496354/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-24T20:40:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1578496354",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1578496508"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1578496508"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Changed and added a test for this case as well",
      "commit_id" : "992c714451676cee33d3dff49f36329423270c1c",
      "created_at" : "2024-04-24T20:40:13Z",
      "diff_hunk" : "@@ -4,19 +4,42 @@\n \n #include <common/url.h>\n \n-#include <event2/http.h>\n-\n-#include <cstdlib>\n+#include <cassert>\n+#include <charconv>\n #include <string>\n+#include <string_view>\n+#include <system_error>\n+#include <util/strencodings.h>\n \n-std::string urlDecode(const std::string &urlEncoded) {\n+std::string urlDecode(std::string_view urlEncoded) {\n     std::string res;\n-    if (!urlEncoded.empty()) {\n-        char *decoded = evhttp_uridecode(urlEncoded.c_str(), false, nullptr);\n-        if (decoded) {\n-            res = std::string(decoded);\n-            free(decoded);\n+    res.reserve(urlEncoded.size());\n+\n+    for (size_t i = 0; i < urlEncoded.size(); ++i) {\n+        char c = urlEncoded[i];\n+        // Special handling for percent which should be followed by two hex digits\n+        // representing an octet values, see RFC 3986, Section 2.1 Percent-Encoding\n+        if (c == '%' && i + 2 < urlEncoded.size()) {\n+            int decoded_value{0};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1578496508",
      "id" : 1578496508,
      "in_reply_to_id" : 1578133898,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585eFfH8",
      "original_commit_id" : "fcee97601f464e3330d10ff85e19e6ce17452897",
      "original_line" : 23,
      "original_position" : 29,
      "original_start_line" : null,
      "path" : "src/common/url.cpp",
      "position" : null,
      "pull_request_review_id" : 2020902115,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1578496508/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-24T20:40:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1578496508",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> `unsigned` may be better\r\n\r\nNo idea what this means ;) but I addressed the feedback, thanks a lot!",
      "created_at" : "2024-04-24T20:41:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#issuecomment-2075804791",
      "id" : 2075804791,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/29904",
      "node_id" : "IC_kwDOABII5857ukR3",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 1,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2075804791/reactions"
      },
      "updated_at" : "2024-04-24T20:41:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2075804791",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1578533717"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1578533717"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Ugh, looks like MSVC has a problem with this, I am reverting it for now (see https://github.com/bitcoin/bitcoin/actions/runs/8823024109/job/24222527982?pr=29904)",
      "commit_id" : "992c714451676cee33d3dff49f36329423270c1c",
      "created_at" : "2024-04-24T21:20:35Z",
      "diff_hunk" : "@@ -4,19 +4,42 @@\n \n #include <common/url.h>\n \n-#include <event2/http.h>\n-\n-#include <cstdlib>\n+#include <cassert>\n+#include <charconv>\n #include <string>\n+#include <string_view>\n+#include <system_error>\n+#include <util/strencodings.h>\n \n-std::string urlDecode(const std::string &urlEncoded) {\n+std::string urlDecode(std::string_view urlEncoded) {\n     std::string res;\n-    if (!urlEncoded.empty()) {\n-        char *decoded = evhttp_uridecode(urlEncoded.c_str(), false, nullptr);\n-        if (decoded) {\n-            res = std::string(decoded);\n-            free(decoded);\n+    res.reserve(urlEncoded.size());\n+\n+    for (size_t i = 0; i < urlEncoded.size(); ++i) {\n+        char c = urlEncoded[i];\n+        // Special handling for percent which should be followed by two hex digits\n+        // representing an octet values, see RFC 3986, Section 2.1 Percent-Encoding\n+        if (c == '%' && i + 2 < urlEncoded.size()) {\n+            int decoded_value{0};\n+            auto [p, ec] = std::from_chars(urlEncoded.data() + i + 1, urlEncoded.data() + i + 3, decoded_value, 16);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1578533717",
      "id" : 1578533717,
      "in_reply_to_id" : 1578145369,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585eFoNV",
      "original_commit_id" : "fcee97601f464e3330d10ff85e19e6ce17452897",
      "original_line" : 24,
      "original_position" : 30,
      "original_start_line" : null,
      "path" : "src/common/url.cpp",
      "position" : null,
      "pull_request_review_id" : 2020902289,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1578533717/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-24T21:21:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1578533717",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1578771999"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1578771999"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Another MSVC bug for us to report upstream I guess. @hebasto.",
      "commit_id" : "992c714451676cee33d3dff49f36329423270c1c",
      "created_at" : "2024-04-25T02:24:53Z",
      "diff_hunk" : "@@ -4,19 +4,42 @@\n \n #include <common/url.h>\n \n-#include <event2/http.h>\n-\n-#include <cstdlib>\n+#include <cassert>\n+#include <charconv>\n #include <string>\n+#include <string_view>\n+#include <system_error>\n+#include <util/strencodings.h>\n \n-std::string urlDecode(const std::string &urlEncoded) {\n+std::string urlDecode(std::string_view urlEncoded) {\n     std::string res;\n-    if (!urlEncoded.empty()) {\n-        char *decoded = evhttp_uridecode(urlEncoded.c_str(), false, nullptr);\n-        if (decoded) {\n-            res = std::string(decoded);\n-            free(decoded);\n+    res.reserve(urlEncoded.size());\n+\n+    for (size_t i = 0; i < urlEncoded.size(); ++i) {\n+        char c = urlEncoded[i];\n+        // Special handling for percent which should be followed by two hex digits\n+        // representing an octet values, see RFC 3986, Section 2.1 Percent-Encoding\n+        if (c == '%' && i + 2 < urlEncoded.size()) {\n+            int decoded_value{0};\n+            auto [p, ec] = std::from_chars(urlEncoded.data() + i + 1, urlEncoded.data() + i + 3, decoded_value, 16);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1578771999",
      "id" : 1578771999,
      "in_reply_to_id" : 1578145369,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585eGiYf",
      "original_commit_id" : "fcee97601f464e3330d10ff85e19e6ce17452897",
      "original_line" : 24,
      "original_position" : 30,
      "original_start_line" : null,
      "path" : "src/common/url.cpp",
      "position" : null,
      "pull_request_review_id" : 2021358570,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1578771999/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-25T02:24:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1578771999",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1578868096"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1578868096"
         }
      },
      "author_association" : "MEMBER",
      "body" : "No, it is not a msvc bug. from_chars actually accepts a raw pointer, not an iterator, so my draft diff was wrong (type-wise)",
      "commit_id" : "992c714451676cee33d3dff49f36329423270c1c",
      "created_at" : "2024-04-25T05:22:12Z",
      "diff_hunk" : "@@ -4,19 +4,42 @@\n \n #include <common/url.h>\n \n-#include <event2/http.h>\n-\n-#include <cstdlib>\n+#include <cassert>\n+#include <charconv>\n #include <string>\n+#include <string_view>\n+#include <system_error>\n+#include <util/strencodings.h>\n \n-std::string urlDecode(const std::string &urlEncoded) {\n+std::string urlDecode(std::string_view urlEncoded) {\n     std::string res;\n-    if (!urlEncoded.empty()) {\n-        char *decoded = evhttp_uridecode(urlEncoded.c_str(), false, nullptr);\n-        if (decoded) {\n-            res = std::string(decoded);\n-            free(decoded);\n+    res.reserve(urlEncoded.size());\n+\n+    for (size_t i = 0; i < urlEncoded.size(); ++i) {\n+        char c = urlEncoded[i];\n+        // Special handling for percent which should be followed by two hex digits\n+        // representing an octet values, see RFC 3986, Section 2.1 Percent-Encoding\n+        if (c == '%' && i + 2 < urlEncoded.size()) {\n+            int decoded_value{0};\n+            auto [p, ec] = std::from_chars(urlEncoded.data() + i + 1, urlEncoded.data() + i + 3, decoded_value, 16);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1578868096",
      "id" : 1578868096,
      "in_reply_to_id" : 1578145369,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585eG52A",
      "original_commit_id" : "fcee97601f464e3330d10ff85e19e6ce17452897",
      "original_line" : 24,
      "original_position" : 30,
      "original_start_line" : null,
      "path" : "src/common/url.cpp",
      "position" : null,
      "pull_request_review_id" : 2021526836,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1578868096/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-25T05:22:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1578868096",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1578875254"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1578875254"
         }
      },
      "author_association" : "MEMBER",
      "body" : "As the function body is new code, I'd say the `url_encoded` can be done correctly when the code is added, but no big deal",
      "commit_id" : "992c714451676cee33d3dff49f36329423270c1c",
      "created_at" : "2024-04-25T05:24:36Z",
      "diff_hunk" : "@@ -4,19 +4,42 @@\n \n #include <common/url.h>\n \n-#include <event2/http.h>\n-\n-#include <cstdlib>\n+#include <cassert>\n+#include <charconv>\n #include <string>\n+#include <string_view>\n+#include <system_error>\n+#include <util/strencodings.h>\n \n-std::string urlDecode(const std::string &urlEncoded) {\n+std::string urlDecode(std::string_view urlEncoded) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1578875254",
      "id" : 1578875254,
      "in_reply_to_id" : 1578146669,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585eG7l2",
      "original_commit_id" : "fcee97601f464e3330d10ff85e19e6ce17452897",
      "original_line" : 14,
      "original_position" : 15,
      "original_start_line" : null,
      "path" : "src/common/url.cpp",
      "position" : null,
      "pull_request_review_id" : 2021536418,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1578875254/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-25T05:24:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1578875254",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1579111090"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1579111090"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I didn't see compiler errors locally and the other CI jobs also didn't seem to fail on compilation. So I assumed clang does some implicit conversion at that point and MSVC doesn't.",
      "commit_id" : "992c714451676cee33d3dff49f36329423270c1c",
      "created_at" : "2024-04-25T08:46:01Z",
      "diff_hunk" : "@@ -4,19 +4,42 @@\n \n #include <common/url.h>\n \n-#include <event2/http.h>\n-\n-#include <cstdlib>\n+#include <cassert>\n+#include <charconv>\n #include <string>\n+#include <string_view>\n+#include <system_error>\n+#include <util/strencodings.h>\n \n-std::string urlDecode(const std::string &urlEncoded) {\n+std::string urlDecode(std::string_view urlEncoded) {\n     std::string res;\n-    if (!urlEncoded.empty()) {\n-        char *decoded = evhttp_uridecode(urlEncoded.c_str(), false, nullptr);\n-        if (decoded) {\n-            res = std::string(decoded);\n-            free(decoded);\n+    res.reserve(urlEncoded.size());\n+\n+    for (size_t i = 0; i < urlEncoded.size(); ++i) {\n+        char c = urlEncoded[i];\n+        // Special handling for percent which should be followed by two hex digits\n+        // representing an octet values, see RFC 3986, Section 2.1 Percent-Encoding\n+        if (c == '%' && i + 2 < urlEncoded.size()) {\n+            int decoded_value{0};\n+            auto [p, ec] = std::from_chars(urlEncoded.data() + i + 1, urlEncoded.data() + i + 3, decoded_value, 16);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1579111090",
      "id" : 1579111090,
      "in_reply_to_id" : 1578145369,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585eH1Ky",
      "original_commit_id" : "fcee97601f464e3330d10ff85e19e6ce17452897",
      "original_line" : 24,
      "original_position" : 30,
      "original_start_line" : null,
      "path" : "src/common/url.cpp",
      "position" : null,
      "pull_request_review_id" : 2021913357,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1579111090/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-25T08:46:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1579111090",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1579125570"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1579125570"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yes, IIRC a standard library is free to define an iterator as a pointer, or allow iterators to convert to pointers implicitly, but there is no requirement for it do so.",
      "commit_id" : "992c714451676cee33d3dff49f36329423270c1c",
      "created_at" : "2024-04-25T08:56:05Z",
      "diff_hunk" : "@@ -4,19 +4,42 @@\n \n #include <common/url.h>\n \n-#include <event2/http.h>\n-\n-#include <cstdlib>\n+#include <cassert>\n+#include <charconv>\n #include <string>\n+#include <string_view>\n+#include <system_error>\n+#include <util/strencodings.h>\n \n-std::string urlDecode(const std::string &urlEncoded) {\n+std::string urlDecode(std::string_view urlEncoded) {\n     std::string res;\n-    if (!urlEncoded.empty()) {\n-        char *decoded = evhttp_uridecode(urlEncoded.c_str(), false, nullptr);\n-        if (decoded) {\n-            res = std::string(decoded);\n-            free(decoded);\n+    res.reserve(urlEncoded.size());\n+\n+    for (size_t i = 0; i < urlEncoded.size(); ++i) {\n+        char c = urlEncoded[i];\n+        // Special handling for percent which should be followed by two hex digits\n+        // representing an octet values, see RFC 3986, Section 2.1 Percent-Encoding\n+        if (c == '%' && i + 2 < urlEncoded.size()) {\n+            int decoded_value{0};\n+            auto [p, ec] = std::from_chars(urlEncoded.data() + i + 1, urlEncoded.data() + i + 3, decoded_value, 16);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/29904#discussion_r1579125570",
      "id" : 1579125570,
      "in_reply_to_id" : 1578145369,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585eH4tC",
      "original_commit_id" : "fcee97601f464e3330d10ff85e19e6ce17452897",
      "original_line" : 24,
      "original_position" : 30,
      "original_start_line" : null,
      "path" : "src/common/url.cpp",
      "position" : null,
      "pull_request_review_id" : 2021936070,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/29904",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1579125570/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2024-04-25T08:56:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1579125570",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/maflcko/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maflcko/followers",
         "following_url" : "https://api.github.com/users/maflcko/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maflcko/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maflcko",
         "id" : 6399679,
         "login" : "maflcko",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/maflcko/orgs",
         "received_events_url" : "https://api.github.com/users/maflcko/received_events",
         "repos_url" : "https://api.github.com/users/maflcko/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maflcko/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maflcko/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maflcko"
      }
   }
]
