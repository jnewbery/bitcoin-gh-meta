{
   "active_lock_reason" : null,
   "assignee" : null,
   "assignees" : [],
   "author_association" : "MEMBER",
   "body" : "This was suggested in https://github.com/bitcoin/bitcoin/pull/26933#issuecomment-1412320818.\r\n\r\n**The Problem**\r\nPackage CPFP (only accessible through regtest-only RPC submitpackage) allows 0-fee (or otherwise below min relay feerate) transactions if they are bumped by a child. We need to know what to do with these transactions if they lose their sponsor, e.g. due to a replacement that removed the input spending this 0-fee transaction.\r\n\r\nThis is made slightly more complicated by the fact that our \"selection scoring\" (BlockAssembler) is different from our \"eviction scoring.\" Roughly, we select based on ancestor feerate and evict based on descendant feerate. This may lead to [evicting things we would actually want to mine](https://github.com/bitcoin/bitcoin/pull/27018#issuecomment-1424742766) and [not evicting things that we will never mine](https://github.com/bitcoin/bitcoin/pull/26933#issuecomment-1400143991).\r\n\r\nThis PR's approach is to remove the 1sat/vB `-blockmintxfee` and have BlockAssembler select anything in the mempool (still based on ancestor packages, but not stopping at 1sat/vB). It also adds logic to `TrimToSize()` to evict anything paying <=0 fees. The idea is, if we're getting to the bottom of our mempool, we scrape up all the sats we can. Anything that pays *some* fee is worth adding to the block template.\r\n\r\nA major advantage of this approach is that 0-fee, non-v3 transactions can be bumped in package CPFP.\r\n\r\nA few observations which may or may not be problematic:\r\n- This increases the potential work after a reorg, since we add an extra step of removing the below-minrelayfeerate entries.\r\n- This increases the number of transactions that may be evicted in a replacement (from the worst case scenario we discussed before, it's up to 2500 entries).\r\n- This means you can remove a transaction from your own mempool by calling prioritisetransaction with a negative value.\r\n",
   "closed_at" : "2023-08-09T09:12:06Z",
   "closed_by" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
      "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
      "followers_url" : "https://api.github.com/users/glozow/followers",
      "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
      "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/glozow",
      "id" : 25183001,
      "login" : "glozow",
      "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
      "organizations_url" : "https://api.github.com/users/glozow/orgs",
      "received_events_url" : "https://api.github.com/users/glozow/received_events",
      "repos_url" : "https://api.github.com/users/glozow/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/glozow"
   },
   "comments" : 12,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27018/comments",
   "created_at" : "2023-02-01T19:11:35Z",
   "draft" : true,
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27018/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/pull/27018",
   "id" : 1566660823,
   "labels" : [
      {
         "color" : "c7def8",
         "default" : false,
         "description" : null,
         "id" : 118378960,
         "name" : "Mining",
         "node_id" : "MDU6TGFiZWwxMTgzNzg5NjA=",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Mining"
      },
      {
         "color" : "fef2c0",
         "default" : false,
         "description" : null,
         "id" : 164208572,
         "name" : "Mempool",
         "node_id" : "MDU6TGFiZWwxNjQyMDg1NzI=",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Mempool"
      },
      {
         "color" : "cccccc",
         "default" : false,
         "description" : "",
         "id" : 5334691551,
         "name" : "CI failed",
         "node_id" : "LA_kwDOABII588AAAABPfju3w",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/CI%20failed"
      }
   ],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27018/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "node_id" : "PR_kwDOABII585JCXFm",
   "number" : 27018,
   "performed_via_github_app" : null,
   "pull_request" : {
      "diff_url" : "https://github.com/bitcoin/bitcoin/pull/27018.diff",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27018",
      "merged_at" : null,
      "patch_url" : "https://github.com/bitcoin/bitcoin/pull/27018.patch",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27018"
   },
   "reactions" : {
      "+1" : 0,
      "-1" : 0,
      "confused" : 0,
      "eyes" : 0,
      "heart" : 0,
      "hooray" : 0,
      "laugh" : 0,
      "rocket" : 0,
      "total_count" : 0,
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27018/reactions"
   },
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "closed",
   "state_reason" : null,
   "timeline_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27018/timeline",
   "title" : "mempool / miner: regularly flush <=0-fee entries and mine everything in the mempool",
   "updated_at" : "2023-08-09T09:12:06Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27018",
   "user" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
      "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
      "followers_url" : "https://api.github.com/users/glozow/followers",
      "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
      "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/glozow",
      "id" : 25183001,
      "login" : "glozow",
      "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
      "organizations_url" : "https://api.github.com/users/glozow/orgs",
      "received_events_url" : "https://api.github.com/users/glozow/received_events",
      "repos_url" : "https://api.github.com/users/glozow/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/glozow"
   }
}
