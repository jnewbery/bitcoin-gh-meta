[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage\nFor detailed information about the code coverage, see the [test coverage report](https://corecheck.dev/bitcoin/bitcoin/pulls/27034).\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [aureleoules](https://github.com/bitcoin/bitcoin/pull/27034#pullrequestreview-1669270305) |\n| Concept ACK | [Sjors](https://github.com/bitcoin/bitcoin/pull/27034#issuecomment-1418799368), [kristapsk](https://github.com/bitcoin/bitcoin/pull/27034#issuecomment-1418804311) |\n\nIf your review is incorrectly listed, please react with ð to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#26840](https://github.com/bitcoin/bitcoin/pull/26840) (refactor: importpubkey, importprivkey, importaddress, importmulti, and importdescriptors rpc by KolbyML)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "created_at" : "2023-02-03T15:21:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27034#issuecomment-1416019711",
      "id" : 1416019711,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27034",
      "node_id" : "IC_kwDOABII585UZr7_",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1416019711/reactions"
      },
      "updated_at" : "2023-10-10T23:03:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1416019711",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27034#discussion_r1097148045"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27034"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1097148045"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Let's not create a legacy spkm inside a descriptor wallet. Just fail instead, and tell the user to use `importdescriptors` for that use case.",
      "commit_id" : "fa78ec839a75d4af8a9779d5478986a1fd33b32d",
      "created_at" : "2023-02-06T09:42:45Z",
      "diff_hunk" : "@@ -247,7 +250,15 @@ RPCHelpMan importaddress()\n     std::shared_ptr<CWallet> const pwallet = GetWalletForJSONRPCRequest(request);\n     if (!pwallet) return UniValue::VNULL;\n \n-    EnsureLegacyScriptPubKeyMan(*pwallet, true);\n+    bool has_legacy = pwallet->GetLegacyScriptPubKeyMan();\n+    if (!has_legacy) {\n+        // As we don't allow mixing watch-only descriptors with spendable ones,\n+        // continue creating a legacy spkm if that is the case",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27034#discussion_r1097148045",
      "id" : 1097148045,
      "line" : 256,
      "node_id" : "PRRC_kwDOABII585BZSaN",
      "original_commit_id" : "fa78ec839a75d4af8a9779d5478986a1fd33b32d",
      "original_line" : 256,
      "original_position" : 27,
      "original_start_line" : null,
      "path" : "src/wallet/rpc/backup.cpp",
      "position" : 27,
      "pull_request_review_id" : 1284854364,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27034",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1097148045/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2023-02-06T09:42:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1097148045",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK on reviving `importaddress` for descriptor wallets for some use cases. But it should continue to fail for anything that doesn't work, and not create a hybrid legacy wallet.",
      "created_at" : "2023-02-06T09:48:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27034#issuecomment-1418799368",
      "id" : 1418799368,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27034",
      "node_id" : "IC_kwDOABII585UkSkI",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1418799368/reactions"
      },
      "updated_at" : "2023-02-06T09:48:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1418799368",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK",
      "created_at" : "2023-02-06T09:52:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27034#issuecomment-1418804311",
      "id" : 1418804311,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27034",
      "node_id" : "IC_kwDOABII585UkTxX",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1418804311/reactions"
      },
      "updated_at" : "2023-02-06T09:52:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1418804311",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4500994?v=4",
         "events_url" : "https://api.github.com/users/kristapsk/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kristapsk/followers",
         "following_url" : "https://api.github.com/users/kristapsk/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kristapsk/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kristapsk",
         "id" : 4500994,
         "login" : "kristapsk",
         "node_id" : "MDQ6VXNlcjQ1MDA5OTQ=",
         "organizations_url" : "https://api.github.com/users/kristapsk/orgs",
         "received_events_url" : "https://api.github.com/users/kristapsk/received_events",
         "repos_url" : "https://api.github.com/users/kristapsk/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kristapsk/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kristapsk/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kristapsk"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27034#discussion_r1097385816"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27034"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1097385816"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This is actually to retain the current behavior, it does not create an hybrid wallet; the legacy spkm creation only happens on blank non-descriptors wallet.\r\n\r\nThe internal `EnsureLegacyScriptPubKeyMan` workflow uses `SetupLegacyScriptPubKeyMan` which fails if the wallet contains any spkm or the `WALLET_FLAG_DESCRIPTORS` wallet flag.",
      "commit_id" : "1d099740031443e185307f66d490ae83be5afbbc",
      "created_at" : "2023-02-06T13:36:54Z",
      "diff_hunk" : "@@ -247,7 +250,15 @@ RPCHelpMan importaddress()\n     std::shared_ptr<CWallet> const pwallet = GetWalletForJSONRPCRequest(request);\n     if (!pwallet) return UniValue::VNULL;\n \n-    EnsureLegacyScriptPubKeyMan(*pwallet, true);\n+    bool has_legacy = pwallet->GetLegacyScriptPubKeyMan();\n+    if (!has_legacy) {\n+        // As we don't allow mixing watch-only descriptors with spendable ones,\n+        // continue creating a legacy spkm if that is the case",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27034#discussion_r1097385816",
      "id" : 1097385816,
      "in_reply_to_id" : 1097148045,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585BaMdY",
      "original_commit_id" : "fa78ec839a75d4af8a9779d5478986a1fd33b32d",
      "original_line" : 256,
      "original_position" : 27,
      "original_start_line" : null,
      "path" : "src/wallet/rpc/backup.cpp",
      "position" : null,
      "pull_request_review_id" : 1285202841,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27034",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1097385816/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2023-02-06T13:36:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1097385816",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Concept ACK on reviving `importaddress` for descriptor wallets for some use cases. But it should continue to fail for anything that doesn't work, and not create a hybrid legacy wallet.\r\n\r\nActually, the comment that I wrote there is wrong, not the code. Will fix it.\r\nThe same previous behavior is retained; the flow does not create an hybrid wallet; the legacy spkm creation only happens on blank non-descriptors wallets. (https://github.com/bitcoin/bitcoin/pull/27034#discussion_r1097385816).",
      "created_at" : "2023-02-06T13:40:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27034#issuecomment-1419100063",
      "id" : 1419100063,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27034",
      "node_id" : "IC_kwDOABII585Ulb-f",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1419100063/reactions"
      },
      "updated_at" : "2023-02-06T13:40:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1419100063",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27034#discussion_r1097431879"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27034"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1097431879"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Ah, that's worth mentioning in the comment, and maybe also covering with a test.",
      "commit_id" : "1d099740031443e185307f66d490ae83be5afbbc",
      "created_at" : "2023-02-06T14:16:22Z",
      "diff_hunk" : "@@ -247,7 +250,15 @@ RPCHelpMan importaddress()\n     std::shared_ptr<CWallet> const pwallet = GetWalletForJSONRPCRequest(request);\n     if (!pwallet) return UniValue::VNULL;\n \n-    EnsureLegacyScriptPubKeyMan(*pwallet, true);\n+    bool has_legacy = pwallet->GetLegacyScriptPubKeyMan();\n+    if (!has_legacy) {\n+        // As we don't allow mixing watch-only descriptors with spendable ones,\n+        // continue creating a legacy spkm if that is the case",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27034#discussion_r1097431879",
      "id" : 1097431879,
      "in_reply_to_id" : 1097148045,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585BaXtH",
      "original_commit_id" : "fa78ec839a75d4af8a9779d5478986a1fd33b32d",
      "original_line" : 256,
      "original_position" : 27,
      "original_start_line" : null,
      "path" : "src/wallet/rpc/backup.cpp",
      "position" : null,
      "pull_request_review_id" : 1285272539,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27034",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1097431879/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2023-02-06T14:16:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1097431879",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27034#discussion_r1097436269"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27034"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1097436269"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I can see how it's useful in a test, but otherwise it's too much of an implementation detail, and potentially confusing.",
      "commit_id" : "1d099740031443e185307f66d490ae83be5afbbc",
      "created_at" : "2023-02-06T14:19:41Z",
      "diff_hunk" : "@@ -59,6 +59,7 @@ static RPCHelpMan getwalletinfo()\n                         }, /*skip_type_check=*/true},\n                         {RPCResult::Type::BOOL, \"descriptors\", \"whether this wallet uses descriptors for scriptPubKey management\"},\n                         {RPCResult::Type::BOOL, \"external_signer\", \"whether this wallet is configured to use an external signer such as a hardware wallet\"},\n+                        {RPCResult::Type::BOOL, \"has_legacy\", \"whether this wallet contain a legacy scriptPubKey manager or not\"},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27034#discussion_r1097436269",
      "id" : 1097436269,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585BaYxt",
      "original_commit_id" : "fa78ec839a75d4af8a9779d5478986a1fd33b32d",
      "original_line" : 62,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/wallet/rpc/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 1285279101,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27034",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1097436269/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2023-02-06T14:19:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1097436269",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27034#discussion_r1097485920"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27034"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1097485920"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I don't think that differs much from the returned 'descriptors' flag. The information might be useful for debugging users' issues.\r\nBut.. I'm not so strong for it neither. Flag removed.",
      "commit_id" : "1d099740031443e185307f66d490ae83be5afbbc",
      "created_at" : "2023-02-06T14:51:41Z",
      "diff_hunk" : "@@ -59,6 +59,7 @@ static RPCHelpMan getwalletinfo()\n                         }, /*skip_type_check=*/true},\n                         {RPCResult::Type::BOOL, \"descriptors\", \"whether this wallet uses descriptors for scriptPubKey management\"},\n                         {RPCResult::Type::BOOL, \"external_signer\", \"whether this wallet is configured to use an external signer such as a hardware wallet\"},\n+                        {RPCResult::Type::BOOL, \"has_legacy\", \"whether this wallet contain a legacy scriptPubKey manager or not\"},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27034#discussion_r1097485920",
      "id" : 1097485920,
      "in_reply_to_id" : 1097436269,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585Bak5g",
      "original_commit_id" : "fa78ec839a75d4af8a9779d5478986a1fd33b32d",
      "original_line" : 62,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/wallet/rpc/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 1285354367,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27034",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1097485920/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2023-02-06T14:51:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1097485920",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27034#discussion_r1097487531"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27034"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1097487531"
         }
      },
      "author_association" : "MEMBER",
      "body" : "yeah ðð¼ ",
      "commit_id" : "1d099740031443e185307f66d490ae83be5afbbc",
      "created_at" : "2023-02-06T14:52:26Z",
      "diff_hunk" : "@@ -247,7 +250,15 @@ RPCHelpMan importaddress()\n     std::shared_ptr<CWallet> const pwallet = GetWalletForJSONRPCRequest(request);\n     if (!pwallet) return UniValue::VNULL;\n \n-    EnsureLegacyScriptPubKeyMan(*pwallet, true);\n+    bool has_legacy = pwallet->GetLegacyScriptPubKeyMan();\n+    if (!has_legacy) {\n+        // As we don't allow mixing watch-only descriptors with spendable ones,\n+        // continue creating a legacy spkm if that is the case",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27034#discussion_r1097487531",
      "id" : 1097487531,
      "in_reply_to_id" : 1097148045,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585BalSr",
      "original_commit_id" : "fa78ec839a75d4af8a9779d5478986a1fd33b32d",
      "original_line" : 256,
      "original_position" : 27,
      "original_start_line" : null,
      "path" : "src/wallet/rpc/backup.cpp",
      "position" : null,
      "pull_request_review_id" : 1285356312,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27034",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1097487531/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2023-02-06T14:52:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1097487531",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27034#discussion_r1097528522"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27034"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1097528522"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Pushed test coverage for it.",
      "commit_id" : "8afc6a7bee375b35ca2bce91146d31a1a7ed7485",
      "created_at" : "2023-02-06T15:21:13Z",
      "diff_hunk" : "@@ -247,7 +250,15 @@ RPCHelpMan importaddress()\n     std::shared_ptr<CWallet> const pwallet = GetWalletForJSONRPCRequest(request);\n     if (!pwallet) return UniValue::VNULL;\n \n-    EnsureLegacyScriptPubKeyMan(*pwallet, true);\n+    bool has_legacy = pwallet->GetLegacyScriptPubKeyMan();\n+    if (!has_legacy) {\n+        // As we don't allow mixing watch-only descriptors with spendable ones,\n+        // continue creating a legacy spkm if that is the case",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27034#discussion_r1097528522",
      "id" : 1097528522,
      "in_reply_to_id" : 1097148045,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585BavTK",
      "original_commit_id" : "fa78ec839a75d4af8a9779d5478986a1fd33b32d",
      "original_line" : 256,
      "original_position" : 27,
      "original_start_line" : null,
      "path" : "src/wallet/rpc/backup.cpp",
      "position" : null,
      "pull_request_review_id" : 1285423509,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27034",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1097528522/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2023-02-06T15:21:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1097528522",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27034#discussion_r1097618028"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27034"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1097618028"
         }
      },
      "author_association" : "MEMBER",
      "body" : "It sounds like almost a mix between `descriptors` and `!blank`, but whether or not a legacy wallet contains a (in memory) `LegacySPKM` should not matter to the user. I didn't even know we don't create an empty one in all cases. ",
      "commit_id" : "8afc6a7bee375b35ca2bce91146d31a1a7ed7485",
      "created_at" : "2023-02-06T16:25:40Z",
      "diff_hunk" : "@@ -59,6 +59,7 @@ static RPCHelpMan getwalletinfo()\n                         }, /*skip_type_check=*/true},\n                         {RPCResult::Type::BOOL, \"descriptors\", \"whether this wallet uses descriptors for scriptPubKey management\"},\n                         {RPCResult::Type::BOOL, \"external_signer\", \"whether this wallet is configured to use an external signer such as a hardware wallet\"},\n+                        {RPCResult::Type::BOOL, \"has_legacy\", \"whether this wallet contain a legacy scriptPubKey manager or not\"},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27034#discussion_r1097618028",
      "id" : 1097618028,
      "in_reply_to_id" : 1097436269,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585BbFJs",
      "original_commit_id" : "fa78ec839a75d4af8a9779d5478986a1fd33b32d",
      "original_line" : 62,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/wallet/rpc/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 1285555216,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27034",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1097618028/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2023-02-06T16:25:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1097618028",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "https://cirrus-ci.com/task/5389792813252608?logs=ci#L3465\r\n\r\n```\r\n                                       self.test_legacy_importaddress()\r\n                                     File \"/tmp/cirrus-ci-build/ci/scratch/build/bitcoin-i686-pc-linux-gnu/test/functional/wallet_basic.py\", line 72, in test_legacy_importaddress\r\n                                       assert_equal(wallet_watch_only.getbalances()[\"watchonly\"]['untrusted_pending'], 10)\r\n                                     File \"/tmp/cirrus-ci-build/ci/scratch/build/bitcoin-i686-pc-linux-gnu/test/functional/test_framework/util.py\", line 56, in assert_equal\r\n                                       raise AssertionError(\"not(%s)\" % \" == \".join(str(arg) for arg in (thing1, thing2) + args))\r\n                                   AssertionError: not(0E-8 == 10)",
      "created_at" : "2023-02-20T15:15:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27034#issuecomment-1437177090",
      "id" : 1437177090,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27034",
      "node_id" : "IC_kwDOABII585VqZUC",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1437177090/reactions"
      },
      "updated_at" : "2023-02-20T15:15:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1437177090",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> https://cirrus-ci.com/task/5389792813252608?logs=ci#L3465\r\n> \r\n> ```\r\n>                                        self.test_legacy_importaddress()\r\n>                                      File \"/tmp/cirrus-ci-build/ci/scratch/build/bitcoin-i686-pc-linux-gnu/test/functional/wallet_basic.py\", line 72, in test_legacy_importaddress\r\n>                                        assert_equal(wallet_watch_only.getbalances()[\"watchonly\"]['untrusted_pending'], 10)\r\n>                                      File \"/tmp/cirrus-ci-build/ci/scratch/build/bitcoin-i686-pc-linux-gnu/test/functional/test_framework/util.py\", line 56, in assert_equal\r\n>                                        raise AssertionError(\"not(%s)\" % \" == \".join(str(arg) for arg in (thing1, thing2) + args))\r\n>                                    AssertionError: not(0E-8 == 10)\r\n> ```\r\n\r\nPushed. Thanks @MarcoFalke.\r\nThe issue was related to the trickle mechanism and the test network topology (lack of sync between mempools). Nothing new really, a `sync_mempool` call after sending the tx fixed it.",
      "created_at" : "2023-02-20T22:39:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27034#issuecomment-1437637813",
      "id" : 1437637813,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27034",
      "node_id" : "IC_kwDOABII585VsJy1",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1437637813/reactions"
      },
      "updated_at" : "2023-02-20T22:39:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1437637813",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27034#discussion_r1112863513"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27034"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1112863513"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Suggested alternative wording that avoids \"scriptPubKey manager\".\r\n\r\n```\r\nFor descriptor wallets, this command only works if it has private keys disabled.\r\nIt will create a new descriptor/s. Otherwise, use \\\"importdescriptors\\\" instead.\r\n```",
      "commit_id" : "c744d32a0a24a16e70acf2a38cc055254a3b23b8",
      "created_at" : "2023-02-21T10:27:01Z",
      "diff_hunk" : "@@ -225,7 +227,8 @@ RPCHelpMan importaddress()\n             \"\\nNote: If you import a non-standard raw script in hex form, outputs sending to it will be treated\\n\"\n             \"as change, and not show up in many RPCs.\\n\"\n             \"Note: Use \\\"getwalletinfo\\\" to query the scanning progress.\\n\"\n-            \"Note: This command is only compatible with legacy wallets. Use \\\"importdescriptors\\\" with \\\"addr(X)\\\" for descriptor wallets.\\n\",\n+            \"Note: This command will create a new descriptor/s if the wallet has private keys disabled and has no legacy scriptPubKey manager.\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27034#discussion_r1112863513",
      "id" : 1112863513,
      "line" : 230,
      "node_id" : "PRRC_kwDOABII585CVPMZ",
      "original_commit_id" : "c744d32a0a24a16e70acf2a38cc055254a3b23b8",
      "original_line" : 230,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/wallet/rpc/backup.cpp",
      "position" : 14,
      "pull_request_review_id" : 1307133534,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27034",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1112863513/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2023-02-21T10:35:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1112863513",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27034#discussion_r1112863805"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27034"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1112863805"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This sentence can be dropped with my suggestion.",
      "commit_id" : "c744d32a0a24a16e70acf2a38cc055254a3b23b8",
      "created_at" : "2023-02-21T10:27:16Z",
      "diff_hunk" : "@@ -225,7 +227,8 @@ RPCHelpMan importaddress()\n             \"\\nNote: If you import a non-standard raw script in hex form, outputs sending to it will be treated\\n\"\n             \"as change, and not show up in many RPCs.\\n\"\n             \"Note: Use \\\"getwalletinfo\\\" to query the scanning progress.\\n\"\n-            \"Note: This command is only compatible with legacy wallets. Use \\\"importdescriptors\\\" with \\\"addr(X)\\\" for descriptor wallets.\\n\",\n+            \"Note: This command will create a new descriptor/s if the wallet has private keys disabled and has no legacy scriptPubKey manager.\"\n+            \"For any other case, the legacy scriptPubKey manager will be used\\n\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27034#discussion_r1112863805",
      "id" : 1112863805,
      "line" : 231,
      "node_id" : "PRRC_kwDOABII585CVPQ9",
      "original_commit_id" : "c744d32a0a24a16e70acf2a38cc055254a3b23b8",
      "original_line" : 231,
      "original_position" : 15,
      "original_start_line" : null,
      "path" : "src/wallet/rpc/backup.cpp",
      "position" : 15,
      "pull_request_review_id" : 1307133534,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27034",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1112863805/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2023-02-21T10:35:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1112863805",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27034#discussion_r1112871259"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27034"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1112871259"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I'm confused: `!use_legacy` means we have a descriptor wallet. We should never create a `LegacyScriptPubKeyMan` in that case. I don't understand what this `if` block is trying to achieve, but I think it should `throw JSONRPCError(RPC_WALLET_ERROR, \"Use 'importdescriptors' instead\"`",
      "commit_id" : "c744d32a0a24a16e70acf2a38cc055254a3b23b8",
      "created_at" : "2023-02-21T10:33:49Z",
      "diff_hunk" : "@@ -246,7 +249,17 @@ RPCHelpMan importaddress()\n     std::shared_ptr<CWallet> const pwallet = GetWalletForJSONRPCRequest(request);\n     if (!pwallet) return UniValue::VNULL;\n \n-    EnsureLegacyScriptPubKeyMan(*pwallet, true);\n+    // Use legacy spkm only if the wallet does not support descriptors.\n+    bool use_legacy = !pwallet->IsWalletFlagSet(WALLET_FLAG_DESCRIPTORS);\n+    if (!use_legacy) {\n+        // As we don't allow mixing watch-only descriptors with spendable ones,\n+        // ensure legacy spkm if wallet is blank and descriptors are not supported.\n+        // (blank check is done inside 'EnsureLegacyScriptPubKeyMan()')\n+        if (!pwallet->IsWalletFlagSet(WALLET_FLAG_DISABLE_PRIVATE_KEYS)) {\n+            EnsureLegacyScriptPubKeyMan(*pwallet, /*also_create=*/true);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27034#discussion_r1112871259",
      "id" : 1112871259,
      "line" : 259,
      "node_id" : "PRRC_kwDOABII585CVRFb",
      "original_commit_id" : "c744d32a0a24a16e70acf2a38cc055254a3b23b8",
      "original_line" : 259,
      "original_position" : 31,
      "original_start_line" : null,
      "path" : "src/wallet/rpc/backup.cpp",
      "position" : 31,
      "pull_request_review_id" : 1307133534,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27034",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1112871259/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2023-02-21T10:35:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1112871259",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n",
      "created_at" : "2023-02-22T10:08:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27034#issuecomment-1439746691",
      "id" : 1439746691,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27034",
      "node_id" : "IC_kwDOABII585V0MqD",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1439746691/reactions"
      },
      "updated_at" : "2023-02-22T10:08:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1439746691",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27034#discussion_r1116993439"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27034"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1116993439"
         }
      },
      "author_association" : "MEMBER",
      "body" : "yeah ok. No legacy spkm can be created here because `EnsureLegacyScriptPubKeyMan` internally calls to `SetupLegacyScriptPubKeyMan` which returns early if the `WALLET_FLAG_DESCRIPTORS` is set.\r\n\r\nI thought that we had a release version that upgraded the legacy wallet into a descriptors wallet, letting the user import descriptors while the legacy spkm is available. But.. seems that we never allowed it, at least not officially.\r\n\r\nGood, thanks.",
      "commit_id" : "ced5ef16cbd8f490fc6543724e207b8650ffce5f",
      "created_at" : "2023-02-24T13:21:02Z",
      "diff_hunk" : "@@ -246,7 +249,17 @@ RPCHelpMan importaddress()\n     std::shared_ptr<CWallet> const pwallet = GetWalletForJSONRPCRequest(request);\n     if (!pwallet) return UniValue::VNULL;\n \n-    EnsureLegacyScriptPubKeyMan(*pwallet, true);\n+    // Use legacy spkm only if the wallet does not support descriptors.\n+    bool use_legacy = !pwallet->IsWalletFlagSet(WALLET_FLAG_DESCRIPTORS);\n+    if (!use_legacy) {\n+        // As we don't allow mixing watch-only descriptors with spendable ones,\n+        // ensure legacy spkm if wallet is blank and descriptors are not supported.\n+        // (blank check is done inside 'EnsureLegacyScriptPubKeyMan()')\n+        if (!pwallet->IsWalletFlagSet(WALLET_FLAG_DISABLE_PRIVATE_KEYS)) {\n+            EnsureLegacyScriptPubKeyMan(*pwallet, /*also_create=*/true);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27034#discussion_r1116993439",
      "id" : 1116993439,
      "in_reply_to_id" : 1112871259,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585Ck_ef",
      "original_commit_id" : "c744d32a0a24a16e70acf2a38cc055254a3b23b8",
      "original_line" : 259,
      "original_position" : 31,
      "original_start_line" : null,
      "path" : "src/wallet/rpc/backup.cpp",
      "position" : null,
      "pull_request_review_id" : 1313415921,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27034",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1116993439/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2023-02-24T13:21:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1116993439",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27034#discussion_r1117043367"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27034"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1117043367"
         }
      },
      "author_association" : "MEMBER",
      "body" : "pushed without the last part, mainly because the user cannot import watch-only descriptors on a private keys enabled wallet. So, `importdescriptors` wouldn't help anyway.",
      "commit_id" : "ced5ef16cbd8f490fc6543724e207b8650ffce5f",
      "created_at" : "2023-02-24T13:59:12Z",
      "diff_hunk" : "@@ -225,7 +227,8 @@ RPCHelpMan importaddress()\n             \"\\nNote: If you import a non-standard raw script in hex form, outputs sending to it will be treated\\n\"\n             \"as change, and not show up in many RPCs.\\n\"\n             \"Note: Use \\\"getwalletinfo\\\" to query the scanning progress.\\n\"\n-            \"Note: This command is only compatible with legacy wallets. Use \\\"importdescriptors\\\" with \\\"addr(X)\\\" for descriptor wallets.\\n\",\n+            \"Note: This command will create a new descriptor/s if the wallet has private keys disabled and has no legacy scriptPubKey manager.\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27034#discussion_r1117043367",
      "id" : 1117043367,
      "in_reply_to_id" : 1112863513,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585ClLqn",
      "original_commit_id" : "c744d32a0a24a16e70acf2a38cc055254a3b23b8",
      "original_line" : 230,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/wallet/rpc/backup.cpp",
      "position" : null,
      "pull_request_review_id" : 1313473371,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27034",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1117043367/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2023-02-24T13:59:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1117043367",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> > the legacy spkm creation only happens on blank non-descriptors wallets\r\n> \r\n> I don't think this is true, but maybe I'm reading the code wrong.\r\n\r\nYou mean that there are other situations where a legacy spkm should be created?\r\nOr you were referring to https://github.com/bitcoin/bitcoin/pull/27034#discussion_r1116993439?\r\n\r\nJust pushed an update [diff](https://github.com/bitcoin/bitcoin/compare/c744d32a0a24a16e70acf2a38cc055254a3b23b8..d3bd158bbdc976c76c7331c2ec79a12574c4e87c).\r\nThanks for the feedback ðð¼ .",
      "created_at" : "2023-02-24T14:04:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27034#issuecomment-1443727487",
      "id" : 1443727487,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27034",
      "node_id" : "IC_kwDOABII585WDYh_",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1443727487/reactions"
      },
      "updated_at" : "2023-02-24T14:04:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1443727487",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27034#discussion_r1121399359"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27034"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1121399359"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> upgraded the legacy wallet into a descriptors wallet\r\n\r\nI think it's best to have only one way to go from a legacy wallet to a descriptor wallet (the migration RPC), so in the long run it's easier to keep testing this stuff.",
      "commit_id" : "ced5ef16cbd8f490fc6543724e207b8650ffce5f",
      "created_at" : "2023-03-01T09:24:08Z",
      "diff_hunk" : "@@ -246,7 +249,17 @@ RPCHelpMan importaddress()\n     std::shared_ptr<CWallet> const pwallet = GetWalletForJSONRPCRequest(request);\n     if (!pwallet) return UniValue::VNULL;\n \n-    EnsureLegacyScriptPubKeyMan(*pwallet, true);\n+    // Use legacy spkm only if the wallet does not support descriptors.\n+    bool use_legacy = !pwallet->IsWalletFlagSet(WALLET_FLAG_DESCRIPTORS);\n+    if (!use_legacy) {\n+        // As we don't allow mixing watch-only descriptors with spendable ones,\n+        // ensure legacy spkm if wallet is blank and descriptors are not supported.\n+        // (blank check is done inside 'EnsureLegacyScriptPubKeyMan()')\n+        if (!pwallet->IsWalletFlagSet(WALLET_FLAG_DISABLE_PRIVATE_KEYS)) {\n+            EnsureLegacyScriptPubKeyMan(*pwallet, /*also_create=*/true);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27034#discussion_r1121399359",
      "id" : 1121399359,
      "in_reply_to_id" : 1112871259,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585C1zI_",
      "original_commit_id" : "c744d32a0a24a16e70acf2a38cc055254a3b23b8",
      "original_line" : 259,
      "original_position" : 31,
      "original_start_line" : null,
      "path" : "src/wallet/rpc/backup.cpp",
      "position" : null,
      "pull_request_review_id" : 1319390173,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27034",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1121399359/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2023-03-01T09:24:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1121399359",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27034#discussion_r1122178962"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27034"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1122178962"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> > upgraded the legacy wallet into a descriptors wallet\r\n> \r\n> I think it's best to have only one way to go from a legacy wallet to a descriptor wallet (the migration RPC), so in the long run it's easier to keep testing this stuff.\r\n\r\nyeah, agree.",
      "commit_id" : "be3ae51ece862fc072d2574c34c808315ebdbff9",
      "created_at" : "2023-03-01T18:56:04Z",
      "diff_hunk" : "@@ -246,7 +249,17 @@ RPCHelpMan importaddress()\n     std::shared_ptr<CWallet> const pwallet = GetWalletForJSONRPCRequest(request);\n     if (!pwallet) return UniValue::VNULL;\n \n-    EnsureLegacyScriptPubKeyMan(*pwallet, true);\n+    // Use legacy spkm only if the wallet does not support descriptors.\n+    bool use_legacy = !pwallet->IsWalletFlagSet(WALLET_FLAG_DESCRIPTORS);\n+    if (!use_legacy) {\n+        // As we don't allow mixing watch-only descriptors with spendable ones,\n+        // ensure legacy spkm if wallet is blank and descriptors are not supported.\n+        // (blank check is done inside 'EnsureLegacyScriptPubKeyMan()')\n+        if (!pwallet->IsWalletFlagSet(WALLET_FLAG_DISABLE_PRIVATE_KEYS)) {\n+            EnsureLegacyScriptPubKeyMan(*pwallet, /*also_create=*/true);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27034#discussion_r1122178962",
      "id" : 1122178962,
      "in_reply_to_id" : 1112871259,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585C4xeS",
      "original_commit_id" : "c744d32a0a24a16e70acf2a38cc055254a3b23b8",
      "original_line" : 259,
      "original_position" : 31,
      "original_start_line" : null,
      "path" : "src/wallet/rpc/backup.cpp",
      "position" : null,
      "pull_request_review_id" : 1320442203,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27034",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1122178962/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-03-01T18:56:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1122178962",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n",
      "created_at" : "2023-05-01T12:51:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27034#issuecomment-1529679879",
      "id" : 1529679879,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27034",
      "node_id" : "IC_kwDOABII585bLRAH",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1529679879/reactions"
      },
      "updated_at" : "2023-05-01T12:51:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1529679879",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27034#discussion_r1353572058"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27034"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1353572058"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: Is the `/s` a typo?\r\n```suggestion\r\n            \"Note: For descriptor wallets, this command will create new descriptors, and only works if the wallet has private keys disabled.\\n\",\r\n```",
      "commit_id" : "be3ae51ece862fc072d2574c34c808315ebdbff9",
      "created_at" : "2023-10-10T22:56:49Z",
      "diff_hunk" : "@@ -226,7 +228,7 @@ RPCHelpMan importaddress()\n             \"\\nNote: If you import a non-standard raw script in hex form, outputs sending to it will be treated\\n\"\n             \"as change, and not show up in many RPCs.\\n\"\n             \"Note: Use \\\"getwalletinfo\\\" to query the scanning progress.\\n\"\n-            \"Note: This command is only compatible with legacy wallets. Use \\\"importdescriptors\\\" for descriptor wallets.\\n\",\n+            \"Note: For descriptor wallets, this command will create new descriptor/s, and only works if the wallet has private keys disabled.\\n\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27034#discussion_r1353572058",
      "id" : 1353572058,
      "line" : 231,
      "node_id" : "PRRC_kwDOABII585Qrd7a",
      "original_commit_id" : "be3ae51ece862fc072d2574c34c808315ebdbff9",
      "original_line" : 231,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/wallet/rpc/backup.cpp",
      "position" : 14,
      "pull_request_review_id" : 1669270305,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27034",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1353572058/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-10-10T23:03:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1353572058",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22493292?v=4",
         "events_url" : "https://api.github.com/users/aureleoules/events{/privacy}",
         "followers_url" : "https://api.github.com/users/aureleoules/followers",
         "following_url" : "https://api.github.com/users/aureleoules/following{/other_user}",
         "gists_url" : "https://api.github.com/users/aureleoules/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/aureleoules",
         "id" : 22493292,
         "login" : "aureleoules",
         "node_id" : "MDQ6VXNlcjIyNDkzMjky",
         "organizations_url" : "https://api.github.com/users/aureleoules/orgs",
         "received_events_url" : "https://api.github.com/users/aureleoules/received_events",
         "repos_url" : "https://api.github.com/users/aureleoules/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/aureleoules/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/aureleoules/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/aureleoules"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Thanks for the review @aureleoules!\r\nhttps://corecheck.dev/bitcoin/bitcoin/pulls/27034 works great â¤ï¸.\r\n\r\nI think that will close the PR so we can remove this RPC command within the legacy wallet removal path.\r\nHappy to re-open it if there is more interest on it.",
      "created_at" : "2023-10-11T00:20:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27034#issuecomment-1756496290",
      "id" : 1756496290,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27034",
      "node_id" : "IC_kwDOABII585osgGi",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1756496290/reactions"
      },
      "updated_at" : "2023-10-11T00:20:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1756496290",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   }
]
